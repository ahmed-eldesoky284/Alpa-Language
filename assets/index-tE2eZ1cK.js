import*as nM from"@mediapipe/face_mesh";function sM(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const o=Object.getOwnPropertyDescriptor(s,r);o&&Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();function N2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function E2(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var Mx={exports:{}},Hd={},Px={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Lb;function rM(){if(Lb)return wt;Lb=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),i=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;function p(G){return G===null||typeof G!="object"?null:(G=f&&G[f]||G["@@iterator"],typeof G=="function"?G:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,w={};function C(G,ne,ye){this.props=G,this.context=ne,this.refs=w,this.updater=ye||y}C.prototype.isReactComponent={},C.prototype.setState=function(G,ne){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,ne,"setState")},C.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function S(){}S.prototype=C.prototype;function b(G,ne,ye){this.props=G,this.context=ne,this.refs=w,this.updater=ye||y}var E=b.prototype=new S;E.constructor=b,v(E,C.prototype),E.isPureReactComponent=!0;var N=Array.isArray,A=Object.prototype.hasOwnProperty,R={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function z(G,ne,ye){var Te,Se={},Ie=null,Re=null;if(ne!=null)for(Te in ne.ref!==void 0&&(Re=ne.ref),ne.key!==void 0&&(Ie=""+ne.key),ne)A.call(ne,Te)&&!L.hasOwnProperty(Te)&&(Se[Te]=ne[Te]);var Fe=arguments.length-2;if(Fe===1)Se.children=ye;else if(1<Fe){for(var Pe=Array(Fe),Qe=0;Qe<Fe;Qe++)Pe[Qe]=arguments[Qe+2];Se.children=Pe}if(G&&G.defaultProps)for(Te in Fe=G.defaultProps,Fe)Se[Te]===void 0&&(Se[Te]=Fe[Te]);return{$$typeof:n,type:G,key:Ie,ref:Re,props:Se,_owner:R.current}}function M(G,ne){return{$$typeof:n,type:G.type,key:ne,ref:G.ref,props:G.props,_owner:G._owner}}function P(G){return typeof G=="object"&&G!==null&&G.$$typeof===n}function F(G){var ne={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(ye){return ne[ye]})}var q=/\/+/g;function ee(G,ne){return typeof G=="object"&&G!==null&&G.key!=null?F(""+G.key):ne.toString(36)}function ue(G,ne,ye,Te,Se){var Ie=typeof G;(Ie==="undefined"||Ie==="boolean")&&(G=null);var Re=!1;if(G===null)Re=!0;else switch(Ie){case"string":case"number":Re=!0;break;case"object":switch(G.$$typeof){case n:case e:Re=!0}}if(Re)return Re=G,Se=Se(Re),G=Te===""?"."+ee(Re,0):Te,N(Se)?(ye="",G!=null&&(ye=G.replace(q,"$&/")+"/"),ue(Se,ne,ye,"",function(Qe){return Qe})):Se!=null&&(P(Se)&&(Se=M(Se,ye+(!Se.key||Re&&Re.key===Se.key?"":(""+Se.key).replace(q,"$&/")+"/")+G)),ne.push(Se)),1;if(Re=0,Te=Te===""?".":Te+":",N(G))for(var Fe=0;Fe<G.length;Fe++){Ie=G[Fe];var Pe=Te+ee(Ie,Fe);Re+=ue(Ie,ne,ye,Pe,Se)}else if(Pe=p(G),typeof Pe=="function")for(G=Pe.call(G),Fe=0;!(Ie=G.next()).done;)Ie=Ie.value,Pe=Te+ee(Ie,Fe++),Re+=ue(Ie,ne,ye,Pe,Se);else if(Ie==="object")throw ne=String(G),Error("Objects are not valid as a React child (found: "+(ne==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":ne)+"). If you meant to render a collection of children, use an array instead.");return Re}function ie(G,ne,ye){if(G==null)return G;var Te=[],Se=0;return ue(G,Te,"","",function(Ie){return ne.call(ye,Ie,Se++)}),Te}function de(G){if(G._status===-1){var ne=G._result;ne=ne(),ne.then(function(ye){(G._status===0||G._status===-1)&&(G._status=1,G._result=ye)},function(ye){(G._status===0||G._status===-1)&&(G._status=2,G._result=ye)}),G._status===-1&&(G._status=0,G._result=ne)}if(G._status===1)return G._result.default;throw G._result}var ae={current:null},J={transition:null},te={ReactCurrentDispatcher:ae,ReactCurrentBatchConfig:J,ReactCurrentOwner:R};function oe(){throw Error("act(...) is not supported in production builds of React.")}return wt.Children={map:ie,forEach:function(G,ne,ye){ie(G,function(){ne.apply(this,arguments)},ye)},count:function(G){var ne=0;return ie(G,function(){ne++}),ne},toArray:function(G){return ie(G,function(ne){return ne})||[]},only:function(G){if(!P(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},wt.Component=C,wt.Fragment=t,wt.Profiler=r,wt.PureComponent=b,wt.StrictMode=s,wt.Suspense=l,wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=te,wt.act=oe,wt.cloneElement=function(G,ne,ye){if(G==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+G+".");var Te=v({},G.props),Se=G.key,Ie=G.ref,Re=G._owner;if(ne!=null){if(ne.ref!==void 0&&(Ie=ne.ref,Re=R.current),ne.key!==void 0&&(Se=""+ne.key),G.type&&G.type.defaultProps)var Fe=G.type.defaultProps;for(Pe in ne)A.call(ne,Pe)&&!L.hasOwnProperty(Pe)&&(Te[Pe]=ne[Pe]===void 0&&Fe!==void 0?Fe[Pe]:ne[Pe])}var Pe=arguments.length-2;if(Pe===1)Te.children=ye;else if(1<Pe){Fe=Array(Pe);for(var Qe=0;Qe<Pe;Qe++)Fe[Qe]=arguments[Qe+2];Te.children=Fe}return{$$typeof:n,type:G.type,key:Se,ref:Ie,props:Te,_owner:Re}},wt.createContext=function(G){return G={$$typeof:i,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},G.Provider={$$typeof:o,_context:G},G.Consumer=G},wt.createElement=z,wt.createFactory=function(G){var ne=z.bind(null,G);return ne.type=G,ne},wt.createRef=function(){return{current:null}},wt.forwardRef=function(G){return{$$typeof:a,render:G}},wt.isValidElement=P,wt.lazy=function(G){return{$$typeof:d,_payload:{_status:-1,_result:G},_init:de}},wt.memo=function(G,ne){return{$$typeof:u,type:G,compare:ne===void 0?null:ne}},wt.startTransition=function(G){var ne=J.transition;J.transition={};try{G()}finally{J.transition=ne}},wt.unstable_act=oe,wt.useCallback=function(G,ne){return ae.current.useCallback(G,ne)},wt.useContext=function(G){return ae.current.useContext(G)},wt.useDebugValue=function(){},wt.useDeferredValue=function(G){return ae.current.useDeferredValue(G)},wt.useEffect=function(G,ne){return ae.current.useEffect(G,ne)},wt.useId=function(){return ae.current.useId()},wt.useImperativeHandle=function(G,ne,ye){return ae.current.useImperativeHandle(G,ne,ye)},wt.useInsertionEffect=function(G,ne){return ae.current.useInsertionEffect(G,ne)},wt.useLayoutEffect=function(G,ne){return ae.current.useLayoutEffect(G,ne)},wt.useMemo=function(G,ne){return ae.current.useMemo(G,ne)},wt.useReducer=function(G,ne,ye){return ae.current.useReducer(G,ne,ye)},wt.useRef=function(G){return ae.current.useRef(G)},wt.useState=function(G){return ae.current.useState(G)},wt.useSyncExternalStore=function(G,ne,ye){return ae.current.useSyncExternalStore(G,ne,ye)},wt.useTransition=function(){return ae.current.useTransition()},wt.version="18.3.1",wt}var Ob;function $2(){return Ob||(Ob=1,Px.exports=rM()),Px.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vb;function oM(){if(Vb)return Hd;Vb=1;var n=$2(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function i(a,l,u){var d,f={},p=null,y=null;u!==void 0&&(p=""+u),l.key!==void 0&&(p=""+l.key),l.ref!==void 0&&(y=l.ref);for(d in l)s.call(l,d)&&!o.hasOwnProperty(d)&&(f[d]=l[d]);if(a&&a.defaultProps)for(d in l=a.defaultProps,l)f[d]===void 0&&(f[d]=l[d]);return{$$typeof:e,type:a,key:p,ref:y,props:f,_owner:r.current}}return Hd.Fragment=t,Hd.jsx=i,Hd.jsxs=i,Hd}var Bb;function iM(){return Bb||(Bb=1,Mx.exports=oM()),Mx.exports}var xe=iM(),Tt=$2();const vv=N2(Tt);var $m={},Lx={exports:{}},Xs={},Ox={exports:{}},Vx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zb;function aM(){return zb||(zb=1,(function(n){function e(J,te){var oe=J.length;J.push(te);e:for(;0<oe;){var G=oe-1>>>1,ne=J[G];if(0<r(ne,te))J[G]=te,J[oe]=ne,oe=G;else break e}}function t(J){return J.length===0?null:J[0]}function s(J){if(J.length===0)return null;var te=J[0],oe=J.pop();if(oe!==te){J[0]=oe;e:for(var G=0,ne=J.length,ye=ne>>>1;G<ye;){var Te=2*(G+1)-1,Se=J[Te],Ie=Te+1,Re=J[Ie];if(0>r(Se,oe))Ie<ne&&0>r(Re,Se)?(J[G]=Re,J[Ie]=oe,G=Ie):(J[G]=Se,J[Te]=oe,G=Te);else if(Ie<ne&&0>r(Re,oe))J[G]=Re,J[Ie]=oe,G=Ie;else break e}}return te}function r(J,te){var oe=J.sortIndex-te.sortIndex;return oe!==0?oe:J.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();n.unstable_now=function(){return i.now()-a}}var l=[],u=[],d=1,f=null,p=3,y=!1,v=!1,w=!1,C=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(J){for(var te=t(u);te!==null;){if(te.callback===null)s(u);else if(te.startTime<=J)s(u),te.sortIndex=te.expirationTime,e(l,te);else break;te=t(u)}}function N(J){if(w=!1,E(J),!v)if(t(l)!==null)v=!0,de(A);else{var te=t(u);te!==null&&ae(N,te.startTime-J)}}function A(J,te){v=!1,w&&(w=!1,S(z),z=-1),y=!0;var oe=p;try{for(E(te),f=t(l);f!==null&&(!(f.expirationTime>te)||J&&!F());){var G=f.callback;if(typeof G=="function"){f.callback=null,p=f.priorityLevel;var ne=G(f.expirationTime<=te);te=n.unstable_now(),typeof ne=="function"?f.callback=ne:f===t(l)&&s(l),E(te)}else s(l);f=t(l)}if(f!==null)var ye=!0;else{var Te=t(u);Te!==null&&ae(N,Te.startTime-te),ye=!1}return ye}finally{f=null,p=oe,y=!1}}var R=!1,L=null,z=-1,M=5,P=-1;function F(){return!(n.unstable_now()-P<M)}function q(){if(L!==null){var J=n.unstable_now();P=J;var te=!0;try{te=L(!0,J)}finally{te?ee():(R=!1,L=null)}}else R=!1}var ee;if(typeof b=="function")ee=function(){b(q)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,ie=ue.port2;ue.port1.onmessage=q,ee=function(){ie.postMessage(null)}}else ee=function(){C(q,0)};function de(J){L=J,R||(R=!0,ee())}function ae(J,te){z=C(function(){J(n.unstable_now())},te)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(J){J.callback=null},n.unstable_continueExecution=function(){v||y||(v=!0,de(A))},n.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<J?Math.floor(1e3/J):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(J){switch(p){case 1:case 2:case 3:var te=3;break;default:te=p}var oe=p;p=te;try{return J()}finally{p=oe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(J,te){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var oe=p;p=J;try{return te()}finally{p=oe}},n.unstable_scheduleCallback=function(J,te,oe){var G=n.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?G+oe:G):oe=G,J){case 1:var ne=-1;break;case 2:ne=250;break;case 5:ne=1073741823;break;case 4:ne=1e4;break;default:ne=5e3}return ne=oe+ne,J={id:d++,callback:te,priorityLevel:J,startTime:oe,expirationTime:ne,sortIndex:-1},oe>G?(J.sortIndex=oe,e(u,J),t(l)===null&&J===t(u)&&(w?(S(z),z=-1):w=!0,ae(N,oe-G))):(J.sortIndex=ne,e(l,J),v||y||(v=!0,de(A))),J},n.unstable_shouldYield=F,n.unstable_wrapCallback=function(J){var te=p;return function(){var oe=p;p=te;try{return J.apply(this,arguments)}finally{p=oe}}}})(Vx)),Vx}var Ub;function lM(){return Ub||(Ub=1,Ox.exports=aM()),Ox.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wb;function uM(){if(Wb)return Xs;Wb=1;var n=$2(),e=lM();function t(c){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+c,x=1;x<arguments.length;x++)h+="&args[]="+encodeURIComponent(arguments[x]);return"Minified React error #"+c+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function o(c,h){i(c,h),i(c+"Capture",h)}function i(c,h){for(r[c]=h,c=0;c<h.length;c++)s.add(h[c])}var a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),l=Object.prototype.hasOwnProperty,u=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},f={};function p(c){return l.call(f,c)?!0:l.call(d,c)?!1:u.test(c)?f[c]=!0:(d[c]=!0,!1)}function y(c,h,x,T){if(x!==null&&x.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return T?!1:x!==null?!x.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function v(c,h,x,T){if(h===null||typeof h>"u"||y(c,h,x,T))return!0;if(T)return!1;if(x!==null)switch(x.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function w(c,h,x,T,k,$,O){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=T,this.attributeNamespace=k,this.mustUseProperty=x,this.propertyName=c,this.type=h,this.sanitizeURL=$,this.removeEmptyString=O}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){C[c]=new w(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var h=c[0];C[h]=new w(h,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){C[c]=new w(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){C[c]=new w(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){C[c]=new w(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){C[c]=new w(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){C[c]=new w(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){C[c]=new w(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){C[c]=new w(c,5,!1,c.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function b(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var h=c.replace(S,b);C[h]=new w(h,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var h=c.replace(S,b);C[h]=new w(h,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var h=c.replace(S,b);C[h]=new w(h,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){C[c]=new w(c,1,!1,c.toLowerCase(),null,!1,!1)}),C.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){C[c]=new w(c,1,!1,c.toLowerCase(),null,!0,!0)});function E(c,h,x,T){var k=C.hasOwnProperty(h)?C[h]:null;(k!==null?k.type!==0:T||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(v(h,x,k,T)&&(x=null),T||k===null?p(h)&&(x===null?c.removeAttribute(h):c.setAttribute(h,""+x)):k.mustUseProperty?c[k.propertyName]=x===null?k.type===3?!1:"":x:(h=k.attributeName,T=k.attributeNamespace,x===null?c.removeAttribute(h):(k=k.type,x=k===3||k===4&&x===!0?"":""+x,T?c.setAttributeNS(T,h,x):c.setAttribute(h,x))))}var N=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),R=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),z=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),F=Symbol.for("react.context"),q=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),de=Symbol.for("react.lazy"),ae=Symbol.for("react.offscreen"),J=Symbol.iterator;function te(c){return c===null||typeof c!="object"?null:(c=J&&c[J]||c["@@iterator"],typeof c=="function"?c:null)}var oe=Object.assign,G;function ne(c){if(G===void 0)try{throw Error()}catch(x){var h=x.stack.trim().match(/\n( *(at )?)/);G=h&&h[1]||""}return`
`+G+c}var ye=!1;function Te(c,h){if(!c||ye)return"";ye=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(ve){var T=ve}Reflect.construct(c,[],h)}else{try{h.call()}catch(ve){T=ve}c.call(h.prototype)}else{try{throw Error()}catch(ve){T=ve}c()}}catch(ve){if(ve&&T&&typeof ve.stack=="string"){for(var k=ve.stack.split(`
`),$=T.stack.split(`
`),O=k.length-1,K=$.length-1;1<=O&&0<=K&&k[O]!==$[K];)K--;for(;1<=O&&0<=K;O--,K--)if(k[O]!==$[K]){if(O!==1||K!==1)do if(O--,K--,0>K||k[O]!==$[K]){var re=`
`+k[O].replace(" at new "," at ");return c.displayName&&re.includes("<anonymous>")&&(re=re.replace("<anonymous>",c.displayName)),re}while(1<=O&&0<=K);break}}}finally{ye=!1,Error.prepareStackTrace=x}return(c=c?c.displayName||c.name:"")?ne(c):""}function Se(c){switch(c.tag){case 5:return ne(c.type);case 16:return ne("Lazy");case 13:return ne("Suspense");case 19:return ne("SuspenseList");case 0:case 2:case 15:return c=Te(c.type,!1),c;case 11:return c=Te(c.type.render,!1),c;case 1:return c=Te(c.type,!0),c;default:return""}}function Ie(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case L:return"Fragment";case R:return"Portal";case M:return"Profiler";case z:return"StrictMode";case ee:return"Suspense";case ue:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case F:return(c.displayName||"Context")+".Consumer";case P:return(c._context.displayName||"Context")+".Provider";case q:var h=c.render;return c=c.displayName,c||(c=h.displayName||h.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case ie:return h=c.displayName||null,h!==null?h:Ie(c.type)||"Memo";case de:h=c._payload,c=c._init;try{return Ie(c(h))}catch{}}return null}function Re(c){var h=c.type;switch(c.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=h.render,c=c.displayName||c.name||"",h.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ie(h);case 8:return h===z?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function Fe(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function Pe(c){var h=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Qe(c){var h=Pe(c)?"checked":"value",x=Object.getOwnPropertyDescriptor(c.constructor.prototype,h),T=""+c[h];if(!c.hasOwnProperty(h)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var k=x.get,$=x.set;return Object.defineProperty(c,h,{configurable:!0,get:function(){return k.call(this)},set:function(O){T=""+O,$.call(this,O)}}),Object.defineProperty(c,h,{enumerable:x.enumerable}),{getValue:function(){return T},setValue:function(O){T=""+O},stopTracking:function(){c._valueTracker=null,delete c[h]}}}}function je(c){c._valueTracker||(c._valueTracker=Qe(c))}function yt(c){if(!c)return!1;var h=c._valueTracker;if(!h)return!0;var x=h.getValue(),T="";return c&&(T=Pe(c)?c.checked?"true":"false":c.value),c=T,c!==x?(h.setValue(c),!0):!1}function Nt(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function At(c,h){var x=h.checked;return oe({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:x??c._wrapperState.initialChecked})}function It(c,h){var x=h.defaultValue==null?"":h.defaultValue,T=h.checked!=null?h.checked:h.defaultChecked;x=Fe(h.value!=null?h.value:x),c._wrapperState={initialChecked:T,initialValue:x,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function Et(c,h){h=h.checked,h!=null&&E(c,"checked",h,!1)}function Lt(c,h){Et(c,h);var x=Fe(h.value),T=h.type;if(x!=null)T==="number"?(x===0&&c.value===""||c.value!=x)&&(c.value=""+x):c.value!==""+x&&(c.value=""+x);else if(T==="submit"||T==="reset"){c.removeAttribute("value");return}h.hasOwnProperty("value")?Kn(c,h.type,x):h.hasOwnProperty("defaultValue")&&Kn(c,h.type,Fe(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(c.defaultChecked=!!h.defaultChecked)}function Ot(c,h,x){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var T=h.type;if(!(T!=="submit"&&T!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+c._wrapperState.initialValue,x||h===c.value||(c.value=h),c.defaultValue=h}x=c.name,x!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,x!==""&&(c.name=x)}function Kn(c,h,x){(h!=="number"||Nt(c.ownerDocument)!==c)&&(x==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+x&&(c.defaultValue=""+x))}var Xt=Array.isArray;function yn(c,h,x,T){if(c=c.options,h){h={};for(var k=0;k<x.length;k++)h["$"+x[k]]=!0;for(x=0;x<c.length;x++)k=h.hasOwnProperty("$"+c[x].value),c[x].selected!==k&&(c[x].selected=k),k&&T&&(c[x].defaultSelected=!0)}else{for(x=""+Fe(x),h=null,k=0;k<c.length;k++){if(c[k].value===x){c[k].selected=!0,T&&(c[k].defaultSelected=!0);return}h!==null||c[k].disabled||(h=c[k])}h!==null&&(h.selected=!0)}}function xn(c,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return oe({},h,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function rr(c,h){var x=h.value;if(x==null){if(x=h.children,h=h.defaultValue,x!=null){if(h!=null)throw Error(t(92));if(Xt(x)){if(1<x.length)throw Error(t(93));x=x[0]}h=x}h==null&&(h=""),x=h}c._wrapperState={initialValue:Fe(x)}}function is(c,h){var x=Fe(h.value),T=Fe(h.defaultValue);x!=null&&(x=""+x,x!==c.value&&(c.value=x),h.defaultValue==null&&c.defaultValue!==x&&(c.defaultValue=x)),T!=null&&(c.defaultValue=""+T)}function Xn(c){var h=c.textContent;h===c._wrapperState.initialValue&&h!==""&&h!==null&&(c.value=h)}function as(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function fs(c,h){return c==null||c==="http://www.w3.org/1999/xhtml"?as(h):c==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var hs,or=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,x,T,k){MSApp.execUnsafeLocalFunction(function(){return c(h,x,T,k)})}:c})(function(c,h){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=h;else{for(hs=hs||document.createElement("div"),hs.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=hs.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;h.firstChild;)c.appendChild(h.firstChild)}});function wr(c,h){if(h){var x=c.firstChild;if(x&&x===c.lastChild&&x.nodeType===3){x.nodeValue=h;return}}c.textContent=h}var Cr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ll=["Webkit","ms","Moz","O"];Object.keys(Cr).forEach(function(c){Ll.forEach(function(h){h=h+c.charAt(0).toUpperCase()+c.substring(1),Cr[h]=Cr[c]})});function po(c,h,x){return h==null||typeof h=="boolean"||h===""?"":x||typeof h!="number"||h===0||Cr.hasOwnProperty(c)&&Cr[c]?(""+h).trim():h+"px"}function ps(c,h){c=c.style;for(var x in h)if(h.hasOwnProperty(x)){var T=x.indexOf("--")===0,k=po(x,h[x],T);x==="float"&&(x="cssFloat"),T?c.setProperty(x,k):c[x]=k}}var pn=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ol(c,h){if(h){if(pn[c]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function zs(c,h){if(c.indexOf("-")===-1)return typeof h.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ei=null;function Vl(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var Bl=null,Bo=null,zo=null;function cd(c){if(c=Ad(c)){if(typeof Bl!="function")throw Error(t(280));var h=c.stateNode;h&&(h=Gp(h),Bl(c.stateNode,c.type,h))}}function dd(c){Bo?zo?zo.push(c):zo=[c]:Bo=c}function mp(){if(Bo){var c=Bo,h=zo;if(zo=Bo=null,cd(c),h)for(c=0;c<h.length;c++)cd(h[c])}}function gp(c,h){return c(h)}function ba(){}var $i=!1;function fd(c,h,x){if($i)return c(h,x);$i=!0;try{return gp(c,h,x)}finally{$i=!1,(Bo!==null||zo!==null)&&(ba(),mp())}}function Ai(c,h){var x=c.stateNode;if(x===null)return null;var T=Gp(x);if(T===null)return null;x=T[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(T=!T.disabled)||(c=c.type,T=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!T;break e;default:c=!1}if(c)return null;if(x&&typeof x!="function")throw Error(t(231,h,typeof x));return x}var _i=!1;if(a)try{var Ri={};Object.defineProperty(Ri,"passive",{get:function(){_i=!0}}),window.addEventListener("test",Ri,Ri),window.removeEventListener("test",Ri,Ri)}catch{_i=!1}function yp(c,h,x,T,k,$,O,K,re){var ve=Array.prototype.slice.call(arguments,3);try{h.apply(x,ve)}catch($e){this.onError($e)}}var Ia=!1,ka=null,Uo=!1,zl=null,xp={onError:function(c){Ia=!0,ka=c}};function vp(c,h,x,T,k,$,O,K,re){Ia=!1,ka=null,yp.apply(xp,arguments)}function u0(c,h,x,T,k,$,O,K,re){if(vp.apply(this,arguments),Ia){if(Ia){var ve=ka;Ia=!1,ka=null}else throw Error(t(198));Uo||(Uo=!0,zl=ve)}}function Wo(c){var h=c,x=c;if(c.alternate)for(;h.return;)h=h.return;else{c=h;do h=c,(h.flags&4098)!==0&&(x=h.return),c=h.return;while(c)}return h.tag===3?x:null}function wp(c){if(c.tag===13){var h=c.memoizedState;if(h===null&&(c=c.alternate,c!==null&&(h=c.memoizedState)),h!==null)return h.dehydrated}return null}function Cp(c){if(Wo(c)!==c)throw Error(t(188))}function Tp(c){var h=c.alternate;if(!h){if(h=Wo(c),h===null)throw Error(t(188));return h!==c?null:c}for(var x=c,T=h;;){var k=x.return;if(k===null)break;var $=k.alternate;if($===null){if(T=k.return,T!==null){x=T;continue}break}if(k.child===$.child){for($=k.child;$;){if($===x)return Cp(k),c;if($===T)return Cp(k),h;$=$.sibling}throw Error(t(188))}if(x.return!==T.return)x=k,T=$;else{for(var O=!1,K=k.child;K;){if(K===x){O=!0,x=k,T=$;break}if(K===T){O=!0,T=k,x=$;break}K=K.sibling}if(!O){for(K=$.child;K;){if(K===x){O=!0,x=$,T=k;break}if(K===T){O=!0,T=$,x=k;break}K=K.sibling}if(!O)throw Error(t(189))}}if(x.alternate!==T)throw Error(t(190))}if(x.tag!==3)throw Error(t(188));return x.stateNode.current===x?c:h}function hd(c){return c=Tp(c),c!==null?Sp(c):null}function Sp(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var h=Sp(c);if(h!==null)return h;c=c.sibling}return null}var bp=e.unstable_scheduleCallback,Ip=e.unstable_cancelCallback,c0=e.unstable_shouldYield,kp=e.unstable_requestPaint,sn=e.unstable_now,pd=e.unstable_getCurrentPriorityLevel,Ul=e.unstable_ImmediatePriority,Wl=e.unstable_UserBlockingPriority,mo=e.unstable_NormalPriority,ir=e.unstable_LowPriority,Np=e.unstable_IdlePriority,Gl=null,ar=null;function Ep(c){if(ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(Gl,c,void 0,(c.current.flags&128)===128)}catch{}}var rn=Math.clz32?Math.clz32:Ap,$p=Math.log,Na=Math.LN2;function Ap(c){return c>>>=0,c===0?32:31-($p(c)/Na|0)|0}var Di=64,Hl=4194304;function Ea(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function Go(c,h){var x=c.pendingLanes;if(x===0)return 0;var T=0,k=c.suspendedLanes,$=c.pingedLanes,O=x&268435455;if(O!==0){var K=O&~k;K!==0?T=Ea(K):($&=O,$!==0&&(T=Ea($)))}else O=x&~k,O!==0?T=Ea(O):$!==0&&(T=Ea($));if(T===0)return 0;if(h!==0&&h!==T&&(h&k)===0&&(k=T&-T,$=h&-h,k>=$||k===16&&($&4194240)!==0))return h;if((T&4)!==0&&(T|=x&16),h=c.entangledLanes,h!==0)for(c=c.entanglements,h&=T;0<h;)x=31-rn(h),k=1<<x,T|=c[x],h&=~k;return T}function _p(c,h){switch(c){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Rp(c,h){for(var x=c.suspendedLanes,T=c.pingedLanes,k=c.expirationTimes,$=c.pendingLanes;0<$;){var O=31-rn($),K=1<<O,re=k[O];re===-1?((K&x)===0||(K&T)!==0)&&(k[O]=_p(K,h)):re<=h&&(c.expiredLanes|=K),$&=~K}}function md(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function Dp(){var c=Di;return Di<<=1,(Di&4194240)===0&&(Di=64),c}function $a(c){for(var h=[],x=0;31>x;x++)h.push(c);return h}function Fi(c,h,x){c.pendingLanes|=h,h!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,h=31-rn(h),c[h]=x}function Fp(c,h){var x=c.pendingLanes&~h;c.pendingLanes=h,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=h,c.mutableReadLanes&=h,c.entangledLanes&=h,h=c.entanglements;var T=c.eventTimes;for(c=c.expirationTimes;0<x;){var k=31-rn(x),$=1<<k;h[k]=0,T[k]=-1,c[k]=-1,x&=~$}}function ql(c,h){var x=c.entangledLanes|=h;for(c=c.entanglements;x;){var T=31-rn(x),k=1<<T;k&h|c[T]&h&&(c[T]|=h),x&=~k}}var Rt=0;function gd(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var yd,Kl,Mp,xd,Pp,vd=!1,Mi=[],Hr=null,go=null,yo=null,Aa=new Map,Pi=new Map,Tr=[],d0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _a(c,h){switch(c){case"focusin":case"focusout":Hr=null;break;case"dragenter":case"dragleave":go=null;break;case"mouseover":case"mouseout":yo=null;break;case"pointerover":case"pointerout":Aa.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pi.delete(h.pointerId)}}function Ra(c,h,x,T,k,$){return c===null||c.nativeEvent!==$?(c={blockedOn:h,domEventName:x,eventSystemFlags:T,nativeEvent:$,targetContainers:[k]},h!==null&&(h=Ad(h),h!==null&&Kl(h)),c):(c.eventSystemFlags|=T,h=c.targetContainers,k!==null&&h.indexOf(k)===-1&&h.push(k),c)}function f0(c,h,x,T,k){switch(h){case"focusin":return Hr=Ra(Hr,c,h,x,T,k),!0;case"dragenter":return go=Ra(go,c,h,x,T,k),!0;case"mouseover":return yo=Ra(yo,c,h,x,T,k),!0;case"pointerover":var $=k.pointerId;return Aa.set($,Ra(Aa.get($)||null,c,h,x,T,k)),!0;case"gotpointercapture":return $=k.pointerId,Pi.set($,Ra(Pi.get($)||null,c,h,x,T,k)),!0}return!1}function wd(c){var h=Da(c.target);if(h!==null){var x=Wo(h);if(x!==null){if(h=x.tag,h===13){if(h=wp(x),h!==null){c.blockedOn=h,Pp(c.priority,function(){Mp(x)});return}}else if(h===3&&x.stateNode.current.memoizedState.isDehydrated){c.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}c.blockedOn=null}function I(c){if(c.blockedOn!==null)return!1;for(var h=c.targetContainers;0<h.length;){var x=nt(c.domEventName,c.eventSystemFlags,h[0],c.nativeEvent);if(x===null){x=c.nativeEvent;var T=new x.constructor(x.type,x);Ei=T,x.target.dispatchEvent(T),Ei=null}else return h=Ad(x),h!==null&&Kl(h),c.blockedOn=x,!1;h.shift()}return!0}function D(c,h,x){I(c)&&x.delete(h)}function V(){vd=!1,Hr!==null&&I(Hr)&&(Hr=null),go!==null&&I(go)&&(go=null),yo!==null&&I(yo)&&(yo=null),Aa.forEach(D),Pi.forEach(D)}function W(c,h){c.blockedOn===h&&(c.blockedOn=null,vd||(vd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,V)))}function X(c){function h(k){return W(k,c)}if(0<Mi.length){W(Mi[0],c);for(var x=1;x<Mi.length;x++){var T=Mi[x];T.blockedOn===c&&(T.blockedOn=null)}}for(Hr!==null&&W(Hr,c),go!==null&&W(go,c),yo!==null&&W(yo,c),Aa.forEach(h),Pi.forEach(h),x=0;x<Tr.length;x++)T=Tr[x],T.blockedOn===c&&(T.blockedOn=null);for(;0<Tr.length&&(x=Tr[0],x.blockedOn===null);)wd(x),x.blockedOn===null&&Tr.shift()}var H=N.ReactCurrentBatchConfig,Y=!0;function fe(c,h,x,T){var k=Rt,$=H.transition;H.transition=null;try{Rt=1,_e(c,h,x,T)}finally{Rt=k,H.transition=$}}function be(c,h,x,T){var k=Rt,$=H.transition;H.transition=null;try{Rt=4,_e(c,h,x,T)}finally{Rt=k,H.transition=$}}function _e(c,h,x,T){if(Y){var k=nt(c,h,x,T);if(k===null)I0(c,h,T,Oe,x),_a(c,T);else if(f0(k,c,h,x,T))T.stopPropagation();else if(_a(c,T),h&4&&-1<d0.indexOf(c)){for(;k!==null;){var $=Ad(k);if($!==null&&yd($),$=nt(c,h,x,T),$===null&&I0(c,h,T,Oe,x),$===k)break;k=$}k!==null&&T.stopPropagation()}else I0(c,h,T,null,x)}}var Oe=null;function nt(c,h,x,T){if(Oe=null,c=Vl(T),c=Da(c),c!==null)if(h=Wo(c),h===null)c=null;else if(x=h.tag,x===13){if(c=wp(h),c!==null)return c;c=null}else if(x===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;c=null}else h!==c&&(c=null);return Oe=c,null}function st(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pd()){case Ul:return 1;case Wl:return 4;case mo:case ir:return 16;case Np:return 536870912;default:return 16}default:return 16}}var Le=null,at=null,ct=null;function Ft(){if(ct)return ct;var c,h=at,x=h.length,T,k="value"in Le?Le.value:Le.textContent,$=k.length;for(c=0;c<x&&h[c]===k[c];c++);var O=x-c;for(T=1;T<=O&&h[x-T]===k[$-T];T++);return ct=k.slice(c,1<T?1-T:void 0)}function Mt(c){var h=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&h===13&&(c=13)):c=h,c===10&&(c=13),32<=c||c===13?c:0}function An(){return!0}function Ds(){return!1}function Wt(c){function h(x,T,k,$,O){this._reactName=x,this._targetInst=k,this.type=T,this.nativeEvent=$,this.target=O,this.currentTarget=null;for(var K in c)c.hasOwnProperty(K)&&(x=c[K],this[K]=x?x($):$[K]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?An:Ds,this.isPropagationStopped=Ds,this}return oe(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=An)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=An)},persist:function(){},isPersistent:An}),h}var vt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sn=Wt(vt),Us=oe({},vt,{view:0,detail:0}),Ho=Wt(Us),Xl,xo,vo,Li=oe({},Us,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:p0,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==vo&&(vo&&c.type==="mousemove"?(Xl=c.screenX-vo.screenX,xo=c.screenY-vo.screenY):xo=Xl=0,vo=c),Xl)},movementY:function(c){return"movementY"in c?c.movementY:xo}}),kT=Wt(Li),AD=oe({},Li,{dataTransfer:0}),_D=Wt(AD),RD=oe({},Us,{relatedTarget:0}),h0=Wt(RD),DD=oe({},vt,{animationName:0,elapsedTime:0,pseudoElement:0}),FD=Wt(DD),MD=oe({},vt,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),PD=Wt(MD),LD=oe({},vt,{data:0}),NT=Wt(LD),OD={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VD={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BD={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zD(c){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(c):(c=BD[c])?!!h[c]:!1}function p0(){return zD}var UD=oe({},Us,{key:function(c){if(c.key){var h=OD[c.key]||c.key;if(h!=="Unidentified")return h}return c.type==="keypress"?(c=Mt(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?VD[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:p0,charCode:function(c){return c.type==="keypress"?Mt(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?Mt(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),WD=Wt(UD),GD=oe({},Li,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ET=Wt(GD),HD=oe({},Us,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:p0}),qD=Wt(HD),KD=oe({},vt,{propertyName:0,elapsedTime:0,pseudoElement:0}),XD=Wt(KD),JD=oe({},Li,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),YD=Wt(JD),QD=[9,13,27,32],m0=a&&"CompositionEvent"in window,Cd=null;a&&"documentMode"in document&&(Cd=document.documentMode);var ZD=a&&"TextEvent"in window&&!Cd,$T=a&&(!m0||Cd&&8<Cd&&11>=Cd),AT=" ",_T=!1;function RT(c,h){switch(c){case"keyup":return QD.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DT(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var Jl=!1;function jD(c,h){switch(c){case"compositionend":return DT(h);case"keypress":return h.which!==32?null:(_T=!0,AT);case"textInput":return c=h.data,c===AT&&_T?null:c;default:return null}}function eF(c,h){if(Jl)return c==="compositionend"||!m0&&RT(c,h)?(c=Ft(),ct=at=Le=null,Jl=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return $T&&h.locale!=="ko"?null:h.data;default:return null}}var tF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function FT(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h==="input"?!!tF[c.type]:h==="textarea"}function MT(c,h,x,T){dd(T),h=zp(h,"onChange"),0<h.length&&(x=new Sn("onChange","change",null,x,T),c.push({event:x,listeners:h}))}var Td=null,Sd=null;function nF(c){jT(c,0)}function Lp(c){var h=eu(c);if(yt(h))return c}function sF(c,h){if(c==="change")return h}var PT=!1;if(a){var g0;if(a){var y0="oninput"in document;if(!y0){var LT=document.createElement("div");LT.setAttribute("oninput","return;"),y0=typeof LT.oninput=="function"}g0=y0}else g0=!1;PT=g0&&(!document.documentMode||9<document.documentMode)}function OT(){Td&&(Td.detachEvent("onpropertychange",VT),Sd=Td=null)}function VT(c){if(c.propertyName==="value"&&Lp(Sd)){var h=[];MT(h,Sd,c,Vl(c)),fd(nF,h)}}function rF(c,h,x){c==="focusin"?(OT(),Td=h,Sd=x,Td.attachEvent("onpropertychange",VT)):c==="focusout"&&OT()}function oF(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return Lp(Sd)}function iF(c,h){if(c==="click")return Lp(h)}function aF(c,h){if(c==="input"||c==="change")return Lp(h)}function lF(c,h){return c===h&&(c!==0||1/c===1/h)||c!==c&&h!==h}var qr=typeof Object.is=="function"?Object.is:lF;function bd(c,h){if(qr(c,h))return!0;if(typeof c!="object"||c===null||typeof h!="object"||h===null)return!1;var x=Object.keys(c),T=Object.keys(h);if(x.length!==T.length)return!1;for(T=0;T<x.length;T++){var k=x[T];if(!l.call(h,k)||!qr(c[k],h[k]))return!1}return!0}function BT(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function zT(c,h){var x=BT(c);c=0;for(var T;x;){if(x.nodeType===3){if(T=c+x.textContent.length,c<=h&&T>=h)return{node:x,offset:h-c};c=T}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=BT(x)}}function UT(c,h){return c&&h?c===h?!0:c&&c.nodeType===3?!1:h&&h.nodeType===3?UT(c,h.parentNode):"contains"in c?c.contains(h):c.compareDocumentPosition?!!(c.compareDocumentPosition(h)&16):!1:!1}function WT(){for(var c=window,h=Nt();h instanceof c.HTMLIFrameElement;){try{var x=typeof h.contentWindow.location.href=="string"}catch{x=!1}if(x)c=h.contentWindow;else break;h=Nt(c.document)}return h}function x0(c){var h=c&&c.nodeName&&c.nodeName.toLowerCase();return h&&(h==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||h==="textarea"||c.contentEditable==="true")}function uF(c){var h=WT(),x=c.focusedElem,T=c.selectionRange;if(h!==x&&x&&x.ownerDocument&&UT(x.ownerDocument.documentElement,x)){if(T!==null&&x0(x)){if(h=T.start,c=T.end,c===void 0&&(c=h),"selectionStart"in x)x.selectionStart=h,x.selectionEnd=Math.min(c,x.value.length);else if(c=(h=x.ownerDocument||document)&&h.defaultView||window,c.getSelection){c=c.getSelection();var k=x.textContent.length,$=Math.min(T.start,k);T=T.end===void 0?$:Math.min(T.end,k),!c.extend&&$>T&&(k=T,T=$,$=k),k=zT(x,$);var O=zT(x,T);k&&O&&(c.rangeCount!==1||c.anchorNode!==k.node||c.anchorOffset!==k.offset||c.focusNode!==O.node||c.focusOffset!==O.offset)&&(h=h.createRange(),h.setStart(k.node,k.offset),c.removeAllRanges(),$>T?(c.addRange(h),c.extend(O.node,O.offset)):(h.setEnd(O.node,O.offset),c.addRange(h)))}}for(h=[],c=x;c=c.parentNode;)c.nodeType===1&&h.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<h.length;x++)c=h[x],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var cF=a&&"documentMode"in document&&11>=document.documentMode,Yl=null,v0=null,Id=null,w0=!1;function GT(c,h,x){var T=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;w0||Yl==null||Yl!==Nt(T)||(T=Yl,"selectionStart"in T&&x0(T)?T={start:T.selectionStart,end:T.selectionEnd}:(T=(T.ownerDocument&&T.ownerDocument.defaultView||window).getSelection(),T={anchorNode:T.anchorNode,anchorOffset:T.anchorOffset,focusNode:T.focusNode,focusOffset:T.focusOffset}),Id&&bd(Id,T)||(Id=T,T=zp(v0,"onSelect"),0<T.length&&(h=new Sn("onSelect","select",null,h,x),c.push({event:h,listeners:T}),h.target=Yl)))}function Op(c,h){var x={};return x[c.toLowerCase()]=h.toLowerCase(),x["Webkit"+c]="webkit"+h,x["Moz"+c]="moz"+h,x}var Ql={animationend:Op("Animation","AnimationEnd"),animationiteration:Op("Animation","AnimationIteration"),animationstart:Op("Animation","AnimationStart"),transitionend:Op("Transition","TransitionEnd")},C0={},HT={};a&&(HT=document.createElement("div").style,"AnimationEvent"in window||(delete Ql.animationend.animation,delete Ql.animationiteration.animation,delete Ql.animationstart.animation),"TransitionEvent"in window||delete Ql.transitionend.transition);function Vp(c){if(C0[c])return C0[c];if(!Ql[c])return c;var h=Ql[c],x;for(x in h)if(h.hasOwnProperty(x)&&x in HT)return C0[c]=h[x];return c}var qT=Vp("animationend"),KT=Vp("animationiteration"),XT=Vp("animationstart"),JT=Vp("transitionend"),YT=new Map,QT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Oi(c,h){YT.set(c,h),o(h,[c])}for(var T0=0;T0<QT.length;T0++){var S0=QT[T0],dF=S0.toLowerCase(),fF=S0[0].toUpperCase()+S0.slice(1);Oi(dF,"on"+fF)}Oi(qT,"onAnimationEnd"),Oi(KT,"onAnimationIteration"),Oi(XT,"onAnimationStart"),Oi("dblclick","onDoubleClick"),Oi("focusin","onFocus"),Oi("focusout","onBlur"),Oi(JT,"onTransitionEnd"),i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var kd="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hF=new Set("cancel close invalid load scroll toggle".split(" ").concat(kd));function ZT(c,h,x){var T=c.type||"unknown-event";c.currentTarget=x,u0(T,h,void 0,c),c.currentTarget=null}function jT(c,h){h=(h&4)!==0;for(var x=0;x<c.length;x++){var T=c[x],k=T.event;T=T.listeners;e:{var $=void 0;if(h)for(var O=T.length-1;0<=O;O--){var K=T[O],re=K.instance,ve=K.currentTarget;if(K=K.listener,re!==$&&k.isPropagationStopped())break e;ZT(k,K,ve),$=re}else for(O=0;O<T.length;O++){if(K=T[O],re=K.instance,ve=K.currentTarget,K=K.listener,re!==$&&k.isPropagationStopped())break e;ZT(k,K,ve),$=re}}}if(Uo)throw c=zl,Uo=!1,zl=null,c}function Zt(c,h){var x=h[_0];x===void 0&&(x=h[_0]=new Set);var T=c+"__bubble";x.has(T)||(eS(h,c,2,!1),x.add(T))}function b0(c,h,x){var T=0;h&&(T|=4),eS(x,c,T,h)}var Bp="_reactListening"+Math.random().toString(36).slice(2);function Nd(c){if(!c[Bp]){c[Bp]=!0,s.forEach(function(x){x!=="selectionchange"&&(hF.has(x)||b0(x,!1,c),b0(x,!0,c))});var h=c.nodeType===9?c:c.ownerDocument;h===null||h[Bp]||(h[Bp]=!0,b0("selectionchange",!1,h))}}function eS(c,h,x,T){switch(st(h)){case 1:var k=fe;break;case 4:k=be;break;default:k=_e}x=k.bind(null,h,x,c),k=void 0,!_i||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(k=!0),T?k!==void 0?c.addEventListener(h,x,{capture:!0,passive:k}):c.addEventListener(h,x,!0):k!==void 0?c.addEventListener(h,x,{passive:k}):c.addEventListener(h,x,!1)}function I0(c,h,x,T,k){var $=T;if((h&1)===0&&(h&2)===0&&T!==null)e:for(;;){if(T===null)return;var O=T.tag;if(O===3||O===4){var K=T.stateNode.containerInfo;if(K===k||K.nodeType===8&&K.parentNode===k)break;if(O===4)for(O=T.return;O!==null;){var re=O.tag;if((re===3||re===4)&&(re=O.stateNode.containerInfo,re===k||re.nodeType===8&&re.parentNode===k))return;O=O.return}for(;K!==null;){if(O=Da(K),O===null)return;if(re=O.tag,re===5||re===6){T=$=O;continue e}K=K.parentNode}}T=T.return}fd(function(){var ve=$,$e=Vl(x),Ae=[];e:{var Ee=YT.get(c);if(Ee!==void 0){var Ue=Sn,Ke=c;switch(c){case"keypress":if(Mt(x)===0)break e;case"keydown":case"keyup":Ue=WD;break;case"focusin":Ke="focus",Ue=h0;break;case"focusout":Ke="blur",Ue=h0;break;case"beforeblur":case"afterblur":Ue=h0;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=kT;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=_D;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=qD;break;case qT:case KT:case XT:Ue=FD;break;case JT:Ue=XD;break;case"scroll":Ue=Ho;break;case"wheel":Ue=YD;break;case"copy":case"cut":case"paste":Ue=PD;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=ET}var Je=(h&4)!==0,bn=!Je&&c==="scroll",pe=Je?Ee!==null?Ee+"Capture":null:Ee;Je=[];for(var ce=ve,ge;ce!==null;){ge=ce;var De=ge.stateNode;if(ge.tag===5&&De!==null&&(ge=De,pe!==null&&(De=Ai(ce,pe),De!=null&&Je.push(Ed(ce,De,ge)))),bn)break;ce=ce.return}0<Je.length&&(Ee=new Ue(Ee,Ke,null,x,$e),Ae.push({event:Ee,listeners:Je}))}}if((h&7)===0){e:{if(Ee=c==="mouseover"||c==="pointerover",Ue=c==="mouseout"||c==="pointerout",Ee&&x!==Ei&&(Ke=x.relatedTarget||x.fromElement)&&(Da(Ke)||Ke[qo]))break e;if((Ue||Ee)&&(Ee=$e.window===$e?$e:(Ee=$e.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,Ue?(Ke=x.relatedTarget||x.toElement,Ue=ve,Ke=Ke?Da(Ke):null,Ke!==null&&(bn=Wo(Ke),Ke!==bn||Ke.tag!==5&&Ke.tag!==6)&&(Ke=null)):(Ue=null,Ke=ve),Ue!==Ke)){if(Je=kT,De="onMouseLeave",pe="onMouseEnter",ce="mouse",(c==="pointerout"||c==="pointerover")&&(Je=ET,De="onPointerLeave",pe="onPointerEnter",ce="pointer"),bn=Ue==null?Ee:eu(Ue),ge=Ke==null?Ee:eu(Ke),Ee=new Je(De,ce+"leave",Ue,x,$e),Ee.target=bn,Ee.relatedTarget=ge,De=null,Da($e)===ve&&(Je=new Je(pe,ce+"enter",Ke,x,$e),Je.target=ge,Je.relatedTarget=bn,De=Je),bn=De,Ue&&Ke)t:{for(Je=Ue,pe=Ke,ce=0,ge=Je;ge;ge=Zl(ge))ce++;for(ge=0,De=pe;De;De=Zl(De))ge++;for(;0<ce-ge;)Je=Zl(Je),ce--;for(;0<ge-ce;)pe=Zl(pe),ge--;for(;ce--;){if(Je===pe||pe!==null&&Je===pe.alternate)break t;Je=Zl(Je),pe=Zl(pe)}Je=null}else Je=null;Ue!==null&&tS(Ae,Ee,Ue,Je,!1),Ke!==null&&bn!==null&&tS(Ae,bn,Ke,Je,!0)}}e:{if(Ee=ve?eu(ve):window,Ue=Ee.nodeName&&Ee.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Ee.type==="file")var Ze=sF;else if(FT(Ee))if(PT)Ze=aF;else{Ze=oF;var rt=rF}else(Ue=Ee.nodeName)&&Ue.toLowerCase()==="input"&&(Ee.type==="checkbox"||Ee.type==="radio")&&(Ze=iF);if(Ze&&(Ze=Ze(c,ve))){MT(Ae,Ze,x,$e);break e}rt&&rt(c,Ee,ve),c==="focusout"&&(rt=Ee._wrapperState)&&rt.controlled&&Ee.type==="number"&&Kn(Ee,"number",Ee.value)}switch(rt=ve?eu(ve):window,c){case"focusin":(FT(rt)||rt.contentEditable==="true")&&(Yl=rt,v0=ve,Id=null);break;case"focusout":Id=v0=Yl=null;break;case"mousedown":w0=!0;break;case"contextmenu":case"mouseup":case"dragend":w0=!1,GT(Ae,x,$e);break;case"selectionchange":if(cF)break;case"keydown":case"keyup":GT(Ae,x,$e)}var ot;if(m0)e:{switch(c){case"compositionstart":var ut="onCompositionStart";break e;case"compositionend":ut="onCompositionEnd";break e;case"compositionupdate":ut="onCompositionUpdate";break e}ut=void 0}else Jl?RT(c,x)&&(ut="onCompositionEnd"):c==="keydown"&&x.keyCode===229&&(ut="onCompositionStart");ut&&($T&&x.locale!=="ko"&&(Jl||ut!=="onCompositionStart"?ut==="onCompositionEnd"&&Jl&&(ot=Ft()):(Le=$e,at="value"in Le?Le.value:Le.textContent,Jl=!0)),rt=zp(ve,ut),0<rt.length&&(ut=new NT(ut,c,null,x,$e),Ae.push({event:ut,listeners:rt}),ot?ut.data=ot:(ot=DT(x),ot!==null&&(ut.data=ot)))),(ot=ZD?jD(c,x):eF(c,x))&&(ve=zp(ve,"onBeforeInput"),0<ve.length&&($e=new NT("onBeforeInput","beforeinput",null,x,$e),Ae.push({event:$e,listeners:ve}),$e.data=ot))}jT(Ae,h)})}function Ed(c,h,x){return{instance:c,listener:h,currentTarget:x}}function zp(c,h){for(var x=h+"Capture",T=[];c!==null;){var k=c,$=k.stateNode;k.tag===5&&$!==null&&(k=$,$=Ai(c,x),$!=null&&T.unshift(Ed(c,$,k)),$=Ai(c,h),$!=null&&T.push(Ed(c,$,k))),c=c.return}return T}function Zl(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function tS(c,h,x,T,k){for(var $=h._reactName,O=[];x!==null&&x!==T;){var K=x,re=K.alternate,ve=K.stateNode;if(re!==null&&re===T)break;K.tag===5&&ve!==null&&(K=ve,k?(re=Ai(x,$),re!=null&&O.unshift(Ed(x,re,K))):k||(re=Ai(x,$),re!=null&&O.push(Ed(x,re,K)))),x=x.return}O.length!==0&&c.push({event:h,listeners:O})}var pF=/\r\n?/g,mF=/\u0000|\uFFFD/g;function nS(c){return(typeof c=="string"?c:""+c).replace(pF,`
`).replace(mF,"")}function Up(c,h,x){if(h=nS(h),nS(c)!==h&&x)throw Error(t(425))}function Wp(){}var k0=null,N0=null;function E0(c,h){return c==="textarea"||c==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var $0=typeof setTimeout=="function"?setTimeout:void 0,gF=typeof clearTimeout=="function"?clearTimeout:void 0,sS=typeof Promise=="function"?Promise:void 0,yF=typeof queueMicrotask=="function"?queueMicrotask:typeof sS<"u"?function(c){return sS.resolve(null).then(c).catch(xF)}:$0;function xF(c){setTimeout(function(){throw c})}function A0(c,h){var x=h,T=0;do{var k=x.nextSibling;if(c.removeChild(x),k&&k.nodeType===8)if(x=k.data,x==="/$"){if(T===0){c.removeChild(k),X(h);return}T--}else x!=="$"&&x!=="$?"&&x!=="$!"||T++;x=k}while(x);X(h)}function Vi(c){for(;c!=null;c=c.nextSibling){var h=c.nodeType;if(h===1||h===3)break;if(h===8){if(h=c.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return c}function rS(c){c=c.previousSibling;for(var h=0;c;){if(c.nodeType===8){var x=c.data;if(x==="$"||x==="$!"||x==="$?"){if(h===0)return c;h--}else x==="/$"&&h++}c=c.previousSibling}return null}var jl=Math.random().toString(36).slice(2),wo="__reactFiber$"+jl,$d="__reactProps$"+jl,qo="__reactContainer$"+jl,_0="__reactEvents$"+jl,vF="__reactListeners$"+jl,wF="__reactHandles$"+jl;function Da(c){var h=c[wo];if(h)return h;for(var x=c.parentNode;x;){if(h=x[qo]||x[wo]){if(x=h.alternate,h.child!==null||x!==null&&x.child!==null)for(c=rS(c);c!==null;){if(x=c[wo])return x;c=rS(c)}return h}c=x,x=c.parentNode}return null}function Ad(c){return c=c[wo]||c[qo],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function eu(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function Gp(c){return c[$d]||null}var R0=[],tu=-1;function Bi(c){return{current:c}}function jt(c){0>tu||(c.current=R0[tu],R0[tu]=null,tu--)}function Jt(c,h){tu++,R0[tu]=c.current,c.current=h}var zi={},ms=Bi(zi),Ws=Bi(!1),Fa=zi;function nu(c,h){var x=c.type.contextTypes;if(!x)return zi;var T=c.stateNode;if(T&&T.__reactInternalMemoizedUnmaskedChildContext===h)return T.__reactInternalMemoizedMaskedChildContext;var k={},$;for($ in x)k[$]=h[$];return T&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=h,c.__reactInternalMemoizedMaskedChildContext=k),k}function Gs(c){return c=c.childContextTypes,c!=null}function Hp(){jt(Ws),jt(ms)}function oS(c,h,x){if(ms.current!==zi)throw Error(t(168));Jt(ms,h),Jt(Ws,x)}function iS(c,h,x){var T=c.stateNode;if(h=h.childContextTypes,typeof T.getChildContext!="function")return x;T=T.getChildContext();for(var k in T)if(!(k in h))throw Error(t(108,Re(c)||"Unknown",k));return oe({},x,T)}function qp(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||zi,Fa=ms.current,Jt(ms,c),Jt(Ws,Ws.current),!0}function aS(c,h,x){var T=c.stateNode;if(!T)throw Error(t(169));x?(c=iS(c,h,Fa),T.__reactInternalMemoizedMergedChildContext=c,jt(Ws),jt(ms),Jt(ms,c)):jt(Ws),Jt(Ws,x)}var Ko=null,Kp=!1,D0=!1;function lS(c){Ko===null?Ko=[c]:Ko.push(c)}function CF(c){Kp=!0,lS(c)}function Ui(){if(!D0&&Ko!==null){D0=!0;var c=0,h=Rt;try{var x=Ko;for(Rt=1;c<x.length;c++){var T=x[c];do T=T(!0);while(T!==null)}Ko=null,Kp=!1}catch(k){throw Ko!==null&&(Ko=Ko.slice(c+1)),bp(Ul,Ui),k}finally{Rt=h,D0=!1}}return null}var su=[],ru=0,Xp=null,Jp=0,Sr=[],br=0,Ma=null,Xo=1,Jo="";function Pa(c,h){su[ru++]=Jp,su[ru++]=Xp,Xp=c,Jp=h}function uS(c,h,x){Sr[br++]=Xo,Sr[br++]=Jo,Sr[br++]=Ma,Ma=c;var T=Xo;c=Jo;var k=32-rn(T)-1;T&=~(1<<k),x+=1;var $=32-rn(h)+k;if(30<$){var O=k-k%5;$=(T&(1<<O)-1).toString(32),T>>=O,k-=O,Xo=1<<32-rn(h)+k|x<<k|T,Jo=$+c}else Xo=1<<$|x<<k|T,Jo=c}function F0(c){c.return!==null&&(Pa(c,1),uS(c,1,0))}function M0(c){for(;c===Xp;)Xp=su[--ru],su[ru]=null,Jp=su[--ru],su[ru]=null;for(;c===Ma;)Ma=Sr[--br],Sr[br]=null,Jo=Sr[--br],Sr[br]=null,Xo=Sr[--br],Sr[br]=null}var lr=null,ur=null,on=!1,Kr=null;function cS(c,h){var x=Er(5,null,null,0);x.elementType="DELETED",x.stateNode=h,x.return=c,h=c.deletions,h===null?(c.deletions=[x],c.flags|=16):h.push(x)}function dS(c,h){switch(c.tag){case 5:var x=c.type;return h=h.nodeType!==1||x.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(c.stateNode=h,lr=c,ur=Vi(h.firstChild),!0):!1;case 6:return h=c.pendingProps===""||h.nodeType!==3?null:h,h!==null?(c.stateNode=h,lr=c,ur=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(x=Ma!==null?{id:Xo,overflow:Jo}:null,c.memoizedState={dehydrated:h,treeContext:x,retryLane:1073741824},x=Er(18,null,null,0),x.stateNode=h,x.return=c,c.child=x,lr=c,ur=null,!0):!1;default:return!1}}function P0(c){return(c.mode&1)!==0&&(c.flags&128)===0}function L0(c){if(on){var h=ur;if(h){var x=h;if(!dS(c,h)){if(P0(c))throw Error(t(418));h=Vi(x.nextSibling);var T=lr;h&&dS(c,h)?cS(T,x):(c.flags=c.flags&-4097|2,on=!1,lr=c)}}else{if(P0(c))throw Error(t(418));c.flags=c.flags&-4097|2,on=!1,lr=c}}}function fS(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;lr=c}function Yp(c){if(c!==lr)return!1;if(!on)return fS(c),on=!0,!1;var h;if((h=c.tag!==3)&&!(h=c.tag!==5)&&(h=c.type,h=h!=="head"&&h!=="body"&&!E0(c.type,c.memoizedProps)),h&&(h=ur)){if(P0(c))throw hS(),Error(t(418));for(;h;)cS(c,h),h=Vi(h.nextSibling)}if(fS(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,h=0;c;){if(c.nodeType===8){var x=c.data;if(x==="/$"){if(h===0){ur=Vi(c.nextSibling);break e}h--}else x!=="$"&&x!=="$!"&&x!=="$?"||h++}c=c.nextSibling}ur=null}}else ur=lr?Vi(c.stateNode.nextSibling):null;return!0}function hS(){for(var c=ur;c;)c=Vi(c.nextSibling)}function ou(){ur=lr=null,on=!1}function O0(c){Kr===null?Kr=[c]:Kr.push(c)}var TF=N.ReactCurrentBatchConfig;function _d(c,h,x){if(c=x.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(x._owner){if(x=x._owner,x){if(x.tag!==1)throw Error(t(309));var T=x.stateNode}if(!T)throw Error(t(147,c));var k=T,$=""+c;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===$?h.ref:(h=function(O){var K=k.refs;O===null?delete K[$]:K[$]=O},h._stringRef=$,h)}if(typeof c!="string")throw Error(t(284));if(!x._owner)throw Error(t(290,c))}return c}function Qp(c,h){throw c=Object.prototype.toString.call(h),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":c))}function pS(c){var h=c._init;return h(c._payload)}function mS(c){function h(pe,ce){if(c){var ge=pe.deletions;ge===null?(pe.deletions=[ce],pe.flags|=16):ge.push(ce)}}function x(pe,ce){if(!c)return null;for(;ce!==null;)h(pe,ce),ce=ce.sibling;return null}function T(pe,ce){for(pe=new Map;ce!==null;)ce.key!==null?pe.set(ce.key,ce):pe.set(ce.index,ce),ce=ce.sibling;return pe}function k(pe,ce){return pe=Yi(pe,ce),pe.index=0,pe.sibling=null,pe}function $(pe,ce,ge){return pe.index=ge,c?(ge=pe.alternate,ge!==null?(ge=ge.index,ge<ce?(pe.flags|=2,ce):ge):(pe.flags|=2,ce)):(pe.flags|=1048576,ce)}function O(pe){return c&&pe.alternate===null&&(pe.flags|=2),pe}function K(pe,ce,ge,De){return ce===null||ce.tag!==6?(ce=$x(ge,pe.mode,De),ce.return=pe,ce):(ce=k(ce,ge),ce.return=pe,ce)}function re(pe,ce,ge,De){var Ze=ge.type;return Ze===L?$e(pe,ce,ge.props.children,De,ge.key):ce!==null&&(ce.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===de&&pS(Ze)===ce.type)?(De=k(ce,ge.props),De.ref=_d(pe,ce,ge),De.return=pe,De):(De=Cm(ge.type,ge.key,ge.props,null,pe.mode,De),De.ref=_d(pe,ce,ge),De.return=pe,De)}function ve(pe,ce,ge,De){return ce===null||ce.tag!==4||ce.stateNode.containerInfo!==ge.containerInfo||ce.stateNode.implementation!==ge.implementation?(ce=Ax(ge,pe.mode,De),ce.return=pe,ce):(ce=k(ce,ge.children||[]),ce.return=pe,ce)}function $e(pe,ce,ge,De,Ze){return ce===null||ce.tag!==7?(ce=Ga(ge,pe.mode,De,Ze),ce.return=pe,ce):(ce=k(ce,ge),ce.return=pe,ce)}function Ae(pe,ce,ge){if(typeof ce=="string"&&ce!==""||typeof ce=="number")return ce=$x(""+ce,pe.mode,ge),ce.return=pe,ce;if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case A:return ge=Cm(ce.type,ce.key,ce.props,null,pe.mode,ge),ge.ref=_d(pe,null,ce),ge.return=pe,ge;case R:return ce=Ax(ce,pe.mode,ge),ce.return=pe,ce;case de:var De=ce._init;return Ae(pe,De(ce._payload),ge)}if(Xt(ce)||te(ce))return ce=Ga(ce,pe.mode,ge,null),ce.return=pe,ce;Qp(pe,ce)}return null}function Ee(pe,ce,ge,De){var Ze=ce!==null?ce.key:null;if(typeof ge=="string"&&ge!==""||typeof ge=="number")return Ze!==null?null:K(pe,ce,""+ge,De);if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case A:return ge.key===Ze?re(pe,ce,ge,De):null;case R:return ge.key===Ze?ve(pe,ce,ge,De):null;case de:return Ze=ge._init,Ee(pe,ce,Ze(ge._payload),De)}if(Xt(ge)||te(ge))return Ze!==null?null:$e(pe,ce,ge,De,null);Qp(pe,ge)}return null}function Ue(pe,ce,ge,De,Ze){if(typeof De=="string"&&De!==""||typeof De=="number")return pe=pe.get(ge)||null,K(ce,pe,""+De,Ze);if(typeof De=="object"&&De!==null){switch(De.$$typeof){case A:return pe=pe.get(De.key===null?ge:De.key)||null,re(ce,pe,De,Ze);case R:return pe=pe.get(De.key===null?ge:De.key)||null,ve(ce,pe,De,Ze);case de:var rt=De._init;return Ue(pe,ce,ge,rt(De._payload),Ze)}if(Xt(De)||te(De))return pe=pe.get(ge)||null,$e(ce,pe,De,Ze,null);Qp(ce,De)}return null}function Ke(pe,ce,ge,De){for(var Ze=null,rt=null,ot=ce,ut=ce=0,Qn=null;ot!==null&&ut<ge.length;ut++){ot.index>ut?(Qn=ot,ot=null):Qn=ot.sibling;var Dt=Ee(pe,ot,ge[ut],De);if(Dt===null){ot===null&&(ot=Qn);break}c&&ot&&Dt.alternate===null&&h(pe,ot),ce=$(Dt,ce,ut),rt===null?Ze=Dt:rt.sibling=Dt,rt=Dt,ot=Qn}if(ut===ge.length)return x(pe,ot),on&&Pa(pe,ut),Ze;if(ot===null){for(;ut<ge.length;ut++)ot=Ae(pe,ge[ut],De),ot!==null&&(ce=$(ot,ce,ut),rt===null?Ze=ot:rt.sibling=ot,rt=ot);return on&&Pa(pe,ut),Ze}for(ot=T(pe,ot);ut<ge.length;ut++)Qn=Ue(ot,pe,ut,ge[ut],De),Qn!==null&&(c&&Qn.alternate!==null&&ot.delete(Qn.key===null?ut:Qn.key),ce=$(Qn,ce,ut),rt===null?Ze=Qn:rt.sibling=Qn,rt=Qn);return c&&ot.forEach(function(Qi){return h(pe,Qi)}),on&&Pa(pe,ut),Ze}function Je(pe,ce,ge,De){var Ze=te(ge);if(typeof Ze!="function")throw Error(t(150));if(ge=Ze.call(ge),ge==null)throw Error(t(151));for(var rt=Ze=null,ot=ce,ut=ce=0,Qn=null,Dt=ge.next();ot!==null&&!Dt.done;ut++,Dt=ge.next()){ot.index>ut?(Qn=ot,ot=null):Qn=ot.sibling;var Qi=Ee(pe,ot,Dt.value,De);if(Qi===null){ot===null&&(ot=Qn);break}c&&ot&&Qi.alternate===null&&h(pe,ot),ce=$(Qi,ce,ut),rt===null?Ze=Qi:rt.sibling=Qi,rt=Qi,ot=Qn}if(Dt.done)return x(pe,ot),on&&Pa(pe,ut),Ze;if(ot===null){for(;!Dt.done;ut++,Dt=ge.next())Dt=Ae(pe,Dt.value,De),Dt!==null&&(ce=$(Dt,ce,ut),rt===null?Ze=Dt:rt.sibling=Dt,rt=Dt);return on&&Pa(pe,ut),Ze}for(ot=T(pe,ot);!Dt.done;ut++,Dt=ge.next())Dt=Ue(ot,pe,ut,Dt.value,De),Dt!==null&&(c&&Dt.alternate!==null&&ot.delete(Dt.key===null?ut:Dt.key),ce=$(Dt,ce,ut),rt===null?Ze=Dt:rt.sibling=Dt,rt=Dt);return c&&ot.forEach(function(tM){return h(pe,tM)}),on&&Pa(pe,ut),Ze}function bn(pe,ce,ge,De){if(typeof ge=="object"&&ge!==null&&ge.type===L&&ge.key===null&&(ge=ge.props.children),typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case A:e:{for(var Ze=ge.key,rt=ce;rt!==null;){if(rt.key===Ze){if(Ze=ge.type,Ze===L){if(rt.tag===7){x(pe,rt.sibling),ce=k(rt,ge.props.children),ce.return=pe,pe=ce;break e}}else if(rt.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===de&&pS(Ze)===rt.type){x(pe,rt.sibling),ce=k(rt,ge.props),ce.ref=_d(pe,rt,ge),ce.return=pe,pe=ce;break e}x(pe,rt);break}else h(pe,rt);rt=rt.sibling}ge.type===L?(ce=Ga(ge.props.children,pe.mode,De,ge.key),ce.return=pe,pe=ce):(De=Cm(ge.type,ge.key,ge.props,null,pe.mode,De),De.ref=_d(pe,ce,ge),De.return=pe,pe=De)}return O(pe);case R:e:{for(rt=ge.key;ce!==null;){if(ce.key===rt)if(ce.tag===4&&ce.stateNode.containerInfo===ge.containerInfo&&ce.stateNode.implementation===ge.implementation){x(pe,ce.sibling),ce=k(ce,ge.children||[]),ce.return=pe,pe=ce;break e}else{x(pe,ce);break}else h(pe,ce);ce=ce.sibling}ce=Ax(ge,pe.mode,De),ce.return=pe,pe=ce}return O(pe);case de:return rt=ge._init,bn(pe,ce,rt(ge._payload),De)}if(Xt(ge))return Ke(pe,ce,ge,De);if(te(ge))return Je(pe,ce,ge,De);Qp(pe,ge)}return typeof ge=="string"&&ge!==""||typeof ge=="number"?(ge=""+ge,ce!==null&&ce.tag===6?(x(pe,ce.sibling),ce=k(ce,ge),ce.return=pe,pe=ce):(x(pe,ce),ce=$x(ge,pe.mode,De),ce.return=pe,pe=ce),O(pe)):x(pe,ce)}return bn}var iu=mS(!0),gS=mS(!1),Zp=Bi(null),jp=null,au=null,V0=null;function B0(){V0=au=jp=null}function z0(c){var h=Zp.current;jt(Zp),c._currentValue=h}function U0(c,h,x){for(;c!==null;){var T=c.alternate;if((c.childLanes&h)!==h?(c.childLanes|=h,T!==null&&(T.childLanes|=h)):T!==null&&(T.childLanes&h)!==h&&(T.childLanes|=h),c===x)break;c=c.return}}function lu(c,h){jp=c,V0=au=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&h)!==0&&(Hs=!0),c.firstContext=null)}function Ir(c){var h=c._currentValue;if(V0!==c)if(c={context:c,memoizedValue:h,next:null},au===null){if(jp===null)throw Error(t(308));au=c,jp.dependencies={lanes:0,firstContext:c}}else au=au.next=c;return h}var La=null;function W0(c){La===null?La=[c]:La.push(c)}function yS(c,h,x,T){var k=h.interleaved;return k===null?(x.next=x,W0(h)):(x.next=k.next,k.next=x),h.interleaved=x,Yo(c,T)}function Yo(c,h){c.lanes|=h;var x=c.alternate;for(x!==null&&(x.lanes|=h),x=c,c=c.return;c!==null;)c.childLanes|=h,x=c.alternate,x!==null&&(x.childLanes|=h),x=c,c=c.return;return x.tag===3?x.stateNode:null}var Wi=!1;function G0(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xS(c,h){c=c.updateQueue,h.updateQueue===c&&(h.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function Qo(c,h){return{eventTime:c,lane:h,tag:0,payload:null,callback:null,next:null}}function Gi(c,h,x){var T=c.updateQueue;if(T===null)return null;if(T=T.shared,(_t&2)!==0){var k=T.pending;return k===null?h.next=h:(h.next=k.next,k.next=h),T.pending=h,Yo(c,x)}return k=T.interleaved,k===null?(h.next=h,W0(T)):(h.next=k.next,k.next=h),T.interleaved=h,Yo(c,x)}function em(c,h,x){if(h=h.updateQueue,h!==null&&(h=h.shared,(x&4194240)!==0)){var T=h.lanes;T&=c.pendingLanes,x|=T,h.lanes=x,ql(c,x)}}function vS(c,h){var x=c.updateQueue,T=c.alternate;if(T!==null&&(T=T.updateQueue,x===T)){var k=null,$=null;if(x=x.firstBaseUpdate,x!==null){do{var O={eventTime:x.eventTime,lane:x.lane,tag:x.tag,payload:x.payload,callback:x.callback,next:null};$===null?k=$=O:$=$.next=O,x=x.next}while(x!==null);$===null?k=$=h:$=$.next=h}else k=$=h;x={baseState:T.baseState,firstBaseUpdate:k,lastBaseUpdate:$,shared:T.shared,effects:T.effects},c.updateQueue=x;return}c=x.lastBaseUpdate,c===null?x.firstBaseUpdate=h:c.next=h,x.lastBaseUpdate=h}function tm(c,h,x,T){var k=c.updateQueue;Wi=!1;var $=k.firstBaseUpdate,O=k.lastBaseUpdate,K=k.shared.pending;if(K!==null){k.shared.pending=null;var re=K,ve=re.next;re.next=null,O===null?$=ve:O.next=ve,O=re;var $e=c.alternate;$e!==null&&($e=$e.updateQueue,K=$e.lastBaseUpdate,K!==O&&(K===null?$e.firstBaseUpdate=ve:K.next=ve,$e.lastBaseUpdate=re))}if($!==null){var Ae=k.baseState;O=0,$e=ve=re=null,K=$;do{var Ee=K.lane,Ue=K.eventTime;if((T&Ee)===Ee){$e!==null&&($e=$e.next={eventTime:Ue,lane:0,tag:K.tag,payload:K.payload,callback:K.callback,next:null});e:{var Ke=c,Je=K;switch(Ee=h,Ue=x,Je.tag){case 1:if(Ke=Je.payload,typeof Ke=="function"){Ae=Ke.call(Ue,Ae,Ee);break e}Ae=Ke;break e;case 3:Ke.flags=Ke.flags&-65537|128;case 0:if(Ke=Je.payload,Ee=typeof Ke=="function"?Ke.call(Ue,Ae,Ee):Ke,Ee==null)break e;Ae=oe({},Ae,Ee);break e;case 2:Wi=!0}}K.callback!==null&&K.lane!==0&&(c.flags|=64,Ee=k.effects,Ee===null?k.effects=[K]:Ee.push(K))}else Ue={eventTime:Ue,lane:Ee,tag:K.tag,payload:K.payload,callback:K.callback,next:null},$e===null?(ve=$e=Ue,re=Ae):$e=$e.next=Ue,O|=Ee;if(K=K.next,K===null){if(K=k.shared.pending,K===null)break;Ee=K,K=Ee.next,Ee.next=null,k.lastBaseUpdate=Ee,k.shared.pending=null}}while(!0);if($e===null&&(re=Ae),k.baseState=re,k.firstBaseUpdate=ve,k.lastBaseUpdate=$e,h=k.shared.interleaved,h!==null){k=h;do O|=k.lane,k=k.next;while(k!==h)}else $===null&&(k.shared.lanes=0);Ba|=O,c.lanes=O,c.memoizedState=Ae}}function wS(c,h,x){if(c=h.effects,h.effects=null,c!==null)for(h=0;h<c.length;h++){var T=c[h],k=T.callback;if(k!==null){if(T.callback=null,T=x,typeof k!="function")throw Error(t(191,k));k.call(T)}}}var Rd={},Co=Bi(Rd),Dd=Bi(Rd),Fd=Bi(Rd);function Oa(c){if(c===Rd)throw Error(t(174));return c}function H0(c,h){switch(Jt(Fd,h),Jt(Dd,c),Jt(Co,Rd),c=h.nodeType,c){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:fs(null,"");break;default:c=c===8?h.parentNode:h,h=c.namespaceURI||null,c=c.tagName,h=fs(h,c)}jt(Co),Jt(Co,h)}function uu(){jt(Co),jt(Dd),jt(Fd)}function CS(c){Oa(Fd.current);var h=Oa(Co.current),x=fs(h,c.type);h!==x&&(Jt(Dd,c),Jt(Co,x))}function q0(c){Dd.current===c&&(jt(Co),jt(Dd))}var mn=Bi(0);function nm(c){for(var h=c;h!==null;){if(h.tag===13){var x=h.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||x.data==="$?"||x.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var K0=[];function X0(){for(var c=0;c<K0.length;c++)K0[c]._workInProgressVersionPrimary=null;K0.length=0}var sm=N.ReactCurrentDispatcher,J0=N.ReactCurrentBatchConfig,Va=0,gn=null,Vn=null,Jn=null,rm=!1,Md=!1,Pd=0,SF=0;function gs(){throw Error(t(321))}function Y0(c,h){if(h===null)return!1;for(var x=0;x<h.length&&x<c.length;x++)if(!qr(c[x],h[x]))return!1;return!0}function Q0(c,h,x,T,k,$){if(Va=$,gn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,sm.current=c===null||c.memoizedState===null?NF:EF,c=x(T,k),Md){$=0;do{if(Md=!1,Pd=0,25<=$)throw Error(t(301));$+=1,Jn=Vn=null,h.updateQueue=null,sm.current=$F,c=x(T,k)}while(Md)}if(sm.current=am,h=Vn!==null&&Vn.next!==null,Va=0,Jn=Vn=gn=null,rm=!1,h)throw Error(t(300));return c}function Z0(){var c=Pd!==0;return Pd=0,c}function To(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jn===null?gn.memoizedState=Jn=c:Jn=Jn.next=c,Jn}function kr(){if(Vn===null){var c=gn.alternate;c=c!==null?c.memoizedState:null}else c=Vn.next;var h=Jn===null?gn.memoizedState:Jn.next;if(h!==null)Jn=h,Vn=c;else{if(c===null)throw Error(t(310));Vn=c,c={memoizedState:Vn.memoizedState,baseState:Vn.baseState,baseQueue:Vn.baseQueue,queue:Vn.queue,next:null},Jn===null?gn.memoizedState=Jn=c:Jn=Jn.next=c}return Jn}function Ld(c,h){return typeof h=="function"?h(c):h}function j0(c){var h=kr(),x=h.queue;if(x===null)throw Error(t(311));x.lastRenderedReducer=c;var T=Vn,k=T.baseQueue,$=x.pending;if($!==null){if(k!==null){var O=k.next;k.next=$.next,$.next=O}T.baseQueue=k=$,x.pending=null}if(k!==null){$=k.next,T=T.baseState;var K=O=null,re=null,ve=$;do{var $e=ve.lane;if((Va&$e)===$e)re!==null&&(re=re.next={lane:0,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null}),T=ve.hasEagerState?ve.eagerState:c(T,ve.action);else{var Ae={lane:$e,action:ve.action,hasEagerState:ve.hasEagerState,eagerState:ve.eagerState,next:null};re===null?(K=re=Ae,O=T):re=re.next=Ae,gn.lanes|=$e,Ba|=$e}ve=ve.next}while(ve!==null&&ve!==$);re===null?O=T:re.next=K,qr(T,h.memoizedState)||(Hs=!0),h.memoizedState=T,h.baseState=O,h.baseQueue=re,x.lastRenderedState=T}if(c=x.interleaved,c!==null){k=c;do $=k.lane,gn.lanes|=$,Ba|=$,k=k.next;while(k!==c)}else k===null&&(x.lanes=0);return[h.memoizedState,x.dispatch]}function ex(c){var h=kr(),x=h.queue;if(x===null)throw Error(t(311));x.lastRenderedReducer=c;var T=x.dispatch,k=x.pending,$=h.memoizedState;if(k!==null){x.pending=null;var O=k=k.next;do $=c($,O.action),O=O.next;while(O!==k);qr($,h.memoizedState)||(Hs=!0),h.memoizedState=$,h.baseQueue===null&&(h.baseState=$),x.lastRenderedState=$}return[$,T]}function TS(){}function SS(c,h){var x=gn,T=kr(),k=h(),$=!qr(T.memoizedState,k);if($&&(T.memoizedState=k,Hs=!0),T=T.queue,tx(kS.bind(null,x,T,c),[c]),T.getSnapshot!==h||$||Jn!==null&&Jn.memoizedState.tag&1){if(x.flags|=2048,Od(9,IS.bind(null,x,T,k,h),void 0,null),Yn===null)throw Error(t(349));(Va&30)!==0||bS(x,h,k)}return k}function bS(c,h,x){c.flags|=16384,c={getSnapshot:h,value:x},h=gn.updateQueue,h===null?(h={lastEffect:null,stores:null},gn.updateQueue=h,h.stores=[c]):(x=h.stores,x===null?h.stores=[c]:x.push(c))}function IS(c,h,x,T){h.value=x,h.getSnapshot=T,NS(h)&&ES(c)}function kS(c,h,x){return x(function(){NS(h)&&ES(c)})}function NS(c){var h=c.getSnapshot;c=c.value;try{var x=h();return!qr(c,x)}catch{return!0}}function ES(c){var h=Yo(c,1);h!==null&&Qr(h,c,1,-1)}function $S(c){var h=To();return typeof c=="function"&&(c=c()),h.memoizedState=h.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ld,lastRenderedState:c},h.queue=c,c=c.dispatch=kF.bind(null,gn,c),[h.memoizedState,c]}function Od(c,h,x,T){return c={tag:c,create:h,destroy:x,deps:T,next:null},h=gn.updateQueue,h===null?(h={lastEffect:null,stores:null},gn.updateQueue=h,h.lastEffect=c.next=c):(x=h.lastEffect,x===null?h.lastEffect=c.next=c:(T=x.next,x.next=c,c.next=T,h.lastEffect=c)),c}function AS(){return kr().memoizedState}function om(c,h,x,T){var k=To();gn.flags|=c,k.memoizedState=Od(1|h,x,void 0,T===void 0?null:T)}function im(c,h,x,T){var k=kr();T=T===void 0?null:T;var $=void 0;if(Vn!==null){var O=Vn.memoizedState;if($=O.destroy,T!==null&&Y0(T,O.deps)){k.memoizedState=Od(h,x,$,T);return}}gn.flags|=c,k.memoizedState=Od(1|h,x,$,T)}function _S(c,h){return om(8390656,8,c,h)}function tx(c,h){return im(2048,8,c,h)}function RS(c,h){return im(4,2,c,h)}function DS(c,h){return im(4,4,c,h)}function FS(c,h){if(typeof h=="function")return c=c(),h(c),function(){h(null)};if(h!=null)return c=c(),h.current=c,function(){h.current=null}}function MS(c,h,x){return x=x!=null?x.concat([c]):null,im(4,4,FS.bind(null,h,c),x)}function nx(){}function PS(c,h){var x=kr();h=h===void 0?null:h;var T=x.memoizedState;return T!==null&&h!==null&&Y0(h,T[1])?T[0]:(x.memoizedState=[c,h],c)}function LS(c,h){var x=kr();h=h===void 0?null:h;var T=x.memoizedState;return T!==null&&h!==null&&Y0(h,T[1])?T[0]:(c=c(),x.memoizedState=[c,h],c)}function OS(c,h,x){return(Va&21)===0?(c.baseState&&(c.baseState=!1,Hs=!0),c.memoizedState=x):(qr(x,h)||(x=Dp(),gn.lanes|=x,Ba|=x,c.baseState=!0),h)}function bF(c,h){var x=Rt;Rt=x!==0&&4>x?x:4,c(!0);var T=J0.transition;J0.transition={};try{c(!1),h()}finally{Rt=x,J0.transition=T}}function VS(){return kr().memoizedState}function IF(c,h,x){var T=Xi(c);if(x={lane:T,action:x,hasEagerState:!1,eagerState:null,next:null},BS(c))zS(h,x);else if(x=yS(c,h,x,T),x!==null){var k=Ms();Qr(x,c,T,k),US(x,h,T)}}function kF(c,h,x){var T=Xi(c),k={lane:T,action:x,hasEagerState:!1,eagerState:null,next:null};if(BS(c))zS(h,k);else{var $=c.alternate;if(c.lanes===0&&($===null||$.lanes===0)&&($=h.lastRenderedReducer,$!==null))try{var O=h.lastRenderedState,K=$(O,x);if(k.hasEagerState=!0,k.eagerState=K,qr(K,O)){var re=h.interleaved;re===null?(k.next=k,W0(h)):(k.next=re.next,re.next=k),h.interleaved=k;return}}catch{}finally{}x=yS(c,h,k,T),x!==null&&(k=Ms(),Qr(x,c,T,k),US(x,h,T))}}function BS(c){var h=c.alternate;return c===gn||h!==null&&h===gn}function zS(c,h){Md=rm=!0;var x=c.pending;x===null?h.next=h:(h.next=x.next,x.next=h),c.pending=h}function US(c,h,x){if((x&4194240)!==0){var T=h.lanes;T&=c.pendingLanes,x|=T,h.lanes=x,ql(c,x)}}var am={readContext:Ir,useCallback:gs,useContext:gs,useEffect:gs,useImperativeHandle:gs,useInsertionEffect:gs,useLayoutEffect:gs,useMemo:gs,useReducer:gs,useRef:gs,useState:gs,useDebugValue:gs,useDeferredValue:gs,useTransition:gs,useMutableSource:gs,useSyncExternalStore:gs,useId:gs,unstable_isNewReconciler:!1},NF={readContext:Ir,useCallback:function(c,h){return To().memoizedState=[c,h===void 0?null:h],c},useContext:Ir,useEffect:_S,useImperativeHandle:function(c,h,x){return x=x!=null?x.concat([c]):null,om(4194308,4,FS.bind(null,h,c),x)},useLayoutEffect:function(c,h){return om(4194308,4,c,h)},useInsertionEffect:function(c,h){return om(4,2,c,h)},useMemo:function(c,h){var x=To();return h=h===void 0?null:h,c=c(),x.memoizedState=[c,h],c},useReducer:function(c,h,x){var T=To();return h=x!==void 0?x(h):h,T.memoizedState=T.baseState=h,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:h},T.queue=c,c=c.dispatch=IF.bind(null,gn,c),[T.memoizedState,c]},useRef:function(c){var h=To();return c={current:c},h.memoizedState=c},useState:$S,useDebugValue:nx,useDeferredValue:function(c){return To().memoizedState=c},useTransition:function(){var c=$S(!1),h=c[0];return c=bF.bind(null,c[1]),To().memoizedState=c,[h,c]},useMutableSource:function(){},useSyncExternalStore:function(c,h,x){var T=gn,k=To();if(on){if(x===void 0)throw Error(t(407));x=x()}else{if(x=h(),Yn===null)throw Error(t(349));(Va&30)!==0||bS(T,h,x)}k.memoizedState=x;var $={value:x,getSnapshot:h};return k.queue=$,_S(kS.bind(null,T,$,c),[c]),T.flags|=2048,Od(9,IS.bind(null,T,$,x,h),void 0,null),x},useId:function(){var c=To(),h=Yn.identifierPrefix;if(on){var x=Jo,T=Xo;x=(T&~(1<<32-rn(T)-1)).toString(32)+x,h=":"+h+"R"+x,x=Pd++,0<x&&(h+="H"+x.toString(32)),h+=":"}else x=SF++,h=":"+h+"r"+x.toString(32)+":";return c.memoizedState=h},unstable_isNewReconciler:!1},EF={readContext:Ir,useCallback:PS,useContext:Ir,useEffect:tx,useImperativeHandle:MS,useInsertionEffect:RS,useLayoutEffect:DS,useMemo:LS,useReducer:j0,useRef:AS,useState:function(){return j0(Ld)},useDebugValue:nx,useDeferredValue:function(c){var h=kr();return OS(h,Vn.memoizedState,c)},useTransition:function(){var c=j0(Ld)[0],h=kr().memoizedState;return[c,h]},useMutableSource:TS,useSyncExternalStore:SS,useId:VS,unstable_isNewReconciler:!1},$F={readContext:Ir,useCallback:PS,useContext:Ir,useEffect:tx,useImperativeHandle:MS,useInsertionEffect:RS,useLayoutEffect:DS,useMemo:LS,useReducer:ex,useRef:AS,useState:function(){return ex(Ld)},useDebugValue:nx,useDeferredValue:function(c){var h=kr();return Vn===null?h.memoizedState=c:OS(h,Vn.memoizedState,c)},useTransition:function(){var c=ex(Ld)[0],h=kr().memoizedState;return[c,h]},useMutableSource:TS,useSyncExternalStore:SS,useId:VS,unstable_isNewReconciler:!1};function Xr(c,h){if(c&&c.defaultProps){h=oe({},h),c=c.defaultProps;for(var x in c)h[x]===void 0&&(h[x]=c[x]);return h}return h}function sx(c,h,x,T){h=c.memoizedState,x=x(T,h),x=x==null?h:oe({},h,x),c.memoizedState=x,c.lanes===0&&(c.updateQueue.baseState=x)}var lm={isMounted:function(c){return(c=c._reactInternals)?Wo(c)===c:!1},enqueueSetState:function(c,h,x){c=c._reactInternals;var T=Ms(),k=Xi(c),$=Qo(T,k);$.payload=h,x!=null&&($.callback=x),h=Gi(c,$,k),h!==null&&(Qr(h,c,k,T),em(h,c,k))},enqueueReplaceState:function(c,h,x){c=c._reactInternals;var T=Ms(),k=Xi(c),$=Qo(T,k);$.tag=1,$.payload=h,x!=null&&($.callback=x),h=Gi(c,$,k),h!==null&&(Qr(h,c,k,T),em(h,c,k))},enqueueForceUpdate:function(c,h){c=c._reactInternals;var x=Ms(),T=Xi(c),k=Qo(x,T);k.tag=2,h!=null&&(k.callback=h),h=Gi(c,k,T),h!==null&&(Qr(h,c,T,x),em(h,c,T))}};function WS(c,h,x,T,k,$,O){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(T,$,O):h.prototype&&h.prototype.isPureReactComponent?!bd(x,T)||!bd(k,$):!0}function GS(c,h,x){var T=!1,k=zi,$=h.contextType;return typeof $=="object"&&$!==null?$=Ir($):(k=Gs(h)?Fa:ms.current,T=h.contextTypes,$=(T=T!=null)?nu(c,k):zi),h=new h(x,$),c.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=lm,c.stateNode=h,h._reactInternals=c,T&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=k,c.__reactInternalMemoizedMaskedChildContext=$),h}function HS(c,h,x,T){c=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(x,T),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(x,T),h.state!==c&&lm.enqueueReplaceState(h,h.state,null)}function rx(c,h,x,T){var k=c.stateNode;k.props=x,k.state=c.memoizedState,k.refs={},G0(c);var $=h.contextType;typeof $=="object"&&$!==null?k.context=Ir($):($=Gs(h)?Fa:ms.current,k.context=nu(c,$)),k.state=c.memoizedState,$=h.getDerivedStateFromProps,typeof $=="function"&&(sx(c,h,$,x),k.state=c.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(h=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),h!==k.state&&lm.enqueueReplaceState(k,k.state,null),tm(c,x,k,T),k.state=c.memoizedState),typeof k.componentDidMount=="function"&&(c.flags|=4194308)}function cu(c,h){try{var x="",T=h;do x+=Se(T),T=T.return;while(T);var k=x}catch($){k=`
Error generating stack: `+$.message+`
`+$.stack}return{value:c,source:h,stack:k,digest:null}}function ox(c,h,x){return{value:c,source:null,stack:x??null,digest:h??null}}function ix(c,h){try{console.error(h.value)}catch(x){setTimeout(function(){throw x})}}var AF=typeof WeakMap=="function"?WeakMap:Map;function qS(c,h,x){x=Qo(-1,x),x.tag=3,x.payload={element:null};var T=h.value;return x.callback=function(){mm||(mm=!0,Cx=T),ix(c,h)},x}function KS(c,h,x){x=Qo(-1,x),x.tag=3;var T=c.type.getDerivedStateFromError;if(typeof T=="function"){var k=h.value;x.payload=function(){return T(k)},x.callback=function(){ix(c,h)}}var $=c.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(x.callback=function(){ix(c,h),typeof T!="function"&&(qi===null?qi=new Set([this]):qi.add(this));var O=h.stack;this.componentDidCatch(h.value,{componentStack:O!==null?O:""})}),x}function XS(c,h,x){var T=c.pingCache;if(T===null){T=c.pingCache=new AF;var k=new Set;T.set(h,k)}else k=T.get(h),k===void 0&&(k=new Set,T.set(h,k));k.has(x)||(k.add(x),c=GF.bind(null,c,h,x),h.then(c,c))}function JS(c){do{var h;if((h=c.tag===13)&&(h=c.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return c;c=c.return}while(c!==null);return null}function YS(c,h,x,T,k){return(c.mode&1)===0?(c===h?c.flags|=65536:(c.flags|=128,x.flags|=131072,x.flags&=-52805,x.tag===1&&(x.alternate===null?x.tag=17:(h=Qo(-1,1),h.tag=2,Gi(x,h,1))),x.lanes|=1),c):(c.flags|=65536,c.lanes=k,c)}var _F=N.ReactCurrentOwner,Hs=!1;function Fs(c,h,x,T){h.child=c===null?gS(h,null,x,T):iu(h,c.child,x,T)}function QS(c,h,x,T,k){x=x.render;var $=h.ref;return lu(h,k),T=Q0(c,h,x,T,$,k),x=Z0(),c!==null&&!Hs?(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~k,Zo(c,h,k)):(on&&x&&F0(h),h.flags|=1,Fs(c,h,T,k),h.child)}function ZS(c,h,x,T,k){if(c===null){var $=x.type;return typeof $=="function"&&!Ex($)&&$.defaultProps===void 0&&x.compare===null&&x.defaultProps===void 0?(h.tag=15,h.type=$,jS(c,h,$,T,k)):(c=Cm(x.type,null,T,h,h.mode,k),c.ref=h.ref,c.return=h,h.child=c)}if($=c.child,(c.lanes&k)===0){var O=$.memoizedProps;if(x=x.compare,x=x!==null?x:bd,x(O,T)&&c.ref===h.ref)return Zo(c,h,k)}return h.flags|=1,c=Yi($,T),c.ref=h.ref,c.return=h,h.child=c}function jS(c,h,x,T,k){if(c!==null){var $=c.memoizedProps;if(bd($,T)&&c.ref===h.ref)if(Hs=!1,h.pendingProps=T=$,(c.lanes&k)!==0)(c.flags&131072)!==0&&(Hs=!0);else return h.lanes=c.lanes,Zo(c,h,k)}return ax(c,h,x,T,k)}function eb(c,h,x){var T=h.pendingProps,k=T.children,$=c!==null?c.memoizedState:null;if(T.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(fu,cr),cr|=x;else{if((x&1073741824)===0)return c=$!==null?$.baseLanes|x:x,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:c,cachePool:null,transitions:null},h.updateQueue=null,Jt(fu,cr),cr|=c,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},T=$!==null?$.baseLanes:x,Jt(fu,cr),cr|=T}else $!==null?(T=$.baseLanes|x,h.memoizedState=null):T=x,Jt(fu,cr),cr|=T;return Fs(c,h,k,x),h.child}function tb(c,h){var x=h.ref;(c===null&&x!==null||c!==null&&c.ref!==x)&&(h.flags|=512,h.flags|=2097152)}function ax(c,h,x,T,k){var $=Gs(x)?Fa:ms.current;return $=nu(h,$),lu(h,k),x=Q0(c,h,x,T,$,k),T=Z0(),c!==null&&!Hs?(h.updateQueue=c.updateQueue,h.flags&=-2053,c.lanes&=~k,Zo(c,h,k)):(on&&T&&F0(h),h.flags|=1,Fs(c,h,x,k),h.child)}function nb(c,h,x,T,k){if(Gs(x)){var $=!0;qp(h)}else $=!1;if(lu(h,k),h.stateNode===null)cm(c,h),GS(h,x,T),rx(h,x,T,k),T=!0;else if(c===null){var O=h.stateNode,K=h.memoizedProps;O.props=K;var re=O.context,ve=x.contextType;typeof ve=="object"&&ve!==null?ve=Ir(ve):(ve=Gs(x)?Fa:ms.current,ve=nu(h,ve));var $e=x.getDerivedStateFromProps,Ae=typeof $e=="function"||typeof O.getSnapshotBeforeUpdate=="function";Ae||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(K!==T||re!==ve)&&HS(h,O,T,ve),Wi=!1;var Ee=h.memoizedState;O.state=Ee,tm(h,T,O,k),re=h.memoizedState,K!==T||Ee!==re||Ws.current||Wi?(typeof $e=="function"&&(sx(h,x,$e,T),re=h.memoizedState),(K=Wi||WS(h,x,K,T,Ee,re,ve))?(Ae||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(h.flags|=4194308)):(typeof O.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=T,h.memoizedState=re),O.props=T,O.state=re,O.context=ve,T=K):(typeof O.componentDidMount=="function"&&(h.flags|=4194308),T=!1)}else{O=h.stateNode,xS(c,h),K=h.memoizedProps,ve=h.type===h.elementType?K:Xr(h.type,K),O.props=ve,Ae=h.pendingProps,Ee=O.context,re=x.contextType,typeof re=="object"&&re!==null?re=Ir(re):(re=Gs(x)?Fa:ms.current,re=nu(h,re));var Ue=x.getDerivedStateFromProps;($e=typeof Ue=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(K!==Ae||Ee!==re)&&HS(h,O,T,re),Wi=!1,Ee=h.memoizedState,O.state=Ee,tm(h,T,O,k);var Ke=h.memoizedState;K!==Ae||Ee!==Ke||Ws.current||Wi?(typeof Ue=="function"&&(sx(h,x,Ue,T),Ke=h.memoizedState),(ve=Wi||WS(h,x,ve,T,Ee,Ke,re)||!1)?($e||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(T,Ke,re),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(T,Ke,re)),typeof O.componentDidUpdate=="function"&&(h.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof O.componentDidUpdate!="function"||K===c.memoizedProps&&Ee===c.memoizedState||(h.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||K===c.memoizedProps&&Ee===c.memoizedState||(h.flags|=1024),h.memoizedProps=T,h.memoizedState=Ke),O.props=T,O.state=Ke,O.context=re,T=ve):(typeof O.componentDidUpdate!="function"||K===c.memoizedProps&&Ee===c.memoizedState||(h.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||K===c.memoizedProps&&Ee===c.memoizedState||(h.flags|=1024),T=!1)}return lx(c,h,x,T,$,k)}function lx(c,h,x,T,k,$){tb(c,h);var O=(h.flags&128)!==0;if(!T&&!O)return k&&aS(h,x,!1),Zo(c,h,$);T=h.stateNode,_F.current=h;var K=O&&typeof x.getDerivedStateFromError!="function"?null:T.render();return h.flags|=1,c!==null&&O?(h.child=iu(h,c.child,null,$),h.child=iu(h,null,K,$)):Fs(c,h,K,$),h.memoizedState=T.state,k&&aS(h,x,!0),h.child}function sb(c){var h=c.stateNode;h.pendingContext?oS(c,h.pendingContext,h.pendingContext!==h.context):h.context&&oS(c,h.context,!1),H0(c,h.containerInfo)}function rb(c,h,x,T,k){return ou(),O0(k),h.flags|=256,Fs(c,h,x,T),h.child}var ux={dehydrated:null,treeContext:null,retryLane:0};function cx(c){return{baseLanes:c,cachePool:null,transitions:null}}function ob(c,h,x){var T=h.pendingProps,k=mn.current,$=!1,O=(h.flags&128)!==0,K;if((K=O)||(K=c!==null&&c.memoizedState===null?!1:(k&2)!==0),K?($=!0,h.flags&=-129):(c===null||c.memoizedState!==null)&&(k|=1),Jt(mn,k&1),c===null)return L0(h),c=h.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((h.mode&1)===0?h.lanes=1:c.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(O=T.children,c=T.fallback,$?(T=h.mode,$=h.child,O={mode:"hidden",children:O},(T&1)===0&&$!==null?($.childLanes=0,$.pendingProps=O):$=Tm(O,T,0,null),c=Ga(c,T,x,null),$.return=h,c.return=h,$.sibling=c,h.child=$,h.child.memoizedState=cx(x),h.memoizedState=ux,c):dx(h,O));if(k=c.memoizedState,k!==null&&(K=k.dehydrated,K!==null))return RF(c,h,O,T,K,k,x);if($){$=T.fallback,O=h.mode,k=c.child,K=k.sibling;var re={mode:"hidden",children:T.children};return(O&1)===0&&h.child!==k?(T=h.child,T.childLanes=0,T.pendingProps=re,h.deletions=null):(T=Yi(k,re),T.subtreeFlags=k.subtreeFlags&14680064),K!==null?$=Yi(K,$):($=Ga($,O,x,null),$.flags|=2),$.return=h,T.return=h,T.sibling=$,h.child=T,T=$,$=h.child,O=c.child.memoizedState,O=O===null?cx(x):{baseLanes:O.baseLanes|x,cachePool:null,transitions:O.transitions},$.memoizedState=O,$.childLanes=c.childLanes&~x,h.memoizedState=ux,T}return $=c.child,c=$.sibling,T=Yi($,{mode:"visible",children:T.children}),(h.mode&1)===0&&(T.lanes=x),T.return=h,T.sibling=null,c!==null&&(x=h.deletions,x===null?(h.deletions=[c],h.flags|=16):x.push(c)),h.child=T,h.memoizedState=null,T}function dx(c,h){return h=Tm({mode:"visible",children:h},c.mode,0,null),h.return=c,c.child=h}function um(c,h,x,T){return T!==null&&O0(T),iu(h,c.child,null,x),c=dx(h,h.pendingProps.children),c.flags|=2,h.memoizedState=null,c}function RF(c,h,x,T,k,$,O){if(x)return h.flags&256?(h.flags&=-257,T=ox(Error(t(422))),um(c,h,O,T)):h.memoizedState!==null?(h.child=c.child,h.flags|=128,null):($=T.fallback,k=h.mode,T=Tm({mode:"visible",children:T.children},k,0,null),$=Ga($,k,O,null),$.flags|=2,T.return=h,$.return=h,T.sibling=$,h.child=T,(h.mode&1)!==0&&iu(h,c.child,null,O),h.child.memoizedState=cx(O),h.memoizedState=ux,$);if((h.mode&1)===0)return um(c,h,O,null);if(k.data==="$!"){if(T=k.nextSibling&&k.nextSibling.dataset,T)var K=T.dgst;return T=K,$=Error(t(419)),T=ox($,T,void 0),um(c,h,O,T)}if(K=(O&c.childLanes)!==0,Hs||K){if(T=Yn,T!==null){switch(O&-O){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=(k&(T.suspendedLanes|O))!==0?0:k,k!==0&&k!==$.retryLane&&($.retryLane=k,Yo(c,k),Qr(T,c,k,-1))}return Nx(),T=ox(Error(t(421))),um(c,h,O,T)}return k.data==="$?"?(h.flags|=128,h.child=c.child,h=HF.bind(null,c),k._reactRetry=h,null):(c=$.treeContext,ur=Vi(k.nextSibling),lr=h,on=!0,Kr=null,c!==null&&(Sr[br++]=Xo,Sr[br++]=Jo,Sr[br++]=Ma,Xo=c.id,Jo=c.overflow,Ma=h),h=dx(h,T.children),h.flags|=4096,h)}function ib(c,h,x){c.lanes|=h;var T=c.alternate;T!==null&&(T.lanes|=h),U0(c.return,h,x)}function fx(c,h,x,T,k){var $=c.memoizedState;$===null?c.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:T,tail:x,tailMode:k}:($.isBackwards=h,$.rendering=null,$.renderingStartTime=0,$.last=T,$.tail=x,$.tailMode=k)}function ab(c,h,x){var T=h.pendingProps,k=T.revealOrder,$=T.tail;if(Fs(c,h,T.children,x),T=mn.current,(T&2)!==0)T=T&1|2,h.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=h.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&ib(c,x,h);else if(c.tag===19)ib(c,x,h);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===h)break e;for(;c.sibling===null;){if(c.return===null||c.return===h)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}T&=1}if(Jt(mn,T),(h.mode&1)===0)h.memoizedState=null;else switch(k){case"forwards":for(x=h.child,k=null;x!==null;)c=x.alternate,c!==null&&nm(c)===null&&(k=x),x=x.sibling;x=k,x===null?(k=h.child,h.child=null):(k=x.sibling,x.sibling=null),fx(h,!1,k,x,$);break;case"backwards":for(x=null,k=h.child,h.child=null;k!==null;){if(c=k.alternate,c!==null&&nm(c)===null){h.child=k;break}c=k.sibling,k.sibling=x,x=k,k=c}fx(h,!0,x,null,$);break;case"together":fx(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function cm(c,h){(h.mode&1)===0&&c!==null&&(c.alternate=null,h.alternate=null,h.flags|=2)}function Zo(c,h,x){if(c!==null&&(h.dependencies=c.dependencies),Ba|=h.lanes,(x&h.childLanes)===0)return null;if(c!==null&&h.child!==c.child)throw Error(t(153));if(h.child!==null){for(c=h.child,x=Yi(c,c.pendingProps),h.child=x,x.return=h;c.sibling!==null;)c=c.sibling,x=x.sibling=Yi(c,c.pendingProps),x.return=h;x.sibling=null}return h.child}function DF(c,h,x){switch(h.tag){case 3:sb(h),ou();break;case 5:CS(h);break;case 1:Gs(h.type)&&qp(h);break;case 4:H0(h,h.stateNode.containerInfo);break;case 10:var T=h.type._context,k=h.memoizedProps.value;Jt(Zp,T._currentValue),T._currentValue=k;break;case 13:if(T=h.memoizedState,T!==null)return T.dehydrated!==null?(Jt(mn,mn.current&1),h.flags|=128,null):(x&h.child.childLanes)!==0?ob(c,h,x):(Jt(mn,mn.current&1),c=Zo(c,h,x),c!==null?c.sibling:null);Jt(mn,mn.current&1);break;case 19:if(T=(x&h.childLanes)!==0,(c.flags&128)!==0){if(T)return ab(c,h,x);h.flags|=128}if(k=h.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Jt(mn,mn.current),T)break;return null;case 22:case 23:return h.lanes=0,eb(c,h,x)}return Zo(c,h,x)}var lb,hx,ub,cb;lb=function(c,h){for(var x=h.child;x!==null;){if(x.tag===5||x.tag===6)c.appendChild(x.stateNode);else if(x.tag!==4&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===h)break;for(;x.sibling===null;){if(x.return===null||x.return===h)return;x=x.return}x.sibling.return=x.return,x=x.sibling}},hx=function(){},ub=function(c,h,x,T){var k=c.memoizedProps;if(k!==T){c=h.stateNode,Oa(Co.current);var $=null;switch(x){case"input":k=At(c,k),T=At(c,T),$=[];break;case"select":k=oe({},k,{value:void 0}),T=oe({},T,{value:void 0}),$=[];break;case"textarea":k=xn(c,k),T=xn(c,T),$=[];break;default:typeof k.onClick!="function"&&typeof T.onClick=="function"&&(c.onclick=Wp)}Ol(x,T);var O;x=null;for(ve in k)if(!T.hasOwnProperty(ve)&&k.hasOwnProperty(ve)&&k[ve]!=null)if(ve==="style"){var K=k[ve];for(O in K)K.hasOwnProperty(O)&&(x||(x={}),x[O]="")}else ve!=="dangerouslySetInnerHTML"&&ve!=="children"&&ve!=="suppressContentEditableWarning"&&ve!=="suppressHydrationWarning"&&ve!=="autoFocus"&&(r.hasOwnProperty(ve)?$||($=[]):($=$||[]).push(ve,null));for(ve in T){var re=T[ve];if(K=k!=null?k[ve]:void 0,T.hasOwnProperty(ve)&&re!==K&&(re!=null||K!=null))if(ve==="style")if(K){for(O in K)!K.hasOwnProperty(O)||re&&re.hasOwnProperty(O)||(x||(x={}),x[O]="");for(O in re)re.hasOwnProperty(O)&&K[O]!==re[O]&&(x||(x={}),x[O]=re[O])}else x||($||($=[]),$.push(ve,x)),x=re;else ve==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,K=K?K.__html:void 0,re!=null&&K!==re&&($=$||[]).push(ve,re)):ve==="children"?typeof re!="string"&&typeof re!="number"||($=$||[]).push(ve,""+re):ve!=="suppressContentEditableWarning"&&ve!=="suppressHydrationWarning"&&(r.hasOwnProperty(ve)?(re!=null&&ve==="onScroll"&&Zt("scroll",c),$||K===re||($=[])):($=$||[]).push(ve,re))}x&&($=$||[]).push("style",x);var ve=$;(h.updateQueue=ve)&&(h.flags|=4)}},cb=function(c,h,x,T){x!==T&&(h.flags|=4)};function Vd(c,h){if(!on)switch(c.tailMode){case"hidden":h=c.tail;for(var x=null;h!==null;)h.alternate!==null&&(x=h),h=h.sibling;x===null?c.tail=null:x.sibling=null;break;case"collapsed":x=c.tail;for(var T=null;x!==null;)x.alternate!==null&&(T=x),x=x.sibling;T===null?h||c.tail===null?c.tail=null:c.tail.sibling=null:T.sibling=null}}function ys(c){var h=c.alternate!==null&&c.alternate.child===c.child,x=0,T=0;if(h)for(var k=c.child;k!==null;)x|=k.lanes|k.childLanes,T|=k.subtreeFlags&14680064,T|=k.flags&14680064,k.return=c,k=k.sibling;else for(k=c.child;k!==null;)x|=k.lanes|k.childLanes,T|=k.subtreeFlags,T|=k.flags,k.return=c,k=k.sibling;return c.subtreeFlags|=T,c.childLanes=x,h}function FF(c,h,x){var T=h.pendingProps;switch(M0(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ys(h),null;case 1:return Gs(h.type)&&Hp(),ys(h),null;case 3:return T=h.stateNode,uu(),jt(Ws),jt(ms),X0(),T.pendingContext&&(T.context=T.pendingContext,T.pendingContext=null),(c===null||c.child===null)&&(Yp(h)?h.flags|=4:c===null||c.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Kr!==null&&(bx(Kr),Kr=null))),hx(c,h),ys(h),null;case 5:q0(h);var k=Oa(Fd.current);if(x=h.type,c!==null&&h.stateNode!=null)ub(c,h,x,T,k),c.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!T){if(h.stateNode===null)throw Error(t(166));return ys(h),null}if(c=Oa(Co.current),Yp(h)){T=h.stateNode,x=h.type;var $=h.memoizedProps;switch(T[wo]=h,T[$d]=$,c=(h.mode&1)!==0,x){case"dialog":Zt("cancel",T),Zt("close",T);break;case"iframe":case"object":case"embed":Zt("load",T);break;case"video":case"audio":for(k=0;k<kd.length;k++)Zt(kd[k],T);break;case"source":Zt("error",T);break;case"img":case"image":case"link":Zt("error",T),Zt("load",T);break;case"details":Zt("toggle",T);break;case"input":It(T,$),Zt("invalid",T);break;case"select":T._wrapperState={wasMultiple:!!$.multiple},Zt("invalid",T);break;case"textarea":rr(T,$),Zt("invalid",T)}Ol(x,$),k=null;for(var O in $)if($.hasOwnProperty(O)){var K=$[O];O==="children"?typeof K=="string"?T.textContent!==K&&($.suppressHydrationWarning!==!0&&Up(T.textContent,K,c),k=["children",K]):typeof K=="number"&&T.textContent!==""+K&&($.suppressHydrationWarning!==!0&&Up(T.textContent,K,c),k=["children",""+K]):r.hasOwnProperty(O)&&K!=null&&O==="onScroll"&&Zt("scroll",T)}switch(x){case"input":je(T),Ot(T,$,!0);break;case"textarea":je(T),Xn(T);break;case"select":case"option":break;default:typeof $.onClick=="function"&&(T.onclick=Wp)}T=k,h.updateQueue=T,T!==null&&(h.flags|=4)}else{O=k.nodeType===9?k:k.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=as(x)),c==="http://www.w3.org/1999/xhtml"?x==="script"?(c=O.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof T.is=="string"?c=O.createElement(x,{is:T.is}):(c=O.createElement(x),x==="select"&&(O=c,T.multiple?O.multiple=!0:T.size&&(O.size=T.size))):c=O.createElementNS(c,x),c[wo]=h,c[$d]=T,lb(c,h,!1,!1),h.stateNode=c;e:{switch(O=zs(x,T),x){case"dialog":Zt("cancel",c),Zt("close",c),k=T;break;case"iframe":case"object":case"embed":Zt("load",c),k=T;break;case"video":case"audio":for(k=0;k<kd.length;k++)Zt(kd[k],c);k=T;break;case"source":Zt("error",c),k=T;break;case"img":case"image":case"link":Zt("error",c),Zt("load",c),k=T;break;case"details":Zt("toggle",c),k=T;break;case"input":It(c,T),k=At(c,T),Zt("invalid",c);break;case"option":k=T;break;case"select":c._wrapperState={wasMultiple:!!T.multiple},k=oe({},T,{value:void 0}),Zt("invalid",c);break;case"textarea":rr(c,T),k=xn(c,T),Zt("invalid",c);break;default:k=T}Ol(x,k),K=k;for($ in K)if(K.hasOwnProperty($)){var re=K[$];$==="style"?ps(c,re):$==="dangerouslySetInnerHTML"?(re=re?re.__html:void 0,re!=null&&or(c,re)):$==="children"?typeof re=="string"?(x!=="textarea"||re!=="")&&wr(c,re):typeof re=="number"&&wr(c,""+re):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(r.hasOwnProperty($)?re!=null&&$==="onScroll"&&Zt("scroll",c):re!=null&&E(c,$,re,O))}switch(x){case"input":je(c),Ot(c,T,!1);break;case"textarea":je(c),Xn(c);break;case"option":T.value!=null&&c.setAttribute("value",""+Fe(T.value));break;case"select":c.multiple=!!T.multiple,$=T.value,$!=null?yn(c,!!T.multiple,$,!1):T.defaultValue!=null&&yn(c,!!T.multiple,T.defaultValue,!0);break;default:typeof k.onClick=="function"&&(c.onclick=Wp)}switch(x){case"button":case"input":case"select":case"textarea":T=!!T.autoFocus;break e;case"img":T=!0;break e;default:T=!1}}T&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return ys(h),null;case 6:if(c&&h.stateNode!=null)cb(c,h,c.memoizedProps,T);else{if(typeof T!="string"&&h.stateNode===null)throw Error(t(166));if(x=Oa(Fd.current),Oa(Co.current),Yp(h)){if(T=h.stateNode,x=h.memoizedProps,T[wo]=h,($=T.nodeValue!==x)&&(c=lr,c!==null))switch(c.tag){case 3:Up(T.nodeValue,x,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&Up(T.nodeValue,x,(c.mode&1)!==0)}$&&(h.flags|=4)}else T=(x.nodeType===9?x:x.ownerDocument).createTextNode(T),T[wo]=h,h.stateNode=T}return ys(h),null;case 13:if(jt(mn),T=h.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(on&&ur!==null&&(h.mode&1)!==0&&(h.flags&128)===0)hS(),ou(),h.flags|=98560,$=!1;else if($=Yp(h),T!==null&&T.dehydrated!==null){if(c===null){if(!$)throw Error(t(318));if($=h.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(t(317));$[wo]=h}else ou(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;ys(h),$=!1}else Kr!==null&&(bx(Kr),Kr=null),$=!0;if(!$)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=x,h):(T=T!==null,T!==(c!==null&&c.memoizedState!==null)&&T&&(h.child.flags|=8192,(h.mode&1)!==0&&(c===null||(mn.current&1)!==0?Bn===0&&(Bn=3):Nx())),h.updateQueue!==null&&(h.flags|=4),ys(h),null);case 4:return uu(),hx(c,h),c===null&&Nd(h.stateNode.containerInfo),ys(h),null;case 10:return z0(h.type._context),ys(h),null;case 17:return Gs(h.type)&&Hp(),ys(h),null;case 19:if(jt(mn),$=h.memoizedState,$===null)return ys(h),null;if(T=(h.flags&128)!==0,O=$.rendering,O===null)if(T)Vd($,!1);else{if(Bn!==0||c!==null&&(c.flags&128)!==0)for(c=h.child;c!==null;){if(O=nm(c),O!==null){for(h.flags|=128,Vd($,!1),T=O.updateQueue,T!==null&&(h.updateQueue=T,h.flags|=4),h.subtreeFlags=0,T=x,x=h.child;x!==null;)$=x,c=T,$.flags&=14680066,O=$.alternate,O===null?($.childLanes=0,$.lanes=c,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=O.childLanes,$.lanes=O.lanes,$.child=O.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=O.memoizedProps,$.memoizedState=O.memoizedState,$.updateQueue=O.updateQueue,$.type=O.type,c=O.dependencies,$.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),x=x.sibling;return Jt(mn,mn.current&1|2),h.child}c=c.sibling}$.tail!==null&&sn()>hu&&(h.flags|=128,T=!0,Vd($,!1),h.lanes=4194304)}else{if(!T)if(c=nm(O),c!==null){if(h.flags|=128,T=!0,x=c.updateQueue,x!==null&&(h.updateQueue=x,h.flags|=4),Vd($,!0),$.tail===null&&$.tailMode==="hidden"&&!O.alternate&&!on)return ys(h),null}else 2*sn()-$.renderingStartTime>hu&&x!==1073741824&&(h.flags|=128,T=!0,Vd($,!1),h.lanes=4194304);$.isBackwards?(O.sibling=h.child,h.child=O):(x=$.last,x!==null?x.sibling=O:h.child=O,$.last=O)}return $.tail!==null?(h=$.tail,$.rendering=h,$.tail=h.sibling,$.renderingStartTime=sn(),h.sibling=null,x=mn.current,Jt(mn,T?x&1|2:x&1),h):(ys(h),null);case 22:case 23:return kx(),T=h.memoizedState!==null,c!==null&&c.memoizedState!==null!==T&&(h.flags|=8192),T&&(h.mode&1)!==0?(cr&1073741824)!==0&&(ys(h),h.subtreeFlags&6&&(h.flags|=8192)):ys(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function MF(c,h){switch(M0(h),h.tag){case 1:return Gs(h.type)&&Hp(),c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 3:return uu(),jt(Ws),jt(ms),X0(),c=h.flags,(c&65536)!==0&&(c&128)===0?(h.flags=c&-65537|128,h):null;case 5:return q0(h),null;case 13:if(jt(mn),c=h.memoizedState,c!==null&&c.dehydrated!==null){if(h.alternate===null)throw Error(t(340));ou()}return c=h.flags,c&65536?(h.flags=c&-65537|128,h):null;case 19:return jt(mn),null;case 4:return uu(),null;case 10:return z0(h.type._context),null;case 22:case 23:return kx(),null;case 24:return null;default:return null}}var dm=!1,xs=!1,PF=typeof WeakSet=="function"?WeakSet:Set,We=null;function du(c,h){var x=c.ref;if(x!==null)if(typeof x=="function")try{x(null)}catch(T){vn(c,h,T)}else x.current=null}function px(c,h,x){try{x()}catch(T){vn(c,h,T)}}var db=!1;function LF(c,h){if(k0=Y,c=WT(),x0(c)){if("selectionStart"in c)var x={start:c.selectionStart,end:c.selectionEnd};else e:{x=(x=c.ownerDocument)&&x.defaultView||window;var T=x.getSelection&&x.getSelection();if(T&&T.rangeCount!==0){x=T.anchorNode;var k=T.anchorOffset,$=T.focusNode;T=T.focusOffset;try{x.nodeType,$.nodeType}catch{x=null;break e}var O=0,K=-1,re=-1,ve=0,$e=0,Ae=c,Ee=null;t:for(;;){for(var Ue;Ae!==x||k!==0&&Ae.nodeType!==3||(K=O+k),Ae!==$||T!==0&&Ae.nodeType!==3||(re=O+T),Ae.nodeType===3&&(O+=Ae.nodeValue.length),(Ue=Ae.firstChild)!==null;)Ee=Ae,Ae=Ue;for(;;){if(Ae===c)break t;if(Ee===x&&++ve===k&&(K=O),Ee===$&&++$e===T&&(re=O),(Ue=Ae.nextSibling)!==null)break;Ae=Ee,Ee=Ae.parentNode}Ae=Ue}x=K===-1||re===-1?null:{start:K,end:re}}else x=null}x=x||{start:0,end:0}}else x=null;for(N0={focusedElem:c,selectionRange:x},Y=!1,We=h;We!==null;)if(h=We,c=h.child,(h.subtreeFlags&1028)!==0&&c!==null)c.return=h,We=c;else for(;We!==null;){h=We;try{var Ke=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(Ke!==null){var Je=Ke.memoizedProps,bn=Ke.memoizedState,pe=h.stateNode,ce=pe.getSnapshotBeforeUpdate(h.elementType===h.type?Je:Xr(h.type,Je),bn);pe.__reactInternalSnapshotBeforeUpdate=ce}break;case 3:var ge=h.stateNode.containerInfo;ge.nodeType===1?ge.textContent="":ge.nodeType===9&&ge.documentElement&&ge.removeChild(ge.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(De){vn(h,h.return,De)}if(c=h.sibling,c!==null){c.return=h.return,We=c;break}We=h.return}return Ke=db,db=!1,Ke}function Bd(c,h,x){var T=h.updateQueue;if(T=T!==null?T.lastEffect:null,T!==null){var k=T=T.next;do{if((k.tag&c)===c){var $=k.destroy;k.destroy=void 0,$!==void 0&&px(h,x,$)}k=k.next}while(k!==T)}}function fm(c,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var x=h=h.next;do{if((x.tag&c)===c){var T=x.create;x.destroy=T()}x=x.next}while(x!==h)}}function mx(c){var h=c.ref;if(h!==null){var x=c.stateNode;switch(c.tag){case 5:c=x;break;default:c=x}typeof h=="function"?h(c):h.current=c}}function fb(c){var h=c.alternate;h!==null&&(c.alternate=null,fb(h)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(h=c.stateNode,h!==null&&(delete h[wo],delete h[$d],delete h[_0],delete h[vF],delete h[wF])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function hb(c){return c.tag===5||c.tag===3||c.tag===4}function pb(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||hb(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function gx(c,h,x){var T=c.tag;if(T===5||T===6)c=c.stateNode,h?x.nodeType===8?x.parentNode.insertBefore(c,h):x.insertBefore(c,h):(x.nodeType===8?(h=x.parentNode,h.insertBefore(c,x)):(h=x,h.appendChild(c)),x=x._reactRootContainer,x!=null||h.onclick!==null||(h.onclick=Wp));else if(T!==4&&(c=c.child,c!==null))for(gx(c,h,x),c=c.sibling;c!==null;)gx(c,h,x),c=c.sibling}function yx(c,h,x){var T=c.tag;if(T===5||T===6)c=c.stateNode,h?x.insertBefore(c,h):x.appendChild(c);else if(T!==4&&(c=c.child,c!==null))for(yx(c,h,x),c=c.sibling;c!==null;)yx(c,h,x),c=c.sibling}var ls=null,Jr=!1;function Hi(c,h,x){for(x=x.child;x!==null;)mb(c,h,x),x=x.sibling}function mb(c,h,x){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(Gl,x)}catch{}switch(x.tag){case 5:xs||du(x,h);case 6:var T=ls,k=Jr;ls=null,Hi(c,h,x),ls=T,Jr=k,ls!==null&&(Jr?(c=ls,x=x.stateNode,c.nodeType===8?c.parentNode.removeChild(x):c.removeChild(x)):ls.removeChild(x.stateNode));break;case 18:ls!==null&&(Jr?(c=ls,x=x.stateNode,c.nodeType===8?A0(c.parentNode,x):c.nodeType===1&&A0(c,x),X(c)):A0(ls,x.stateNode));break;case 4:T=ls,k=Jr,ls=x.stateNode.containerInfo,Jr=!0,Hi(c,h,x),ls=T,Jr=k;break;case 0:case 11:case 14:case 15:if(!xs&&(T=x.updateQueue,T!==null&&(T=T.lastEffect,T!==null))){k=T=T.next;do{var $=k,O=$.destroy;$=$.tag,O!==void 0&&(($&2)!==0||($&4)!==0)&&px(x,h,O),k=k.next}while(k!==T)}Hi(c,h,x);break;case 1:if(!xs&&(du(x,h),T=x.stateNode,typeof T.componentWillUnmount=="function"))try{T.props=x.memoizedProps,T.state=x.memoizedState,T.componentWillUnmount()}catch(K){vn(x,h,K)}Hi(c,h,x);break;case 21:Hi(c,h,x);break;case 22:x.mode&1?(xs=(T=xs)||x.memoizedState!==null,Hi(c,h,x),xs=T):Hi(c,h,x);break;default:Hi(c,h,x)}}function gb(c){var h=c.updateQueue;if(h!==null){c.updateQueue=null;var x=c.stateNode;x===null&&(x=c.stateNode=new PF),h.forEach(function(T){var k=qF.bind(null,c,T);x.has(T)||(x.add(T),T.then(k,k))})}}function Yr(c,h){var x=h.deletions;if(x!==null)for(var T=0;T<x.length;T++){var k=x[T];try{var $=c,O=h,K=O;e:for(;K!==null;){switch(K.tag){case 5:ls=K.stateNode,Jr=!1;break e;case 3:ls=K.stateNode.containerInfo,Jr=!0;break e;case 4:ls=K.stateNode.containerInfo,Jr=!0;break e}K=K.return}if(ls===null)throw Error(t(160));mb($,O,k),ls=null,Jr=!1;var re=k.alternate;re!==null&&(re.return=null),k.return=null}catch(ve){vn(k,h,ve)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)yb(h,c),h=h.sibling}function yb(c,h){var x=c.alternate,T=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(Yr(h,c),So(c),T&4){try{Bd(3,c,c.return),fm(3,c)}catch(Je){vn(c,c.return,Je)}try{Bd(5,c,c.return)}catch(Je){vn(c,c.return,Je)}}break;case 1:Yr(h,c),So(c),T&512&&x!==null&&du(x,x.return);break;case 5:if(Yr(h,c),So(c),T&512&&x!==null&&du(x,x.return),c.flags&32){var k=c.stateNode;try{wr(k,"")}catch(Je){vn(c,c.return,Je)}}if(T&4&&(k=c.stateNode,k!=null)){var $=c.memoizedProps,O=x!==null?x.memoizedProps:$,K=c.type,re=c.updateQueue;if(c.updateQueue=null,re!==null)try{K==="input"&&$.type==="radio"&&$.name!=null&&Et(k,$),zs(K,O);var ve=zs(K,$);for(O=0;O<re.length;O+=2){var $e=re[O],Ae=re[O+1];$e==="style"?ps(k,Ae):$e==="dangerouslySetInnerHTML"?or(k,Ae):$e==="children"?wr(k,Ae):E(k,$e,Ae,ve)}switch(K){case"input":Lt(k,$);break;case"textarea":is(k,$);break;case"select":var Ee=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!$.multiple;var Ue=$.value;Ue!=null?yn(k,!!$.multiple,Ue,!1):Ee!==!!$.multiple&&($.defaultValue!=null?yn(k,!!$.multiple,$.defaultValue,!0):yn(k,!!$.multiple,$.multiple?[]:"",!1))}k[$d]=$}catch(Je){vn(c,c.return,Je)}}break;case 6:if(Yr(h,c),So(c),T&4){if(c.stateNode===null)throw Error(t(162));k=c.stateNode,$=c.memoizedProps;try{k.nodeValue=$}catch(Je){vn(c,c.return,Je)}}break;case 3:if(Yr(h,c),So(c),T&4&&x!==null&&x.memoizedState.isDehydrated)try{X(h.containerInfo)}catch(Je){vn(c,c.return,Je)}break;case 4:Yr(h,c),So(c);break;case 13:Yr(h,c),So(c),k=c.child,k.flags&8192&&($=k.memoizedState!==null,k.stateNode.isHidden=$,!$||k.alternate!==null&&k.alternate.memoizedState!==null||(wx=sn())),T&4&&gb(c);break;case 22:if($e=x!==null&&x.memoizedState!==null,c.mode&1?(xs=(ve=xs)||$e,Yr(h,c),xs=ve):Yr(h,c),So(c),T&8192){if(ve=c.memoizedState!==null,(c.stateNode.isHidden=ve)&&!$e&&(c.mode&1)!==0)for(We=c,$e=c.child;$e!==null;){for(Ae=We=$e;We!==null;){switch(Ee=We,Ue=Ee.child,Ee.tag){case 0:case 11:case 14:case 15:Bd(4,Ee,Ee.return);break;case 1:du(Ee,Ee.return);var Ke=Ee.stateNode;if(typeof Ke.componentWillUnmount=="function"){T=Ee,x=Ee.return;try{h=T,Ke.props=h.memoizedProps,Ke.state=h.memoizedState,Ke.componentWillUnmount()}catch(Je){vn(T,x,Je)}}break;case 5:du(Ee,Ee.return);break;case 22:if(Ee.memoizedState!==null){wb(Ae);continue}}Ue!==null?(Ue.return=Ee,We=Ue):wb(Ae)}$e=$e.sibling}e:for($e=null,Ae=c;;){if(Ae.tag===5){if($e===null){$e=Ae;try{k=Ae.stateNode,ve?($=k.style,typeof $.setProperty=="function"?$.setProperty("display","none","important"):$.display="none"):(K=Ae.stateNode,re=Ae.memoizedProps.style,O=re!=null&&re.hasOwnProperty("display")?re.display:null,K.style.display=po("display",O))}catch(Je){vn(c,c.return,Je)}}}else if(Ae.tag===6){if($e===null)try{Ae.stateNode.nodeValue=ve?"":Ae.memoizedProps}catch(Je){vn(c,c.return,Je)}}else if((Ae.tag!==22&&Ae.tag!==23||Ae.memoizedState===null||Ae===c)&&Ae.child!==null){Ae.child.return=Ae,Ae=Ae.child;continue}if(Ae===c)break e;for(;Ae.sibling===null;){if(Ae.return===null||Ae.return===c)break e;$e===Ae&&($e=null),Ae=Ae.return}$e===Ae&&($e=null),Ae.sibling.return=Ae.return,Ae=Ae.sibling}}break;case 19:Yr(h,c),So(c),T&4&&gb(c);break;case 21:break;default:Yr(h,c),So(c)}}function So(c){var h=c.flags;if(h&2){try{e:{for(var x=c.return;x!==null;){if(hb(x)){var T=x;break e}x=x.return}throw Error(t(160))}switch(T.tag){case 5:var k=T.stateNode;T.flags&32&&(wr(k,""),T.flags&=-33);var $=pb(c);yx(c,$,k);break;case 3:case 4:var O=T.stateNode.containerInfo,K=pb(c);gx(c,K,O);break;default:throw Error(t(161))}}catch(re){vn(c,c.return,re)}c.flags&=-3}h&4096&&(c.flags&=-4097)}function OF(c,h,x){We=c,xb(c)}function xb(c,h,x){for(var T=(c.mode&1)!==0;We!==null;){var k=We,$=k.child;if(k.tag===22&&T){var O=k.memoizedState!==null||dm;if(!O){var K=k.alternate,re=K!==null&&K.memoizedState!==null||xs;K=dm;var ve=xs;if(dm=O,(xs=re)&&!ve)for(We=k;We!==null;)O=We,re=O.child,O.tag===22&&O.memoizedState!==null?Cb(k):re!==null?(re.return=O,We=re):Cb(k);for(;$!==null;)We=$,xb($),$=$.sibling;We=k,dm=K,xs=ve}vb(c)}else(k.subtreeFlags&8772)!==0&&$!==null?($.return=k,We=$):vb(c)}}function vb(c){for(;We!==null;){var h=We;if((h.flags&8772)!==0){var x=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:xs||fm(5,h);break;case 1:var T=h.stateNode;if(h.flags&4&&!xs)if(x===null)T.componentDidMount();else{var k=h.elementType===h.type?x.memoizedProps:Xr(h.type,x.memoizedProps);T.componentDidUpdate(k,x.memoizedState,T.__reactInternalSnapshotBeforeUpdate)}var $=h.updateQueue;$!==null&&wS(h,$,T);break;case 3:var O=h.updateQueue;if(O!==null){if(x=null,h.child!==null)switch(h.child.tag){case 5:x=h.child.stateNode;break;case 1:x=h.child.stateNode}wS(h,O,x)}break;case 5:var K=h.stateNode;if(x===null&&h.flags&4){x=K;var re=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":re.autoFocus&&x.focus();break;case"img":re.src&&(x.src=re.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var ve=h.alternate;if(ve!==null){var $e=ve.memoizedState;if($e!==null){var Ae=$e.dehydrated;Ae!==null&&X(Ae)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}xs||h.flags&512&&mx(h)}catch(Ee){vn(h,h.return,Ee)}}if(h===c){We=null;break}if(x=h.sibling,x!==null){x.return=h.return,We=x;break}We=h.return}}function wb(c){for(;We!==null;){var h=We;if(h===c){We=null;break}var x=h.sibling;if(x!==null){x.return=h.return,We=x;break}We=h.return}}function Cb(c){for(;We!==null;){var h=We;try{switch(h.tag){case 0:case 11:case 15:var x=h.return;try{fm(4,h)}catch(re){vn(h,x,re)}break;case 1:var T=h.stateNode;if(typeof T.componentDidMount=="function"){var k=h.return;try{T.componentDidMount()}catch(re){vn(h,k,re)}}var $=h.return;try{mx(h)}catch(re){vn(h,$,re)}break;case 5:var O=h.return;try{mx(h)}catch(re){vn(h,O,re)}}}catch(re){vn(h,h.return,re)}if(h===c){We=null;break}var K=h.sibling;if(K!==null){K.return=h.return,We=K;break}We=h.return}}var VF=Math.ceil,hm=N.ReactCurrentDispatcher,xx=N.ReactCurrentOwner,Nr=N.ReactCurrentBatchConfig,_t=0,Yn=null,_n=null,us=0,cr=0,fu=Bi(0),Bn=0,zd=null,Ba=0,pm=0,vx=0,Ud=null,qs=null,wx=0,hu=1/0,jo=null,mm=!1,Cx=null,qi=null,gm=!1,Ki=null,ym=0,Wd=0,Tx=null,xm=-1,vm=0;function Ms(){return(_t&6)!==0?sn():xm!==-1?xm:xm=sn()}function Xi(c){return(c.mode&1)===0?1:(_t&2)!==0&&us!==0?us&-us:TF.transition!==null?(vm===0&&(vm=Dp()),vm):(c=Rt,c!==0||(c=window.event,c=c===void 0?16:st(c.type)),c)}function Qr(c,h,x,T){if(50<Wd)throw Wd=0,Tx=null,Error(t(185));Fi(c,x,T),((_t&2)===0||c!==Yn)&&(c===Yn&&((_t&2)===0&&(pm|=x),Bn===4&&Ji(c,us)),Ks(c,T),x===1&&_t===0&&(h.mode&1)===0&&(hu=sn()+500,Kp&&Ui()))}function Ks(c,h){var x=c.callbackNode;Rp(c,h);var T=Go(c,c===Yn?us:0);if(T===0)x!==null&&Ip(x),c.callbackNode=null,c.callbackPriority=0;else if(h=T&-T,c.callbackPriority!==h){if(x!=null&&Ip(x),h===1)c.tag===0?CF(Sb.bind(null,c)):lS(Sb.bind(null,c)),yF(function(){(_t&6)===0&&Ui()}),x=null;else{switch(gd(T)){case 1:x=Ul;break;case 4:x=Wl;break;case 16:x=mo;break;case 536870912:x=Np;break;default:x=mo}x=_b(x,Tb.bind(null,c))}c.callbackPriority=h,c.callbackNode=x}}function Tb(c,h){if(xm=-1,vm=0,(_t&6)!==0)throw Error(t(327));var x=c.callbackNode;if(pu()&&c.callbackNode!==x)return null;var T=Go(c,c===Yn?us:0);if(T===0)return null;if((T&30)!==0||(T&c.expiredLanes)!==0||h)h=wm(c,T);else{h=T;var k=_t;_t|=2;var $=Ib();(Yn!==c||us!==h)&&(jo=null,hu=sn()+500,Ua(c,h));do try{UF();break}catch(K){bb(c,K)}while(!0);B0(),hm.current=$,_t=k,_n!==null?h=0:(Yn=null,us=0,h=Bn)}if(h!==0){if(h===2&&(k=md(c),k!==0&&(T=k,h=Sx(c,k))),h===1)throw x=zd,Ua(c,0),Ji(c,T),Ks(c,sn()),x;if(h===6)Ji(c,T);else{if(k=c.current.alternate,(T&30)===0&&!BF(k)&&(h=wm(c,T),h===2&&($=md(c),$!==0&&(T=$,h=Sx(c,$))),h===1))throw x=zd,Ua(c,0),Ji(c,T),Ks(c,sn()),x;switch(c.finishedWork=k,c.finishedLanes=T,h){case 0:case 1:throw Error(t(345));case 2:Wa(c,qs,jo);break;case 3:if(Ji(c,T),(T&130023424)===T&&(h=wx+500-sn(),10<h)){if(Go(c,0)!==0)break;if(k=c.suspendedLanes,(k&T)!==T){Ms(),c.pingedLanes|=c.suspendedLanes&k;break}c.timeoutHandle=$0(Wa.bind(null,c,qs,jo),h);break}Wa(c,qs,jo);break;case 4:if(Ji(c,T),(T&4194240)===T)break;for(h=c.eventTimes,k=-1;0<T;){var O=31-rn(T);$=1<<O,O=h[O],O>k&&(k=O),T&=~$}if(T=k,T=sn()-T,T=(120>T?120:480>T?480:1080>T?1080:1920>T?1920:3e3>T?3e3:4320>T?4320:1960*VF(T/1960))-T,10<T){c.timeoutHandle=$0(Wa.bind(null,c,qs,jo),T);break}Wa(c,qs,jo);break;case 5:Wa(c,qs,jo);break;default:throw Error(t(329))}}}return Ks(c,sn()),c.callbackNode===x?Tb.bind(null,c):null}function Sx(c,h){var x=Ud;return c.current.memoizedState.isDehydrated&&(Ua(c,h).flags|=256),c=wm(c,h),c!==2&&(h=qs,qs=x,h!==null&&bx(h)),c}function bx(c){qs===null?qs=c:qs.push.apply(qs,c)}function BF(c){for(var h=c;;){if(h.flags&16384){var x=h.updateQueue;if(x!==null&&(x=x.stores,x!==null))for(var T=0;T<x.length;T++){var k=x[T],$=k.getSnapshot;k=k.value;try{if(!qr($(),k))return!1}catch{return!1}}}if(x=h.child,h.subtreeFlags&16384&&x!==null)x.return=h,h=x;else{if(h===c)break;for(;h.sibling===null;){if(h.return===null||h.return===c)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Ji(c,h){for(h&=~vx,h&=~pm,c.suspendedLanes|=h,c.pingedLanes&=~h,c=c.expirationTimes;0<h;){var x=31-rn(h),T=1<<x;c[x]=-1,h&=~T}}function Sb(c){if((_t&6)!==0)throw Error(t(327));pu();var h=Go(c,0);if((h&1)===0)return Ks(c,sn()),null;var x=wm(c,h);if(c.tag!==0&&x===2){var T=md(c);T!==0&&(h=T,x=Sx(c,T))}if(x===1)throw x=zd,Ua(c,0),Ji(c,h),Ks(c,sn()),x;if(x===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=h,Wa(c,qs,jo),Ks(c,sn()),null}function Ix(c,h){var x=_t;_t|=1;try{return c(h)}finally{_t=x,_t===0&&(hu=sn()+500,Kp&&Ui())}}function za(c){Ki!==null&&Ki.tag===0&&(_t&6)===0&&pu();var h=_t;_t|=1;var x=Nr.transition,T=Rt;try{if(Nr.transition=null,Rt=1,c)return c()}finally{Rt=T,Nr.transition=x,_t=h,(_t&6)===0&&Ui()}}function kx(){cr=fu.current,jt(fu)}function Ua(c,h){c.finishedWork=null,c.finishedLanes=0;var x=c.timeoutHandle;if(x!==-1&&(c.timeoutHandle=-1,gF(x)),_n!==null)for(x=_n.return;x!==null;){var T=x;switch(M0(T),T.tag){case 1:T=T.type.childContextTypes,T!=null&&Hp();break;case 3:uu(),jt(Ws),jt(ms),X0();break;case 5:q0(T);break;case 4:uu();break;case 13:jt(mn);break;case 19:jt(mn);break;case 10:z0(T.type._context);break;case 22:case 23:kx()}x=x.return}if(Yn=c,_n=c=Yi(c.current,null),us=cr=h,Bn=0,zd=null,vx=pm=Ba=0,qs=Ud=null,La!==null){for(h=0;h<La.length;h++)if(x=La[h],T=x.interleaved,T!==null){x.interleaved=null;var k=T.next,$=x.pending;if($!==null){var O=$.next;$.next=k,T.next=O}x.pending=T}La=null}return c}function bb(c,h){do{var x=_n;try{if(B0(),sm.current=am,rm){for(var T=gn.memoizedState;T!==null;){var k=T.queue;k!==null&&(k.pending=null),T=T.next}rm=!1}if(Va=0,Jn=Vn=gn=null,Md=!1,Pd=0,xx.current=null,x===null||x.return===null){Bn=1,zd=h,_n=null;break}e:{var $=c,O=x.return,K=x,re=h;if(h=us,K.flags|=32768,re!==null&&typeof re=="object"&&typeof re.then=="function"){var ve=re,$e=K,Ae=$e.tag;if(($e.mode&1)===0&&(Ae===0||Ae===11||Ae===15)){var Ee=$e.alternate;Ee?($e.updateQueue=Ee.updateQueue,$e.memoizedState=Ee.memoizedState,$e.lanes=Ee.lanes):($e.updateQueue=null,$e.memoizedState=null)}var Ue=JS(O);if(Ue!==null){Ue.flags&=-257,YS(Ue,O,K,$,h),Ue.mode&1&&XS($,ve,h),h=Ue,re=ve;var Ke=h.updateQueue;if(Ke===null){var Je=new Set;Je.add(re),h.updateQueue=Je}else Ke.add(re);break e}else{if((h&1)===0){XS($,ve,h),Nx();break e}re=Error(t(426))}}else if(on&&K.mode&1){var bn=JS(O);if(bn!==null){(bn.flags&65536)===0&&(bn.flags|=256),YS(bn,O,K,$,h),O0(cu(re,K));break e}}$=re=cu(re,K),Bn!==4&&(Bn=2),Ud===null?Ud=[$]:Ud.push($),$=O;do{switch($.tag){case 3:$.flags|=65536,h&=-h,$.lanes|=h;var pe=qS($,re,h);vS($,pe);break e;case 1:K=re;var ce=$.type,ge=$.stateNode;if(($.flags&128)===0&&(typeof ce.getDerivedStateFromError=="function"||ge!==null&&typeof ge.componentDidCatch=="function"&&(qi===null||!qi.has(ge)))){$.flags|=65536,h&=-h,$.lanes|=h;var De=KS($,K,h);vS($,De);break e}}$=$.return}while($!==null)}Nb(x)}catch(Ze){h=Ze,_n===x&&x!==null&&(_n=x=x.return);continue}break}while(!0)}function Ib(){var c=hm.current;return hm.current=am,c===null?am:c}function Nx(){(Bn===0||Bn===3||Bn===2)&&(Bn=4),Yn===null||(Ba&268435455)===0&&(pm&268435455)===0||Ji(Yn,us)}function wm(c,h){var x=_t;_t|=2;var T=Ib();(Yn!==c||us!==h)&&(jo=null,Ua(c,h));do try{zF();break}catch(k){bb(c,k)}while(!0);if(B0(),_t=x,hm.current=T,_n!==null)throw Error(t(261));return Yn=null,us=0,Bn}function zF(){for(;_n!==null;)kb(_n)}function UF(){for(;_n!==null&&!c0();)kb(_n)}function kb(c){var h=Ab(c.alternate,c,cr);c.memoizedProps=c.pendingProps,h===null?Nb(c):_n=h,xx.current=null}function Nb(c){var h=c;do{var x=h.alternate;if(c=h.return,(h.flags&32768)===0){if(x=FF(x,h,cr),x!==null){_n=x;return}}else{if(x=MF(x,h),x!==null){x.flags&=32767,_n=x;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{Bn=6,_n=null;return}}if(h=h.sibling,h!==null){_n=h;return}_n=h=c}while(h!==null);Bn===0&&(Bn=5)}function Wa(c,h,x){var T=Rt,k=Nr.transition;try{Nr.transition=null,Rt=1,WF(c,h,x,T)}finally{Nr.transition=k,Rt=T}return null}function WF(c,h,x,T){do pu();while(Ki!==null);if((_t&6)!==0)throw Error(t(327));x=c.finishedWork;var k=c.finishedLanes;if(x===null)return null;if(c.finishedWork=null,c.finishedLanes=0,x===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var $=x.lanes|x.childLanes;if(Fp(c,$),c===Yn&&(_n=Yn=null,us=0),(x.subtreeFlags&2064)===0&&(x.flags&2064)===0||gm||(gm=!0,_b(mo,function(){return pu(),null})),$=(x.flags&15990)!==0,(x.subtreeFlags&15990)!==0||$){$=Nr.transition,Nr.transition=null;var O=Rt;Rt=1;var K=_t;_t|=4,xx.current=null,LF(c,x),yb(x,c),uF(N0),Y=!!k0,N0=k0=null,c.current=x,OF(x),kp(),_t=K,Rt=O,Nr.transition=$}else c.current=x;if(gm&&(gm=!1,Ki=c,ym=k),$=c.pendingLanes,$===0&&(qi=null),Ep(x.stateNode),Ks(c,sn()),h!==null)for(T=c.onRecoverableError,x=0;x<h.length;x++)k=h[x],T(k.value,{componentStack:k.stack,digest:k.digest});if(mm)throw mm=!1,c=Cx,Cx=null,c;return(ym&1)!==0&&c.tag!==0&&pu(),$=c.pendingLanes,($&1)!==0?c===Tx?Wd++:(Wd=0,Tx=c):Wd=0,Ui(),null}function pu(){if(Ki!==null){var c=gd(ym),h=Nr.transition,x=Rt;try{if(Nr.transition=null,Rt=16>c?16:c,Ki===null)var T=!1;else{if(c=Ki,Ki=null,ym=0,(_t&6)!==0)throw Error(t(331));var k=_t;for(_t|=4,We=c.current;We!==null;){var $=We,O=$.child;if((We.flags&16)!==0){var K=$.deletions;if(K!==null){for(var re=0;re<K.length;re++){var ve=K[re];for(We=ve;We!==null;){var $e=We;switch($e.tag){case 0:case 11:case 15:Bd(8,$e,$)}var Ae=$e.child;if(Ae!==null)Ae.return=$e,We=Ae;else for(;We!==null;){$e=We;var Ee=$e.sibling,Ue=$e.return;if(fb($e),$e===ve){We=null;break}if(Ee!==null){Ee.return=Ue,We=Ee;break}We=Ue}}}var Ke=$.alternate;if(Ke!==null){var Je=Ke.child;if(Je!==null){Ke.child=null;do{var bn=Je.sibling;Je.sibling=null,Je=bn}while(Je!==null)}}We=$}}if(($.subtreeFlags&2064)!==0&&O!==null)O.return=$,We=O;else e:for(;We!==null;){if($=We,($.flags&2048)!==0)switch($.tag){case 0:case 11:case 15:Bd(9,$,$.return)}var pe=$.sibling;if(pe!==null){pe.return=$.return,We=pe;break e}We=$.return}}var ce=c.current;for(We=ce;We!==null;){O=We;var ge=O.child;if((O.subtreeFlags&2064)!==0&&ge!==null)ge.return=O,We=ge;else e:for(O=ce;We!==null;){if(K=We,(K.flags&2048)!==0)try{switch(K.tag){case 0:case 11:case 15:fm(9,K)}}catch(Ze){vn(K,K.return,Ze)}if(K===O){We=null;break e}var De=K.sibling;if(De!==null){De.return=K.return,We=De;break e}We=K.return}}if(_t=k,Ui(),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(Gl,c)}catch{}T=!0}return T}finally{Rt=x,Nr.transition=h}}return!1}function Eb(c,h,x){h=cu(x,h),h=qS(c,h,1),c=Gi(c,h,1),h=Ms(),c!==null&&(Fi(c,1,h),Ks(c,h))}function vn(c,h,x){if(c.tag===3)Eb(c,c,x);else for(;h!==null;){if(h.tag===3){Eb(h,c,x);break}else if(h.tag===1){var T=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof T.componentDidCatch=="function"&&(qi===null||!qi.has(T))){c=cu(x,c),c=KS(h,c,1),h=Gi(h,c,1),c=Ms(),h!==null&&(Fi(h,1,c),Ks(h,c));break}}h=h.return}}function GF(c,h,x){var T=c.pingCache;T!==null&&T.delete(h),h=Ms(),c.pingedLanes|=c.suspendedLanes&x,Yn===c&&(us&x)===x&&(Bn===4||Bn===3&&(us&130023424)===us&&500>sn()-wx?Ua(c,0):vx|=x),Ks(c,h)}function $b(c,h){h===0&&((c.mode&1)===0?h=1:(h=Hl,Hl<<=1,(Hl&130023424)===0&&(Hl=4194304)));var x=Ms();c=Yo(c,h),c!==null&&(Fi(c,h,x),Ks(c,x))}function HF(c){var h=c.memoizedState,x=0;h!==null&&(x=h.retryLane),$b(c,x)}function qF(c,h){var x=0;switch(c.tag){case 13:var T=c.stateNode,k=c.memoizedState;k!==null&&(x=k.retryLane);break;case 19:T=c.stateNode;break;default:throw Error(t(314))}T!==null&&T.delete(h),$b(c,x)}var Ab;Ab=function(c,h,x){if(c!==null)if(c.memoizedProps!==h.pendingProps||Ws.current)Hs=!0;else{if((c.lanes&x)===0&&(h.flags&128)===0)return Hs=!1,DF(c,h,x);Hs=(c.flags&131072)!==0}else Hs=!1,on&&(h.flags&1048576)!==0&&uS(h,Jp,h.index);switch(h.lanes=0,h.tag){case 2:var T=h.type;cm(c,h),c=h.pendingProps;var k=nu(h,ms.current);lu(h,x),k=Q0(null,h,T,c,k,x);var $=Z0();return h.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,Gs(T)?($=!0,qp(h)):$=!1,h.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,G0(h),k.updater=lm,h.stateNode=k,k._reactInternals=h,rx(h,T,c,x),h=lx(null,h,T,!0,$,x)):(h.tag=0,on&&$&&F0(h),Fs(null,h,k,x),h=h.child),h;case 16:T=h.elementType;e:{switch(cm(c,h),c=h.pendingProps,k=T._init,T=k(T._payload),h.type=T,k=h.tag=XF(T),c=Xr(T,c),k){case 0:h=ax(null,h,T,c,x);break e;case 1:h=nb(null,h,T,c,x);break e;case 11:h=QS(null,h,T,c,x);break e;case 14:h=ZS(null,h,T,Xr(T.type,c),x);break e}throw Error(t(306,T,""))}return h;case 0:return T=h.type,k=h.pendingProps,k=h.elementType===T?k:Xr(T,k),ax(c,h,T,k,x);case 1:return T=h.type,k=h.pendingProps,k=h.elementType===T?k:Xr(T,k),nb(c,h,T,k,x);case 3:e:{if(sb(h),c===null)throw Error(t(387));T=h.pendingProps,$=h.memoizedState,k=$.element,xS(c,h),tm(h,T,null,x);var O=h.memoizedState;if(T=O.element,$.isDehydrated)if($={element:T,isDehydrated:!1,cache:O.cache,pendingSuspenseBoundaries:O.pendingSuspenseBoundaries,transitions:O.transitions},h.updateQueue.baseState=$,h.memoizedState=$,h.flags&256){k=cu(Error(t(423)),h),h=rb(c,h,T,x,k);break e}else if(T!==k){k=cu(Error(t(424)),h),h=rb(c,h,T,x,k);break e}else for(ur=Vi(h.stateNode.containerInfo.firstChild),lr=h,on=!0,Kr=null,x=gS(h,null,T,x),h.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(ou(),T===k){h=Zo(c,h,x);break e}Fs(c,h,T,x)}h=h.child}return h;case 5:return CS(h),c===null&&L0(h),T=h.type,k=h.pendingProps,$=c!==null?c.memoizedProps:null,O=k.children,E0(T,k)?O=null:$!==null&&E0(T,$)&&(h.flags|=32),tb(c,h),Fs(c,h,O,x),h.child;case 6:return c===null&&L0(h),null;case 13:return ob(c,h,x);case 4:return H0(h,h.stateNode.containerInfo),T=h.pendingProps,c===null?h.child=iu(h,null,T,x):Fs(c,h,T,x),h.child;case 11:return T=h.type,k=h.pendingProps,k=h.elementType===T?k:Xr(T,k),QS(c,h,T,k,x);case 7:return Fs(c,h,h.pendingProps,x),h.child;case 8:return Fs(c,h,h.pendingProps.children,x),h.child;case 12:return Fs(c,h,h.pendingProps.children,x),h.child;case 10:e:{if(T=h.type._context,k=h.pendingProps,$=h.memoizedProps,O=k.value,Jt(Zp,T._currentValue),T._currentValue=O,$!==null)if(qr($.value,O)){if($.children===k.children&&!Ws.current){h=Zo(c,h,x);break e}}else for($=h.child,$!==null&&($.return=h);$!==null;){var K=$.dependencies;if(K!==null){O=$.child;for(var re=K.firstContext;re!==null;){if(re.context===T){if($.tag===1){re=Qo(-1,x&-x),re.tag=2;var ve=$.updateQueue;if(ve!==null){ve=ve.shared;var $e=ve.pending;$e===null?re.next=re:(re.next=$e.next,$e.next=re),ve.pending=re}}$.lanes|=x,re=$.alternate,re!==null&&(re.lanes|=x),U0($.return,x,h),K.lanes|=x;break}re=re.next}}else if($.tag===10)O=$.type===h.type?null:$.child;else if($.tag===18){if(O=$.return,O===null)throw Error(t(341));O.lanes|=x,K=O.alternate,K!==null&&(K.lanes|=x),U0(O,x,h),O=$.sibling}else O=$.child;if(O!==null)O.return=$;else for(O=$;O!==null;){if(O===h){O=null;break}if($=O.sibling,$!==null){$.return=O.return,O=$;break}O=O.return}$=O}Fs(c,h,k.children,x),h=h.child}return h;case 9:return k=h.type,T=h.pendingProps.children,lu(h,x),k=Ir(k),T=T(k),h.flags|=1,Fs(c,h,T,x),h.child;case 14:return T=h.type,k=Xr(T,h.pendingProps),k=Xr(T.type,k),ZS(c,h,T,k,x);case 15:return jS(c,h,h.type,h.pendingProps,x);case 17:return T=h.type,k=h.pendingProps,k=h.elementType===T?k:Xr(T,k),cm(c,h),h.tag=1,Gs(T)?(c=!0,qp(h)):c=!1,lu(h,x),GS(h,T,k),rx(h,T,k,x),lx(null,h,T,!0,c,x);case 19:return ab(c,h,x);case 22:return eb(c,h,x)}throw Error(t(156,h.tag))};function _b(c,h){return bp(c,h)}function KF(c,h,x,T){this.tag=c,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=T,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(c,h,x,T){return new KF(c,h,x,T)}function Ex(c){return c=c.prototype,!(!c||!c.isReactComponent)}function XF(c){if(typeof c=="function")return Ex(c)?1:0;if(c!=null){if(c=c.$$typeof,c===q)return 11;if(c===ie)return 14}return 2}function Yi(c,h){var x=c.alternate;return x===null?(x=Er(c.tag,h,c.key,c.mode),x.elementType=c.elementType,x.type=c.type,x.stateNode=c.stateNode,x.alternate=c,c.alternate=x):(x.pendingProps=h,x.type=c.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=c.flags&14680064,x.childLanes=c.childLanes,x.lanes=c.lanes,x.child=c.child,x.memoizedProps=c.memoizedProps,x.memoizedState=c.memoizedState,x.updateQueue=c.updateQueue,h=c.dependencies,x.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},x.sibling=c.sibling,x.index=c.index,x.ref=c.ref,x}function Cm(c,h,x,T,k,$){var O=2;if(T=c,typeof c=="function")Ex(c)&&(O=1);else if(typeof c=="string")O=5;else e:switch(c){case L:return Ga(x.children,k,$,h);case z:O=8,k|=8;break;case M:return c=Er(12,x,h,k|2),c.elementType=M,c.lanes=$,c;case ee:return c=Er(13,x,h,k),c.elementType=ee,c.lanes=$,c;case ue:return c=Er(19,x,h,k),c.elementType=ue,c.lanes=$,c;case ae:return Tm(x,k,$,h);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case P:O=10;break e;case F:O=9;break e;case q:O=11;break e;case ie:O=14;break e;case de:O=16,T=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return h=Er(O,x,h,k),h.elementType=c,h.type=T,h.lanes=$,h}function Ga(c,h,x,T){return c=Er(7,c,T,h),c.lanes=x,c}function Tm(c,h,x,T){return c=Er(22,c,T,h),c.elementType=ae,c.lanes=x,c.stateNode={isHidden:!1},c}function $x(c,h,x){return c=Er(6,c,null,h),c.lanes=x,c}function Ax(c,h,x){return h=Er(4,c.children!==null?c.children:[],c.key,h),h.lanes=x,h.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},h}function JF(c,h,x,T,k){this.tag=h,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$a(0),this.expirationTimes=$a(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$a(0),this.identifierPrefix=T,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function _x(c,h,x,T,k,$,O,K,re){return c=new JF(c,h,x,K,re),h===1?(h=1,$===!0&&(h|=8)):h=0,$=Er(3,null,null,h),c.current=$,$.stateNode=c,$.memoizedState={element:T,isDehydrated:x,cache:null,transitions:null,pendingSuspenseBoundaries:null},G0($),c}function YF(c,h,x){var T=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:T==null?null:""+T,children:c,containerInfo:h,implementation:x}}function Rb(c){if(!c)return zi;c=c._reactInternals;e:{if(Wo(c)!==c||c.tag!==1)throw Error(t(170));var h=c;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(Gs(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(c.tag===1){var x=c.type;if(Gs(x))return iS(c,x,h)}return h}function Db(c,h,x,T,k,$,O,K,re){return c=_x(x,T,!0,c,k,$,O,K,re),c.context=Rb(null),x=c.current,T=Ms(),k=Xi(x),$=Qo(T,k),$.callback=h??null,Gi(x,$,k),c.current.lanes=k,Fi(c,k,T),Ks(c,T),c}function Sm(c,h,x,T){var k=h.current,$=Ms(),O=Xi(k);return x=Rb(x),h.context===null?h.context=x:h.pendingContext=x,h=Qo($,O),h.payload={element:c},T=T===void 0?null:T,T!==null&&(h.callback=T),c=Gi(k,h,O),c!==null&&(Qr(c,k,O,$),em(c,k,O)),O}function bm(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function Fb(c,h){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var x=c.retryLane;c.retryLane=x!==0&&x<h?x:h}}function Rx(c,h){Fb(c,h),(c=c.alternate)&&Fb(c,h)}function QF(){return null}var Mb=typeof reportError=="function"?reportError:function(c){console.error(c)};function Dx(c){this._internalRoot=c}Im.prototype.render=Dx.prototype.render=function(c){var h=this._internalRoot;if(h===null)throw Error(t(409));Sm(c,h,null,null)},Im.prototype.unmount=Dx.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var h=c.containerInfo;za(function(){Sm(null,c,null,null)}),h[qo]=null}};function Im(c){this._internalRoot=c}Im.prototype.unstable_scheduleHydration=function(c){if(c){var h=xd();c={blockedOn:null,target:c,priority:h};for(var x=0;x<Tr.length&&h!==0&&h<Tr[x].priority;x++);Tr.splice(x,0,c),x===0&&wd(c)}};function Fx(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function km(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function Pb(){}function ZF(c,h,x,T,k){if(k){if(typeof T=="function"){var $=T;T=function(){var ve=bm(O);$.call(ve)}}var O=Db(h,T,c,0,null,!1,!1,"",Pb);return c._reactRootContainer=O,c[qo]=O.current,Nd(c.nodeType===8?c.parentNode:c),za(),O}for(;k=c.lastChild;)c.removeChild(k);if(typeof T=="function"){var K=T;T=function(){var ve=bm(re);K.call(ve)}}var re=_x(c,0,!1,null,null,!1,!1,"",Pb);return c._reactRootContainer=re,c[qo]=re.current,Nd(c.nodeType===8?c.parentNode:c),za(function(){Sm(h,re,x,T)}),re}function Nm(c,h,x,T,k){var $=x._reactRootContainer;if($){var O=$;if(typeof k=="function"){var K=k;k=function(){var re=bm(O);K.call(re)}}Sm(h,O,c,k)}else O=ZF(x,h,c,k,T);return bm(O)}yd=function(c){switch(c.tag){case 3:var h=c.stateNode;if(h.current.memoizedState.isDehydrated){var x=Ea(h.pendingLanes);x!==0&&(ql(h,x|1),Ks(h,sn()),(_t&6)===0&&(hu=sn()+500,Ui()))}break;case 13:za(function(){var T=Yo(c,1);if(T!==null){var k=Ms();Qr(T,c,1,k)}}),Rx(c,1)}},Kl=function(c){if(c.tag===13){var h=Yo(c,134217728);if(h!==null){var x=Ms();Qr(h,c,134217728,x)}Rx(c,134217728)}},Mp=function(c){if(c.tag===13){var h=Xi(c),x=Yo(c,h);if(x!==null){var T=Ms();Qr(x,c,h,T)}Rx(c,h)}},xd=function(){return Rt},Pp=function(c,h){var x=Rt;try{return Rt=c,h()}finally{Rt=x}},Bl=function(c,h,x){switch(h){case"input":if(Lt(c,x),h=x.name,x.type==="radio"&&h!=null){for(x=c;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<x.length;h++){var T=x[h];if(T!==c&&T.form===c.form){var k=Gp(T);if(!k)throw Error(t(90));yt(T),Lt(T,k)}}}break;case"textarea":is(c,x);break;case"select":h=x.value,h!=null&&yn(c,!!x.multiple,h,!1)}},gp=Ix,ba=za;var jF={usingClientEntryPoint:!1,Events:[Ad,eu,Gp,dd,mp,Ix]},Gd={findFiberByHostInstance:Da,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},eM={bundleType:Gd.bundleType,version:Gd.version,rendererPackageName:Gd.rendererPackageName,rendererConfig:Gd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=hd(c),c===null?null:c.stateNode},findFiberByHostInstance:Gd.findFiberByHostInstance||QF,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Em=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Em.isDisabled&&Em.supportsFiber)try{Gl=Em.inject(eM),ar=Em}catch{}}return Xs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jF,Xs.createPortal=function(c,h){var x=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fx(h))throw Error(t(200));return YF(c,h,null,x)},Xs.createRoot=function(c,h){if(!Fx(c))throw Error(t(299));var x=!1,T="",k=Mb;return h!=null&&(h.unstable_strictMode===!0&&(x=!0),h.identifierPrefix!==void 0&&(T=h.identifierPrefix),h.onRecoverableError!==void 0&&(k=h.onRecoverableError)),h=_x(c,1,!1,null,null,x,!1,T,k),c[qo]=h.current,Nd(c.nodeType===8?c.parentNode:c),new Dx(h)},Xs.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var h=c._reactInternals;if(h===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=hd(h),c=c===null?null:c.stateNode,c},Xs.flushSync=function(c){return za(c)},Xs.hydrate=function(c,h,x){if(!km(h))throw Error(t(200));return Nm(null,c,h,!0,x)},Xs.hydrateRoot=function(c,h,x){if(!Fx(c))throw Error(t(405));var T=x!=null&&x.hydratedSources||null,k=!1,$="",O=Mb;if(x!=null&&(x.unstable_strictMode===!0&&(k=!0),x.identifierPrefix!==void 0&&($=x.identifierPrefix),x.onRecoverableError!==void 0&&(O=x.onRecoverableError)),h=Db(h,null,c,1,x??null,k,!1,$,O),c[qo]=h.current,Nd(c),T)for(c=0;c<T.length;c++)x=T[c],k=x._getVersion,k=k(x._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[x,k]:h.mutableSourceEagerHydrationData.push(x,k);return new Im(h)},Xs.render=function(c,h,x){if(!km(h))throw Error(t(200));return Nm(null,c,h,!1,x)},Xs.unmountComponentAtNode=function(c){if(!km(c))throw Error(t(40));return c._reactRootContainer?(za(function(){Nm(null,null,c,!1,function(){c._reactRootContainer=null,c[qo]=null})}),!0):!1},Xs.unstable_batchedUpdates=Ix,Xs.unstable_renderSubtreeIntoContainer=function(c,h,x,T){if(!km(x))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return Nm(c,h,x,!1,T)},Xs.version="18.3.1-next-f1338f8080-20240426",Xs}var Gb;function cM(){if(Gb)return Lx.exports;Gb=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Lx.exports=uM(),Lx.exports}var Hb;function dM(){if(Hb)return $m;Hb=1;var n=cM();return $m.createRoot=n.createRoot,$m.hydrateRoot=n.hydrateRoot,$m}var fM=dM();const hM=N2(fM);var zt=(n=>(n[n.COMMAND=0]="COMMAND",n[n.RESPONSE=1]="RESPONSE",n[n.ERROR=2]="ERROR",n[n.USER_INPUT=3]="USER_INPUT",n))(zt||{}),Fr=(n=>(n.NONE="none",n.PEOPLE="people",n.OBJECTS="objects",n.BOTH="both",n))(Fr||{});const pM=({type:n,content:e,language:t})=>{const s=()=>{const r=t==="ar"?"C:\\ألبا>":"C:\\ALPA>";switch(n){case zt.COMMAND:return xe.jsxs("div",{className:"flex",children:[xe.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:r}),xe.jsx("span",{dir:"auto",children:e})]});case zt.USER_INPUT:return xe.jsxs("div",{className:"flex",children:[xe.jsx("span",{className:"text-blue-500 dark:text-blue-400 mr-2",children:">"}),xe.jsx("span",{dir:"auto",children:e})]});case zt.RESPONSE:return e.startsWith("data:image")?xe.jsx("img",{src:e,alt:"Generated",className:"max-w-sm my-2 rounded-lg"}):xe.jsx("pre",{dir:"auto",className:"whitespace-pre-wrap text-gray-800 dark:text-gray-200",children:e});case zt.ERROR:return xe.jsx("pre",{dir:"auto",className:"whitespace-pre-wrap text-red-600 dark:text-red-400",children:e});default:return xe.jsx("pre",{dir:"auto",className:"whitespace-pre-wrap",children:e})}};return xe.jsx("div",{className:"mb-2",children:s()})},mM=()=>xe.jsxs("div",{className:"flex items-baseline space-x-1 text-gray-500 dark:text-gray-400",children:[xe.jsx("span",{children:"Processing"}),xe.jsx("div",{className:"w-1 h-1 bg-current rounded-full animate-pulse [animation-delay:-0.3s]"}),xe.jsx("div",{className:"w-1 h-1 bg-current rounded-full animate-pulse [animation-delay:-0.15s]"}),xe.jsx("div",{className:"w-1 h-1 bg-current rounded-full animate-pulse"})]}),gM=({history:n,isLoading:e,language:t})=>xe.jsxs("div",{className:"flex-grow","aria-live":"polite",children:[n.map((s,r)=>xe.jsx(pM,{type:s.type,content:s.content,language:t},r)),e&&xe.jsx(mM,{})]}),qb=`Welcome to Alpa Language v1.0
Copyright (c) 2025 Ahmed Eldesoky.
Type 'help' for a list of available commands.`,Ao={HELP:{aliases:["help","مساعدة"],description:"Displays a list of available commands and their descriptions.",usage:"help"},CLEAR:{aliases:["clear","مسح"],description:"Clears the terminal screen.",usage:"clear",action:"CLEAR"},EXIT:{aliases:["exit","خروج"],description:"Exits the terminal (simulated).",usage:"exit"},AI_CHAT:{aliases:["ai.chat","ذكاء.محادثة"],description:"Starts an interactive chat session with the AI.",usage:"ai.chat",action:"START_CHAT"},AI_IMAGE:{aliases:["image","تخيل"],description:"Generates an image based on a text prompt.",usage:"image <prompt>"},CAMERA_OPEN:{aliases:["camera.open","كاميرا.فتح"],description:"Opens the camera view.",usage:"camera.open",action:"CAMERA_START"},CAMERA_CLOSE:{aliases:["camera.close","كاميرا.اغلاق"],description:"Closes the camera view.",usage:"camera.close",action:"CAMERA_STOP"},CAMERA_DESCRIBE:{aliases:["camera.describe","كاميرا.وصف"],description:"Uses AI to describe what the camera sees. You can add a prompt.",usage:"camera.describe [prompt]",action:"CAMERA_CAPTURE_AND_DESCRIBE",payload:n=>n.join(" ")},DETECT_OBJECTS:{aliases:["detect.objects","كشف.اشياء"],description:"Detects objects, people, or both in the camera view.",usage:`detect.objects <${Object.values(Fr).join("|")}>`,args:Object.values(Fr),action:"SET_OBJECT_DETECTION_MODE",payload:n=>n[0]||Fr.OBJECTS},DETECT_FACES:{aliases:["detect.faces","كشف.وجوه"],description:"Toggles face detection on or off.",usage:"detect.faces <on|off>",args:["on","off"],action:"SET_FACE_DETECTION",payload:n=>n[0]==="on"},BOT_NEW:{aliases:["bot.new","بوت.جديد"],description:"Builds and deploys a chatbot for various platforms (e.g., web, whatsapp, telegram).",usage:"bot.new <platform> <data_source_url_or_file>"},AI_SPEECH_TO_TEXT:{aliases:["ai.stt","ذكاء.صوت_الى_نص"],description:"Transcribes audio from a file into text.",usage:"ai.stt <file.mp3>"},AI_TEXT_TO_SPEECH:{aliases:["ai.tts","ذكاء.نص_الى_صوت"],description:"Converts text into speech.",usage:'ai.tts "<text_to_convert>"',action:"SPEAK_TEXT",payload:n=>n.join(" ")},AI_OCR:{aliases:["ai.ocr","ذكاء.استخراج_نص"],description:"Extracts text from an image or video file.",usage:"ai.ocr <image.png | video.mp4>"},AI_ANALYZE:{aliases:["ai.analyze","ذكاء.تحليل"],description:"Performs a deep analysis of the provided content (e.g., sentiment, topics).",usage:'ai.analyze <"text content" | file.txt>'},AI_SUMMARIZE:{aliases:["ai.summarize","ذكاء.تلخيص"],description:"Fetches content from a URL and generates a concise summary.",usage:"ai.summarize <url>"},DEPLOY_GHPAGES:{aliases:["deploy.ghpages","نشر.ghpages"],description:"Builds and deploys the Alpa website to GitHub Pages.",usage:"deploy.ghpages"},DEPLOY_VSC_EXTENSION:{aliases:["deploy.vscode","نشر.vscode"],description:"Packages the Alpa VS Code extension into a downloadable file.",usage:"deploy.vscode"},DEPLOY_VERCEL:{aliases:["deploy.vercel","نشر.vercel"],description:"Deploys the Alpa project to Vercel.",usage:"deploy.vercel"}},yM=Object.values(Ao).flatMap(n=>n.aliases),xM=n=>{const t=n.toLowerCase().split(" ").filter(Boolean),s=n.endsWith(" ")?"":t[t.length-1]||"";if(t.length<=1&&!n.endsWith(" "))return s===""?[]:yM.filter(i=>i.startsWith(s));const r=t[0];if(!r)return[];const o=Object.keys(Ao).find(i=>Ao[i].aliases.includes(r));if(o){const i=Ao[o];if(i.args){const a=t.length>1?s:"";return a===""&&n.endsWith(" ")?i.args:i.args.filter(l=>l.startsWith(a))}}return[]},A2=({theme:n,toggleTheme:e})=>xe.jsx("button",{onClick:e,className:"p-2 rounded-full text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-gray-900 focus:ring-blue-500 transition-colors duration-200","aria-label":"Toggle theme",children:n==="light"?xe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:xe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):xe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:xe.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"})})}),vM=({onSubmit:n,commandHistory:e,theme:t,onToggleTheme:s,language:r,isChatting:o})=>{const[i,a]=Tt.useState(""),[l,u]=Tt.useState(-1),[d,f]=Tt.useState([]),[p,y]=Tt.useState(0),v=Tt.useRef(null);Tt.useEffect(()=>{var R;(R=v.current)==null||R.focus()},[]);const w=R=>{const L=R.target.value;a(L);const z=xM(L);f(z),y(0)},C=R=>{R.preventDefault(),i.trim()&&(n(i),a(""),u(-1),f([]))},S=R=>{var M;const L=i.trim().split(" ");L.length<=1&&!i.endsWith(" ")?a(R+" "):(L[L.length-1]=R,a(L.join(" ")+" ")),f([]),(M=v.current)==null||M.focus()},b=R=>{if(d.length>0){if(R.key==="ArrowDown"){R.preventDefault(),y(L=>(L+1)%d.length);return}if(R.key==="ArrowUp"){R.preventDefault(),y(L=>(L-1+d.length)%d.length);return}if(R.key==="Tab"){R.preventDefault(),S(d[p]);return}if(R.key==="Escape"){R.preventDefault(),f([]);return}}if(R.key==="ArrowUp"){if(R.preventDefault(),e.length>0){const L=l<e.length-1?l+1:l;L!==l&&(u(L),a(e[e.length-1-L]))}}else if(R.key==="ArrowDown")if(R.preventDefault(),l>0){const L=l-1;u(L),a(e[e.length-1-L])}else l===0&&(u(-1),a(""))},A=o?r==="ar"?"محادثة> ":"CHAT> ":r==="ar"?"C:\\ألبا>":"C:\\ALPA>";return xe.jsxs("form",{onSubmit:C,className:"flex items-center border-t border-gray-200 dark:border-gray-700 pt-2",children:[xe.jsx("span",{className:"text-green-600 dark:text-green-400 mr-2",children:A}),xe.jsxs("div",{className:"relative flex-grow",children:[d.length>0&&xe.jsx("div",{className:"absolute bottom-full left-0 mb-1 w-full bg-gray-100 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 rounded-md shadow-lg max-h-48 overflow-y-auto z-10",children:xe.jsx("ul",{children:d.map((R,L)=>xe.jsx("li",{className:`px-3 py-1 cursor-pointer text-gray-800 dark:text-gray-300 ${L===p?"bg-blue-500 text-white":"hover:bg-gray-200 dark:hover:bg-gray-700"}`,onMouseDown:z=>z.preventDefault(),onClick:()=>S(R),children:R},R))})}),xe.jsx("input",{ref:v,type:"text",value:i,onChange:w,onKeyDown:b,className:"w-full bg-transparent text-gray-900 dark:text-gray-200 outline-none",autoFocus:!0,spellCheck:"false",autoComplete:"off",dir:"auto"})]}),xe.jsx(A2,{theme:t,toggleTheme:s})]})},wM=`
## Welcome to Alpa
Alpa is a bilingual, AI-native programming language designed for productivity and integration across multiple domains. This documentation will guide you through its core features.
### Core Concepts
The language is built around modules that provide powerful commands for specific tasks. You can interact with these modules using English, Arabic, or short aliases.
- **AI-Native:** Interact with generative AI models directly from the language.
- **Bilingual:** All keywords and commands work in English and Arabic.
- **Multi-Domain:** Built-in tools for data analysis, web development, robotics, and more.

## Installation & Tooling
While this is a web-based terminal, Alpa is designed as a production-ready language.
### VS Code Extension
To enhance your development experience, Alpa provides a dedicated VS Code extension featuring:
- **AI-powered autocompletion:** Get smart suggestions as you type.
- **Syntax Highlighting:** Improved readability for Alpa code.
- **Bilingual Tooltips:** Hover over commands to see descriptions in your preferred language.

## Deployment
Alpa is designed to be a production-ready language, which includes tools for deploying your projects.

### Deploying to GitHub Pages
You can deploy the Alpa static website simulator directly to GitHub Pages using a simple command. This will simulate the build and deployment process.
\`\`\`
deploy.ghpages
\`\`\`

### Deploying to Vercel
Similarly, you can simulate a deployment to Vercel, a popular platform for frontend applications.
\`\`\`
deploy.vercel
\`\`\`

### Publishing the VS Code Extension
The Alpa VS Code extension can be packaged and published to the official marketplace. This command simulates the entire process.
\`\`\`
# This command simulates packaging and publishing
deploy.vscode
\`\`\`

## AI Module (ذكاء)
The AI module is at the heart of Alpa. You can use it to perform various AI tasks.
\`\`\`
# Generate an image from a prompt
image a cat wearing a space helmet
# Or in Arabic
تخيل قطة ترتدي خوذة فضاء
\`\`\`

### Advanced AI Commands
**Speech-to-Text**
\`\`\`
# Transcribe an audio file
ai.stt "meeting_recording.mp3"
\`\`\`
**Text-to-Speech**
\`\`\`
# Generate an audio file from text
ai.tts "Hello from Alpa language"
\`\`\`
**OCR (Optical Character Recognition)**
\`\`\`
# Extract text from an image
ai.ocr "invoice.png"
\`\`\`
**Content Analysis**
\`\`\`
# Analyze the sentiment and topics of a text
ai.analyze "Alpa is a fantastic and productive language for AI development."
\`\`\`

## Chatbot Development (بوت)
Build and deploy chatbots with a single command.
- \`bot.new\` (بوت.جديد): Initializes, configures, and deploys a new chatbot.
- **Supported Platforms:** \`web\`, \`whatsapp\`, \`telegram\`, \`facebook\`, \`instagram\`.
- **Data Sources:** You can use a URL to a live API, a Hugging Face model endpoint, or a local file.
\`\`\`
# Create a new bot for Telegram using a Hugging Face model
bot.new telegram "https://huggingface.co/models/My-LLM"

# Create a web-based bot using a local data file
bot.new web "faq.csv"
\`\`\`

## Camera Module (كاميرا)
Interact with the device's camera for real-time computer vision tasks.
\`\`\`
# Open the camera and detect objects
camera.open
detect.objects both
\`\`\`
`,CM=`
## مرحباً بك في ألبا
ألبا هي لغة برمجة ثنائية اللغة، ومصممة أصلاً للذكاء الاصطناعي لتحقيق الإنتاجية والتكامل عبر مجالات متعددة. ستوجهك هذه الوثائق عبر ميزاتها الأساسية.
### المفاهيم الأساسية
اللغة مبنية حول وحدات (modules) توفر أوامر قوية لمهام محددة. يمكنك التفاعل مع هذه الوحدات باستخدام الإنجليزية أو العربية أو الاختصارات.
- **مبنية للذكاء الاصطناعي:** تفاعل مع نماذج الذكاء الاصطناعي التوليدية مباشرة من اللغة.
- **ثنائية اللغة:** جميع الكلمات الرئيسية والأوامر تعمل باللغتين الإنجليزية والعربية.
- **متعددة المجالات:** أدوات مدمجة لتحليل البيانات، وتطوير الويب، والروبوتات، والمزيد.

## التثبيت والأدوات
بينما هذه واجهة طرفية (terminal) على الويب، تم تصميم ألبا كلغة جاهزة للإنتاج.
### إضافة VS Code
لتحسين تجربة التطوير الخاصة بك، توفر ألبا إضافة مخصصة لـ VS Code تتميز بما يلي:
- **إكمال تلقائي مدعوم بالذكاء الاصطناعي:** احصل على اقتراحات ذكية أثناء الكتابة.
- **تمييز الصيغة (Syntax Highlighting):** قابلية قراءة محسنة لكود ألبا.
- **تلميحات ثنائية اللغة:** مرر الفأرة فوق الأوامر لرؤية الأوصاف بلغتك المفضلة.

## النشر (Deployment)
تم تصميم ألبا لتكون لغة جاهزة للإنتاج، وهذا يتضمن أدوات لنشر مشاريعك.

### النشر على GitHub Pages
يمكنك نشر محاكي موقع ألبا الثابت مباشرة على GitHub Pages باستخدام أمر بسيط. سيقوم هذا الأمر بمحاكاة عملية البناء والنشر.
\`\`\`
نشر.ghpages
\`\`\`

### النشر على Vercel
بشكل مشابه، يمكنك محاكاة عملية نشر إلى Vercel، وهي منصة شائعة لتطبيقات الواجهة الأمامية.
\`\`\`
نشر.vercel
\`\`\`

### نشر إضافة VS Code
يمكن حزم إضافة VS Code الخاصة بلغة ألبا ونشرها في المتجر الرسمي. هذا الأمر يحاكي العملية بأكملها.
\`\`\`
# هذا الأمر يحاكي عملية الحزم والنشر
نشر.vscode
\`\`\`

## وحدة الذكاء (AI)
وحدة الذكاء هي قلب لغة ألبا. يمكنك استخدامها لأداء مهام الذكاء الاصطناعي المختلفة.
\`\`\`
# توليد صورة من نص
image a cat wearing a space helmet
# أو بالعربية
تخيل قطة ترتدي خوذة فضاء
\`\`\`

### أوامر الذكاء الاصطناعي المتقدمة
**تحويل الصوت إلى نص**
\`\`\`
# تفريغ نصي لملف صوتي
ذكاء.صوت_الى_نص "تسجيل_اجتماع.mp3"
\`\`\`
**تحويل النص إلى صوت**
\`\`\`
# توليد ملف صوتي من نص
ذكاء.نص_الى_صوت "مرحباً من لغة ألبا"
\`\`\`
**التعرف الضوئي على الحروف (OCR)**
\`\`\`
# استخراج نص من صورة
ذكاء.استخراج_نص "فاتورة.png"
\`\`\`
**تحليل المحتوى**
\`\`\`
# تحليل المشاعر والمواضيع الرئيسية في نص
ذكاء.تحليل "ألبا لغة رائعة ومنتجة لتطوير الذكاء الاصطناعي."
\`\`\`

## تطوير روبوتات الدردشة (بوت)
قم ببناء ونشر روبوتات الدردشة بأمر واحد.
- \`بوت.جديد\` (bot.new): يقوم بتهيئة وتكوين ونشر روبوت دردشة جديد.
- **المنصات المدعومة:** \`web\`, \`whatsapp\`, \`telegram\`, \`facebook\`, \`instagram\`.
- **مصادر البيانات:** يمكنك استخدام رابط URL لواجهة برمجة تطبيقات مباشرة، أو نقطة نهاية لنموذج Hugging Face، أو ملف محلي.
\`\`\`
# إنشاء بوت جديد لتليجرام باستخدام نموذج Hugging Face
بوت.جديد telegram "https://huggingface.co/models/My-LLM"

# إنشاء بوت للويب باستخدام ملف بيانات محلي
بوت.جديد web "faq.csv"
\`\`\`

## وحدة الكاميرا (Camera)
تفاعل مع كاميرا الجهاز لمهام الرؤية الحاسوبية في الوقت الفعلي.
\`\`\`
# فتح الكاميرا وكشف الأشياء
كاميرا.فتح
كشف.اشياء both
\`\`\`
`,cE={en:{title:"Alpa Language",subtitle:"A new way to interact with your computer and the world.",description:"Use natural language to execute commands, generate content, and control your device. Alpa combines a powerful command-line interface with cutting-edge AI to understand your intent.",launchButton:"Launch Terminal",languageToggleLabel:"العربية",docsButton:"Documentation",backButton:"Back",installTitle:"Get Started with Alpa",installDescription:"Download the Alpa runtime for your operating system or add the extension to VS Code.",downloadWindows:"Windows",downloadMacOS:"macOS",downloadLinux:"Linux",vscodeExtension:"VS Code Extension",downloadFor:"Download for",otherPlatforms:"Other platforms",docsContent:wM,featuresTitle:"The Power of Alpa",featureAiTitle:"AI-Native Core",featureAiDescription:"Directly access generative AI for text, images, and analysis with simple, intuitive commands.",featureBilingualTitle:"Bilingual Syntax",featureBilingualDescription:"Code seamlessly in English or Arabic. Alpa understands both, making it accessible to everyone.",featureMultiDomainTitle:"Multi-Domain Powerhouse",featureMultiDomainDescription:"From data science and web development to robotics and cloud, Alpa provides built-in modules for every need.",featureVisionTitle:"Interactive Vision",featureVisionDescription:"Leverage your camera for real-time object detection, face tracking, and AI-powered visual analysis.",featureToolingTitle:"Developer-Centric Tooling",featureToolingDescription:"Boost your productivity with an AI-powered VS Code extension, smart suggestions, and a powerful REPL.",featureDeploymentTitle:"Rapid Deployment",featureDeploymentDescription:"Deploy chatbots, websites, and backend services in seconds with single-line commands."},ar:{title:"لغة ألبا",subtitle:"طريقة جديدة للتفاعل مع حاسوبك والعالم.",description:"استخدم اللغة الطبيعية لتنفيذ الأوامر وإنشاء المحتوى والتحكم في جهازك. تجمع ألبا بين واجهة سطر أوامر قوية وذكاء اصطناعي متطور لفهم ما تريد.",launchButton:"شغل الطرفية",languageToggleLabel:"English",docsButton:"الوثائق",backButton:"رجوع",installTitle:"ابدأ مع ألبا",installDescription:"قم بتنزيل بيئة تشغيل ألبا لنظام التشغيل الخاص بك أو أضف الإضافة إلى VS Code.",downloadWindows:"ويندوز",downloadMacOS:"ماك",downloadLinux:"لينكس",vscodeExtension:"إضافة VS Code",downloadFor:"تنزيل لـ",otherPlatforms:"منصات أخرى",docsContent:CM,featuresTitle:"قوة لغة ألبا",featureAiTitle:"قلب نابض بالذكاء الاصطناعي",featureAiDescription:"صل إلى الذكاء الاصطناعي التوليدي مباشرة لإنشاء النصوص والصور والتحليلات بأوامر بسيطة وبديهية.",featureBilingualTitle:"صيغة ثنائية اللغة",featureBilingualDescription:"برمج بسلاسة باللغة الإنجليزية أو العربية. تفهم ألبا كلتيهما، مما يجعلها في متناول الجميع.",featureMultiDomainTitle:"قوة متعددة المجالات",featureMultiDomainDescription:"من علوم البيانات وتطوير الويب إلى الروبوتات والسحابة، توفر ألبا وحدات مدمجة لكل احتياجاتك.",featureVisionTitle:"رؤية تفاعلية",featureVisionDescription:"استخدم الكاميرا الخاصة بك للكشف عن الأشياء وتتبع الوجوه والتحليل البصري المدعوم بالذكاء الاصطناعي.",featureToolingTitle:"أدوات موجهة للمطورين",featureToolingDescription:"عزز إنتاجيتك مع إضافة VS Code المدعومة بالذكاء الاصطناعي، والاقتراحات الذكية، وبيئة REPL قوية.",featureDeploymentTitle:"نشر فوري",featureDeploymentDescription:"انشر روبوتات الدردشة والمواقع وخدمات الواجهة الخلفية في ثوانٍ بأوامر من سطر واحد."}},Bx="ahmed-eldesoky284",zx="Alpa-Language",ei={copyright:{year:2025,holder:"Ahmed Eldesoky"},downloads:{windows:`https://github.com/${Bx}/${zx}/releases/latest/download/alpa-installer.exe`,macos:`https://github.com/${Bx}/${zx}/releases/latest/download/alpa-installer.dmg`,linux:`https://github.com/${Bx}/${zx}/releases/latest/download/alpa-installer.deb`,vscode_extension_marketplace:"https://marketplace.visualstudio.com/items?itemName=AlpaLanguage.vscode-alpa"}},TM=()=>{const n=window.navigator.platform,e=window.navigator.userAgent;return n.startsWith("Win")||/Windows/.test(e)?"Windows":n.startsWith("Mac")||/Macintosh/.test(e)?"macOS":n.startsWith("Linux")||/Linux/.test(e)?"Linux":"Unknown"},qd=n=>{window.open(n,"_blank","noopener,noreferrer")},Kb=({icon:n,label:e,onClick:t})=>xe.jsxs("button",{onClick:t,className:"flex items-center justify-center gap-3 px-8 py-4 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-semibold rounded-lg shadow-md hover:bg-gray-300 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transform hover:scale-105 transition-transform duration-200 w-full max-w-xs sm:w-auto",children:[n,xe.jsx("span",{children:e})]}),mu=({icon:n,title:e,description:t})=>xe.jsxs("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 h-full",children:[xe.jsx("div",{className:"flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 dark:bg-gray-950 text-blue-600 dark:text-blue-400 mb-4",children:n}),xe.jsx("h3",{className:"text-xl font-bold mb-2 text-gray-800 dark:text-gray-100",children:e}),xe.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t})]}),SM=({onLaunchTerminal:n,onShowDocs:e,theme:t,toggleTheme:s,language:r,setLanguage:o})=>{const i=cE[r],[a,l]=vv.useState("Unknown");vv.useEffect(()=>{l(TM())},[]);const u=()=>{o(r==="en"?"ar":"en")},d={windows:xe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:xe.jsx("path",{d:"M3,12V3H12V12H3M3,21V13.5H12V21H3M13.5,3V12H21V3H13.5M13.5,21V13.5H21V21H13.5Z"})}),macos:xe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:xe.jsx("path",{d:"M19.1,13.84C19.25,13.84 19.5,13.84 19.65,13.84C19.65,13.56 19.6,12.39 19.6,12.11C19.55,10.63 18.8,8.34 17.2,7.14C16.2,6.34 14.8,6.09 14,6.09C12.3,6.09 11.2,6.94 10.3,6.94C9.4,6.94 8.5,6.14 7.2,6.14C5.6,6.14 4.1,7.14 3.3,8.74C1.5,12.24 2.8,16.59 4.6,18.94C5.5,19.94 6.6,21.09 8,21.09C8.9,21.09 9.3,20.59 10.9,20.59C12.5,20.59 12.9,21.09 14,21.09C15.3,21.09 16.2,19.94 17.1,18.94C17.7,18.24 18.2,17.34 18.6,16.44C18.1,16.24 17.5,15.94 17.1,15.44C16.5,14.64 16.6,13.64 17.3,13.04C17.8,12.64 18.5,12.59 19,12.89C19,12.84 19.05,12.84 19.1,12.84M13.2,4.09C13.8,3.49 14.2,2.69 14.1,1.79C13.2,1.89 12.3,2.39 11.8,3.09C11.2,3.79 10.7,4.69 10.8,5.59C11.8,5.49 12.6,4.79 13.2,4.09Z"})}),linux:xe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:xe.jsx("path",{d:"M14,14.2H10V20.6C10.9,20.8 11.5,21 12,21C12.6,21 13.1,20.8 14,20.6V14.2M18.8,10.3C18.9,10.8 19,11.4 19,12C19,12.2 19,12.3 19,12.5C18.3,12.4 17.5,12.2 16.7,11.9C16,11.7 15,11.5 14,11.1V4.4C15.2,4.8 16.2,5.1 17.1,5.4C18,5.7 18.5,5.9 18.7,6C19,6.1 19.1,6.2 19.2,6.2C19.5,6.4 19.6,6.6 19.5,6.9C19.4,7.2 19.1,7.5 18.7,7.6C18.5,7.7 18.3,7.7 18,7.7C17.3,7.7 16.4,7.5 15.3,7.1C15,7 14.5,6.9 14,6.8V10.1C15.3,10.4 16.8,10.5 18.3,10.3C18.5,10.3 18.6,10.3 18.8,10.3M12,2C14,2 15.3,2.4 16.1,3.2C16.9,4 17,4.8 17,5.5C17,5.7 17,5.8 16.9,6C16.8,6.1 16.5,6.3 16.1,6.5C15.7,6.7 15,6.9 14,7.1V7.2C14.7,7.5 15.2,7.9 15.5,8.4C15.8,8.9 16,9.5 16,10.1C16,11.2 15.5,12.1 14.6,12.8C13.7,13.5 12.7,13.8 11.5,13.8H10V11.8H11.5C12,11.8 12.3,11.7 12.6,11.5C12.9,11.3 13,11 13,10.6C13,10.2 12.9,9.9 12.6,9.7C12.3,9.5 12,9.4 11.5,9.4H10V7.4H11.5C11.9,7.4 12.2,7.3 12.5,7.1C12.8,6.9 12.9,6.6 12.9,6.2C12.9,5.8 12.8,5.5 12.5,5.3C12.2,5.1 11.9,5 11.5,5H10V3.8H11.2C12.3,3.8 13.1,4.1 13.5,4.8C13.6,5 13.8,5.1 14,5.1C14.2,5.1 14.4,5 14.5,4.8C14.6,4.6 14.6,4.4 14.5,4.2C14.2,3.3 13.3,2.8 12,2.8C11.1,2.8 10.4,3 10,3.2V2H12M5,6.1C5.2,6 5.5,5.8 5.9,5.6C6.3,5.4 6.8,5.2 7.4,5C8.3,4.7 9,4.5 9.1,4.4C9.2,4.3 9.3,4.2 9.4,4.2C9.5,4.2 9.6,4.3 9.7,4.3C9.9,4.4 10,4.6 10,4.9C10,5.2 9.8,5.4 9.5,5.5C9.4,5.6 9.2,5.6 9,5.6C8.3,5.6 7.4,5.8 6.3,6.2C6,6.3 5.5,6.4 5,6.5V9.8C6.3,9.5 7.8,9.4 9.3,9.6C9.5,9.6 9.6,9.6 9.8,9.6C9.9,10.1 10,10.7 10,11.3C10,11.5 10,11.6 10,11.8C9.3,11.7 8.5,11.5 7.7,11.2C7,11 6,10.8 5,10.4V4.4L5,6.1Z"})}),vscode:xe.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:xe.jsx("path",{d:"M23,3.3l-5.7,2.3v12.8l5.7,2.3V3.3z M15.2,0L2.3,5.6v12.8L15.2,24V0z M13.1,17.4l-4-2.3V8.9l4-2.3V17.4z"})})},f={ai:xe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[xe.jsx("path",{d:"M12 8V4H8"}),xe.jsx("rect",{x:"4",y:"4",width:"16",height:"16",rx:"2"}),xe.jsx("path",{d:"M2 14h2"}),xe.jsx("path",{d:"M20 14h2"}),xe.jsx("path",{d:"M15 13v2a1 1 0 0 0 1 1h2"}),xe.jsx("path",{d:"M15 5h2a1 1 0 0 1 1 1v2"})]}),bilingual:xe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[xe.jsx("path",{d:"m5 8 6 6"}),xe.jsx("path",{d:"m4 14 6-6 2-3"}),xe.jsx("path",{d:"M2 5h12"}),xe.jsx("path",{d:"M7 2h1"}),xe.jsx("path",{d:"m22 22-5-10-5 10"}),xe.jsx("path",{d:"M14 18h6"})]}),multiDomain:xe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[xe.jsx("path",{d:"M3 9.5a1.5 1.5 0 0 1 3 0V11a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5V9.5a1.5 1.5 0 0 1 3 0V11a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5V9.5a1.5 1.5 0 0 1 3 0V11a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5v- симптомы"}),xe.jsx("rect",{x:"3",y:"14",width:"18",height:"7",rx:"2"})]}),vision:xe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[xe.jsx("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),xe.jsx("circle",{cx:"12",cy:"12",r:"3"})]}),tooling:xe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[xe.jsx("path",{d:"m16 18-6-6 6-6"}),xe.jsx("path",{d:"M8 6h8c1.1 0 2 .9 2 2v8c0 1.1-.9 2-2 2H8c-1.1 0-2-.9-2-2V8c0-1.1.9-2 2-2z"})]}),deployment:xe.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[xe.jsx("path",{d:"M2 16.1A5 5 0 0 1 5.9 20M2 12.05A9 9 0 0 1 9.95 20M2 8V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2h-6"}),xe.jsx("path",{d:"M12 18h8"}),xe.jsx("path",{d:"M18 15v6"}),xe.jsx("path",{d:"M15 18h-2a2 2 0 1 0 0-4h2"})]})};return xe.jsxs("div",{className:`flex flex-col items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-300 font-sans ${r==="ar"?"rtl":"ltr"}`,children:[xe.jsxs("div",{className:"absolute top-4 right-4 flex items-center space-x-4 z-10",children:[xe.jsx("button",{onClick:u,className:"px-4 py-2 text-sm font-medium bg-gray-200 dark:bg-gray-700 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900 focus:ring-blue-500",children:i.languageToggleLabel}),xe.jsx(A2,{theme:t,toggleTheme:s})]}),xe.jsxs("main",{className:"text-center p-8 flex flex-col items-center w-full",children:[xe.jsxs("div",{className:"min-h-[50vh] flex flex-col justify-center items-center",children:[xe.jsx("h1",{className:"text-5xl md:text-6xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-blue-500 to-teal-400",children:i.title}),xe.jsx("p",{className:"text-lg md:text-xl text-gray-600 dark:text-gray-300 mb-8 max-w-2xl",children:i.subtitle}),xe.jsx("div",{className:"max-w-2xl mx-auto mb-10",children:xe.jsx("p",{className:"text-base text-gray-700 dark:text-gray-400",children:i.description})}),xe.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center gap-4 mb-16",children:[xe.jsx("button",{onClick:n,className:"px-8 py-3 bg-blue-600 text-white font-semibold rounded-lg shadow-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75 transform hover:scale-105 transition-transform duration-200",children:i.launchButton}),xe.jsx("button",{onClick:e,className:"px-8 py-3 bg-gray-700 text-white font-semibold rounded-lg shadow-md hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-600 focus:ring-opacity-75 transform hover:scale-105 transition-transform duration-200",children:i.docsButton})]})]}),xe.jsxs("section",{className:"w-full max-w-6xl px-4 py-16 bg-gray-100 dark:bg-gray-950 rounded-2xl",children:[xe.jsx("h2",{className:"text-4xl font-bold text-center mb-12 text-gray-800 dark:text-gray-100",children:i.featuresTitle}),xe.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[xe.jsx(mu,{icon:f.ai,title:i.featureAiTitle,description:i.featureAiDescription}),xe.jsx(mu,{icon:f.bilingual,title:i.featureBilingualTitle,description:i.featureBilingualDescription}),xe.jsx(mu,{icon:f.multiDomain,title:i.featureMultiDomainTitle,description:i.featureMultiDomainDescription}),xe.jsx(mu,{icon:f.vision,title:i.featureVisionTitle,description:i.featureVisionDescription}),xe.jsx(mu,{icon:f.tooling,title:i.featureToolingTitle,description:i.featureToolingDescription}),xe.jsx(mu,{icon:f.deployment,title:i.featureDeploymentTitle,description:i.featureDeploymentDescription})]})]}),xe.jsxs("section",{className:"w-full max-w-4xl px-4 mt-24",children:[xe.jsx("h2",{className:"text-3xl font-bold mb-4",children:i.installTitle}),xe.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-8",children:i.installDescription}),xe.jsxs("div",{className:"flex flex-col items-center",children:[xe.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch justify-center gap-4 mb-6",children:[a!=="Unknown"&&xe.jsx(Kb,{icon:d[a.toLowerCase()],label:`${i.downloadFor} ${a}`,onClick:()=>qd(ei.downloads[a.toLowerCase()])}),xe.jsx(Kb,{icon:d.vscode,label:i.vscodeExtension,onClick:()=>qd(ei.downloads.vscode_extension_marketplace)})]}),xe.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:xe.jsxs("div",{className:"flex items-center gap-x-4 gap-y-2 flex-wrap justify-center",children:[xe.jsxs("span",{className:"font-semibold",children:[i.otherPlatforms,":"]}),a!=="Windows"&&xe.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),qd(ei.downloads.windows)},className:"hover:underline",children:i.downloadWindows}),a!=="macOS"&&xe.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),qd(ei.downloads.macos)},className:"hover:underline",children:i.downloadMacOS}),a!=="Linux"&&xe.jsx("a",{href:"#",onClick:p=>{p.preventDefault(),qd(ei.downloads.linux)},className:"hover:underline",children:i.downloadLinux})]})})]})]})]}),xe.jsx("footer",{className:"w-full text-center p-4 text-sm text-gray-500 dark:text-gray-400 mt-16",children:xe.jsxs("p",{children:["© ",ei.copyright.year," ",ei.copyright.holder,". All rights reserved."]})})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let bM,IM;function kM(){return{geminiUrl:bM,vertexUrl:IM}}function NM(n,e,t,s){var r,o;if(!(n!=null&&n.baseUrl)){const i=kM();return e?(r=i.vertexUrl)!==null&&r!==void 0?r:t:(o=i.geminiUrl)!==null&&o!==void 0?o:s}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sl{}function Xe(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(s,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const o=e[r];return o!=null?String(o):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function g(n,e,t){for(let o=0;o<e.length-1;o++){const i=e[o];if(i.endsWith("[]")){const a=i.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${i}`);if(Array.isArray(n[a])){const l=n[a];if(Array.isArray(t))for(let u=0;u<l.length;u++){const d=l[u];g(d,e.slice(o+1),t[u])}else for(const u of l)g(u,e.slice(o+1),t)}return}else if(i.endsWith("[0]")){const a=i.slice(0,-3);a in n||(n[a]=[{}]);const l=n[a];g(l[0],e.slice(o+1),t);return}(!n[i]||typeof n[i]!="object")&&(n[i]={}),n=n[i]}const s=e[e.length-1],r=n[s];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else n[s]=t}function m(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const s=e[t];if(s.endsWith("[]")){const r=s.slice(0,-2);if(r in n){const o=n[r];return Array.isArray(o)?o.map(i=>m(i,e.slice(t+1))):void 0}else return}else n=n[s]}return n}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wv(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Xb;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Xb||(Xb={}));var Jb;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(Jb||(Jb={}));var ea;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(ea||(ea={}));var Yb;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(Yb||(Yb={}));var Qb;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(Qb||(Qb={}));var Zb;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(Zb||(Zb={}));var jb;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(jb||(jb={}));var eI;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(eI||(eI={}));var tI;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(tI||(tI={}));var nI;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(nI||(nI={}));var sI;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(sI||(sI={}));var rI;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(rI||(rI={}));var oI;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(oI||(oI={}));var iI;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY"})(iI||(iI={}));var aI;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(aI||(aI={}));var og;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(og||(og={}));var lI;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(lI||(lI={}));var Cv;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(Cv||(Cv={}));var uI;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(uI||(uI={}));var cI;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(cI||(cI={}));var dI;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(dI||(dI={}));var fI;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(fI||(fI={}));var hI;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(hI||(hI={}));var pI;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(pI||(pI={}));var mI;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(mI||(mI={}));var gI;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(gI||(gI={}));var yI;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(yI||(yI={}));var xI;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(xI||(xI={}));var vI;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(vI||(vI={}));var wI;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(wI||(wI={}));var CI;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(CI||(CI={}));var TI;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(TI||(TI={}));var SI;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(SI||(SI={}));var bI;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(bI||(bI={}));var II;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(II||(II={}));var kI;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(kI||(kI={}));var NI;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(NI||(NI={}));var EI;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(EI||(EI={}));var $I;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})($I||($I={}));var AI;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(AI||(AI={}));var _I;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(_I||(_I={}));var RI;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(RI||(RI={}));var DI;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(DI||(DI={}));var FI;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(FI||(FI={}));var MI;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(MI||(MI={}));var Tu;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Tu||(Tu={}));class Tv{constructor(e){const t={};for(const s of e.headers.entries())t[s[0]]=s[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Kd{get text(){var e,t,s,r,o,i,a,l;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const f=[];for(const p of(l=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[y,v]of Object.entries(p))y!=="text"&&y!=="thought"&&(v!==null||v!==void 0)&&f.push(y);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;d=!0,u+=p.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var e,t,s,r,o,i,a,l;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const f of(l=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[p,y]of Object.entries(f))p!=="inlineData"&&(y!==null||y!==void 0)&&d.push(p);f.inlineData&&typeof f.inlineData.data=="string"&&(u+=atob(f.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,t,s,r,o,i,a,l;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,t,s,r,o,i,a,l,u;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(l=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.executableCode).map(f=>f.executableCode).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,t,s,r,o,i,a,l,u;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(l=(a=(i=(o=this.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(f=>f.codeExecutionResult).map(f=>f.codeExecutionResult).filter(f=>f!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class PI{}class LI{}class EM{}class $M{}class AM{}class _M{}class OI{}class VI{}class BI{}class RM{}class zI{}class ig{_fromAPIResponse({apiResponse:e,isVertexAI:t}){const s=new ig;if(s.name=e.name,s.metadata=e.metadata,s.done=e.done,s.error=e.error,t){const r=e.response;if(r){const o=new zI,i=r.videos;o.generatedVideos=i==null?void 0:i.map(a=>({video:{uri:a.gcsUri,videoBytes:a.bytesBase64Encoded?wv(a.bytesBase64Encoded):void 0,mimeType:a.mimeType}})),o.raiMediaFilteredCount=r.raiMediaFilteredCount,o.raiMediaFilteredReasons=r.raiMediaFilteredReasons,s.response=o}}else{const r=e.response;if(r){const o=new zI,i=r.generateVideoResponse,a=i==null?void 0:i.generatedSamples;o.generatedVideos=a==null?void 0:a.map(l=>{const u=l.video;return{video:{uri:u==null?void 0:u.uri,videoBytes:u!=null&&u.encodedVideo?wv(u==null?void 0:u.encodedVideo):void 0,mimeType:l.encoding}}}),o.raiMediaFilteredCount=i==null?void 0:i.raiMediaFilteredCount,o.raiMediaFilteredReasons=i==null?void 0:i.raiMediaFilteredReasons,s.response=o}}return s}}class UI{}class WI{}class GI{}class DM{}class FM{}class MM{}class HI{}class PM{get text(){var e,t,s;let r="",o=!1;const i=[];for(const a of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&i.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;o=!0,r+=a.text}}return i.length>0&&console.warn(`there are non-text parts ${i} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),o?r:void 0}get data(){var e,t,s;let r="";const o=[];for(const i of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[a,l]of Object.entries(i))a!=="inlineData"&&l!==null&&o.push(a);i.inlineData&&typeof i.inlineData.data=="string"&&(r+=atob(i.inlineData.data))}return o.length>0&&console.warn(`there are non-data parts ${o} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class LM{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Pt(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function dE(n,e){const t=Pt(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function fE(n){return Array.isArray(n)?n.map(e=>ag(e)):[ag(n)]}function ag(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function hE(n){const e=ag(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function pE(n){const e=ag(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function qI(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function mE(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>qI(e)):[qI(n)]}function Sv(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function KI(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function XI(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Is(n){if(n==null)throw new Error("ContentUnion is required");return Sv(n)?n:{role:"user",parts:mE(n)}}function gE(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const s=Is(t);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(n.isVertexAI()){const t=Is(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Is(t)):[Is(e)]}function Lr(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(KI(n)||XI(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Is(n)]}const e=[],t=[],s=Sv(n[0]);for(const r of n){const o=Sv(r);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)e.push(r);else{if(KI(r)||XI(r))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(r)}}return s||e.push({role:"user",parts:mE(t)}),e}function OM(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(s=>s!=="null");if(t.length===1)e.type=Object.values(ea).includes(t[0].toUpperCase())?t[0].toUpperCase():ea.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of t)e.anyOf.push({type:Object.values(ea).includes(s.toUpperCase())?s.toUpperCase():ea.TYPE_UNSPECIFIED})}}function bu(n){const e={},t=["items"],s=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const o=n.anyOf;o!=null&&o.length==2&&(o[0].type==="null"?(e.nullable=!0,n=o[1]):o[1].type==="null"&&(e.nullable=!0,n=o[0])),n.type instanceof Array&&OM(n.type,e);for(const[i,a]of Object.entries(n))if(a!=null)if(i=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(ea).includes(a.toUpperCase())?a.toUpperCase():ea.TYPE_UNSPECIFIED}else if(t.includes(i))e[i]=bu(a);else if(s.includes(i)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(bu(u))}e[i]=l}else if(r.includes(i)){const l={};for(const[u,d]of Object.entries(a))l[u]=bu(d);e[i]=l}else{if(i==="additionalProperties")continue;e[i]=a}return e}function _2(n){return bu(n)}function R2(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function D2(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Hu(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=bu(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=bu(e.response));return n}function qu(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function VM(n,e,t,s=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===s;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function vi(n,e){if(typeof e!="string")throw new Error("name must be a string");return VM(n,e,"cachedContents")}function yE(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function bl(n){return wv(n)}function BM(n){return n!=null&&typeof n=="object"&&"name"in n}function zM(n){return n!=null&&typeof n=="object"&&"video"in n}function UM(n){return n!=null&&typeof n=="object"&&"uri"in n}function xE(n){var e;let t;if(BM(n)&&(t=n.name),!(UM(n)&&(t=n.uri,t===void 0))&&!(zM(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const r=t.split("files/")[1].match(/[a-z0-9]+/);if(r===null)throw new Error(`Could not extract file name from URI ${t}`);t=r[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function vE(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function wE(n){for(const e of["models","tunedModels","publisherModels"])if(WM(n,e))return n[e];return[]}function WM(n,e){return n!==null&&typeof n=="object"&&e in n}function GM(n,e={}){const t=n,s={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(s.responseJsonSchema=t.outputSchema),e.behavior&&(s.behavior=e.behavior),{functionDeclarations:[s]}}function HM(n,e={}){const t=[],s=new Set;for(const r of n){const o=r.name;if(s.has(o))throw new Error(`Duplicate function name ${o} found in MCP tools. Please ensure function names are unique.`);s.add(o);const i=GM(r,e);i.functionDeclarations&&t.push(...i.functionDeclarations)}return{functionDeclarations:t}}function CE(n,e){if(typeof e!="string"&&!Array.isArray(e)){if(n&&n.isVertexAI()){if(e.gcsUri&&e.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!e.gcsUri&&!e.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(e.inlinedRequests&&e.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!e.inlinedRequests&&!e.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return e}else{if(Array.isArray(e))return{inlinedRequests:e};if(typeof e=="string"){if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:[e]};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};if(e.startsWith("files/"))return{fileName:e}}}throw new Error(`Unsupported source: ${e}`)}function qM(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function Ku(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function TE(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function KM(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function XM(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function JM(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function YM(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],KM(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],XM(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],JM(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function SE(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>YM(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function QM(n){const e={},t=m(n,["anyOf"]);t!=null&&g(e,["anyOf"],t);const s=m(n,["default"]);s!=null&&g(e,["default"],s);const r=m(n,["description"]);r!=null&&g(e,["description"],r);const o=m(n,["enum"]);o!=null&&g(e,["enum"],o);const i=m(n,["example"]);i!=null&&g(e,["example"],i);const a=m(n,["format"]);a!=null&&g(e,["format"],a);const l=m(n,["items"]);l!=null&&g(e,["items"],l);const u=m(n,["maxItems"]);u!=null&&g(e,["maxItems"],u);const d=m(n,["maxLength"]);d!=null&&g(e,["maxLength"],d);const f=m(n,["maxProperties"]);f!=null&&g(e,["maxProperties"],f);const p=m(n,["maximum"]);p!=null&&g(e,["maximum"],p);const y=m(n,["minItems"]);y!=null&&g(e,["minItems"],y);const v=m(n,["minLength"]);v!=null&&g(e,["minLength"],v);const w=m(n,["minProperties"]);w!=null&&g(e,["minProperties"],w);const C=m(n,["minimum"]);C!=null&&g(e,["minimum"],C);const S=m(n,["nullable"]);S!=null&&g(e,["nullable"],S);const b=m(n,["pattern"]);b!=null&&g(e,["pattern"],b);const E=m(n,["properties"]);E!=null&&g(e,["properties"],E);const N=m(n,["propertyOrdering"]);N!=null&&g(e,["propertyOrdering"],N);const A=m(n,["required"]);A!=null&&g(e,["required"],A);const R=m(n,["title"]);R!=null&&g(e,["title"],R);const L=m(n,["type"]);return L!=null&&g(e,["type"],L),e}function ZM(n){const e={};if(m(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=m(n,["category"]);t!=null&&g(e,["category"],t);const s=m(n,["threshold"]);return s!=null&&g(e,["threshold"],s),e}function jM(n){const e={},t=m(n,["behavior"]);t!=null&&g(e,["behavior"],t);const s=m(n,["description"]);s!=null&&g(e,["description"],s);const r=m(n,["name"]);r!=null&&g(e,["name"],r);const o=m(n,["parameters"]);o!=null&&g(e,["parameters"],o);const i=m(n,["parametersJsonSchema"]);i!=null&&g(e,["parametersJsonSchema"],i);const a=m(n,["response"]);a!=null&&g(e,["response"],a);const l=m(n,["responseJsonSchema"]);return l!=null&&g(e,["responseJsonSchema"],l),e}function eP(n){const e={},t=m(n,["startTime"]);t!=null&&g(e,["startTime"],t);const s=m(n,["endTime"]);return s!=null&&g(e,["endTime"],s),e}function tP(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],eP(t)),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function nP(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["dynamicThreshold"]);return s!=null&&g(e,["dynamicThreshold"],s),e}function sP(n){const e={},t=m(n,["dynamicRetrievalConfig"]);return t!=null&&g(e,["dynamicRetrievalConfig"],nP(t)),e}function rP(){return{}}function oP(n){const e={},t=m(n,["environment"]);return t!=null&&g(e,["environment"],t),e}function iP(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>jM(u))),g(e,["functionDeclarations"],l)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],tP(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&g(e,["googleSearchRetrieval"],sP(r)),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(n,["urlContext"])!=null&&g(e,["urlContext"],rP());const i=m(n,["computerUse"]);i!=null&&g(e,["computerUse"],oP(i));const a=m(n,["codeExecution"]);return a!=null&&g(e,["codeExecution"],a),e}function aP(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["allowedFunctionNames"]);return s!=null&&g(e,["allowedFunctionNames"],s),e}function lP(n){const e={},t=m(n,["latitude"]);t!=null&&g(e,["latitude"],t);const s=m(n,["longitude"]);return s!=null&&g(e,["longitude"],s),e}function uP(n){const e={},t=m(n,["latLng"]);t!=null&&g(e,["latLng"],lP(t));const s=m(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function cP(n){const e={},t=m(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],aP(t));const s=m(n,["retrievalConfig"]);return s!=null&&g(e,["retrievalConfig"],uP(s)),e}function dP(n){const e={},t=m(n,["voiceName"]);return t!=null&&g(e,["voiceName"],t),e}function bE(n){const e={},t=m(n,["prebuiltVoiceConfig"]);return t!=null&&g(e,["prebuiltVoiceConfig"],dP(t)),e}function fP(n){const e={},t=m(n,["speaker"]);t!=null&&g(e,["speaker"],t);const s=m(n,["voiceConfig"]);return s!=null&&g(e,["voiceConfig"],bE(s)),e}function hP(n){const e={},t=m(n,["speakerVoiceConfigs"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>fP(r))),g(e,["speakerVoiceConfigs"],s)}return e}function pP(n){const e={},t=m(n,["voiceConfig"]);t!=null&&g(e,["voiceConfig"],bE(t));const s=m(n,["multiSpeakerVoiceConfig"]);s!=null&&g(e,["multiSpeakerVoiceConfig"],hP(s));const r=m(n,["languageCode"]);return r!=null&&g(e,["languageCode"],r),e}function mP(n){const e={},t=m(n,["includeThoughts"]);t!=null&&g(e,["includeThoughts"],t);const s=m(n,["thinkingBudget"]);return s!=null&&g(e,["thinkingBudget"],s),e}function gP(n,e,t){const s={},r=m(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],SE(Is(r)));const o=m(e,["temperature"]);o!=null&&g(s,["temperature"],o);const i=m(e,["topP"]);i!=null&&g(s,["topP"],i);const a=m(e,["topK"]);a!=null&&g(s,["topK"],a);const l=m(e,["candidateCount"]);l!=null&&g(s,["candidateCount"],l);const u=m(e,["maxOutputTokens"]);u!=null&&g(s,["maxOutputTokens"],u);const d=m(e,["stopSequences"]);d!=null&&g(s,["stopSequences"],d);const f=m(e,["responseLogprobs"]);f!=null&&g(s,["responseLogprobs"],f);const p=m(e,["logprobs"]);p!=null&&g(s,["logprobs"],p);const y=m(e,["presencePenalty"]);y!=null&&g(s,["presencePenalty"],y);const v=m(e,["frequencyPenalty"]);v!=null&&g(s,["frequencyPenalty"],v);const w=m(e,["seed"]);w!=null&&g(s,["seed"],w);const C=m(e,["responseMimeType"]);C!=null&&g(s,["responseMimeType"],C);const S=m(e,["responseSchema"]);S!=null&&g(s,["responseSchema"],QM(_2(S)));const b=m(e,["responseJsonSchema"]);if(b!=null&&g(s,["responseJsonSchema"],b),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=m(e,["safetySettings"]);if(t!==void 0&&E!=null){let F=E;Array.isArray(F)&&(F=F.map(q=>ZM(q))),g(t,["safetySettings"],F)}const N=m(e,["tools"]);if(t!==void 0&&N!=null){let F=qu(N);Array.isArray(F)&&(F=F.map(q=>iP(Hu(q)))),g(t,["tools"],F)}const A=m(e,["toolConfig"]);if(t!==void 0&&A!=null&&g(t,["toolConfig"],cP(A)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=m(e,["cachedContent"]);t!==void 0&&R!=null&&g(t,["cachedContent"],vi(n,R));const L=m(e,["responseModalities"]);L!=null&&g(s,["responseModalities"],L);const z=m(e,["mediaResolution"]);z!=null&&g(s,["mediaResolution"],z);const M=m(e,["speechConfig"]);if(M!=null&&g(s,["speechConfig"],pP(R2(M))),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=m(e,["thinkingConfig"]);return P!=null&&g(s,["thinkingConfig"],mP(P)),s}function yP(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["request","model"],Pt(n,s));const r=m(e,["contents"]);if(r!=null){let i=Lr(r);Array.isArray(i)&&(i=i.map(a=>SE(a))),g(t,["request","contents"],i)}const o=m(e,["config"]);return o!=null&&g(t,["request","generationConfig"],gP(n,o,t)),t}function xP(n,e){const t={};if(m(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(m(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const s=m(e,["fileName"]);s!=null&&g(t,["fileName"],s);const r=m(e,["inlinedRequests"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>yP(n,i))),g(t,["requests","requests"],o)}return t}function vP(n,e){const t={},s=m(n,["displayName"]);if(e!==void 0&&s!=null&&g(e,["batch","displayName"],s),m(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function JI(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["src"]);r!=null&&g(t,["batch","inputConfig"],xP(n,CE(n,r)));const o=m(e,["config"]);return o!=null&&g(t,["config"],vP(o,t)),t}function wP(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],Ku(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function CP(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],Ku(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function TP(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);if(e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),m(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function SP(n){const e={},t=m(n,["config"]);return t!=null&&g(e,["config"],TP(t,e)),e}function bP(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],Ku(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function IP(n){const e={},t=m(n,["format"]);t!=null&&g(e,["instancesFormat"],t);const s=m(n,["gcsUri"]);s!=null&&g(e,["gcsSource","uris"],s);const r=m(n,["bigqueryUri"]);if(r!=null&&g(e,["bigquerySource","inputUri"],r),m(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function kP(n){const e={},t=m(n,["format"]);t!=null&&g(e,["predictionsFormat"],t);const s=m(n,["gcsUri"]);s!=null&&g(e,["gcsDestination","outputUriPrefix"],s);const r=m(n,["bigqueryUri"]);if(r!=null&&g(e,["bigqueryDestination","outputUri"],r),m(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(m(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return e}function NP(n,e){const t={},s=m(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const r=m(n,["dest"]);return e!==void 0&&r!=null&&g(e,["outputConfig"],kP(qM(r))),t}function EP(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["model"],Pt(n,s));const r=m(e,["src"]);r!=null&&g(t,["inputConfig"],IP(CE(n,r)));const o=m(e,["config"]);return o!=null&&g(t,["config"],NP(o,t)),t}function $P(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],Ku(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function AP(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],Ku(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function _P(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);e!==void 0&&r!=null&&g(e,["_query","pageToken"],r);const o=m(n,["filter"]);return e!==void 0&&o!=null&&g(e,["_query","filter"],o),t}function RP(n){const e={},t=m(n,["config"]);return t!=null&&g(e,["config"],_P(t,e)),e}function DP(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],Ku(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function FP(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function MP(n){const e={},t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function PP(n){const e={},t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function LP(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],FP(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],MP(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],PP(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function OP(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>LP(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function VP(n){const e={},t=m(n,["citationSources"]);return t!=null&&g(e,["citations"],t),e}function BP(n){const e={},t=m(n,["retrievedUrl"]);t!=null&&g(e,["retrievedUrl"],t);const s=m(n,["urlRetrievalStatus"]);return s!=null&&g(e,["urlRetrievalStatus"],s),e}function zP(n){const e={},t=m(n,["urlMetadata"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>BP(r))),g(e,["urlMetadata"],s)}return e}function UP(n){const e={},t=m(n,["content"]);t!=null&&g(e,["content"],OP(t));const s=m(n,["citationMetadata"]);s!=null&&g(e,["citationMetadata"],VP(s));const r=m(n,["tokenCount"]);r!=null&&g(e,["tokenCount"],r);const o=m(n,["finishReason"]);o!=null&&g(e,["finishReason"],o);const i=m(n,["urlContextMetadata"]);i!=null&&g(e,["urlContextMetadata"],zP(i));const a=m(n,["avgLogprobs"]);a!=null&&g(e,["avgLogprobs"],a);const l=m(n,["groundingMetadata"]);l!=null&&g(e,["groundingMetadata"],l);const u=m(n,["index"]);u!=null&&g(e,["index"],u);const d=m(n,["logprobsResult"]);d!=null&&g(e,["logprobsResult"],d);const f=m(n,["safetyRatings"]);return f!=null&&g(e,["safetyRatings"],f),e}function WP(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["candidates"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>UP(u))),g(e,["candidates"],l)}const r=m(n,["modelVersion"]);r!=null&&g(e,["modelVersion"],r);const o=m(n,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);const i=m(n,["responseId"]);i!=null&&g(e,["responseId"],i);const a=m(n,["usageMetadata"]);return a!=null&&g(e,["usageMetadata"],a),e}function IE(n){const e={},t=m(n,["details"]);t!=null&&g(e,["details"],t);const s=m(n,["code"]);s!=null&&g(e,["code"],s);const r=m(n,["message"]);return r!=null&&g(e,["message"],r),e}function GP(n){const e={},t=m(n,["response"]);t!=null&&g(e,["response"],WP(t));const s=m(n,["error"]);return s!=null&&g(e,["error"],IE(s)),e}function HP(n){const e={},t=m(n,["responsesFile"]);t!=null&&g(e,["fileName"],t);const s=m(n,["inlinedResponses","inlinedResponses"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>GP(o))),g(e,["inlinedResponses"],r)}return e}function Hm(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["metadata","displayName"]);s!=null&&g(e,["displayName"],s);const r=m(n,["metadata","state"]);r!=null&&g(e,["state"],TE(r));const o=m(n,["metadata","createTime"]);o!=null&&g(e,["createTime"],o);const i=m(n,["metadata","endTime"]);i!=null&&g(e,["endTime"],i);const a=m(n,["metadata","updateTime"]);a!=null&&g(e,["updateTime"],a);const l=m(n,["metadata","model"]);l!=null&&g(e,["model"],l);const u=m(n,["metadata","output"]);return u!=null&&g(e,["dest"],HP(u)),e}function qP(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["operations"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>Hm(i))),g(e,["batchJobs"],o)}return e}function KP(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&g(e,["name"],s);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const o=m(n,["error"]);return o!=null&&g(e,["error"],IE(o)),e}function kE(n){const e={},t=m(n,["details"]);t!=null&&g(e,["details"],t);const s=m(n,["code"]);s!=null&&g(e,["code"],s);const r=m(n,["message"]);return r!=null&&g(e,["message"],r),e}function XP(n){const e={},t=m(n,["instancesFormat"]);t!=null&&g(e,["format"],t);const s=m(n,["gcsSource","uris"]);s!=null&&g(e,["gcsUri"],s);const r=m(n,["bigquerySource","inputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function JP(n){const e={},t=m(n,["predictionsFormat"]);t!=null&&g(e,["format"],t);const s=m(n,["gcsDestination","outputUriPrefix"]);s!=null&&g(e,["gcsUri"],s);const r=m(n,["bigqueryDestination","outputUri"]);return r!=null&&g(e,["bigqueryUri"],r),e}function bv(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["displayName"]);s!=null&&g(e,["displayName"],s);const r=m(n,["state"]);r!=null&&g(e,["state"],TE(r));const o=m(n,["error"]);o!=null&&g(e,["error"],kE(o));const i=m(n,["createTime"]);i!=null&&g(e,["createTime"],i);const a=m(n,["startTime"]);a!=null&&g(e,["startTime"],a);const l=m(n,["endTime"]);l!=null&&g(e,["endTime"],l);const u=m(n,["updateTime"]);u!=null&&g(e,["updateTime"],u);const d=m(n,["model"]);d!=null&&g(e,["model"],d);const f=m(n,["inputConfig"]);f!=null&&g(e,["src"],XP(f));const p=m(n,["outputConfig"]);return p!=null&&g(e,["dest"],JP(p)),e}function YP(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["batchPredictionJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>bv(i))),g(e,["batchJobs"],o)}return e}function QP(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&g(e,["name"],s);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const o=m(n,["error"]);return o!=null&&g(e,["error"],kE(o)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var ll;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(ll||(ll={}));class If{constructor(e,t,s,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,s,r)}init(e,t,s){var r,o;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let i={config:{}};!s||Object.keys(s).length===0?i={config:{}}:typeof s=="object"?i=Object.assign({},s):i=s,i.config&&(i.config.pageToken=t.nextPageToken),this.paramsInternal=i,this.pageInternalSize=(o=(r=i.config)===null||r===void 0?void 0:r.pageSize)!==null&&o!==void 0?o:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class ZP extends Sl{constructor(e){super(),this.apiClient=e,this.create=async t=>{var s,r;if(this.apiClient.isVertexAI()){const i=Date.now().toString();if(Array.isArray(t.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(t.config=t.config||{},t.config.displayName===void 0&&(t.config.displayName="genaiBatchJob_${timestampStr}"),t.config.dest===void 0&&typeof t.src=="string")if(t.src.startsWith("gs://")&&t.src.endsWith(".jsonl"))t.config.dest=`${t.src.slice(0,-6)}/dest`;else if(t.src.startsWith("bq://"))t.config.dest=`${t.src}_dest_${i}`;else throw new Error("Unsupported source:"+t.src)}else if(Array.isArray(t.src)||typeof t.src!="string"&&t.src.inlinedRequests){let o="",i={};const a=JI(this.apiClient,t);o=Xe("{model}:batchGenerateContent",a._url),i=a._query;const d=a.batch.inputConfig.requests,f=d.requests,p=[];for(const v of f){const w=v;if(w.systemInstruction){const C=w.systemInstruction;delete w.systemInstruction;const S=w.request;S.systemInstruction=C,w.request=S}p.push(w)}return d.requests=p,delete a.config,delete a._url,delete a._query,this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(s=t.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(v=>v.json()).then(v=>Hm(v))}return await this.createInternal(t)},this.list=async(t={})=>new If(ll.PAGED_ITEM_BATCH_JOBS,s=>this.listInternal(s),await this.listInternal(t),t)}async createInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=EP(this.apiClient,e);return a=Xe("batchPredictionJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>bv(d))}else{const u=JI(this.apiClient,e);return a=Xe("{model}:batchGenerateContent",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>Hm(d))}}async get(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=$P(this.apiClient,e);return a=Xe("batchPredictionJobs/{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>bv(d))}else{const u=wP(this.apiClient,e);return a=Xe("batches/{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>Hm(d))}}async cancel(e){var t,s,r,o;let i="",a={};if(this.apiClient.isVertexAI()){const l=AP(this.apiClient,e);i=Xe("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const l=CP(this.apiClient,e);i=Xe("batches/{name}:cancel",l._url),a=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async listInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=RP(e);return a=Xe("batchPredictionJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=YP(d),p=new HI;return Object.assign(p,f),p})}else{const u=SP(e);return a=Xe("batches",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=qP(d),p=new HI;return Object.assign(p,f),p})}}async delete(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=DP(this.apiClient,e);return a=Xe("batchPredictionJobs/{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>QP(d))}else{const u=bP(this.apiClient,e);return a=Xe("batches/{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>KP(d))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jP(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function eL(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function tL(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function nL(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],jP(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],eL(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],tL(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function YI(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>nL(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function sL(n){const e={},t=m(n,["behavior"]);t!=null&&g(e,["behavior"],t);const s=m(n,["description"]);s!=null&&g(e,["description"],s);const r=m(n,["name"]);r!=null&&g(e,["name"],r);const o=m(n,["parameters"]);o!=null&&g(e,["parameters"],o);const i=m(n,["parametersJsonSchema"]);i!=null&&g(e,["parametersJsonSchema"],i);const a=m(n,["response"]);a!=null&&g(e,["response"],a);const l=m(n,["responseJsonSchema"]);return l!=null&&g(e,["responseJsonSchema"],l),e}function rL(n){const e={},t=m(n,["startTime"]);t!=null&&g(e,["startTime"],t);const s=m(n,["endTime"]);return s!=null&&g(e,["endTime"],s),e}function oL(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],rL(t)),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function iL(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["dynamicThreshold"]);return s!=null&&g(e,["dynamicThreshold"],s),e}function aL(n){const e={},t=m(n,["dynamicRetrievalConfig"]);return t!=null&&g(e,["dynamicRetrievalConfig"],iL(t)),e}function lL(){return{}}function uL(n){const e={},t=m(n,["environment"]);return t!=null&&g(e,["environment"],t),e}function cL(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>sL(u))),g(e,["functionDeclarations"],l)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],oL(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&g(e,["googleSearchRetrieval"],aL(r)),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(n,["urlContext"])!=null&&g(e,["urlContext"],lL());const i=m(n,["computerUse"]);i!=null&&g(e,["computerUse"],uL(i));const a=m(n,["codeExecution"]);return a!=null&&g(e,["codeExecution"],a),e}function dL(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["allowedFunctionNames"]);return s!=null&&g(e,["allowedFunctionNames"],s),e}function fL(n){const e={},t=m(n,["latitude"]);t!=null&&g(e,["latitude"],t);const s=m(n,["longitude"]);return s!=null&&g(e,["longitude"],s),e}function hL(n){const e={},t=m(n,["latLng"]);t!=null&&g(e,["latLng"],fL(t));const s=m(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function pL(n){const e={},t=m(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],dL(t));const s=m(n,["retrievalConfig"]);return s!=null&&g(e,["retrievalConfig"],hL(s)),e}function mL(n,e){const t={},s=m(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const r=m(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);const o=m(n,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);const i=m(n,["contents"]);if(e!==void 0&&i!=null){let d=Lr(i);Array.isArray(d)&&(d=d.map(f=>YI(f))),g(e,["contents"],d)}const a=m(n,["systemInstruction"]);e!==void 0&&a!=null&&g(e,["systemInstruction"],YI(Is(a)));const l=m(n,["tools"]);if(e!==void 0&&l!=null){let d=l;Array.isArray(d)&&(d=d.map(f=>cL(f))),g(e,["tools"],d)}const u=m(n,["toolConfig"]);if(e!==void 0&&u!=null&&g(e,["toolConfig"],pL(u)),m(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function gL(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["model"],dE(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],mL(r,t)),t}function yL(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],vi(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function xL(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],vi(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function vL(n,e){const t={},s=m(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const r=m(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function wL(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],vi(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],vL(r,t)),t}function CL(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function TL(n){const e={},t=m(n,["config"]);return t!=null&&g(e,["config"],CL(t,e)),e}function SL(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function bL(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["data"]);s!=null&&g(e,["data"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function IL(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["fileUri"]);s!=null&&g(e,["fileUri"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function kL(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],SL(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],bL(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],IL(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function QI(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>kL(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function NL(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&g(e,["description"],t);const s=m(n,["name"]);s!=null&&g(e,["name"],s);const r=m(n,["parameters"]);r!=null&&g(e,["parameters"],r);const o=m(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);const i=m(n,["response"]);i!=null&&g(e,["response"],i);const a=m(n,["responseJsonSchema"]);return a!=null&&g(e,["responseJsonSchema"],a),e}function EL(n){const e={},t=m(n,["startTime"]);t!=null&&g(e,["startTime"],t);const s=m(n,["endTime"]);return s!=null&&g(e,["endTime"],s),e}function $L(n){const e={},t=m(n,["timeRangeFilter"]);t!=null&&g(e,["timeRangeFilter"],EL(t));const s=m(n,["excludeDomains"]);return s!=null&&g(e,["excludeDomains"],s),e}function AL(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["dynamicThreshold"]);return s!=null&&g(e,["dynamicThreshold"],s),e}function _L(n){const e={},t=m(n,["dynamicRetrievalConfig"]);return t!=null&&g(e,["dynamicRetrievalConfig"],AL(t)),e}function RL(n){const e={},t=m(n,["excludeDomains"]);return t!=null&&g(e,["excludeDomains"],t),e}function DL(n){const e={},t=m(n,["apiKeyString"]);return t!=null&&g(e,["apiKeyString"],t),e}function FL(n){const e={},t=m(n,["apiKeyConfig"]);t!=null&&g(e,["apiKeyConfig"],DL(t));const s=m(n,["authType"]);s!=null&&g(e,["authType"],s);const r=m(n,["googleServiceAccountConfig"]);r!=null&&g(e,["googleServiceAccountConfig"],r);const o=m(n,["httpBasicAuthConfig"]);o!=null&&g(e,["httpBasicAuthConfig"],o);const i=m(n,["oauthConfig"]);i!=null&&g(e,["oauthConfig"],i);const a=m(n,["oidcConfig"]);return a!=null&&g(e,["oidcConfig"],a),e}function ML(n){const e={},t=m(n,["authConfig"]);return t!=null&&g(e,["authConfig"],FL(t)),e}function PL(){return{}}function LL(n){const e={},t=m(n,["environment"]);return t!=null&&g(e,["environment"],t),e}function OL(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(p=>NL(p))),g(e,["functionDeclarations"],f)}const s=m(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const r=m(n,["googleSearch"]);r!=null&&g(e,["googleSearch"],$L(r));const o=m(n,["googleSearchRetrieval"]);o!=null&&g(e,["googleSearchRetrieval"],_L(o));const i=m(n,["enterpriseWebSearch"]);i!=null&&g(e,["enterpriseWebSearch"],RL(i));const a=m(n,["googleMaps"]);a!=null&&g(e,["googleMaps"],ML(a)),m(n,["urlContext"])!=null&&g(e,["urlContext"],PL());const u=m(n,["computerUse"]);u!=null&&g(e,["computerUse"],LL(u));const d=m(n,["codeExecution"]);return d!=null&&g(e,["codeExecution"],d),e}function VL(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["allowedFunctionNames"]);return s!=null&&g(e,["allowedFunctionNames"],s),e}function BL(n){const e={},t=m(n,["latitude"]);t!=null&&g(e,["latitude"],t);const s=m(n,["longitude"]);return s!=null&&g(e,["longitude"],s),e}function zL(n){const e={},t=m(n,["latLng"]);t!=null&&g(e,["latLng"],BL(t));const s=m(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function UL(n){const e={},t=m(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],VL(t));const s=m(n,["retrievalConfig"]);return s!=null&&g(e,["retrievalConfig"],zL(s)),e}function WL(n,e){const t={},s=m(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const r=m(n,["expireTime"]);e!==void 0&&r!=null&&g(e,["expireTime"],r);const o=m(n,["displayName"]);e!==void 0&&o!=null&&g(e,["displayName"],o);const i=m(n,["contents"]);if(e!==void 0&&i!=null){let f=Lr(i);Array.isArray(f)&&(f=f.map(p=>QI(p))),g(e,["contents"],f)}const a=m(n,["systemInstruction"]);e!==void 0&&a!=null&&g(e,["systemInstruction"],QI(Is(a)));const l=m(n,["tools"]);if(e!==void 0&&l!=null){let f=l;Array.isArray(f)&&(f=f.map(p=>OL(p))),g(e,["tools"],f)}const u=m(n,["toolConfig"]);e!==void 0&&u!=null&&g(e,["toolConfig"],UL(u));const d=m(n,["kmsKeyName"]);return e!==void 0&&d!=null&&g(e,["encryption_spec","kmsKeyName"],d),t}function GL(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["model"],dE(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],WL(r,t)),t}function HL(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],vi(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function qL(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],vi(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function KL(n,e){const t={},s=m(n,["ttl"]);e!==void 0&&s!=null&&g(e,["ttl"],s);const r=m(n,["expireTime"]);return e!==void 0&&r!=null&&g(e,["expireTime"],r),t}function XL(n,e){const t={},s=m(e,["name"]);s!=null&&g(t,["_url","name"],vi(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],KL(r,t)),t}function JL(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function YL(n){const e={},t=m(n,["config"]);return t!=null&&g(e,["config"],JL(t,e)),e}function qm(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["displayName"]);s!=null&&g(e,["displayName"],s);const r=m(n,["model"]);r!=null&&g(e,["model"],r);const o=m(n,["createTime"]);o!=null&&g(e,["createTime"],o);const i=m(n,["updateTime"]);i!=null&&g(e,["updateTime"],i);const a=m(n,["expireTime"]);a!=null&&g(e,["expireTime"],a);const l=m(n,["usageMetadata"]);return l!=null&&g(e,["usageMetadata"],l),e}function QL(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function ZL(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>qm(i))),g(e,["cachedContents"],o)}return e}function Km(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["displayName"]);s!=null&&g(e,["displayName"],s);const r=m(n,["model"]);r!=null&&g(e,["model"],r);const o=m(n,["createTime"]);o!=null&&g(e,["createTime"],o);const i=m(n,["updateTime"]);i!=null&&g(e,["updateTime"],i);const a=m(n,["expireTime"]);a!=null&&g(e,["expireTime"],a);const l=m(n,["usageMetadata"]);return l!=null&&g(e,["usageMetadata"],l),e}function jL(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function eO(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["cachedContents"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>Km(i))),g(e,["cachedContents"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tO extends Sl{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new If(ll.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(t),t)}async create(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=GL(this.apiClient,e);return a=Xe("cachedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>Km(d))}else{const u=gL(this.apiClient,e);return a=Xe("cachedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>qm(d))}}async get(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=HL(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>Km(d))}else{const u=yL(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>qm(d))}}async delete(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=qL(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=jL(d),p=new WI;return Object.assign(p,f),p})}else{const u=xL(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=QL(d),p=new WI;return Object.assign(p,f),p})}}async update(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=XL(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>Km(d))}else{const u=wL(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>qm(d))}}async listInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=YL(e);return a=Xe("cachedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=eO(d),p=new GI;return Object.assign(p,f),p})}else{const u=TL(e);return a=Xe("cachedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=ZL(d),p=new GI;return Object.assign(p,f),p})}}}function ZI(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function en(n){return this instanceof en?(this.v=n,this):new en(n)}function Iu(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",i),r[Symbol.asyncIterator]=function(){return this},r;function i(y){return function(v){return Promise.resolve(v).then(y,f)}}function a(y,v){s[y]&&(r[y]=function(w){return new Promise(function(C,S){o.push([y,w,C,S])>1||l(y,w)})},v&&(r[y]=v(r[y])))}function l(y,v){try{u(s[y](v))}catch(w){p(o[0][3],w)}}function u(y){y.value instanceof en?Promise.resolve(y.value.v).then(d,f):p(o[0][2],y)}function d(y){l("next",y)}function f(y){l("throw",y)}function p(y,v){y(v),o.shift(),o.length&&l(o[0][0],o[0][1])}}function of(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof ZI=="function"?ZI(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(o){t[o]=n[o]&&function(i){return new Promise(function(a,l){i=n[o](i),r(a,l,i.done,i.value)})}}function r(o,i,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nO(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:NE(t)}function NE(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function sO(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function jI(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let s=0;for(;s<t;)if(n[s].role==="user")e.push(n[s]),s++;else{const r=[];let o=!0;for(;s<t&&n[s].role==="model";)r.push(n[s]),o&&!NE(n[s])&&(o=!1),s++;o?e.push(...r):e.pop()}return e}class rO{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new oO(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class oO{constructor(e,t,s,r={},o=[]){this.apiClient=e,this.modelsModule=t,this.model=s,this.config=r,this.history=o,this.sendPromise=Promise.resolve(),sO(o)}async sendMessage(e){var t;await this.sendPromise;const s=Is(e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var o,i,a;const l=await r,u=(i=(o=l.candidates)===null||o===void 0?void 0:o[0])===null||i===void 0?void 0:i.content,d=l.automaticFunctionCallingHistory,f=this.getHistory(!0).length;let p=[];d!=null&&(p=(a=d.slice(f))!==null&&a!==void 0?a:[]);const y=u?[u]:[];this.recordHistory(s,y,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),r}async sendMessageStream(e){var t;await this.sendPromise;const s=Is(e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const o=await r;return this.processStreamResponse(o,s)}getHistory(e=!1){const t=e?jI(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var s,r;return Iu(this,arguments,function*(){var i,a,l,u;const d=[];try{for(var f=!0,p=of(e),y;y=yield en(p.next()),i=y.done,!i;f=!0){u=y.value,f=!1;const v=u;if(nO(v)){const w=(r=(s=v.candidates)===null||s===void 0?void 0:s[0])===null||r===void 0?void 0:r.content;w!==void 0&&d.push(w)}yield yield en(v)}}catch(v){a={error:v}}finally{try{!f&&!i&&(l=p.return)&&(yield en(l.call(p)))}finally{if(a)throw a.error}}this.recordHistory(t,d)})}recordHistory(e,t,s){let r=[];t.length>0&&t.every(o=>o.role!==void 0)?r=t:r.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...jI(s)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ug extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Ug.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function iO(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);return e!==void 0&&r!=null&&g(e,["_query","pageToken"],r),t}function aO(n){const e={},t=m(n,["config"]);return t!=null&&g(e,["config"],iO(t,e)),e}function lO(n){const e={},t=m(n,["details"]);t!=null&&g(e,["details"],t);const s=m(n,["message"]);s!=null&&g(e,["message"],s);const r=m(n,["code"]);return r!=null&&g(e,["code"],r),e}function uO(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["displayName"]);s!=null&&g(e,["displayName"],s);const r=m(n,["mimeType"]);r!=null&&g(e,["mimeType"],r);const o=m(n,["sizeBytes"]);o!=null&&g(e,["sizeBytes"],o);const i=m(n,["createTime"]);i!=null&&g(e,["createTime"],i);const a=m(n,["expirationTime"]);a!=null&&g(e,["expirationTime"],a);const l=m(n,["updateTime"]);l!=null&&g(e,["updateTime"],l);const u=m(n,["sha256Hash"]);u!=null&&g(e,["sha256Hash"],u);const d=m(n,["uri"]);d!=null&&g(e,["uri"],d);const f=m(n,["downloadUri"]);f!=null&&g(e,["downloadUri"],f);const p=m(n,["state"]);p!=null&&g(e,["state"],p);const y=m(n,["source"]);y!=null&&g(e,["source"],y);const v=m(n,["videoMetadata"]);v!=null&&g(e,["videoMetadata"],v);const w=m(n,["error"]);return w!=null&&g(e,["error"],lO(w)),e}function cO(n){const e={},t=m(n,["file"]);t!=null&&g(e,["file"],uO(t));const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}function dO(n){const e={},t=m(n,["name"]);t!=null&&g(e,["_url","file"],xE(t));const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}function fO(n){const e={},t=m(n,["name"]);t!=null&&g(e,["_url","file"],xE(t));const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}function hO(n){const e={},t=m(n,["details"]);t!=null&&g(e,["details"],t);const s=m(n,["message"]);s!=null&&g(e,["message"],s);const r=m(n,["code"]);return r!=null&&g(e,["code"],r),e}function Iv(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["displayName"]);s!=null&&g(e,["displayName"],s);const r=m(n,["mimeType"]);r!=null&&g(e,["mimeType"],r);const o=m(n,["sizeBytes"]);o!=null&&g(e,["sizeBytes"],o);const i=m(n,["createTime"]);i!=null&&g(e,["createTime"],i);const a=m(n,["expirationTime"]);a!=null&&g(e,["expirationTime"],a);const l=m(n,["updateTime"]);l!=null&&g(e,["updateTime"],l);const u=m(n,["sha256Hash"]);u!=null&&g(e,["sha256Hash"],u);const d=m(n,["uri"]);d!=null&&g(e,["uri"],d);const f=m(n,["downloadUri"]);f!=null&&g(e,["downloadUri"],f);const p=m(n,["state"]);p!=null&&g(e,["state"],p);const y=m(n,["source"]);y!=null&&g(e,["source"],y);const v=m(n,["videoMetadata"]);v!=null&&g(e,["videoMetadata"],v);const w=m(n,["error"]);return w!=null&&g(e,["error"],hO(w)),e}function pO(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["files"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>Iv(i))),g(e,["files"],o)}return e}function mO(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function gO(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class yO extends Sl{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new If(ll.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>Iv(t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=aO(e);return o=Xe("files",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),r.then(l=>{const u=pO(l),d=new DM;return Object.assign(d,u),d})}}async createInternal(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=cO(e);return o=Xe("upload/v1beta/files",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),r.then(l=>{const u=mO(l),d=new FM;return Object.assign(d,u),d})}}async get(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=dO(e);return o=Xe("files/{file}",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),r.then(l=>Iv(l))}}async delete(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=fO(e);return o=Xe("files/{file}",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),r.then(l=>{const u=gO(l),d=new MM;return Object.assign(d,u),d})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function xO(n){const e={},t=m(n,["voiceName"]);return t!=null&&g(e,["voiceName"],t),e}function EE(n){const e={},t=m(n,["prebuiltVoiceConfig"]);return t!=null&&g(e,["prebuiltVoiceConfig"],xO(t)),e}function vO(n){const e={},t=m(n,["speaker"]);t!=null&&g(e,["speaker"],t);const s=m(n,["voiceConfig"]);return s!=null&&g(e,["voiceConfig"],EE(s)),e}function wO(n){const e={},t=m(n,["speakerVoiceConfigs"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>vO(r))),g(e,["speakerVoiceConfigs"],s)}return e}function CO(n){const e={},t=m(n,["voiceConfig"]);t!=null&&g(e,["voiceConfig"],EE(t));const s=m(n,["multiSpeakerVoiceConfig"]);s!=null&&g(e,["multiSpeakerVoiceConfig"],wO(s));const r=m(n,["languageCode"]);return r!=null&&g(e,["languageCode"],r),e}function TO(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function SO(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function bO(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function IO(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],TO(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],SO(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],bO(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function kO(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>IO(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function NO(n){const e={},t=m(n,["behavior"]);t!=null&&g(e,["behavior"],t);const s=m(n,["description"]);s!=null&&g(e,["description"],s);const r=m(n,["name"]);r!=null&&g(e,["name"],r);const o=m(n,["parameters"]);o!=null&&g(e,["parameters"],o);const i=m(n,["parametersJsonSchema"]);i!=null&&g(e,["parametersJsonSchema"],i);const a=m(n,["response"]);a!=null&&g(e,["response"],a);const l=m(n,["responseJsonSchema"]);return l!=null&&g(e,["responseJsonSchema"],l),e}function EO(n){const e={},t=m(n,["startTime"]);t!=null&&g(e,["startTime"],t);const s=m(n,["endTime"]);return s!=null&&g(e,["endTime"],s),e}function $O(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],EO(t)),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function AO(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["dynamicThreshold"]);return s!=null&&g(e,["dynamicThreshold"],s),e}function _O(n){const e={},t=m(n,["dynamicRetrievalConfig"]);return t!=null&&g(e,["dynamicRetrievalConfig"],AO(t)),e}function RO(){return{}}function DO(n){const e={},t=m(n,["environment"]);return t!=null&&g(e,["environment"],t),e}function FO(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>NO(u))),g(e,["functionDeclarations"],l)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],$O(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&g(e,["googleSearchRetrieval"],_O(r)),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(n,["urlContext"])!=null&&g(e,["urlContext"],RO());const i=m(n,["computerUse"]);i!=null&&g(e,["computerUse"],DO(i));const a=m(n,["codeExecution"]);return a!=null&&g(e,["codeExecution"],a),e}function MO(n){const e={},t=m(n,["handle"]);if(t!=null&&g(e,["handle"],t),m(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function ek(){return{}}function PO(n){const e={},t=m(n,["disabled"]);t!=null&&g(e,["disabled"],t);const s=m(n,["startOfSpeechSensitivity"]);s!=null&&g(e,["startOfSpeechSensitivity"],s);const r=m(n,["endOfSpeechSensitivity"]);r!=null&&g(e,["endOfSpeechSensitivity"],r);const o=m(n,["prefixPaddingMs"]);o!=null&&g(e,["prefixPaddingMs"],o);const i=m(n,["silenceDurationMs"]);return i!=null&&g(e,["silenceDurationMs"],i),e}function LO(n){const e={},t=m(n,["automaticActivityDetection"]);t!=null&&g(e,["automaticActivityDetection"],PO(t));const s=m(n,["activityHandling"]);s!=null&&g(e,["activityHandling"],s);const r=m(n,["turnCoverage"]);return r!=null&&g(e,["turnCoverage"],r),e}function OO(n){const e={},t=m(n,["targetTokens"]);return t!=null&&g(e,["targetTokens"],t),e}function VO(n){const e={},t=m(n,["triggerTokens"]);t!=null&&g(e,["triggerTokens"],t);const s=m(n,["slidingWindow"]);return s!=null&&g(e,["slidingWindow"],OO(s)),e}function BO(n){const e={},t=m(n,["proactiveAudio"]);return t!=null&&g(e,["proactiveAudio"],t),e}function zO(n,e){const t={},s=m(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],s);const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const o=m(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const i=m(n,["topP"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","topP"],i);const a=m(n,["topK"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","topK"],a);const l=m(n,["maxOutputTokens"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","maxOutputTokens"],l);const u=m(n,["mediaResolution"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","mediaResolution"],u);const d=m(n,["seed"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","seed"],d);const f=m(n,["speechConfig"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","speechConfig"],CO(D2(f)));const p=m(n,["enableAffectiveDialog"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],p);const y=m(n,["systemInstruction"]);e!==void 0&&y!=null&&g(e,["setup","systemInstruction"],kO(Is(y)));const v=m(n,["tools"]);if(e!==void 0&&v!=null){let A=qu(v);Array.isArray(A)&&(A=A.map(R=>FO(Hu(R)))),g(e,["setup","tools"],A)}const w=m(n,["sessionResumption"]);e!==void 0&&w!=null&&g(e,["setup","sessionResumption"],MO(w));const C=m(n,["inputAudioTranscription"]);e!==void 0&&C!=null&&g(e,["setup","inputAudioTranscription"],ek());const S=m(n,["outputAudioTranscription"]);e!==void 0&&S!=null&&g(e,["setup","outputAudioTranscription"],ek());const b=m(n,["realtimeInputConfig"]);e!==void 0&&b!=null&&g(e,["setup","realtimeInputConfig"],LO(b));const E=m(n,["contextWindowCompression"]);e!==void 0&&E!=null&&g(e,["setup","contextWindowCompression"],VO(E));const N=m(n,["proactivity"]);return e!==void 0&&N!=null&&g(e,["setup","proactivity"],BO(N)),t}function UO(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["setup","model"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],zO(r,t)),t}function WO(){return{}}function GO(){return{}}function HO(n){const e={},t=m(n,["media"]);t!=null&&g(e,["mediaChunks"],fE(t));const s=m(n,["audio"]);s!=null&&g(e,["audio"],pE(s));const r=m(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);const o=m(n,["video"]);o!=null&&g(e,["video"],hE(o));const i=m(n,["text"]);return i!=null&&g(e,["text"],i),m(n,["activityStart"])!=null&&g(e,["activityStart"],WO()),m(n,["activityEnd"])!=null&&g(e,["activityEnd"],GO()),e}function $E(n){const e={},t=m(n,["text"]);t!=null&&g(e,["text"],t);const s=m(n,["weight"]);return s!=null&&g(e,["weight"],s),e}function qO(n){const e={},t=m(n,["weightedPrompts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>$E(r))),g(e,["weightedPrompts"],s)}return e}function AE(n){const e={},t=m(n,["temperature"]);t!=null&&g(e,["temperature"],t);const s=m(n,["topK"]);s!=null&&g(e,["topK"],s);const r=m(n,["seed"]);r!=null&&g(e,["seed"],r);const o=m(n,["guidance"]);o!=null&&g(e,["guidance"],o);const i=m(n,["bpm"]);i!=null&&g(e,["bpm"],i);const a=m(n,["density"]);a!=null&&g(e,["density"],a);const l=m(n,["brightness"]);l!=null&&g(e,["brightness"],l);const u=m(n,["scale"]);u!=null&&g(e,["scale"],u);const d=m(n,["muteBass"]);d!=null&&g(e,["muteBass"],d);const f=m(n,["muteDrums"]);f!=null&&g(e,["muteDrums"],f);const p=m(n,["onlyBassAndDrums"]);p!=null&&g(e,["onlyBassAndDrums"],p);const y=m(n,["musicGenerationMode"]);return y!=null&&g(e,["musicGenerationMode"],y),e}function KO(n){const e={},t=m(n,["musicGenerationConfig"]);return t!=null&&g(e,["musicGenerationConfig"],AE(t)),e}function _E(n){const e={},t=m(n,["model"]);return t!=null&&g(e,["model"],t),e}function RE(n){const e={},t=m(n,["weightedPrompts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>$E(r))),g(e,["weightedPrompts"],s)}return e}function kv(n){const e={},t=m(n,["setup"]);t!=null&&g(e,["setup"],_E(t));const s=m(n,["clientContent"]);s!=null&&g(e,["clientContent"],RE(s));const r=m(n,["musicGenerationConfig"]);r!=null&&g(e,["musicGenerationConfig"],AE(r));const o=m(n,["playbackControl"]);return o!=null&&g(e,["playbackControl"],o),e}function XO(n){const e={},t=m(n,["voiceName"]);return t!=null&&g(e,["voiceName"],t),e}function JO(n){const e={},t=m(n,["prebuiltVoiceConfig"]);return t!=null&&g(e,["prebuiltVoiceConfig"],XO(t)),e}function YO(n){const e={},t=m(n,["voiceConfig"]);if(t!=null&&g(e,["voiceConfig"],JO(t)),m(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=m(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function QO(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function ZO(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["data"]);s!=null&&g(e,["data"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function jO(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["fileUri"]);s!=null&&g(e,["fileUri"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function eV(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],QO(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],ZO(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],jO(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function tV(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>eV(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function nV(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&g(e,["description"],t);const s=m(n,["name"]);s!=null&&g(e,["name"],s);const r=m(n,["parameters"]);r!=null&&g(e,["parameters"],r);const o=m(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);const i=m(n,["response"]);i!=null&&g(e,["response"],i);const a=m(n,["responseJsonSchema"]);return a!=null&&g(e,["responseJsonSchema"],a),e}function sV(n){const e={},t=m(n,["startTime"]);t!=null&&g(e,["startTime"],t);const s=m(n,["endTime"]);return s!=null&&g(e,["endTime"],s),e}function rV(n){const e={},t=m(n,["timeRangeFilter"]);t!=null&&g(e,["timeRangeFilter"],sV(t));const s=m(n,["excludeDomains"]);return s!=null&&g(e,["excludeDomains"],s),e}function oV(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["dynamicThreshold"]);return s!=null&&g(e,["dynamicThreshold"],s),e}function iV(n){const e={},t=m(n,["dynamicRetrievalConfig"]);return t!=null&&g(e,["dynamicRetrievalConfig"],oV(t)),e}function aV(n){const e={},t=m(n,["excludeDomains"]);return t!=null&&g(e,["excludeDomains"],t),e}function lV(n){const e={},t=m(n,["apiKeyString"]);return t!=null&&g(e,["apiKeyString"],t),e}function uV(n){const e={},t=m(n,["apiKeyConfig"]);t!=null&&g(e,["apiKeyConfig"],lV(t));const s=m(n,["authType"]);s!=null&&g(e,["authType"],s);const r=m(n,["googleServiceAccountConfig"]);r!=null&&g(e,["googleServiceAccountConfig"],r);const o=m(n,["httpBasicAuthConfig"]);o!=null&&g(e,["httpBasicAuthConfig"],o);const i=m(n,["oauthConfig"]);i!=null&&g(e,["oauthConfig"],i);const a=m(n,["oidcConfig"]);return a!=null&&g(e,["oidcConfig"],a),e}function cV(n){const e={},t=m(n,["authConfig"]);return t!=null&&g(e,["authConfig"],uV(t)),e}function dV(){return{}}function fV(n){const e={},t=m(n,["environment"]);return t!=null&&g(e,["environment"],t),e}function hV(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(p=>nV(p))),g(e,["functionDeclarations"],f)}const s=m(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const r=m(n,["googleSearch"]);r!=null&&g(e,["googleSearch"],rV(r));const o=m(n,["googleSearchRetrieval"]);o!=null&&g(e,["googleSearchRetrieval"],iV(o));const i=m(n,["enterpriseWebSearch"]);i!=null&&g(e,["enterpriseWebSearch"],aV(i));const a=m(n,["googleMaps"]);a!=null&&g(e,["googleMaps"],cV(a)),m(n,["urlContext"])!=null&&g(e,["urlContext"],dV());const u=m(n,["computerUse"]);u!=null&&g(e,["computerUse"],fV(u));const d=m(n,["codeExecution"]);return d!=null&&g(e,["codeExecution"],d),e}function pV(n){const e={},t=m(n,["handle"]);t!=null&&g(e,["handle"],t);const s=m(n,["transparent"]);return s!=null&&g(e,["transparent"],s),e}function tk(){return{}}function mV(n){const e={},t=m(n,["disabled"]);t!=null&&g(e,["disabled"],t);const s=m(n,["startOfSpeechSensitivity"]);s!=null&&g(e,["startOfSpeechSensitivity"],s);const r=m(n,["endOfSpeechSensitivity"]);r!=null&&g(e,["endOfSpeechSensitivity"],r);const o=m(n,["prefixPaddingMs"]);o!=null&&g(e,["prefixPaddingMs"],o);const i=m(n,["silenceDurationMs"]);return i!=null&&g(e,["silenceDurationMs"],i),e}function gV(n){const e={},t=m(n,["automaticActivityDetection"]);t!=null&&g(e,["automaticActivityDetection"],mV(t));const s=m(n,["activityHandling"]);s!=null&&g(e,["activityHandling"],s);const r=m(n,["turnCoverage"]);return r!=null&&g(e,["turnCoverage"],r),e}function yV(n){const e={},t=m(n,["targetTokens"]);return t!=null&&g(e,["targetTokens"],t),e}function xV(n){const e={},t=m(n,["triggerTokens"]);t!=null&&g(e,["triggerTokens"],t);const s=m(n,["slidingWindow"]);return s!=null&&g(e,["slidingWindow"],yV(s)),e}function vV(n){const e={},t=m(n,["proactiveAudio"]);return t!=null&&g(e,["proactiveAudio"],t),e}function wV(n,e){const t={},s=m(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],s);const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const o=m(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const i=m(n,["topP"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","topP"],i);const a=m(n,["topK"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","topK"],a);const l=m(n,["maxOutputTokens"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","maxOutputTokens"],l);const u=m(n,["mediaResolution"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","mediaResolution"],u);const d=m(n,["seed"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","seed"],d);const f=m(n,["speechConfig"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","speechConfig"],YO(D2(f)));const p=m(n,["enableAffectiveDialog"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],p);const y=m(n,["systemInstruction"]);e!==void 0&&y!=null&&g(e,["setup","systemInstruction"],tV(Is(y)));const v=m(n,["tools"]);if(e!==void 0&&v!=null){let A=qu(v);Array.isArray(A)&&(A=A.map(R=>hV(Hu(R)))),g(e,["setup","tools"],A)}const w=m(n,["sessionResumption"]);e!==void 0&&w!=null&&g(e,["setup","sessionResumption"],pV(w));const C=m(n,["inputAudioTranscription"]);e!==void 0&&C!=null&&g(e,["setup","inputAudioTranscription"],tk());const S=m(n,["outputAudioTranscription"]);e!==void 0&&S!=null&&g(e,["setup","outputAudioTranscription"],tk());const b=m(n,["realtimeInputConfig"]);e!==void 0&&b!=null&&g(e,["setup","realtimeInputConfig"],gV(b));const E=m(n,["contextWindowCompression"]);e!==void 0&&E!=null&&g(e,["setup","contextWindowCompression"],xV(E));const N=m(n,["proactivity"]);return e!==void 0&&N!=null&&g(e,["setup","proactivity"],vV(N)),t}function CV(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["setup","model"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],wV(r,t)),t}function TV(){return{}}function SV(){return{}}function bV(n){const e={},t=m(n,["media"]);t!=null&&g(e,["mediaChunks"],fE(t));const s=m(n,["audio"]);s!=null&&g(e,["audio"],pE(s));const r=m(n,["audioStreamEnd"]);r!=null&&g(e,["audioStreamEnd"],r);const o=m(n,["video"]);o!=null&&g(e,["video"],hE(o));const i=m(n,["text"]);return i!=null&&g(e,["text"],i),m(n,["activityStart"])!=null&&g(e,["activityStart"],TV()),m(n,["activityEnd"])!=null&&g(e,["activityEnd"],SV()),e}function IV(){return{}}function kV(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function NV(n){const e={},t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function EV(n){const e={},t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function $V(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],kV(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],NV(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],EV(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function AV(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>$V(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function nk(n){const e={},t=m(n,["text"]);t!=null&&g(e,["text"],t);const s=m(n,["finished"]);return s!=null&&g(e,["finished"],s),e}function _V(n){const e={},t=m(n,["retrievedUrl"]);t!=null&&g(e,["retrievedUrl"],t);const s=m(n,["urlRetrievalStatus"]);return s!=null&&g(e,["urlRetrievalStatus"],s),e}function RV(n){const e={},t=m(n,["urlMetadata"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>_V(r))),g(e,["urlMetadata"],s)}return e}function DV(n){const e={},t=m(n,["modelTurn"]);t!=null&&g(e,["modelTurn"],AV(t));const s=m(n,["turnComplete"]);s!=null&&g(e,["turnComplete"],s);const r=m(n,["interrupted"]);r!=null&&g(e,["interrupted"],r);const o=m(n,["groundingMetadata"]);o!=null&&g(e,["groundingMetadata"],o);const i=m(n,["generationComplete"]);i!=null&&g(e,["generationComplete"],i);const a=m(n,["inputTranscription"]);a!=null&&g(e,["inputTranscription"],nk(a));const l=m(n,["outputTranscription"]);l!=null&&g(e,["outputTranscription"],nk(l));const u=m(n,["urlContextMetadata"]);return u!=null&&g(e,["urlContextMetadata"],RV(u)),e}function FV(n){const e={},t=m(n,["id"]);t!=null&&g(e,["id"],t);const s=m(n,["args"]);s!=null&&g(e,["args"],s);const r=m(n,["name"]);return r!=null&&g(e,["name"],r),e}function MV(n){const e={},t=m(n,["functionCalls"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>FV(r))),g(e,["functionCalls"],s)}return e}function PV(n){const e={},t=m(n,["ids"]);return t!=null&&g(e,["ids"],t),e}function Am(n){const e={},t=m(n,["modality"]);t!=null&&g(e,["modality"],t);const s=m(n,["tokenCount"]);return s!=null&&g(e,["tokenCount"],s),e}function LV(n){const e={},t=m(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);const s=m(n,["cachedContentTokenCount"]);s!=null&&g(e,["cachedContentTokenCount"],s);const r=m(n,["responseTokenCount"]);r!=null&&g(e,["responseTokenCount"],r);const o=m(n,["toolUsePromptTokenCount"]);o!=null&&g(e,["toolUsePromptTokenCount"],o);const i=m(n,["thoughtsTokenCount"]);i!=null&&g(e,["thoughtsTokenCount"],i);const a=m(n,["totalTokenCount"]);a!=null&&g(e,["totalTokenCount"],a);const l=m(n,["promptTokensDetails"]);if(l!=null){let p=l;Array.isArray(p)&&(p=p.map(y=>Am(y))),g(e,["promptTokensDetails"],p)}const u=m(n,["cacheTokensDetails"]);if(u!=null){let p=u;Array.isArray(p)&&(p=p.map(y=>Am(y))),g(e,["cacheTokensDetails"],p)}const d=m(n,["responseTokensDetails"]);if(d!=null){let p=d;Array.isArray(p)&&(p=p.map(y=>Am(y))),g(e,["responseTokensDetails"],p)}const f=m(n,["toolUsePromptTokensDetails"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(y=>Am(y))),g(e,["toolUsePromptTokensDetails"],p)}return e}function OV(n){const e={},t=m(n,["timeLeft"]);return t!=null&&g(e,["timeLeft"],t),e}function VV(n){const e={},t=m(n,["newHandle"]);t!=null&&g(e,["newHandle"],t);const s=m(n,["resumable"]);s!=null&&g(e,["resumable"],s);const r=m(n,["lastConsumedClientMessageIndex"]);return r!=null&&g(e,["lastConsumedClientMessageIndex"],r),e}function BV(n){const e={};m(n,["setupComplete"])!=null&&g(e,["setupComplete"],IV());const s=m(n,["serverContent"]);s!=null&&g(e,["serverContent"],DV(s));const r=m(n,["toolCall"]);r!=null&&g(e,["toolCall"],MV(r));const o=m(n,["toolCallCancellation"]);o!=null&&g(e,["toolCallCancellation"],PV(o));const i=m(n,["usageMetadata"]);i!=null&&g(e,["usageMetadata"],LV(i));const a=m(n,["goAway"]);a!=null&&g(e,["goAway"],OV(a));const l=m(n,["sessionResumptionUpdate"]);return l!=null&&g(e,["sessionResumptionUpdate"],VV(l)),e}function zV(){return{}}function UV(n){const e={},t=m(n,["text"]);t!=null&&g(e,["text"],t);const s=m(n,["weight"]);return s!=null&&g(e,["weight"],s),e}function WV(n){const e={},t=m(n,["weightedPrompts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>UV(r))),g(e,["weightedPrompts"],s)}return e}function GV(n){const e={},t=m(n,["temperature"]);t!=null&&g(e,["temperature"],t);const s=m(n,["topK"]);s!=null&&g(e,["topK"],s);const r=m(n,["seed"]);r!=null&&g(e,["seed"],r);const o=m(n,["guidance"]);o!=null&&g(e,["guidance"],o);const i=m(n,["bpm"]);i!=null&&g(e,["bpm"],i);const a=m(n,["density"]);a!=null&&g(e,["density"],a);const l=m(n,["brightness"]);l!=null&&g(e,["brightness"],l);const u=m(n,["scale"]);u!=null&&g(e,["scale"],u);const d=m(n,["muteBass"]);d!=null&&g(e,["muteBass"],d);const f=m(n,["muteDrums"]);f!=null&&g(e,["muteDrums"],f);const p=m(n,["onlyBassAndDrums"]);p!=null&&g(e,["onlyBassAndDrums"],p);const y=m(n,["musicGenerationMode"]);return y!=null&&g(e,["musicGenerationMode"],y),e}function HV(n){const e={},t=m(n,["clientContent"]);t!=null&&g(e,["clientContent"],WV(t));const s=m(n,["musicGenerationConfig"]);return s!=null&&g(e,["musicGenerationConfig"],GV(s)),e}function qV(n){const e={},t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);s!=null&&g(e,["mimeType"],s);const r=m(n,["sourceMetadata"]);return r!=null&&g(e,["sourceMetadata"],HV(r)),e}function KV(n){const e={},t=m(n,["audioChunks"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>qV(r))),g(e,["audioChunks"],s)}return e}function XV(n){const e={},t=m(n,["text"]);t!=null&&g(e,["text"],t);const s=m(n,["filteredReason"]);return s!=null&&g(e,["filteredReason"],s),e}function JV(n){const e={};m(n,["setupComplete"])!=null&&g(e,["setupComplete"],zV());const s=m(n,["serverContent"]);s!=null&&g(e,["serverContent"],KV(s));const r=m(n,["filteredPrompt"]);return r!=null&&g(e,["filteredPrompt"],XV(r)),e}function YV(n){const e={},t=m(n,["sessionId"]);return t!=null&&g(e,["sessionId"],t),e}function QV(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function ZV(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["data"]);s!=null&&g(e,["data"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function jV(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["fileUri"]);s!=null&&g(e,["fileUri"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function e6(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],QV(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],ZV(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],jV(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function t6(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>e6(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function sk(n){const e={},t=m(n,["text"]);t!=null&&g(e,["text"],t);const s=m(n,["finished"]);return s!=null&&g(e,["finished"],s),e}function n6(n){const e={},t=m(n,["modelTurn"]);t!=null&&g(e,["modelTurn"],t6(t));const s=m(n,["turnComplete"]);s!=null&&g(e,["turnComplete"],s);const r=m(n,["interrupted"]);r!=null&&g(e,["interrupted"],r);const o=m(n,["groundingMetadata"]);o!=null&&g(e,["groundingMetadata"],o);const i=m(n,["generationComplete"]);i!=null&&g(e,["generationComplete"],i);const a=m(n,["inputTranscription"]);a!=null&&g(e,["inputTranscription"],sk(a));const l=m(n,["outputTranscription"]);return l!=null&&g(e,["outputTranscription"],sk(l)),e}function s6(n){const e={},t=m(n,["args"]);t!=null&&g(e,["args"],t);const s=m(n,["name"]);return s!=null&&g(e,["name"],s),e}function r6(n){const e={},t=m(n,["functionCalls"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>s6(r))),g(e,["functionCalls"],s)}return e}function o6(n){const e={},t=m(n,["ids"]);return t!=null&&g(e,["ids"],t),e}function _m(n){const e={},t=m(n,["modality"]);t!=null&&g(e,["modality"],t);const s=m(n,["tokenCount"]);return s!=null&&g(e,["tokenCount"],s),e}function i6(n){const e={},t=m(n,["promptTokenCount"]);t!=null&&g(e,["promptTokenCount"],t);const s=m(n,["cachedContentTokenCount"]);s!=null&&g(e,["cachedContentTokenCount"],s);const r=m(n,["candidatesTokenCount"]);r!=null&&g(e,["responseTokenCount"],r);const o=m(n,["toolUsePromptTokenCount"]);o!=null&&g(e,["toolUsePromptTokenCount"],o);const i=m(n,["thoughtsTokenCount"]);i!=null&&g(e,["thoughtsTokenCount"],i);const a=m(n,["totalTokenCount"]);a!=null&&g(e,["totalTokenCount"],a);const l=m(n,["promptTokensDetails"]);if(l!=null){let y=l;Array.isArray(y)&&(y=y.map(v=>_m(v))),g(e,["promptTokensDetails"],y)}const u=m(n,["cacheTokensDetails"]);if(u!=null){let y=u;Array.isArray(y)&&(y=y.map(v=>_m(v))),g(e,["cacheTokensDetails"],y)}const d=m(n,["candidatesTokensDetails"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(v=>_m(v))),g(e,["responseTokensDetails"],y)}const f=m(n,["toolUsePromptTokensDetails"]);if(f!=null){let y=f;Array.isArray(y)&&(y=y.map(v=>_m(v))),g(e,["toolUsePromptTokensDetails"],y)}const p=m(n,["trafficType"]);return p!=null&&g(e,["trafficType"],p),e}function a6(n){const e={},t=m(n,["timeLeft"]);return t!=null&&g(e,["timeLeft"],t),e}function l6(n){const e={},t=m(n,["newHandle"]);t!=null&&g(e,["newHandle"],t);const s=m(n,["resumable"]);s!=null&&g(e,["resumable"],s);const r=m(n,["lastConsumedClientMessageIndex"]);return r!=null&&g(e,["lastConsumedClientMessageIndex"],r),e}function u6(n){const e={},t=m(n,["setupComplete"]);t!=null&&g(e,["setupComplete"],YV(t));const s=m(n,["serverContent"]);s!=null&&g(e,["serverContent"],n6(s));const r=m(n,["toolCall"]);r!=null&&g(e,["toolCall"],r6(r));const o=m(n,["toolCallCancellation"]);o!=null&&g(e,["toolCallCancellation"],o6(o));const i=m(n,["usageMetadata"]);i!=null&&g(e,["usageMetadata"],i6(i));const a=m(n,["goAway"]);a!=null&&g(e,["goAway"],a6(a));const l=m(n,["sessionResumptionUpdate"]);return l!=null&&g(e,["sessionResumptionUpdate"],l6(l)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function c6(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function d6(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function f6(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function h6(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],c6(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],d6(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],f6(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function Wg(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>h6(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function p6(n){const e={},t=m(n,["anyOf"]);t!=null&&g(e,["anyOf"],t);const s=m(n,["default"]);s!=null&&g(e,["default"],s);const r=m(n,["description"]);r!=null&&g(e,["description"],r);const o=m(n,["enum"]);o!=null&&g(e,["enum"],o);const i=m(n,["example"]);i!=null&&g(e,["example"],i);const a=m(n,["format"]);a!=null&&g(e,["format"],a);const l=m(n,["items"]);l!=null&&g(e,["items"],l);const u=m(n,["maxItems"]);u!=null&&g(e,["maxItems"],u);const d=m(n,["maxLength"]);d!=null&&g(e,["maxLength"],d);const f=m(n,["maxProperties"]);f!=null&&g(e,["maxProperties"],f);const p=m(n,["maximum"]);p!=null&&g(e,["maximum"],p);const y=m(n,["minItems"]);y!=null&&g(e,["minItems"],y);const v=m(n,["minLength"]);v!=null&&g(e,["minLength"],v);const w=m(n,["minProperties"]);w!=null&&g(e,["minProperties"],w);const C=m(n,["minimum"]);C!=null&&g(e,["minimum"],C);const S=m(n,["nullable"]);S!=null&&g(e,["nullable"],S);const b=m(n,["pattern"]);b!=null&&g(e,["pattern"],b);const E=m(n,["properties"]);E!=null&&g(e,["properties"],E);const N=m(n,["propertyOrdering"]);N!=null&&g(e,["propertyOrdering"],N);const A=m(n,["required"]);A!=null&&g(e,["required"],A);const R=m(n,["title"]);R!=null&&g(e,["title"],R);const L=m(n,["type"]);return L!=null&&g(e,["type"],L),e}function m6(n){const e={};if(m(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const t=m(n,["category"]);t!=null&&g(e,["category"],t);const s=m(n,["threshold"]);return s!=null&&g(e,["threshold"],s),e}function g6(n){const e={},t=m(n,["behavior"]);t!=null&&g(e,["behavior"],t);const s=m(n,["description"]);s!=null&&g(e,["description"],s);const r=m(n,["name"]);r!=null&&g(e,["name"],r);const o=m(n,["parameters"]);o!=null&&g(e,["parameters"],o);const i=m(n,["parametersJsonSchema"]);i!=null&&g(e,["parametersJsonSchema"],i);const a=m(n,["response"]);a!=null&&g(e,["response"],a);const l=m(n,["responseJsonSchema"]);return l!=null&&g(e,["responseJsonSchema"],l),e}function y6(n){const e={},t=m(n,["startTime"]);t!=null&&g(e,["startTime"],t);const s=m(n,["endTime"]);return s!=null&&g(e,["endTime"],s),e}function x6(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],y6(t)),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function v6(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["dynamicThreshold"]);return s!=null&&g(e,["dynamicThreshold"],s),e}function w6(n){const e={},t=m(n,["dynamicRetrievalConfig"]);return t!=null&&g(e,["dynamicRetrievalConfig"],v6(t)),e}function C6(){return{}}function T6(n){const e={},t=m(n,["environment"]);return t!=null&&g(e,["environment"],t),e}function S6(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>g6(u))),g(e,["functionDeclarations"],l)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],x6(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&g(e,["googleSearchRetrieval"],w6(r)),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(n,["urlContext"])!=null&&g(e,["urlContext"],C6());const i=m(n,["computerUse"]);i!=null&&g(e,["computerUse"],T6(i));const a=m(n,["codeExecution"]);return a!=null&&g(e,["codeExecution"],a),e}function b6(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["allowedFunctionNames"]);return s!=null&&g(e,["allowedFunctionNames"],s),e}function I6(n){const e={},t=m(n,["latitude"]);t!=null&&g(e,["latitude"],t);const s=m(n,["longitude"]);return s!=null&&g(e,["longitude"],s),e}function k6(n){const e={},t=m(n,["latLng"]);t!=null&&g(e,["latLng"],I6(t));const s=m(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function N6(n){const e={},t=m(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],b6(t));const s=m(n,["retrievalConfig"]);return s!=null&&g(e,["retrievalConfig"],k6(s)),e}function E6(n){const e={},t=m(n,["voiceName"]);return t!=null&&g(e,["voiceName"],t),e}function DE(n){const e={},t=m(n,["prebuiltVoiceConfig"]);return t!=null&&g(e,["prebuiltVoiceConfig"],E6(t)),e}function $6(n){const e={},t=m(n,["speaker"]);t!=null&&g(e,["speaker"],t);const s=m(n,["voiceConfig"]);return s!=null&&g(e,["voiceConfig"],DE(s)),e}function A6(n){const e={},t=m(n,["speakerVoiceConfigs"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>$6(r))),g(e,["speakerVoiceConfigs"],s)}return e}function _6(n){const e={},t=m(n,["voiceConfig"]);t!=null&&g(e,["voiceConfig"],DE(t));const s=m(n,["multiSpeakerVoiceConfig"]);s!=null&&g(e,["multiSpeakerVoiceConfig"],A6(s));const r=m(n,["languageCode"]);return r!=null&&g(e,["languageCode"],r),e}function R6(n){const e={},t=m(n,["includeThoughts"]);t!=null&&g(e,["includeThoughts"],t);const s=m(n,["thinkingBudget"]);return s!=null&&g(e,["thinkingBudget"],s),e}function D6(n,e,t){const s={},r=m(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],Wg(Is(r)));const o=m(e,["temperature"]);o!=null&&g(s,["temperature"],o);const i=m(e,["topP"]);i!=null&&g(s,["topP"],i);const a=m(e,["topK"]);a!=null&&g(s,["topK"],a);const l=m(e,["candidateCount"]);l!=null&&g(s,["candidateCount"],l);const u=m(e,["maxOutputTokens"]);u!=null&&g(s,["maxOutputTokens"],u);const d=m(e,["stopSequences"]);d!=null&&g(s,["stopSequences"],d);const f=m(e,["responseLogprobs"]);f!=null&&g(s,["responseLogprobs"],f);const p=m(e,["logprobs"]);p!=null&&g(s,["logprobs"],p);const y=m(e,["presencePenalty"]);y!=null&&g(s,["presencePenalty"],y);const v=m(e,["frequencyPenalty"]);v!=null&&g(s,["frequencyPenalty"],v);const w=m(e,["seed"]);w!=null&&g(s,["seed"],w);const C=m(e,["responseMimeType"]);C!=null&&g(s,["responseMimeType"],C);const S=m(e,["responseSchema"]);S!=null&&g(s,["responseSchema"],p6(_2(S)));const b=m(e,["responseJsonSchema"]);if(b!=null&&g(s,["responseJsonSchema"],b),m(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(m(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const E=m(e,["safetySettings"]);if(t!==void 0&&E!=null){let F=E;Array.isArray(F)&&(F=F.map(q=>m6(q))),g(t,["safetySettings"],F)}const N=m(e,["tools"]);if(t!==void 0&&N!=null){let F=qu(N);Array.isArray(F)&&(F=F.map(q=>S6(Hu(q)))),g(t,["tools"],F)}const A=m(e,["toolConfig"]);if(t!==void 0&&A!=null&&g(t,["toolConfig"],N6(A)),m(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=m(e,["cachedContent"]);t!==void 0&&R!=null&&g(t,["cachedContent"],vi(n,R));const L=m(e,["responseModalities"]);L!=null&&g(s,["responseModalities"],L);const z=m(e,["mediaResolution"]);z!=null&&g(s,["mediaResolution"],z);const M=m(e,["speechConfig"]);if(M!=null&&g(s,["speechConfig"],_6(R2(M))),m(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=m(e,["thinkingConfig"]);return P!=null&&g(s,["thinkingConfig"],R6(P)),s}function rk(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["contents"]);if(r!=null){let i=Lr(r);Array.isArray(i)&&(i=i.map(a=>Wg(a))),g(t,["contents"],i)}const o=m(e,["config"]);return o!=null&&g(t,["generationConfig"],D6(n,o,t)),t}function F6(n,e){const t={},s=m(n,["taskType"]);e!==void 0&&s!=null&&g(e,["requests[]","taskType"],s);const r=m(n,["title"]);e!==void 0&&r!=null&&g(e,["requests[]","title"],r);const o=m(n,["outputDimensionality"]);if(e!==void 0&&o!=null&&g(e,["requests[]","outputDimensionality"],o),m(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(m(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function M6(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["contents"]);r!=null&&g(t,["requests[]","content"],gE(n,r));const o=m(e,["config"]);o!=null&&g(t,["config"],F6(o,t));const i=m(e,["model"]);return i!==void 0&&g(t,["requests[]","model"],Pt(n,i)),t}function P6(n,e){const t={};if(m(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=m(n,["numberOfImages"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const r=m(n,["aspectRatio"]);e!==void 0&&r!=null&&g(e,["parameters","aspectRatio"],r);const o=m(n,["guidanceScale"]);if(e!==void 0&&o!=null&&g(e,["parameters","guidanceScale"],o),m(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const i=m(n,["safetyFilterLevel"]);e!==void 0&&i!=null&&g(e,["parameters","safetySetting"],i);const a=m(n,["personGeneration"]);e!==void 0&&a!=null&&g(e,["parameters","personGeneration"],a);const l=m(n,["includeSafetyAttributes"]);e!==void 0&&l!=null&&g(e,["parameters","includeSafetyAttributes"],l);const u=m(n,["includeRaiReason"]);e!==void 0&&u!=null&&g(e,["parameters","includeRaiReason"],u);const d=m(n,["language"]);e!==void 0&&d!=null&&g(e,["parameters","language"],d);const f=m(n,["outputMimeType"]);e!==void 0&&f!=null&&g(e,["parameters","outputOptions","mimeType"],f);const p=m(n,["outputCompressionQuality"]);if(e!==void 0&&p!=null&&g(e,["parameters","outputOptions","compressionQuality"],p),m(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");const y=m(n,["imageSize"]);if(e!==void 0&&y!=null&&g(e,["parameters","sampleImageSize"],y),m(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function L6(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);const o=m(e,["config"]);return o!=null&&g(t,["config"],P6(o,t)),t}function O6(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","name"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function V6(n,e,t){const s={},r=m(e,["pageSize"]);t!==void 0&&r!=null&&g(t,["_query","pageSize"],r);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&g(t,["_query","pageToken"],o);const i=m(e,["filter"]);t!==void 0&&i!=null&&g(t,["_query","filter"],i);const a=m(e,["queryBase"]);return t!==void 0&&a!=null&&g(t,["_url","models_url"],vE(n,a)),s}function B6(n,e){const t={},s=m(e,["config"]);return s!=null&&g(t,["config"],V6(n,s,t)),t}function z6(n,e){const t={},s=m(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const r=m(n,["description"]);e!==void 0&&r!=null&&g(e,["description"],r);const o=m(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&g(e,["defaultCheckpointId"],o),t}function U6(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","name"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],z6(r,t)),t}function W6(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","name"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function G6(n){const e={};if(m(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(m(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(m(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function H6(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["contents"]);if(r!=null){let i=Lr(r);Array.isArray(i)&&(i=i.map(a=>Wg(a))),g(t,["contents"],i)}const o=m(e,["config"]);return o!=null&&g(t,["config"],G6(o)),t}function FE(n){const e={};if(m(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=m(n,["imageBytes"]);t!=null&&g(e,["bytesBase64Encoded"],bl(t));const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function q6(n,e){const t={},s=m(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const r=m(n,["image"]);if(e!==void 0&&r!=null&&g(e,["instances[0]","image"],FE(r)),m(n,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");return t}function K6(n,e){const t={},s=m(n,["numberOfVideos"]);if(e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s),m(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(m(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const r=m(n,["durationSeconds"]);if(e!==void 0&&r!=null&&g(e,["parameters","durationSeconds"],r),m(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=m(n,["aspectRatio"]);e!==void 0&&o!=null&&g(e,["parameters","aspectRatio"],o);const i=m(n,["resolution"]);e!==void 0&&i!=null&&g(e,["parameters","resolution"],i);const a=m(n,["personGeneration"]);if(e!==void 0&&a!=null&&g(e,["parameters","personGeneration"],a),m(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=m(n,["negativePrompt"]);e!==void 0&&l!=null&&g(e,["parameters","negativePrompt"],l);const u=m(n,["enhancePrompt"]);if(e!==void 0&&u!=null&&g(e,["parameters","enhancePrompt"],u),m(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(m(n,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(m(n,["referenceImages"])!==void 0)throw new Error("referenceImages parameter is not supported in Gemini API.");if(m(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function X6(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);const o=m(e,["image"]);if(o!=null&&g(t,["instances[0]","image"],FE(o)),m(e,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const i=m(e,["source"]);i!=null&&g(t,["config"],q6(i,t));const a=m(e,["config"]);return a!=null&&g(t,["config"],K6(a,t)),t}function J6(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function Y6(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["data"]);s!=null&&g(e,["data"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function Q6(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["fileUri"]);s!=null&&g(e,["fileUri"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function Z6(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],J6(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],Y6(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],Q6(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function Xu(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>Z6(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function j6(n){const e={},t=m(n,["anyOf"]);t!=null&&g(e,["anyOf"],t);const s=m(n,["default"]);s!=null&&g(e,["default"],s);const r=m(n,["description"]);r!=null&&g(e,["description"],r);const o=m(n,["enum"]);o!=null&&g(e,["enum"],o);const i=m(n,["example"]);i!=null&&g(e,["example"],i);const a=m(n,["format"]);a!=null&&g(e,["format"],a);const l=m(n,["items"]);l!=null&&g(e,["items"],l);const u=m(n,["maxItems"]);u!=null&&g(e,["maxItems"],u);const d=m(n,["maxLength"]);d!=null&&g(e,["maxLength"],d);const f=m(n,["maxProperties"]);f!=null&&g(e,["maxProperties"],f);const p=m(n,["maximum"]);p!=null&&g(e,["maximum"],p);const y=m(n,["minItems"]);y!=null&&g(e,["minItems"],y);const v=m(n,["minLength"]);v!=null&&g(e,["minLength"],v);const w=m(n,["minProperties"]);w!=null&&g(e,["minProperties"],w);const C=m(n,["minimum"]);C!=null&&g(e,["minimum"],C);const S=m(n,["nullable"]);S!=null&&g(e,["nullable"],S);const b=m(n,["pattern"]);b!=null&&g(e,["pattern"],b);const E=m(n,["properties"]);E!=null&&g(e,["properties"],E);const N=m(n,["propertyOrdering"]);N!=null&&g(e,["propertyOrdering"],N);const A=m(n,["required"]);A!=null&&g(e,["required"],A);const R=m(n,["title"]);R!=null&&g(e,["title"],R);const L=m(n,["type"]);return L!=null&&g(e,["type"],L),e}function e5(n){const e={},t=m(n,["featureSelectionPreference"]);return t!=null&&g(e,["featureSelectionPreference"],t),e}function t5(n){const e={},t=m(n,["method"]);t!=null&&g(e,["method"],t);const s=m(n,["category"]);s!=null&&g(e,["category"],s);const r=m(n,["threshold"]);return r!=null&&g(e,["threshold"],r),e}function n5(n){const e={};if(m(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=m(n,["description"]);t!=null&&g(e,["description"],t);const s=m(n,["name"]);s!=null&&g(e,["name"],s);const r=m(n,["parameters"]);r!=null&&g(e,["parameters"],r);const o=m(n,["parametersJsonSchema"]);o!=null&&g(e,["parametersJsonSchema"],o);const i=m(n,["response"]);i!=null&&g(e,["response"],i);const a=m(n,["responseJsonSchema"]);return a!=null&&g(e,["responseJsonSchema"],a),e}function s5(n){const e={},t=m(n,["startTime"]);t!=null&&g(e,["startTime"],t);const s=m(n,["endTime"]);return s!=null&&g(e,["endTime"],s),e}function r5(n){const e={},t=m(n,["timeRangeFilter"]);t!=null&&g(e,["timeRangeFilter"],s5(t));const s=m(n,["excludeDomains"]);return s!=null&&g(e,["excludeDomains"],s),e}function o5(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["dynamicThreshold"]);return s!=null&&g(e,["dynamicThreshold"],s),e}function i5(n){const e={},t=m(n,["dynamicRetrievalConfig"]);return t!=null&&g(e,["dynamicRetrievalConfig"],o5(t)),e}function a5(n){const e={},t=m(n,["excludeDomains"]);return t!=null&&g(e,["excludeDomains"],t),e}function l5(n){const e={},t=m(n,["apiKeyString"]);return t!=null&&g(e,["apiKeyString"],t),e}function u5(n){const e={},t=m(n,["apiKeyConfig"]);t!=null&&g(e,["apiKeyConfig"],l5(t));const s=m(n,["authType"]);s!=null&&g(e,["authType"],s);const r=m(n,["googleServiceAccountConfig"]);r!=null&&g(e,["googleServiceAccountConfig"],r);const o=m(n,["httpBasicAuthConfig"]);o!=null&&g(e,["httpBasicAuthConfig"],o);const i=m(n,["oauthConfig"]);i!=null&&g(e,["oauthConfig"],i);const a=m(n,["oidcConfig"]);return a!=null&&g(e,["oidcConfig"],a),e}function c5(n){const e={},t=m(n,["authConfig"]);return t!=null&&g(e,["authConfig"],u5(t)),e}function d5(){return{}}function f5(n){const e={},t=m(n,["environment"]);return t!=null&&g(e,["environment"],t),e}function ME(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let f=t;Array.isArray(f)&&(f=f.map(p=>n5(p))),g(e,["functionDeclarations"],f)}const s=m(n,["retrieval"]);s!=null&&g(e,["retrieval"],s);const r=m(n,["googleSearch"]);r!=null&&g(e,["googleSearch"],r5(r));const o=m(n,["googleSearchRetrieval"]);o!=null&&g(e,["googleSearchRetrieval"],i5(o));const i=m(n,["enterpriseWebSearch"]);i!=null&&g(e,["enterpriseWebSearch"],a5(i));const a=m(n,["googleMaps"]);a!=null&&g(e,["googleMaps"],c5(a)),m(n,["urlContext"])!=null&&g(e,["urlContext"],d5());const u=m(n,["computerUse"]);u!=null&&g(e,["computerUse"],f5(u));const d=m(n,["codeExecution"]);return d!=null&&g(e,["codeExecution"],d),e}function h5(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["allowedFunctionNames"]);return s!=null&&g(e,["allowedFunctionNames"],s),e}function p5(n){const e={},t=m(n,["latitude"]);t!=null&&g(e,["latitude"],t);const s=m(n,["longitude"]);return s!=null&&g(e,["longitude"],s),e}function m5(n){const e={},t=m(n,["latLng"]);t!=null&&g(e,["latLng"],p5(t));const s=m(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function g5(n){const e={},t=m(n,["functionCallingConfig"]);t!=null&&g(e,["functionCallingConfig"],h5(t));const s=m(n,["retrievalConfig"]);return s!=null&&g(e,["retrievalConfig"],m5(s)),e}function y5(n){const e={},t=m(n,["voiceName"]);return t!=null&&g(e,["voiceName"],t),e}function x5(n){const e={},t=m(n,["prebuiltVoiceConfig"]);return t!=null&&g(e,["prebuiltVoiceConfig"],y5(t)),e}function v5(n){const e={},t=m(n,["voiceConfig"]);if(t!=null&&g(e,["voiceConfig"],x5(t)),m(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=m(n,["languageCode"]);return s!=null&&g(e,["languageCode"],s),e}function w5(n){const e={},t=m(n,["includeThoughts"]);t!=null&&g(e,["includeThoughts"],t);const s=m(n,["thinkingBudget"]);return s!=null&&g(e,["thinkingBudget"],s),e}function C5(n,e,t){const s={},r=m(e,["systemInstruction"]);t!==void 0&&r!=null&&g(t,["systemInstruction"],Xu(Is(r)));const o=m(e,["temperature"]);o!=null&&g(s,["temperature"],o);const i=m(e,["topP"]);i!=null&&g(s,["topP"],i);const a=m(e,["topK"]);a!=null&&g(s,["topK"],a);const l=m(e,["candidateCount"]);l!=null&&g(s,["candidateCount"],l);const u=m(e,["maxOutputTokens"]);u!=null&&g(s,["maxOutputTokens"],u);const d=m(e,["stopSequences"]);d!=null&&g(s,["stopSequences"],d);const f=m(e,["responseLogprobs"]);f!=null&&g(s,["responseLogprobs"],f);const p=m(e,["logprobs"]);p!=null&&g(s,["logprobs"],p);const y=m(e,["presencePenalty"]);y!=null&&g(s,["presencePenalty"],y);const v=m(e,["frequencyPenalty"]);v!=null&&g(s,["frequencyPenalty"],v);const w=m(e,["seed"]);w!=null&&g(s,["seed"],w);const C=m(e,["responseMimeType"]);C!=null&&g(s,["responseMimeType"],C);const S=m(e,["responseSchema"]);S!=null&&g(s,["responseSchema"],j6(_2(S)));const b=m(e,["responseJsonSchema"]);b!=null&&g(s,["responseJsonSchema"],b);const E=m(e,["routingConfig"]);E!=null&&g(s,["routingConfig"],E);const N=m(e,["modelSelectionConfig"]);N!=null&&g(s,["modelConfig"],e5(N));const A=m(e,["safetySettings"]);if(t!==void 0&&A!=null){let ie=A;Array.isArray(ie)&&(ie=ie.map(de=>t5(de))),g(t,["safetySettings"],ie)}const R=m(e,["tools"]);if(t!==void 0&&R!=null){let ie=qu(R);Array.isArray(ie)&&(ie=ie.map(de=>ME(Hu(de)))),g(t,["tools"],ie)}const L=m(e,["toolConfig"]);t!==void 0&&L!=null&&g(t,["toolConfig"],g5(L));const z=m(e,["labels"]);t!==void 0&&z!=null&&g(t,["labels"],z);const M=m(e,["cachedContent"]);t!==void 0&&M!=null&&g(t,["cachedContent"],vi(n,M));const P=m(e,["responseModalities"]);P!=null&&g(s,["responseModalities"],P);const F=m(e,["mediaResolution"]);F!=null&&g(s,["mediaResolution"],F);const q=m(e,["speechConfig"]);q!=null&&g(s,["speechConfig"],v5(R2(q)));const ee=m(e,["audioTimestamp"]);ee!=null&&g(s,["audioTimestamp"],ee);const ue=m(e,["thinkingConfig"]);return ue!=null&&g(s,["thinkingConfig"],w5(ue)),s}function ok(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["contents"]);if(r!=null){let i=Lr(r);Array.isArray(i)&&(i=i.map(a=>Xu(a))),g(t,["contents"],i)}const o=m(e,["config"]);return o!=null&&g(t,["generationConfig"],C5(n,o,t)),t}function T5(n,e){const t={},s=m(n,["taskType"]);e!==void 0&&s!=null&&g(e,["instances[]","task_type"],s);const r=m(n,["title"]);e!==void 0&&r!=null&&g(e,["instances[]","title"],r);const o=m(n,["outputDimensionality"]);e!==void 0&&o!=null&&g(e,["parameters","outputDimensionality"],o);const i=m(n,["mimeType"]);e!==void 0&&i!=null&&g(e,["instances[]","mimeType"],i);const a=m(n,["autoTruncate"]);return e!==void 0&&a!=null&&g(e,["parameters","autoTruncate"],a),t}function S5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["contents"]);r!=null&&g(t,["instances[]","content"],gE(n,r));const o=m(e,["config"]);return o!=null&&g(t,["config"],T5(o,t)),t}function b5(n,e){const t={},s=m(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const r=m(n,["negativePrompt"]);e!==void 0&&r!=null&&g(e,["parameters","negativePrompt"],r);const o=m(n,["numberOfImages"]);e!==void 0&&o!=null&&g(e,["parameters","sampleCount"],o);const i=m(n,["aspectRatio"]);e!==void 0&&i!=null&&g(e,["parameters","aspectRatio"],i);const a=m(n,["guidanceScale"]);e!==void 0&&a!=null&&g(e,["parameters","guidanceScale"],a);const l=m(n,["seed"]);e!==void 0&&l!=null&&g(e,["parameters","seed"],l);const u=m(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&g(e,["parameters","safetySetting"],u);const d=m(n,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const f=m(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&g(e,["parameters","includeSafetyAttributes"],f);const p=m(n,["includeRaiReason"]);e!==void 0&&p!=null&&g(e,["parameters","includeRaiReason"],p);const y=m(n,["language"]);e!==void 0&&y!=null&&g(e,["parameters","language"],y);const v=m(n,["outputMimeType"]);e!==void 0&&v!=null&&g(e,["parameters","outputOptions","mimeType"],v);const w=m(n,["outputCompressionQuality"]);e!==void 0&&w!=null&&g(e,["parameters","outputOptions","compressionQuality"],w);const C=m(n,["addWatermark"]);e!==void 0&&C!=null&&g(e,["parameters","addWatermark"],C);const S=m(n,["imageSize"]);e!==void 0&&S!=null&&g(e,["parameters","sampleImageSize"],S);const b=m(n,["enhancePrompt"]);return e!==void 0&&b!=null&&g(e,["parameters","enhancePrompt"],b),t}function I5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);const o=m(e,["config"]);return o!=null&&g(t,["config"],b5(o,t)),t}function Oo(n){const e={},t=m(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const s=m(n,["imageBytes"]);s!=null&&g(e,["bytesBase64Encoded"],bl(s));const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function k5(n){const e={},t=m(n,["maskMode"]);t!=null&&g(e,["maskMode"],t);const s=m(n,["segmentationClasses"]);s!=null&&g(e,["maskClasses"],s);const r=m(n,["maskDilation"]);return r!=null&&g(e,["dilation"],r),e}function N5(n){const e={},t=m(n,["controlType"]);t!=null&&g(e,["controlType"],t);const s=m(n,["enableControlImageComputation"]);return s!=null&&g(e,["computeControl"],s),e}function E5(n){const e={},t=m(n,["styleDescription"]);return t!=null&&g(e,["styleDescription"],t),e}function $5(n){const e={},t=m(n,["subjectType"]);t!=null&&g(e,["subjectType"],t);const s=m(n,["subjectDescription"]);return s!=null&&g(e,["subjectDescription"],s),e}function A5(n){const e={},t=m(n,["referenceImage"]);t!=null&&g(e,["referenceImage"],Oo(t));const s=m(n,["referenceId"]);s!=null&&g(e,["referenceId"],s);const r=m(n,["referenceType"]);r!=null&&g(e,["referenceType"],r);const o=m(n,["maskImageConfig"]);o!=null&&g(e,["maskImageConfig"],k5(o));const i=m(n,["controlImageConfig"]);i!=null&&g(e,["controlImageConfig"],N5(i));const a=m(n,["styleImageConfig"]);a!=null&&g(e,["styleImageConfig"],E5(a));const l=m(n,["subjectImageConfig"]);return l!=null&&g(e,["subjectImageConfig"],$5(l)),e}function _5(n,e){const t={},s=m(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const r=m(n,["negativePrompt"]);e!==void 0&&r!=null&&g(e,["parameters","negativePrompt"],r);const o=m(n,["numberOfImages"]);e!==void 0&&o!=null&&g(e,["parameters","sampleCount"],o);const i=m(n,["aspectRatio"]);e!==void 0&&i!=null&&g(e,["parameters","aspectRatio"],i);const a=m(n,["guidanceScale"]);e!==void 0&&a!=null&&g(e,["parameters","guidanceScale"],a);const l=m(n,["seed"]);e!==void 0&&l!=null&&g(e,["parameters","seed"],l);const u=m(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&g(e,["parameters","safetySetting"],u);const d=m(n,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const f=m(n,["includeSafetyAttributes"]);e!==void 0&&f!=null&&g(e,["parameters","includeSafetyAttributes"],f);const p=m(n,["includeRaiReason"]);e!==void 0&&p!=null&&g(e,["parameters","includeRaiReason"],p);const y=m(n,["language"]);e!==void 0&&y!=null&&g(e,["parameters","language"],y);const v=m(n,["outputMimeType"]);e!==void 0&&v!=null&&g(e,["parameters","outputOptions","mimeType"],v);const w=m(n,["outputCompressionQuality"]);e!==void 0&&w!=null&&g(e,["parameters","outputOptions","compressionQuality"],w);const C=m(n,["addWatermark"]);e!==void 0&&C!=null&&g(e,["parameters","addWatermark"],C);const S=m(n,["editMode"]);e!==void 0&&S!=null&&g(e,["parameters","editMode"],S);const b=m(n,["baseSteps"]);return e!==void 0&&b!=null&&g(e,["parameters","editConfig","baseSteps"],b),t}function R5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);const o=m(e,["referenceImages"]);if(o!=null){let a=o;Array.isArray(a)&&(a=a.map(l=>A5(l))),g(t,["instances[0]","referenceImages"],a)}const i=m(e,["config"]);return i!=null&&g(t,["config"],_5(i,t)),t}function D5(n,e){const t={},s=m(n,["outputGcsUri"]);e!==void 0&&s!=null&&g(e,["parameters","storageUri"],s);const r=m(n,["includeRaiReason"]);e!==void 0&&r!=null&&g(e,["parameters","includeRaiReason"],r);const o=m(n,["outputMimeType"]);e!==void 0&&o!=null&&g(e,["parameters","outputOptions","mimeType"],o);const i=m(n,["outputCompressionQuality"]);e!==void 0&&i!=null&&g(e,["parameters","outputOptions","compressionQuality"],i);const a=m(n,["enhanceInputImage"]);e!==void 0&&a!=null&&g(e,["parameters","upscaleConfig","enhanceInputImage"],a);const l=m(n,["imagePreservationFactor"]);e!==void 0&&l!=null&&g(e,["parameters","upscaleConfig","imagePreservationFactor"],l);const u=m(n,["numberOfImages"]);e!==void 0&&u!=null&&g(e,["parameters","sampleCount"],u);const d=m(n,["mode"]);return e!==void 0&&d!=null&&g(e,["parameters","mode"],d),t}function F5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["image"]);r!=null&&g(t,["instances[0]","image"],Oo(r));const o=m(e,["upscaleFactor"]);o!=null&&g(t,["parameters","upscaleConfig","upscaleFactor"],o);const i=m(e,["config"]);return i!=null&&g(t,["config"],D5(i,t)),t}function M5(n){const e={},t=m(n,["productImage"]);return t!=null&&g(e,["image"],Oo(t)),e}function P5(n,e){const t={},s=m(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const r=m(n,["personImage"]);e!==void 0&&r!=null&&g(e,["instances[0]","personImage","image"],Oo(r));const o=m(n,["productImages"]);if(e!==void 0&&o!=null){let i=o;Array.isArray(i)&&(i=i.map(a=>M5(a))),g(e,["instances[0]","productImages"],i)}return t}function L5(n,e){const t={},s=m(n,["numberOfImages"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const r=m(n,["baseSteps"]);e!==void 0&&r!=null&&g(e,["parameters","editConfig","baseSteps"],r);const o=m(n,["outputGcsUri"]);e!==void 0&&o!=null&&g(e,["parameters","storageUri"],o);const i=m(n,["seed"]);e!==void 0&&i!=null&&g(e,["parameters","seed"],i);const a=m(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&g(e,["parameters","safetySetting"],a);const l=m(n,["personGeneration"]);e!==void 0&&l!=null&&g(e,["parameters","personGeneration"],l);const u=m(n,["addWatermark"]);e!==void 0&&u!=null&&g(e,["parameters","addWatermark"],u);const d=m(n,["outputMimeType"]);e!==void 0&&d!=null&&g(e,["parameters","outputOptions","mimeType"],d);const f=m(n,["outputCompressionQuality"]);e!==void 0&&f!=null&&g(e,["parameters","outputOptions","compressionQuality"],f);const p=m(n,["enhancePrompt"]);return e!==void 0&&p!=null&&g(e,["parameters","enhancePrompt"],p),t}function O5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["source"]);r!=null&&g(t,["config"],P5(r,t));const o=m(e,["config"]);return o!=null&&g(t,["config"],L5(o,t)),t}function V5(n){const e={},t=m(n,["image"]);return t!=null&&g(e,["image"],Oo(t)),e}function B5(n,e){const t={},s=m(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const r=m(n,["image"]);e!==void 0&&r!=null&&g(e,["instances[0]","image"],Oo(r));const o=m(n,["scribbleImage"]);return e!==void 0&&o!=null&&g(e,["instances[0]","scribble"],V5(o)),t}function z5(n,e){const t={},s=m(n,["mode"]);e!==void 0&&s!=null&&g(e,["parameters","mode"],s);const r=m(n,["maxPredictions"]);e!==void 0&&r!=null&&g(e,["parameters","maxPredictions"],r);const o=m(n,["confidenceThreshold"]);e!==void 0&&o!=null&&g(e,["parameters","confidenceThreshold"],o);const i=m(n,["maskDilation"]);e!==void 0&&i!=null&&g(e,["parameters","maskDilation"],i);const a=m(n,["binaryColorThreshold"]);return e!==void 0&&a!=null&&g(e,["parameters","binaryColorThreshold"],a),t}function U5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["source"]);r!=null&&g(t,["config"],B5(r,t));const o=m(e,["config"]);return o!=null&&g(t,["config"],z5(o,t)),t}function W5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","name"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function G5(n,e,t){const s={},r=m(e,["pageSize"]);t!==void 0&&r!=null&&g(t,["_query","pageSize"],r);const o=m(e,["pageToken"]);t!==void 0&&o!=null&&g(t,["_query","pageToken"],o);const i=m(e,["filter"]);t!==void 0&&i!=null&&g(t,["_query","filter"],i);const a=m(e,["queryBase"]);return t!==void 0&&a!=null&&g(t,["_url","models_url"],vE(n,a)),s}function H5(n,e){const t={},s=m(e,["config"]);return s!=null&&g(t,["config"],G5(n,s,t)),t}function q5(n,e){const t={},s=m(n,["displayName"]);e!==void 0&&s!=null&&g(e,["displayName"],s);const r=m(n,["description"]);e!==void 0&&r!=null&&g(e,["description"],r);const o=m(n,["defaultCheckpointId"]);return e!==void 0&&o!=null&&g(e,["defaultCheckpointId"],o),t}function K5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],q5(r,t)),t}function X5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","name"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],r),t}function J5(n,e){const t={},s=m(n,["systemInstruction"]);e!==void 0&&s!=null&&g(e,["systemInstruction"],Xu(Is(s)));const r=m(n,["tools"]);if(e!==void 0&&r!=null){let i=r;Array.isArray(i)&&(i=i.map(a=>ME(a))),g(e,["tools"],i)}const o=m(n,["generationConfig"]);return e!==void 0&&o!=null&&g(e,["generationConfig"],o),t}function Y5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["contents"]);if(r!=null){let i=Lr(r);Array.isArray(i)&&(i=i.map(a=>Xu(a))),g(t,["contents"],i)}const o=m(e,["config"]);return o!=null&&g(t,["config"],J5(o,t)),t}function Q5(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["contents"]);if(r!=null){let i=Lr(r);Array.isArray(i)&&(i=i.map(a=>Xu(a))),g(t,["contents"],i)}const o=m(e,["config"]);return o!=null&&g(t,["config"],o),t}function PE(n){const e={},t=m(n,["uri"]);t!=null&&g(e,["gcsUri"],t);const s=m(n,["videoBytes"]);s!=null&&g(e,["bytesBase64Encoded"],bl(s));const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function Z5(n,e){const t={},s=m(n,["prompt"]);e!==void 0&&s!=null&&g(e,["instances[0]","prompt"],s);const r=m(n,["image"]);e!==void 0&&r!=null&&g(e,["instances[0]","image"],Oo(r));const o=m(n,["video"]);return e!==void 0&&o!=null&&g(e,["instances[0]","video"],PE(o)),t}function j5(n){const e={},t=m(n,["image"]);t!=null&&g(e,["image"],Oo(t));const s=m(n,["referenceType"]);return s!=null&&g(e,["referenceType"],s),e}function eB(n,e){const t={},s=m(n,["numberOfVideos"]);e!==void 0&&s!=null&&g(e,["parameters","sampleCount"],s);const r=m(n,["outputGcsUri"]);e!==void 0&&r!=null&&g(e,["parameters","storageUri"],r);const o=m(n,["fps"]);e!==void 0&&o!=null&&g(e,["parameters","fps"],o);const i=m(n,["durationSeconds"]);e!==void 0&&i!=null&&g(e,["parameters","durationSeconds"],i);const a=m(n,["seed"]);e!==void 0&&a!=null&&g(e,["parameters","seed"],a);const l=m(n,["aspectRatio"]);e!==void 0&&l!=null&&g(e,["parameters","aspectRatio"],l);const u=m(n,["resolution"]);e!==void 0&&u!=null&&g(e,["parameters","resolution"],u);const d=m(n,["personGeneration"]);e!==void 0&&d!=null&&g(e,["parameters","personGeneration"],d);const f=m(n,["pubsubTopic"]);e!==void 0&&f!=null&&g(e,["parameters","pubsubTopic"],f);const p=m(n,["negativePrompt"]);e!==void 0&&p!=null&&g(e,["parameters","negativePrompt"],p);const y=m(n,["enhancePrompt"]);e!==void 0&&y!=null&&g(e,["parameters","enhancePrompt"],y);const v=m(n,["generateAudio"]);e!==void 0&&v!=null&&g(e,["parameters","generateAudio"],v);const w=m(n,["lastFrame"]);e!==void 0&&w!=null&&g(e,["instances[0]","lastFrame"],Oo(w));const C=m(n,["referenceImages"]);if(e!==void 0&&C!=null){let b=C;Array.isArray(b)&&(b=b.map(E=>j5(E))),g(e,["instances[0]","referenceImages"],b)}const S=m(n,["compressionQuality"]);return e!==void 0&&S!=null&&g(e,["parameters","compressionQuality"],S),t}function tB(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["_url","model"],Pt(n,s));const r=m(e,["prompt"]);r!=null&&g(t,["instances[0]","prompt"],r);const o=m(e,["image"]);o!=null&&g(t,["instances[0]","image"],Oo(o));const i=m(e,["video"]);i!=null&&g(t,["instances[0]","video"],PE(i));const a=m(e,["source"]);a!=null&&g(t,["config"],Z5(a,t));const l=m(e,["config"]);return l!=null&&g(t,["config"],eB(l,t)),t}function nB(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function sB(n){const e={},t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function rB(n){const e={},t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function oB(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],nB(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],sB(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],rB(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function iB(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>oB(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function aB(n){const e={},t=m(n,["citationSources"]);return t!=null&&g(e,["citations"],t),e}function lB(n){const e={},t=m(n,["retrievedUrl"]);t!=null&&g(e,["retrievedUrl"],t);const s=m(n,["urlRetrievalStatus"]);return s!=null&&g(e,["urlRetrievalStatus"],s),e}function uB(n){const e={},t=m(n,["urlMetadata"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>lB(r))),g(e,["urlMetadata"],s)}return e}function cB(n){const e={},t=m(n,["content"]);t!=null&&g(e,["content"],iB(t));const s=m(n,["citationMetadata"]);s!=null&&g(e,["citationMetadata"],aB(s));const r=m(n,["tokenCount"]);r!=null&&g(e,["tokenCount"],r);const o=m(n,["finishReason"]);o!=null&&g(e,["finishReason"],o);const i=m(n,["urlContextMetadata"]);i!=null&&g(e,["urlContextMetadata"],uB(i));const a=m(n,["avgLogprobs"]);a!=null&&g(e,["avgLogprobs"],a);const l=m(n,["groundingMetadata"]);l!=null&&g(e,["groundingMetadata"],l);const u=m(n,["index"]);u!=null&&g(e,["index"],u);const d=m(n,["logprobsResult"]);d!=null&&g(e,["logprobsResult"],d);const f=m(n,["safetyRatings"]);return f!=null&&g(e,["safetyRatings"],f),e}function ik(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["candidates"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(u=>cB(u))),g(e,["candidates"],l)}const r=m(n,["modelVersion"]);r!=null&&g(e,["modelVersion"],r);const o=m(n,["promptFeedback"]);o!=null&&g(e,["promptFeedback"],o);const i=m(n,["responseId"]);i!=null&&g(e,["responseId"],i);const a=m(n,["usageMetadata"]);return a!=null&&g(e,["usageMetadata"],a),e}function dB(n){const e={},t=m(n,["values"]);return t!=null&&g(e,["values"],t),e}function fB(){return{}}function hB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["embeddings"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>dB(i))),g(e,["embeddings"],o)}return m(n,["metadata"])!=null&&g(e,["metadata"],fB()),e}function pB(n){const e={},t=m(n,["bytesBase64Encoded"]);t!=null&&g(e,["imageBytes"],bl(t));const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function LE(n){const e={},t=m(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const s=m(n,["safetyAttributes","scores"]);s!=null&&g(e,["scores"],s);const r=m(n,["contentType"]);return r!=null&&g(e,["contentType"],r),e}function mB(n){const e={},t=m(n,["_self"]);t!=null&&g(e,["image"],pB(t));const s=m(n,["raiFilteredReason"]);s!=null&&g(e,["raiFilteredReason"],s);const r=m(n,["_self"]);return r!=null&&g(e,["safetyAttributes"],LE(r)),e}function gB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>mB(i))),g(e,["generatedImages"],o)}const r=m(n,["positivePromptSafetyAttributes"]);return r!=null&&g(e,["positivePromptSafetyAttributes"],LE(r)),e}function yB(n){const e={},t=m(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);const s=m(n,["createTime"]);s!=null&&g(e,["createTime"],s);const r=m(n,["updateTime"]);return r!=null&&g(e,["updateTime"],r),e}function Nv(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["displayName"]);s!=null&&g(e,["displayName"],s);const r=m(n,["description"]);r!=null&&g(e,["description"],r);const o=m(n,["version"]);o!=null&&g(e,["version"],o);const i=m(n,["_self"]);i!=null&&g(e,["tunedModelInfo"],yB(i));const a=m(n,["inputTokenLimit"]);a!=null&&g(e,["inputTokenLimit"],a);const l=m(n,["outputTokenLimit"]);l!=null&&g(e,["outputTokenLimit"],l);const u=m(n,["supportedGenerationMethods"]);return u!=null&&g(e,["supportedActions"],u),e}function xB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["_self"]);if(r!=null){let o=wE(r);Array.isArray(o)&&(o=o.map(i=>Nv(i))),g(e,["models"],o)}return e}function vB(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function wB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["totalTokens"]);s!=null&&g(e,["totalTokens"],s);const r=m(n,["cachedContentTokenCount"]);return r!=null&&g(e,["cachedContentTokenCount"],r),e}function CB(n){const e={},t=m(n,["video","uri"]);t!=null&&g(e,["uri"],t);const s=m(n,["video","encodedVideo"]);s!=null&&g(e,["videoBytes"],bl(s));const r=m(n,["encoding"]);return r!=null&&g(e,["mimeType"],r),e}function TB(n){const e={},t=m(n,["_self"]);return t!=null&&g(e,["video"],CB(t)),e}function SB(n){const e={},t=m(n,["generatedSamples"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(i=>TB(i))),g(e,["generatedVideos"],o)}const s=m(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const r=m(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function bB(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["metadata"]);s!=null&&g(e,["metadata"],s);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const o=m(n,["error"]);o!=null&&g(e,["error"],o);const i=m(n,["response","generateVideoResponse"]);return i!=null&&g(e,["response"],SB(i)),e}function IB(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function kB(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["data"]);s!=null&&g(e,["data"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function NB(n){const e={},t=m(n,["displayName"]);t!=null&&g(e,["displayName"],t);const s=m(n,["fileUri"]);s!=null&&g(e,["fileUri"],s);const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function EB(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],IB(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],kB(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],NB(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function $B(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>EB(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function AB(n){const e={},t=m(n,["citations"]);return t!=null&&g(e,["citations"],t),e}function _B(n){const e={},t=m(n,["retrievedUrl"]);t!=null&&g(e,["retrievedUrl"],t);const s=m(n,["urlRetrievalStatus"]);return s!=null&&g(e,["urlRetrievalStatus"],s),e}function RB(n){const e={},t=m(n,["urlMetadata"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>_B(r))),g(e,["urlMetadata"],s)}return e}function DB(n){const e={},t=m(n,["content"]);t!=null&&g(e,["content"],$B(t));const s=m(n,["citationMetadata"]);s!=null&&g(e,["citationMetadata"],AB(s));const r=m(n,["finishMessage"]);r!=null&&g(e,["finishMessage"],r);const o=m(n,["finishReason"]);o!=null&&g(e,["finishReason"],o);const i=m(n,["urlContextMetadata"]);i!=null&&g(e,["urlContextMetadata"],RB(i));const a=m(n,["avgLogprobs"]);a!=null&&g(e,["avgLogprobs"],a);const l=m(n,["groundingMetadata"]);l!=null&&g(e,["groundingMetadata"],l);const u=m(n,["index"]);u!=null&&g(e,["index"],u);const d=m(n,["logprobsResult"]);d!=null&&g(e,["logprobsResult"],d);const f=m(n,["safetyRatings"]);return f!=null&&g(e,["safetyRatings"],f),e}function ak(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["candidates"]);if(s!=null){let u=s;Array.isArray(u)&&(u=u.map(d=>DB(d))),g(e,["candidates"],u)}const r=m(n,["createTime"]);r!=null&&g(e,["createTime"],r);const o=m(n,["modelVersion"]);o!=null&&g(e,["modelVersion"],o);const i=m(n,["promptFeedback"]);i!=null&&g(e,["promptFeedback"],i);const a=m(n,["responseId"]);a!=null&&g(e,["responseId"],a);const l=m(n,["usageMetadata"]);return l!=null&&g(e,["usageMetadata"],l),e}function FB(n){const e={},t=m(n,["truncated"]);t!=null&&g(e,["truncated"],t);const s=m(n,["token_count"]);return s!=null&&g(e,["tokenCount"],s),e}function MB(n){const e={},t=m(n,["values"]);t!=null&&g(e,["values"],t);const s=m(n,["statistics"]);return s!=null&&g(e,["statistics"],FB(s)),e}function PB(n){const e={},t=m(n,["billableCharacterCount"]);return t!=null&&g(e,["billableCharacterCount"],t),e}function LB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["predictions[]","embeddings"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>MB(i))),g(e,["embeddings"],o)}const r=m(n,["metadata"]);return r!=null&&g(e,["metadata"],PB(r)),e}function OE(n){const e={},t=m(n,["gcsUri"]);t!=null&&g(e,["gcsUri"],t);const s=m(n,["bytesBase64Encoded"]);s!=null&&g(e,["imageBytes"],bl(s));const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function VE(n){const e={},t=m(n,["safetyAttributes","categories"]);t!=null&&g(e,["categories"],t);const s=m(n,["safetyAttributes","scores"]);s!=null&&g(e,["scores"],s);const r=m(n,["contentType"]);return r!=null&&g(e,["contentType"],r),e}function Gg(n){const e={},t=m(n,["_self"]);t!=null&&g(e,["image"],OE(t));const s=m(n,["raiFilteredReason"]);s!=null&&g(e,["raiFilteredReason"],s);const r=m(n,["_self"]);r!=null&&g(e,["safetyAttributes"],VE(r));const o=m(n,["prompt"]);return o!=null&&g(e,["enhancedPrompt"],o),e}function OB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["predictions"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(i=>Gg(i))),g(e,["generatedImages"],o)}const r=m(n,["positivePromptSafetyAttributes"]);return r!=null&&g(e,["positivePromptSafetyAttributes"],VE(r)),e}function VB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Gg(o))),g(e,["generatedImages"],r)}return e}function BB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Gg(o))),g(e,["generatedImages"],r)}return e}function zB(n){const e={},t=m(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>Gg(r))),g(e,["generatedImages"],s)}return e}function UB(n){const e={},t=m(n,["label"]);t!=null&&g(e,["label"],t);const s=m(n,["score"]);return s!=null&&g(e,["score"],s),e}function WB(n){const e={},t=m(n,["_self"]);t!=null&&g(e,["mask"],OE(t));const s=m(n,["labels"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>UB(o))),g(e,["labels"],r)}return e}function GB(n){const e={},t=m(n,["predictions"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>WB(r))),g(e,["generatedMasks"],s)}return e}function HB(n){const e={},t=m(n,["endpoint"]);t!=null&&g(e,["name"],t);const s=m(n,["deployedModelId"]);return s!=null&&g(e,["deployedModelId"],s),e}function qB(n){const e={},t=m(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&g(e,["baseModel"],t);const s=m(n,["createTime"]);s!=null&&g(e,["createTime"],s);const r=m(n,["updateTime"]);return r!=null&&g(e,["updateTime"],r),e}function KB(n){const e={},t=m(n,["checkpointId"]);t!=null&&g(e,["checkpointId"],t);const s=m(n,["epoch"]);s!=null&&g(e,["epoch"],s);const r=m(n,["step"]);return r!=null&&g(e,["step"],r),e}function Ev(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["displayName"]);s!=null&&g(e,["displayName"],s);const r=m(n,["description"]);r!=null&&g(e,["description"],r);const o=m(n,["versionId"]);o!=null&&g(e,["version"],o);const i=m(n,["deployedModels"]);if(i!=null){let f=i;Array.isArray(f)&&(f=f.map(p=>HB(p))),g(e,["endpoints"],f)}const a=m(n,["labels"]);a!=null&&g(e,["labels"],a);const l=m(n,["_self"]);l!=null&&g(e,["tunedModelInfo"],qB(l));const u=m(n,["defaultCheckpointId"]);u!=null&&g(e,["defaultCheckpointId"],u);const d=m(n,["checkpoints"]);if(d!=null){let f=d;Array.isArray(f)&&(f=f.map(p=>KB(p))),g(e,["checkpoints"],f)}return e}function XB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["_self"]);if(r!=null){let o=wE(r);Array.isArray(o)&&(o=o.map(i=>Ev(i))),g(e,["models"],o)}return e}function JB(n){const e={},t=m(n,["sdkHttpResponse"]);return t!=null&&g(e,["sdkHttpResponse"],t),e}function YB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["totalTokens"]);return s!=null&&g(e,["totalTokens"],s),e}function QB(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["tokensInfo"]);return s!=null&&g(e,["tokensInfo"],s),e}function ZB(n){const e={},t=m(n,["gcsUri"]);t!=null&&g(e,["uri"],t);const s=m(n,["bytesBase64Encoded"]);s!=null&&g(e,["videoBytes"],bl(s));const r=m(n,["mimeType"]);return r!=null&&g(e,["mimeType"],r),e}function jB(n){const e={},t=m(n,["_self"]);return t!=null&&g(e,["video"],ZB(t)),e}function ez(n){const e={},t=m(n,["videos"]);if(t!=null){let o=t;Array.isArray(o)&&(o=o.map(i=>jB(i))),g(e,["generatedVideos"],o)}const s=m(n,["raiMediaFilteredCount"]);s!=null&&g(e,["raiMediaFilteredCount"],s);const r=m(n,["raiMediaFilteredReasons"]);return r!=null&&g(e,["raiMediaFilteredReasons"],r),e}function tz(n){const e={},t=m(n,["name"]);t!=null&&g(e,["name"],t);const s=m(n,["metadata"]);s!=null&&g(e,["metadata"],s);const r=m(n,["done"]);r!=null&&g(e,["done"],r);const o=m(n,["error"]);o!=null&&g(e,["error"],o);const i=m(n,["response"]);return i!=null&&g(e,["response"],ez(i)),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const nz="Content-Type",sz="X-Server-Timeout",rz="User-Agent",$v="x-goog-api-client",oz="1.17.0",iz=`google-genai-sdk/${oz}`,az="v1beta1",lz="v1beta",lk=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class uz{constructor(e){var t,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:az,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:lz,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,s){const r=[this.getRequestUrlInternal(t)];return s&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,s);if(e.queryParams)for(const[i,a]of Object.entries(e.queryParams))r.searchParams.append(i,String(a));let o={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else o.body=e.body;return o=await this.includeExtraHttpOptionsToRequestInit(o,t,e.abortSignal),this.unaryApiCall(r,o,e.httpMethod)}patchHttpOptions(e,t){const s=JSON.parse(JSON.stringify(e));for(const[r,o]of Object.entries(t))typeof o=="object"?s[r]=Object.assign(Object.assign({},s[r]),o):o!==void 0&&(s[r]=o);return s}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,s);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let o={};return o.body=e.body,o=await this.includeExtraHttpOptionsToRequestInit(o,t,e.abortSignal),this.streamApiCall(r,o,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,s){if(t&&t.timeout||s){const r=new AbortController,o=r.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const i=setTimeout(()=>r.abort(),t.timeout);i&&typeof i.unref=="function"&&i.unref()}s&&s.addEventListener("abort",()=>{r.abort()}),e.signal=o}return t&&t.extraBody!==null&&cz(e,t.extraBody),e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async r=>(await uk(r),new Tv(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async r=>(await uk(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return Iu(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),o=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let i="";for(;;){const{done:a,value:l}=yield en(r.read());if(a){if(i.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=o.decode(l,{stream:!0});try{const f=JSON.parse(u);if("error"in f){const p=JSON.parse(JSON.stringify(f.error)),y=p.status,v=p.code,w=`got status: ${y}. ${JSON.stringify(f)}`;if(v>=400&&v<600)throw new Ug({message:w,status:v})}}catch(f){if(f.name==="ApiError")throw f}i+=u;let d=i.match(lk);for(;d;){const f=d[1];try{const p=new Response(f,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield en(new Tv(p)),i=i.slice(d[0].length),d=i.match(lk)}catch(p){throw new Error(`exception parsing stream chunk ${f}. ${p}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},t=iz+" "+this.clientOptions.userAgentExtra;return e[rz]=t,e[$v]=t,e[nz]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[s,r]of Object.entries(e.headers))t.append(s,r);e.timeout&&e.timeout>0&&t.append(sz,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var s;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const o=this.clientOptions.uploader,i=await o.stat(e);r.sizeBytes=String(i.size);const a=(s=t==null?void 0:t.mimeType)!==null&&s!==void 0?s:i.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=a;const l=await this.fetchUploadUrl(r,t);return o.upload(e,l,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var s;let r={};t!=null&&t.httpOptions?r=t.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const o={file:e},i=await this.request({path:Xe("upload/v1beta/files",o._url),body:JSON.stringify(o),httpMethod:"POST",httpOptions:r});if(!i||!(i!=null&&i.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const a=(s=i==null?void 0:i.headers)===null||s===void 0?void 0:s["x-goog-upload-url"];if(a===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return a}}async function uk(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const r=JSON.stringify(s);throw t>=400&&t<600?new Ug({message:r,status:t}):new Error(r)}}function cz(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const o=JSON.parse(n.body);if(typeof o=="object"&&o!==null&&!Array.isArray(o))t=o;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function s(o,i){const a=Object.assign({},o);for(const l in i)if(Object.prototype.hasOwnProperty.call(i,l)){const u=i[l],d=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&d&&typeof d=="object"&&!Array.isArray(d)?a[l]=s(d,u):(d&&u&&typeof d!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof d}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const r=s(t,e);n.body=JSON.stringify(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const dz="mcp_used/unknown";let fz=!1;function BE(n){for(const e of n)if(hz(e)||typeof e=="object"&&"inputSchema"in e)return!0;return fz}function zE(n){var e;const t=(e=n[$v])!==null&&e!==void 0?e:"";n[$v]=(t+` ${dz}`).trimStart()}function hz(n){return n!==null&&typeof n=="object"&&n instanceof F2}function pz(n,e=100){return Iu(this,arguments,function*(){let s,r=0;for(;r<e;){const o=yield en(n.listTools({cursor:s}));for(const i of o.tools)yield yield en(i),r++;if(!o.nextCursor)break;s=o.nextCursor}})}class F2{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new F2(e,t)}async initialize(){var e,t,s,r;if(this.mcpTools.length>0)return;const o={},i=[];for(const d of this.mcpClients)try{for(var a=!0,l=(t=void 0,of(pz(d))),u;u=await l.next(),e=u.done,!e;a=!0){r=u.value,a=!1;const f=r;i.push(f);const p=f.name;if(o[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);o[p]=d}}catch(f){t={error:f}}finally{try{!a&&!e&&(s=l.return)&&await s.call(l)}finally{if(t)throw t.error}}this.mcpTools=i,this.functionNameToMcpClient=o}async tool(){return await this.initialize(),HM(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const s of e)if(s.name in this.functionNameToMcpClient){const r=this.functionNameToMcpClient[s.name];let o;this.config.timeout&&(o={timeout:this.config.timeout});const i=await r.callTool({name:s.name,arguments:s.args},void 0,o);t.push({functionResponse:{name:s.name,response:i.isError?{error:i}:i}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function mz(n,e,t){const s=new LM;let r;t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data);const o=JV(r);Object.assign(s,o),e(s)}class gz{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s}async connect(e){var t,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),o=this.apiClient.getApiVersion(),i=vz(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${r}/ws/google.ai.generativelanguage.${o}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const d=new Promise(E=>{u=E}),f=e.callbacks,p=function(){u({})},y=this.apiClient,v={onopen:p,onmessage:E=>{mz(y,f.onmessage,E)},onerror:(t=f==null?void 0:f.onerror)!==null&&t!==void 0?t:function(E){},onclose:(s=f==null?void 0:f.onclose)!==null&&s!==void 0?s:function(E){}},w=this.webSocketFactory.create(l,xz(i),v);w.connect(),await d;const C=Pt(this.apiClient,e.model),S=_E({model:C}),b=kv({setup:S});return w.send(JSON.stringify(b)),new yz(w,this.apiClient)}}class yz{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=qO(e),s=RE(t);this.conn.send(JSON.stringify({clientContent:s}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=KO(e),s=kv(t);this.conn.send(JSON.stringify(s))}sendPlaybackControl(e){const t=kv({playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Tu.PLAY)}pause(){this.sendPlaybackControl(Tu.PAUSE)}stop(){this.sendPlaybackControl(Tu.STOP)}resetContext(){this.sendPlaybackControl(Tu.RESET_CONTEXT)}close(){this.conn.close()}}function xz(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function vz(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wz="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Cz(n,e,t){const s=new PM;let r;t.data instanceof Blob?r=await t.data.text():t.data instanceof ArrayBuffer?r=new TextDecoder().decode(t.data):r=t.data;const o=JSON.parse(r);if(n.isVertexAI()){const i=u6(o);Object.assign(s,i)}else{const i=BV(o);Object.assign(s,i)}e(s)}class Tz{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s,this.music=new gz(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,s,r,o,i,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let d;const f=this.apiClient.getHeaders();e.config&&e.config.tools&&BE(e.config.tools)&&zE(f);const p=kz(f);if(this.apiClient.isVertexAI())d=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p);else{const M=this.apiClient.getApiKey();let P="BidiGenerateContent",F="key";M!=null&&M.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),P="BidiGenerateContentConstrained",F="access_token"),d=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${P}?${F}=${M}`}let y=()=>{};const v=new Promise(M=>{y=M}),w=e.callbacks,C=function(){var M;(M=w==null?void 0:w.onopen)===null||M===void 0||M.call(w),y({})},S=this.apiClient,b={onopen:C,onmessage:M=>{Cz(S,w.onmessage,M)},onerror:(t=w==null?void 0:w.onerror)!==null&&t!==void 0?t:function(M){},onclose:(s=w==null?void 0:w.onclose)!==null&&s!==void 0?s:function(M){}},E=this.webSocketFactory.create(d,Iz(p),b);E.connect(),await v;let N=Pt(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&N.startsWith("publishers/")){const M=this.apiClient.getProject(),P=this.apiClient.getLocation();N=`projects/${M}/locations/${P}/`+N}let A={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[og.AUDIO]}:e.config.responseModalities=[og.AUDIO]),!((o=e.config)===null||o===void 0)&&o.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const R=(a=(i=e.config)===null||i===void 0?void 0:i.tools)!==null&&a!==void 0?a:[],L=[];for(const M of R)if(this.isCallableTool(M)){const P=M;L.push(await P.tool())}else L.push(M);L.length>0&&(e.config.tools=L);const z={model:N,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?A=CV(this.apiClient,z):A=UO(this.apiClient,z),delete A.config,E.send(JSON.stringify(A)),new bz(E,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const Sz={turnComplete:!0};class bz{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let s=[];try{s=Lr(t.turns),e.isVertexAI()?s=s.map(r=>Xu(r)):s=s.map(r=>Wg(r))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:s,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let s=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?s=t.functionResponses:s=[t.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const o of s){if(typeof o!="object"||o===null||!("name"in o)||!("response"in o))throw new Error(`Could not parse function response, type '${typeof o}'.`);if(!e.isVertexAI()&&!("id"in o))throw new Error(wz)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},Sz),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:bV(e)}:t={realtimeInput:HO(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function Iz(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function kz(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const ck=10;function dk(n){var e,t,s;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const i of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(ku(i)){r=!0;break}if(!r)return!0;const o=(s=n==null?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return o&&(o<0||!Number.isInteger(o))||o==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",o),!0):!1}function ku(n){return"callTool"in n&&typeof n.callTool=="function"}function Nz(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>ku(r)))!==null&&s!==void 0?s:!1}function Ez(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>!ku(r)))!==null&&s!==void 0?s:!1}function fk(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class $z extends Sl{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var s,r,o,i,a;const l=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!Nz(t)||dk(t.config))return await this.generateContentInternal(l);if(Ez(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,d;const f=Lr(l.contents),p=(o=(r=(s=l.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&o!==void 0?o:ck;let y=0;for(;y<p&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const v=u.candidates[0].content,w=[];for(const C of(a=(i=t.config)===null||i===void 0?void 0:i.tools)!==null&&a!==void 0?a:[])if(ku(C)){const b=await C.callTool(u.functionCalls);w.push(...b)}y++,d={role:"user",parts:w},l.contents=Lr(l.contents),l.contents.push(v),l.contents.push(d),fk(l.config)&&(f.push(v),f.push(d))}return fk(l.config)&&(u.automaticFunctionCallingHistory=f),u},this.generateContentStream=async t=>{if(this.maybeMoveToResponseJsonSchem(t),dk(t.config)){const s=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(s)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(s=>{var r;let o;const i=[];if(s!=null&&s.generatedImages)for(const l of s.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((r=l==null?void 0:l.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?o=l==null?void 0:l.safetyAttributes:i.push(l);let a;return o?a={generatedImages:i,positivePromptSafetyAttributes:o,sdkHttpResponse:s.sdkHttpResponse}:a={generatedImages:i,sdkHttpResponse:s.sdkHttpResponse},a}),this.list=async t=>{var s;const i={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!i.config.queryBase){if(!((s=i.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");i.config.filter="labels.tune-type:*"}return new If(ll.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(i),i)},this.editImage=async t=>{const s={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(s.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async t=>{let s={numberOfImages:1,mode:"upscale"};t.config&&(s=Object.assign(Object.assign({},s),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:s};return await this.upscaleImageInternal(r)},this.generateVideos=async t=>{if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,s,r;const o=(t=e.config)===null||t===void 0?void 0:t.tools;if(!o)return e;const i=await Promise.all(o.map(async l=>ku(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:i})};if(a.config.tools=i,e.config&&e.config.tools&&BE(e.config.tools)){const l=(r=(s=e.config.httpOptions)===null||s===void 0?void 0:s.headers)!==null&&r!==void 0?r:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),zE(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var t,s,r;const o=new Map;for(const i of(s=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&s!==void 0?s:[])if(ku(i)){const a=i,l=await a.tool();for(const u of(r=l.functionDeclarations)!==null&&r!==void 0?r:[]){if(!u.name)throw new Error("Function declaration name is required.");if(o.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);o.set(u.name,a)}}return o}async processAfcStream(e){var t,s,r;const o=(r=(s=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:ck;let i=!1,a=0;const l=await this.initAfcToolsMap(e);return(function(u,d,f){var p,y;return Iu(this,arguments,function*(){for(var v,w,C,S;a<o;){i&&(a++,i=!1);const A=yield en(u.processParamsMaybeAddMcpUsage(f)),R=yield en(u.generateContentStreamInternal(A)),L=[],z=[];try{for(var b=!0,E=(w=void 0,of(R)),N;N=yield en(E.next()),v=N.done,!v;b=!0){S=N.value,b=!1;const M=S;if(yield yield en(M),M.candidates&&(!((p=M.candidates[0])===null||p===void 0)&&p.content)){z.push(M.candidates[0].content);for(const P of(y=M.candidates[0].content.parts)!==null&&y!==void 0?y:[])if(a<o&&P.functionCall){if(!P.functionCall.name)throw new Error("Function call name was not returned by the model.");if(d.has(P.functionCall.name)){const F=yield en(d.get(P.functionCall.name).callTool([P.functionCall]));L.push(...F)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${d.keys()}, mising tool: ${P.functionCall.name}`)}}}}catch(M){w={error:M}}finally{try{!b&&!v&&(C=E.return)&&(yield en(C.call(E)))}finally{if(w)throw w.error}}if(L.length>0){i=!0;const M=new Kd;M.candidates=[{content:{role:"user",parts:L}}],yield yield en(M);const P=[];P.push(...z),P.push({role:"user",parts:L});const F=Lr(f.contents).concat(P);f.contents=F}else break}})})(this,l,e)}async generateContentInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=ok(this.apiClient,e);return a=Xe("{model}:generateContent",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=ak(d),p=new Kd;return Object.assign(p,f),p})}else{const u=rk(this.apiClient,e);return a=Xe("{model}:generateContent",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=ik(d),p=new Kd;return Object.assign(p,f),p})}}async generateContentStreamInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=ok(this.apiClient,e);return a=Xe("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),i.then(function(f){return Iu(this,arguments,function*(){var p,y,v,w;try{for(var C=!0,S=of(f),b;b=yield en(S.next()),p=b.done,!p;C=!0){w=b.value,C=!1;const E=w,N=ak(yield en(E.json()));N.sdkHttpResponse={headers:E.headers};const A=new Kd;Object.assign(A,N),yield yield en(A)}}catch(E){y={error:E}}finally{try{!C&&!p&&(v=S.return)&&(yield en(v.call(S)))}finally{if(y)throw y.error}}})})}else{const u=rk(this.apiClient,e);return a=Xe("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}),i.then(function(f){return Iu(this,arguments,function*(){var p,y,v,w;try{for(var C=!0,S=of(f),b;b=yield en(S.next()),p=b.done,!p;C=!0){w=b.value,C=!1;const E=w,N=ik(yield en(E.json()));N.sdkHttpResponse={headers:E.headers};const A=new Kd;Object.assign(A,N),yield yield en(A)}}catch(E){y={error:E}}finally{try{!C&&!p&&(v=S.return)&&(yield en(v.call(S)))}finally{if(y)throw y.error}}})})}}async embedContent(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=S5(this.apiClient,e);return a=Xe("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=LB(d),p=new PI;return Object.assign(p,f),p})}else{const u=M6(this.apiClient,e);return a=Xe("{model}:batchEmbedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=hB(d),p=new PI;return Object.assign(p,f),p})}}async generateImagesInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=I5(this.apiClient,e);return a=Xe("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=OB(d),p=new LI;return Object.assign(p,f),p})}else{const u=L6(this.apiClient,e);return a=Xe("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=gB(d),p=new LI;return Object.assign(p,f),p})}}async editImageInternal(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI()){const a=R5(this.apiClient,e);return o=Xe("{model}:predict",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),r.then(l=>{const u=VB(l),d=new EM;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI()){const a=F5(this.apiClient,e);return o=Xe("{model}:predict",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),r.then(l=>{const u=BB(l),d=new $M;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI()){const a=O5(this.apiClient,e);return o=Xe("{model}:predict",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),r.then(l=>{const u=zB(l),d=new AM;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI()){const a=U5(this.apiClient,e);return o=Xe("{model}:predict",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),r.then(l=>{const u=GB(l),d=new _M;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=W5(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>Ev(d))}else{const u=O6(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>Nv(d))}}async listInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=H5(this.apiClient,e);return a=Xe("{models_url}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=XB(d),p=new OI;return Object.assign(p,f),p})}else{const u=B6(this.apiClient,e);return a=Xe("{models_url}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=xB(d),p=new OI;return Object.assign(p,f),p})}}async update(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=K5(this.apiClient,e);return a=Xe("{model}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>Ev(d))}else{const u=U6(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>Nv(d))}}async delete(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=X5(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=JB(d),p=new VI;return Object.assign(p,f),p})}else{const u=W6(this.apiClient,e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=vB(d),p=new VI;return Object.assign(p,f),p})}}async countTokens(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=Y5(this.apiClient,e);return a=Xe("{model}:countTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=YB(d),p=new BI;return Object.assign(p,f),p})}else{const u=H6(this.apiClient,e);return a=Xe("{model}:countTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=wB(d),p=new BI;return Object.assign(p,f),p})}}async computeTokens(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI()){const a=Q5(this.apiClient,e);return o=Xe("{model}:computeTokens",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),r.then(l=>{const u=QB(l),d=new RM;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=tB(this.apiClient,e);return a=Xe("{model}:predictLongRunning",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i.then(d=>{const f=tz(d),p=new ig;return Object.assign(p,f),p})}else{const u=X6(this.apiClient,e);return a=Xe("{model}:predictLongRunning",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i.then(d=>{const f=bB(d),p=new ig;return Object.assign(p,f),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Az(n){const e={},t=m(n,["operationName"]);t!=null&&g(e,["_url","operationName"],t);const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}function _z(n){const e={},t=m(n,["operationName"]);t!=null&&g(e,["operationName"],t);const s=m(n,["resourceName"]);s!=null&&g(e,["_url","resourceName"],s);const r=m(n,["config"]);return r!=null&&g(e,["config"],r),e}function Rz(n){const e={},t=m(n,["operationName"]);t!=null&&g(e,["_url","operationName"],t);const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Dz extends Sl{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let o;s&&"httpOptions"in s&&(o=s.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:i,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async get(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let o;s&&"httpOptions"in s&&(o=s.httpOptions);const i=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:o}});return t._fromAPIResponse({apiResponse:i,isVertexAI:!0})}else{const r=await this.getVideosOperationInternal({operationName:t.name,config:s});return t._fromAPIResponse({apiResponse:r,isVertexAI:!1})}}async getVideosOperationInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=Rz(e);return a=Xe("{operationName}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json()),i}else{const u=Az(e);return a=Xe("{operationName}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json()),i}}async fetchPredictVideosOperationInternal(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI()){const a=_z(e);return o=Xe("{resourceName}:fetchPredictOperation",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json()),r}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Fz(n){const e={},t=m(n,["voiceName"]);return t!=null&&g(e,["voiceName"],t),e}function UE(n){const e={},t=m(n,["prebuiltVoiceConfig"]);return t!=null&&g(e,["prebuiltVoiceConfig"],Fz(t)),e}function Mz(n){const e={},t=m(n,["speaker"]);t!=null&&g(e,["speaker"],t);const s=m(n,["voiceConfig"]);return s!=null&&g(e,["voiceConfig"],UE(s)),e}function Pz(n){const e={},t=m(n,["speakerVoiceConfigs"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>Mz(r))),g(e,["speakerVoiceConfigs"],s)}return e}function Lz(n){const e={},t=m(n,["voiceConfig"]);t!=null&&g(e,["voiceConfig"],UE(t));const s=m(n,["multiSpeakerVoiceConfig"]);s!=null&&g(e,["multiSpeakerVoiceConfig"],Pz(s));const r=m(n,["languageCode"]);return r!=null&&g(e,["languageCode"],r),e}function Oz(n){const e={},t=m(n,["fps"]);t!=null&&g(e,["fps"],t);const s=m(n,["endOffset"]);s!=null&&g(e,["endOffset"],s);const r=m(n,["startOffset"]);return r!=null&&g(e,["startOffset"],r),e}function Vz(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["data"]);t!=null&&g(e,["data"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function Bz(n){const e={};if(m(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=m(n,["fileUri"]);t!=null&&g(e,["fileUri"],t);const s=m(n,["mimeType"]);return s!=null&&g(e,["mimeType"],s),e}function zz(n){const e={},t=m(n,["videoMetadata"]);t!=null&&g(e,["videoMetadata"],Oz(t));const s=m(n,["thought"]);s!=null&&g(e,["thought"],s);const r=m(n,["inlineData"]);r!=null&&g(e,["inlineData"],Vz(r));const o=m(n,["fileData"]);o!=null&&g(e,["fileData"],Bz(o));const i=m(n,["thoughtSignature"]);i!=null&&g(e,["thoughtSignature"],i);const a=m(n,["codeExecutionResult"]);a!=null&&g(e,["codeExecutionResult"],a);const l=m(n,["executableCode"]);l!=null&&g(e,["executableCode"],l);const u=m(n,["functionCall"]);u!=null&&g(e,["functionCall"],u);const d=m(n,["functionResponse"]);d!=null&&g(e,["functionResponse"],d);const f=m(n,["text"]);return f!=null&&g(e,["text"],f),e}function Uz(n){const e={},t=m(n,["parts"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>zz(o))),g(e,["parts"],r)}const s=m(n,["role"]);return s!=null&&g(e,["role"],s),e}function Wz(n){const e={},t=m(n,["behavior"]);t!=null&&g(e,["behavior"],t);const s=m(n,["description"]);s!=null&&g(e,["description"],s);const r=m(n,["name"]);r!=null&&g(e,["name"],r);const o=m(n,["parameters"]);o!=null&&g(e,["parameters"],o);const i=m(n,["parametersJsonSchema"]);i!=null&&g(e,["parametersJsonSchema"],i);const a=m(n,["response"]);a!=null&&g(e,["response"],a);const l=m(n,["responseJsonSchema"]);return l!=null&&g(e,["responseJsonSchema"],l),e}function Gz(n){const e={},t=m(n,["startTime"]);t!=null&&g(e,["startTime"],t);const s=m(n,["endTime"]);return s!=null&&g(e,["endTime"],s),e}function Hz(n){const e={},t=m(n,["timeRangeFilter"]);if(t!=null&&g(e,["timeRangeFilter"],Gz(t)),m(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");return e}function qz(n){const e={},t=m(n,["mode"]);t!=null&&g(e,["mode"],t);const s=m(n,["dynamicThreshold"]);return s!=null&&g(e,["dynamicThreshold"],s),e}function Kz(n){const e={},t=m(n,["dynamicRetrievalConfig"]);return t!=null&&g(e,["dynamicRetrievalConfig"],qz(t)),e}function Xz(){return{}}function Jz(n){const e={},t=m(n,["environment"]);return t!=null&&g(e,["environment"],t),e}function Yz(n){const e={},t=m(n,["functionDeclarations"]);if(t!=null){let l=t;Array.isArray(l)&&(l=l.map(u=>Wz(u))),g(e,["functionDeclarations"],l)}if(m(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=m(n,["googleSearch"]);s!=null&&g(e,["googleSearch"],Hz(s));const r=m(n,["googleSearchRetrieval"]);if(r!=null&&g(e,["googleSearchRetrieval"],Kz(r)),m(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(m(n,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");m(n,["urlContext"])!=null&&g(e,["urlContext"],Xz());const i=m(n,["computerUse"]);i!=null&&g(e,["computerUse"],Jz(i));const a=m(n,["codeExecution"]);return a!=null&&g(e,["codeExecution"],a),e}function Qz(n){const e={},t=m(n,["handle"]);if(t!=null&&g(e,["handle"],t),m(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function hk(){return{}}function Zz(n){const e={},t=m(n,["disabled"]);t!=null&&g(e,["disabled"],t);const s=m(n,["startOfSpeechSensitivity"]);s!=null&&g(e,["startOfSpeechSensitivity"],s);const r=m(n,["endOfSpeechSensitivity"]);r!=null&&g(e,["endOfSpeechSensitivity"],r);const o=m(n,["prefixPaddingMs"]);o!=null&&g(e,["prefixPaddingMs"],o);const i=m(n,["silenceDurationMs"]);return i!=null&&g(e,["silenceDurationMs"],i),e}function jz(n){const e={},t=m(n,["automaticActivityDetection"]);t!=null&&g(e,["automaticActivityDetection"],Zz(t));const s=m(n,["activityHandling"]);s!=null&&g(e,["activityHandling"],s);const r=m(n,["turnCoverage"]);return r!=null&&g(e,["turnCoverage"],r),e}function eU(n){const e={},t=m(n,["targetTokens"]);return t!=null&&g(e,["targetTokens"],t),e}function tU(n){const e={},t=m(n,["triggerTokens"]);t!=null&&g(e,["triggerTokens"],t);const s=m(n,["slidingWindow"]);return s!=null&&g(e,["slidingWindow"],eU(s)),e}function nU(n){const e={},t=m(n,["proactiveAudio"]);return t!=null&&g(e,["proactiveAudio"],t),e}function sU(n,e){const t={},s=m(n,["generationConfig"]);e!==void 0&&s!=null&&g(e,["setup","generationConfig"],s);const r=m(n,["responseModalities"]);e!==void 0&&r!=null&&g(e,["setup","generationConfig","responseModalities"],r);const o=m(n,["temperature"]);e!==void 0&&o!=null&&g(e,["setup","generationConfig","temperature"],o);const i=m(n,["topP"]);e!==void 0&&i!=null&&g(e,["setup","generationConfig","topP"],i);const a=m(n,["topK"]);e!==void 0&&a!=null&&g(e,["setup","generationConfig","topK"],a);const l=m(n,["maxOutputTokens"]);e!==void 0&&l!=null&&g(e,["setup","generationConfig","maxOutputTokens"],l);const u=m(n,["mediaResolution"]);e!==void 0&&u!=null&&g(e,["setup","generationConfig","mediaResolution"],u);const d=m(n,["seed"]);e!==void 0&&d!=null&&g(e,["setup","generationConfig","seed"],d);const f=m(n,["speechConfig"]);e!==void 0&&f!=null&&g(e,["setup","generationConfig","speechConfig"],Lz(D2(f)));const p=m(n,["enableAffectiveDialog"]);e!==void 0&&p!=null&&g(e,["setup","generationConfig","enableAffectiveDialog"],p);const y=m(n,["systemInstruction"]);e!==void 0&&y!=null&&g(e,["setup","systemInstruction"],Uz(Is(y)));const v=m(n,["tools"]);if(e!==void 0&&v!=null){let A=qu(v);Array.isArray(A)&&(A=A.map(R=>Yz(Hu(R)))),g(e,["setup","tools"],A)}const w=m(n,["sessionResumption"]);e!==void 0&&w!=null&&g(e,["setup","sessionResumption"],Qz(w));const C=m(n,["inputAudioTranscription"]);e!==void 0&&C!=null&&g(e,["setup","inputAudioTranscription"],hk());const S=m(n,["outputAudioTranscription"]);e!==void 0&&S!=null&&g(e,["setup","outputAudioTranscription"],hk());const b=m(n,["realtimeInputConfig"]);e!==void 0&&b!=null&&g(e,["setup","realtimeInputConfig"],jz(b));const E=m(n,["contextWindowCompression"]);e!==void 0&&E!=null&&g(e,["setup","contextWindowCompression"],tU(E));const N=m(n,["proactivity"]);return e!==void 0&&N!=null&&g(e,["setup","proactivity"],nU(N)),t}function rU(n,e){const t={},s=m(e,["model"]);s!=null&&g(t,["setup","model"],Pt(n,s));const r=m(e,["config"]);return r!=null&&g(t,["config"],sU(r,t)),t}function oU(n,e,t){const s={},r=m(e,["expireTime"]);t!==void 0&&r!=null&&g(t,["expireTime"],r);const o=m(e,["newSessionExpireTime"]);t!==void 0&&o!=null&&g(t,["newSessionExpireTime"],o);const i=m(e,["uses"]);t!==void 0&&i!=null&&g(t,["uses"],i);const a=m(e,["liveConnectConstraints"]);t!==void 0&&a!=null&&g(t,["bidiGenerateContentSetup"],rU(n,a));const l=m(e,["lockAdditionalFields"]);return t!==void 0&&l!=null&&g(t,["fieldMask"],l),s}function iU(n,e){const t={},s=m(e,["config"]);return s!=null&&g(t,["config"],oU(n,s,t)),t}function aU(n){const e={},t=m(n,["name"]);return t!=null&&g(e,["name"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function lU(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const s=n[t];if(typeof s=="object"&&s!=null&&Object.keys(s).length>0){const r=Object.keys(s).map(o=>`${t}.${o}`);e.push(...r)}else e.push(t)}return e.join(",")}function uU(n,e){let t=null;const s=n.bidiGenerateContentSetup;if(typeof s=="object"&&s!==null&&"setup"in s){const o=s.setup;typeof o=="object"&&o!==null?(n.bidiGenerateContentSetup=o,t=o):delete n.bidiGenerateContentSetup}else s!==void 0&&delete n.bidiGenerateContentSetup;const r=n.fieldMask;if(t){const o=lU(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)o?n.fieldMask=o:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&r!==null&&Array.isArray(r)&&r.length>0){const i=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];r.length>0&&(a=r.map(u=>i.includes(u)?`generationConfig.${u}`:u));const l=[];o&&l.push(o),a.length>0&&l.push(...a),l.length>0?n.fieldMask=l.join(","):delete n.fieldMask}else delete n.fieldMask}else r!==null&&Array.isArray(r)&&r.length>0?n.fieldMask=r.join(","):delete n.fieldMask;return n}class cU extends Sl{constructor(e){super(),this.apiClient=e}async create(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=iU(this.apiClient,e);o=Xe("auth_tokens",a._url),i=a._query,delete a.config,delete a._url,delete a._query;const l=uU(a,e.config);return r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(u=>u.json()),r.then(u=>aU(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function dU(n){const e={},t=m(n,["name"]);t!=null&&g(e,["_url","name"],t);const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}function fU(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);e!==void 0&&r!=null&&g(e,["_query","pageToken"],r);const o=m(n,["filter"]);return e!==void 0&&o!=null&&g(e,["_query","filter"],o),t}function hU(n){const e={},t=m(n,["config"]);return t!=null&&g(e,["config"],fU(t,e)),e}function pU(n){const e={},t=m(n,["name"]);t!=null&&g(e,["_url","name"],t);const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}function mU(n){const e={},t=m(n,["textInput"]);t!=null&&g(e,["textInput"],t);const s=m(n,["output"]);return s!=null&&g(e,["output"],s),e}function gU(n){const e={};if(m(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(m(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const t=m(n,["examples"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>mU(r))),g(e,["examples","examples"],s)}return e}function yU(n,e){const t={};if(m(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=m(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&g(e,["displayName"],s),m(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=m(n,["epochCount"]);e!==void 0&&r!=null&&g(e,["tuningTask","hyperparameters","epochCount"],r);const o=m(n,["learningRateMultiplier"]);if(o!=null&&g(t,["tuningTask","hyperparameters","learningRateMultiplier"],o),m(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(m(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(m(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const i=m(n,["batchSize"]);e!==void 0&&i!=null&&g(e,["tuningTask","hyperparameters","batchSize"],i);const a=m(n,["learningRate"]);return e!==void 0&&a!=null&&g(e,["tuningTask","hyperparameters","learningRate"],a),t}function xU(n){const e={},t=m(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);const s=m(n,["preTunedModel"]);s!=null&&g(e,["preTunedModel"],s);const r=m(n,["trainingDataset"]);r!=null&&g(e,["tuningTask","trainingData"],gU(r));const o=m(n,["config"]);return o!=null&&g(e,["config"],yU(o,e)),e}function vU(n){const e={},t=m(n,["name"]);t!=null&&g(e,["_url","name"],t);const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}function wU(n,e){const t={},s=m(n,["pageSize"]);e!==void 0&&s!=null&&g(e,["_query","pageSize"],s);const r=m(n,["pageToken"]);e!==void 0&&r!=null&&g(e,["_query","pageToken"],r);const o=m(n,["filter"]);return e!==void 0&&o!=null&&g(e,["_query","filter"],o),t}function CU(n){const e={},t=m(n,["config"]);return t!=null&&g(e,["config"],wU(t,e)),e}function TU(n){const e={},t=m(n,["name"]);t!=null&&g(e,["_url","name"],t);const s=m(n,["config"]);return s!=null&&g(e,["config"],s),e}function SU(n,e){const t={},s=m(n,["gcsUri"]);e!==void 0&&s!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],s);const r=m(n,["vertexDatasetResource"]);if(e!==void 0&&r!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],r),m(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return t}function bU(n,e){const t={},s=m(n,["gcsUri"]);s!=null&&g(t,["validationDatasetUri"],s);const r=m(n,["vertexDatasetResource"]);return e!==void 0&&r!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],r),t}function IU(n,e){const t={},s=m(n,["validationDataset"]);e!==void 0&&s!=null&&g(e,["supervisedTuningSpec"],bU(s,t));const r=m(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&g(e,["tunedModelDisplayName"],r);const o=m(n,["description"]);e!==void 0&&o!=null&&g(e,["description"],o);const i=m(n,["epochCount"]);e!==void 0&&i!=null&&g(e,["supervisedTuningSpec","hyperParameters","epochCount"],i);const a=m(n,["learningRateMultiplier"]);e!==void 0&&a!=null&&g(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],a);const l=m(n,["exportLastCheckpointOnly"]);e!==void 0&&l!=null&&g(e,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const u=m(n,["preTunedModelCheckpointId"]);u!=null&&g(t,["preTunedModel","checkpointId"],u);const d=m(n,["adapterSize"]);if(e!==void 0&&d!=null&&g(e,["supervisedTuningSpec","hyperParameters","adapterSize"],d),m(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(m(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return t}function kU(n){const e={},t=m(n,["baseModel"]);t!=null&&g(e,["baseModel"],t);const s=m(n,["preTunedModel"]);s!=null&&g(e,["preTunedModel"],s);const r=m(n,["trainingDataset"]);r!=null&&g(e,["supervisedTuningSpec","trainingDatasetUri"],SU(r,e));const o=m(n,["config"]);return o!=null&&g(e,["config"],IU(o,e)),e}function NU(n){const e={},t=m(n,["name"]);t!=null&&g(e,["model"],t);const s=m(n,["name"]);return s!=null&&g(e,["endpoint"],s),e}function WE(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&g(e,["name"],s);const r=m(n,["state"]);r!=null&&g(e,["state"],yE(r));const o=m(n,["createTime"]);o!=null&&g(e,["createTime"],o);const i=m(n,["tuningTask","startTime"]);i!=null&&g(e,["startTime"],i);const a=m(n,["tuningTask","completeTime"]);a!=null&&g(e,["endTime"],a);const l=m(n,["updateTime"]);l!=null&&g(e,["updateTime"],l);const u=m(n,["description"]);u!=null&&g(e,["description"],u);const d=m(n,["baseModel"]);d!=null&&g(e,["baseModel"],d);const f=m(n,["_self"]);f!=null&&g(e,["tunedModel"],NU(f));const p=m(n,["customBaseModel"]);p!=null&&g(e,["customBaseModel"],p);const y=m(n,["experiment"]);y!=null&&g(e,["experiment"],y);const v=m(n,["labels"]);v!=null&&g(e,["labels"],v);const w=m(n,["outputUri"]);w!=null&&g(e,["outputUri"],w);const C=m(n,["pipelineJob"]);C!=null&&g(e,["pipelineJob"],C);const S=m(n,["serviceAccount"]);S!=null&&g(e,["serviceAccount"],S);const b=m(n,["tunedModelDisplayName"]);return b!=null&&g(e,["tunedModelDisplayName"],b),e}function EU(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["tunedModels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>WE(i))),g(e,["tuningJobs"],o)}return e}function $U(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&g(e,["name"],s);const r=m(n,["metadata"]);r!=null&&g(e,["metadata"],r);const o=m(n,["done"]);o!=null&&g(e,["done"],o);const i=m(n,["error"]);return i!=null&&g(e,["error"],i),e}function AU(n){const e={},t=m(n,["checkpointId"]);t!=null&&g(e,["checkpointId"],t);const s=m(n,["epoch"]);s!=null&&g(e,["epoch"],s);const r=m(n,["step"]);r!=null&&g(e,["step"],r);const o=m(n,["endpoint"]);return o!=null&&g(e,["endpoint"],o),e}function _U(n){const e={},t=m(n,["model"]);t!=null&&g(e,["model"],t);const s=m(n,["endpoint"]);s!=null&&g(e,["endpoint"],s);const r=m(n,["checkpoints"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>AU(i))),g(e,["checkpoints"],o)}return e}function Av(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["name"]);s!=null&&g(e,["name"],s);const r=m(n,["state"]);r!=null&&g(e,["state"],yE(r));const o=m(n,["createTime"]);o!=null&&g(e,["createTime"],o);const i=m(n,["startTime"]);i!=null&&g(e,["startTime"],i);const a=m(n,["endTime"]);a!=null&&g(e,["endTime"],a);const l=m(n,["updateTime"]);l!=null&&g(e,["updateTime"],l);const u=m(n,["error"]);u!=null&&g(e,["error"],u);const d=m(n,["description"]);d!=null&&g(e,["description"],d);const f=m(n,["baseModel"]);f!=null&&g(e,["baseModel"],f);const p=m(n,["tunedModel"]);p!=null&&g(e,["tunedModel"],_U(p));const y=m(n,["preTunedModel"]);y!=null&&g(e,["preTunedModel"],y);const v=m(n,["supervisedTuningSpec"]);v!=null&&g(e,["supervisedTuningSpec"],v);const w=m(n,["tuningDataStats"]);w!=null&&g(e,["tuningDataStats"],w);const C=m(n,["encryptionSpec"]);C!=null&&g(e,["encryptionSpec"],C);const S=m(n,["partnerModelTuningSpec"]);S!=null&&g(e,["partnerModelTuningSpec"],S);const b=m(n,["customBaseModel"]);b!=null&&g(e,["customBaseModel"],b);const E=m(n,["experiment"]);E!=null&&g(e,["experiment"],E);const N=m(n,["labels"]);N!=null&&g(e,["labels"],N);const A=m(n,["outputUri"]);A!=null&&g(e,["outputUri"],A);const R=m(n,["pipelineJob"]);R!=null&&g(e,["pipelineJob"],R);const L=m(n,["serviceAccount"]);L!=null&&g(e,["serviceAccount"],L);const z=m(n,["tunedModelDisplayName"]);return z!=null&&g(e,["tunedModelDisplayName"],z),e}function RU(n){const e={},t=m(n,["sdkHttpResponse"]);t!=null&&g(e,["sdkHttpResponse"],t);const s=m(n,["nextPageToken"]);s!=null&&g(e,["nextPageToken"],s);const r=m(n,["tuningJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(i=>Av(i))),g(e,["tuningJobs"],o)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class DU extends Sl{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new If(ll.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel},r=Object.assign(Object.assign({},t),{preTunedModel:s});return r.baseModel=void 0,await this.tuneInternal(r)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),r=await this.tuneMldevInternal(s);let o="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?o=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(o=r.name.split("/operations/")[0]),{name:o,state:Cv.JOB_STATE_QUEUED}}}}async getInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=vU(e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>Av(d))}else{const u=dU(e);return a=Xe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>WE(d))}}async listInternal(e){var t,s,r,o;let i,a="",l={};if(this.apiClient.isVertexAI()){const u=CU(e);return a=Xe("tuningJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=RU(d),p=new UI;return Object.assign(p,f),p})}else{const u=hU(e);return a=Xe("tunedModels",u._url),l=u._query,delete u.config,delete u._url,delete u._query,i=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal}).then(d=>d.json().then(f=>{const p=f;return p.sdkHttpResponse={headers:d.headers},p})),i.then(d=>{const f=EU(d),p=new UI;return Object.assign(p,f),p})}}async cancel(e){var t,s,r,o;let i="",a={};if(this.apiClient.isVertexAI()){const l=TU(e);i=Xe("{name}:cancel",l._url),a=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal})}else{const l=pU(e);i=Xe("{name}:cancel",l._url),a=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:i,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(o=e.config)===null||o===void 0?void 0:o.abortSignal})}}async tuneInternal(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI()){const a=kU(e);return o=Xe("tuningJobs",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),r.then(l=>Av(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,s;let r,o="",i={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=xU(e);return o=Xe("tunedModels",a._url),i=a._query,delete a.config,delete a._url,delete a._query,r=this.apiClient.request({path:o,queryParams:i,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(l=>l.json().then(u=>{const d=u;return d.sdkHttpResponse={headers:l.headers},d})),r.then(l=>$U(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class FU{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const MU=1024*1024*8,PU=3,LU=1e3,OU=2,Ux="x-goog-upload-status";async function VU(n,e,t){var s,r,o;let i=0,a=0,l=new Tv(new Response),u="upload";for(i=n.size;a<i;){const f=Math.min(MU,i-a),p=n.slice(a,a+f);a+f>=i&&(u+=", finalize");let y=0,v=LU;for(;y<PU&&(l=await t.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(a),"Content-Length":String(f)}}}),!(!((s=l==null?void 0:l.headers)===null||s===void 0)&&s[Ux]));)y++,await zU(v),v=v*OU;if(a+=f,((r=l==null?void 0:l.headers)===null||r===void 0?void 0:r[Ux])!=="active")break;if(i<=a)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(l==null?void 0:l.json());if(((o=l==null?void 0:l.headers)===null||o===void 0?void 0:o[Ux])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function BU(n){return{size:n.size,type:n.type}}function zU(n){return new Promise(e=>setTimeout(e,n))}class UU{async upload(e,t,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await VU(e,t,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await BU(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class WU{create(e,t,s){return new GU(e,t,s)}}class GU{constructor(e,t,s){this.url=e,this.headers=t,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const pk="x-goog-api-key";class HU{constructor(e){this.apiKey=e}async addAuthHeaders(e){if(e.get(pk)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(pk,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qU="gl-node/";class KU{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const s=NM(e.httpOptions,e.vertexai,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion;const r=new HU(this.apiKey);this.apiClient=new uz({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:qU+"web",uploader:new UU,downloader:new FU}),this.models=new $z(this.apiClient),this.live=new Tz(this.apiClient,r,new WU),this.batches=new ZP(this.apiClient),this.chats=new rO(this.models,this.apiClient),this.caches=new tO(this.apiClient),this.files=new yO(this.apiClient),this.operations=new Dz(this.apiClient),this.authTokens=new cU(this.apiClient),this.tunings=new DU(this.apiClient)}}let Wx=null;const kf=()=>(Wx||(Wx=new KU({apiKey:void 0})),Wx),Nf=(n,e)=>(console.error(`Error during ${e}:`,n),n instanceof Error?n.message.includes("API key not valid")||n.message.includes("API_KEY_INVALID")?`Error: Your API key is invalid or missing.
Please ensure the API_KEY environment variable is set correctly. The application cannot function without a valid key.`:`Error from AI service during ${e}: ${n.message}`:`An unknown error occurred during ${e}.`),mk=async n=>{try{return(await kf().models.generateContent({model:"gemini-2.5-flash",contents:n})).text}catch(e){return Nf(e,"text generation")}},XU=async n=>{try{const e=kf(),t=`Provide a concise, one-paragraph summary of the following text:

---
${n}
---`;return(await e.models.generateContent({model:"gemini-2.5-flash",contents:t})).text}catch(e){return Nf(e,"text summarization")}},JU=()=>kf().chats.create({model:"gemini-2.5-flash"}),YU=async(n,e)=>{try{return(await n.sendMessage({message:e})).text}catch(t){return Nf(t,"chat message")}},QU=async n=>{try{const t=await kf().models.generateImages({model:"imagen-4.0-generate-001",prompt:n,config:{numberOfImages:1,outputMimeType:"image/jpeg",aspectRatio:"1:1"}});return t.generatedImages&&t.generatedImages.length>0?`data:image/jpeg;base64,${t.generatedImages[0].image.imageBytes}`:"Could not generate image. The response was empty."}catch(e){return Nf(e,"image generation")}},ZU=async(n,e)=>{try{const t=kf(),s={inlineData:{mimeType:"image/jpeg",data:n}},r={text:e||"Describe what you see in this image in detail."};return(await t.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[s,r]}})).text}catch(t){return Nf(t,"image analysis")}},jU=n=>{const e=n.toLowerCase(),t=Object.keys(Ao).find(s=>Ao[s].aliases.includes(e));return t?{key:t,def:Ao[t]}:null},e8=()=>{let n=`Available Commands:

`;for(const e in Ao){const t=Ao[e];n+=`  ${t.aliases.join(", ")}
`,t.usage&&(n+=`    Usage: ${t.usage}
`),n+=`    Description: ${t.description}

`}return n},gu=n=>new Promise(e=>setTimeout(e,n)),GE=(n,e)=>{if(n.length<e.length)return GE(e,n);if(e.length===0)return n.length;let t=Array.from({length:e.length+1},(s,r)=>r);for(let s=0;s<n.length;s++){let r=[s+1];for(let o=0;o<e.length;o++){let i=t[o+1]+1,a=r[o]+1,l=t[o]+(n[s]!==e[o]?1:0);r.push(Math.min(i,a,l))}t=r}return t[e.length]},t8=async(n,e,t)=>{var d;const s=n.trim();if(!s)return{};const r=((d=s.match(/(?:[^\s"]+|"[^"]*")+/g))==null?void 0:d.map(f=>f.replace(/"/g,"")))??[],o=r[0],i=r.slice(1),a=jU(o);if(!a){let f=null,p=3;const y=Object.values(Ao).flatMap(w=>w.aliases);for(const w of y){const C=GE(o.toLowerCase(),w);C<p&&(p=C,f=w)}return f?{output:`Error: Command '${o}' not found. Did you mean '${f}'?`}:{output:await mk(n)}}const{key:l,def:u}=a;if((l==="CAMERA_DESCRIBE"||l==="DETECT_OBJECTS"||l==="DETECT_FACES")&&!e)return{output:"Error: Camera is not open. Use 'camera.open' first."};switch(l){case"HELP":return{output:e8()};case"EXIT":return{output:"Simulating exit. In a real terminal, this would close."};case"CLEAR":return{commandKey:l,action:u.action};case"AI_CHAT":return{action:u.action,output:'Starting chat session. Type "exit" or "خروج" to end.'};case"AI_IMAGE":const f=i.join(" ");return f?{output:await QU(f)}:{output:`Error: An image prompt is required.

Usage: ${u.usage}
Example: image a futuristic city at sunset`};case"CAMERA_OPEN":case"CAMERA_CLOSE":return{action:u.action};case"CAMERA_DESCRIBE":const p=u.payload?u.payload(i):void 0;return{action:u.action,payload:p,output:"[AI]: Capturing frame for analysis..."};case"DETECT_OBJECTS":{const y=i[0]||"objects";if(u.args&&!u.args.includes(y))return{output:`Error: Invalid detection mode '${y}'.

Usage: ${u.usage}
Available modes are: ${u.args.join(", ")}.`};const v=u.payload?u.payload(i):y;return{action:u.action,payload:v,output:`Object detection mode set to: ${v}`}}case"DETECT_FACES":{const y=i[0];if(u.args&&!u.args.includes(y))return{output:`Error: Invalid argument '${y}'.

Usage: ${u.usage}
Example: detect.faces on`};const v=u.payload?u.payload(i):void 0;return{action:u.action,payload:v,output:`Face detection set to: ${v?"on":"off"}`}}case"BOT_NEW":{if(i.length<2)return{output:`Error: Missing arguments for creating a bot.

Usage: ${u.usage}
Example: bot.new web "https://example.com/faq.json"`};const[y,v]=i,w=["web","whatsapp","telegram","facebook","instagram"];return w.includes(y.toLowerCase())?{output:`[INFO]: Initializing chatbot project...
[AI]: Connecting to data source: ${v}...
[OK]: Data source validated.
[INFO]: Configuring platform adapter for ${y}...
[DEPLOY]: Deploying chatbot...
[SUCCESS]: Chatbot is now live! Endpoint: https://bot.alpa.cloud/${y}/${Math.random().toString(36).substring(7)}`}:{output:`Error: Unsupported platform '${y}'.

Supported platforms are: ${w.join(", ")}.`}}case"AI_SPEECH_TO_TEXT":return i.length<1?{output:`Error: Missing file argument.

Usage: ${u.usage}`}:{output:`[AI]: Transcribing ${i[0]}...
[SUCCESS]: Transcription complete.

"Hello, this is a simulated transcription from Alpa's speech-to-text engine. It demonstrates the ability to convert audio into written text."`};case"AI_TEXT_TO_SPEECH":return i.join(" ")?{action:u.action,payload:u.payload?u.payload(i):void 0,output:"[AI]: Speaking..."}:{output:`Error: Missing text to speak.

Usage: ${u.usage}
Example: ai.tts "Hello from Alpa"`};case"AI_OCR":return i.length<1?{output:`Error: Missing file argument.

Usage: ${u.usage}`}:{output:`[AI]: Performing OCR on ${i[0]}...
[SUCCESS]: Extracted text:

"ALPA LANGUAGE
- AI Native
- Bilingual
- Production Ready"`};case"AI_ANALYZE":{const y=i.join(" ");if(!y)return{output:`Error: Missing content to analyze.

Usage: ${u.usage}
Example: ai.analyze "Alpa is a fantastic language."`};t({type:zt.RESPONSE,content:"[AI]: Analyzing content..."});const v=`Analyze the following text and provide a report for a terminal interface. The report must include these sections with clear headings: "Sentiment", "Key Topics", and "Summary".

Text to analyze: "${y}"`;return{output:`[AI]: Analysis Report
${await mk(v)}`}}case"AI_SUMMARIZE":{const y=i[0];if(!y)return{output:`Error: A URL is required.

Usage: ${u.usage}
Example: ai.summarize https://en.wikipedia.org/wiki/Artificial_intelligence`};try{new URL(y)}catch{return{output:"Error: Invalid URL provided."}}t({type:zt.RESPONSE,content:`[AI]: Simulating content fetch from ${y}...`}),await gu(1500),t({type:zt.RESPONSE,content:"[OK]: Content retrieved successfully."}),t({type:zt.RESPONSE,content:"[AI]: Analyzing and generating summary..."});const w=await XU("Artificial intelligence is intelligence demonstrated by machines, as opposed to the natural intelligence displayed by humans and other animals. AI research has been defined as the field of study of intelligent agents, which refers to any device that perceives its environment and takes actions that maximize its chance of successfully achieving its goals. The term 'artificial intelligence' had previously been used to describe machines that mimic and display 'human' cognitive skills that are associated with the human mind, such as 'learning' and 'problem-solving'. This definition has since been rejected by major AI researchers who now describe AI in terms of rationality and acting rationally, which does not limit AI to human-like cognition.");return{output:`[AI]: Summary for ${y}

${w}`}}case"DEPLOY_GHPAGES":{const y=[{delay:500,message:"[BUILD]: Building Alpa static website..."},{delay:1500,message:"[OK]: Production build created in './dist' folder."},{delay:500,message:"[GIT]: Committing changes to 'gh-pages' branch..."},{delay:2e3,message:"[DEPLOY]: Pushing to GitHub..."},{delay:1e3,message:"[SUCCESS]: Website is now live at: https://your-username.github.io/alpa-lang/"}];for(const v of y)await gu(v.delay),t({type:zt.RESPONSE,content:v.message});return{}}case"DEPLOY_VSC_EXTENSION":{const y=[{delay:500,message:"[VSCE]: Reading extension manifest..."},{delay:1e3,message:"[VSCE]: Packaging extension..."}];for(const C of y)await gu(C.delay),t({type:zt.RESPONSE,content:C.message});await gu(1500),t({type:zt.RESPONSE,content:"[OK]: Created alpa-language-support-1.0.0.vsix (1.2 MB)."});const w=`// This is a simulated .vsix package file. 
// In a real scenario, this would be a ZIP archive containing the extension files.
// For demonstration, this text file includes the manifest.

// --- MANIFEST (package.json) ---
${JSON.stringify({name:"alpa-language-support",displayName:"Alpa Language Support",description:"Syntax highlighting and snippets for the Alpa programming language.",version:"1.0.0",publisher:"AlpaLang",engines:{vscode:"^1.80.0"},categories:["Programming Languages"],contributes:{languages:[{id:"alpa",aliases:["Alpa","alpa"],extensions:[".alpa"],configuration:"./language-configuration.json"}],grammars:[{language:"alpa",scopeName:"source.alpa",path:"./syntaxes/alpa.tmLanguage.json"}]}},null,2)}
`;return await gu(500),t({type:zt.RESPONSE,content:"[INFO]: Packaging complete. Your file download will start shortly."}),t({type:zt.RESPONSE,content:"[INFO]: To publish a real extension, you would run 'vsce publish' in your terminal."}),{action:"DOWNLOAD_FILE",payload:{filename:"alpa-language-support-1.0.0.vsix.txt",content:w,mimeType:"text/plain"}}}case"DEPLOY_VERCEL":{const y=[{delay:300,message:"[VERCEL]: Deploying project..."},{delay:1e3,message:"[VERCEL]: Cloning repository..."},{delay:1500,message:"[VERCEL]: Build command `npm run build` found."},{delay:2e3,message:"[VERCEL]: Building project..."},{delay:2500,message:"[VERCEL]: Analyzing output..."},{delay:500,message:"[VERCEL]: Running checks..."},{delay:1e3,message:"[SUCCESS]: Deployment complete! Project is live at: https://alpa-lang-demo-"+Math.random().toString(36).substring(2,8)+".vercel.app"}];for(const v of y)await gu(v.delay),t({type:zt.RESPONSE,content:v.message});return{}}default:if(u.action){const y=u.payload?u.payload(i):void 0;return{action:u.action,payload:y}}return{output:`Command '${o}' is recognized but not yet implemented.`}}};var Qd={exports:{}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n8=1e-7,s8=1e-4;class M2{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Hg{refCount(e){return dr("refCount")}incRef(e){return dr("incRef")}timerAvailable(){return!0}time(e){return dr("time")}read(e){return dr("read")}readSync(e){return dr("readSync")}readToGPU(e,t){return dr("readToGPU")}numDataIds(){return dr("numDataIds")}disposeData(e,t){return dr("disposeData")}write(e,t,s){return dr("write")}move(e,t,s,r,o){return dr("move")}memory(){return dr("memory")}floatPrecision(){return dr("floatPrecision")}epsilon(){return this.floatPrecision()===32?n8:s8}dispose(){return dr("dispose")}}function dr(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2(n){let e=n.length,t=0;for(;e>0;)t=Math.random()*e|0,e--,ri(n,e,t)}function r8(n,e){if(n.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${n.length}Second array length was ${e.length}`);let t=n.length,s=0;for(;t>0;)s=Math.random()*t|0,t--,ri(n,t,s),ri(e,t,s)}function ia(n,e,t){return Math.max(n,Math.min(e,t))}function qg(n){return n%2===0?n:n+1}function ri(n,e,t){const s=n[e];n[e]=n[t],n[t]=s}function HE(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function o8(n,e){const t=Math.random();return e*t+(1-t)*n}function i8(n,e){let t=0;for(let s=0;s<n.length;s++){const r=Number(n[s])-Number(e[s]);t+=r*r}return t}function B(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function ns(n,e,t=""){B(Ct(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function Il(n){B(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function di(n,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(n)||cs(n)&&!t)for(let s=0;s<n.length;++s)di(n[s],e,t);else e.push(n);return e}function we(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function a8(n){return n.length===0}function Ct(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function ul(n){return n%1===0}function l8(n){if(Math.tanh!=null)return Math.tanh(n);if(n===1/0)return 1;if(n===-1/0)return-1;{const e=Math.exp(2*n);return(e-1)/(e+1)}}function lg(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function u8(n){const e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return P2(e),e}function nl(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function _v(n,e=r=>0,t,s=setTimeout){return new Promise((r,o)=>{let i=0;const a=()=>{if(n()){r();return}i++;const l=e(i);if(t!=null&&i>=t){o();return}s(a,l)};a()})}function L2(n,e){let t=1,s=-1;for(let o=0;o<n.length;++o)if(n[o]>=0)t*=n[o];else if(n[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(n[o]<0)throw Error(`Shapes can not be < 0. Found ${n[o]} at dim ${o}`);if(s===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const r=n.slice();return r[s]=e/t,r}function gt(n,e){const t=e.length;return n=n==null?e.map((s,r)=>r):[].concat(n),B(n.every(s=>s>=-t&&s<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),B(n.every(s=>ul(s)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(s=>s<0?t+s:s)}function wi(n,e){const t=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||r?null:gt(e,n).sort();let i=0;for(let a=0;a<n.length;++a){if(o!=null){if(o[i]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(o[i]==null||o[i]>a)&&n[a]===1&&(t.push(n[a]),s.push(a)),o[i]<=a&&i++}n[a]!==1&&(t.push(n[a]),s.push(a))}return{newShape:t,keptDims:s}}function On(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else throw new Error(`Unknown data type ${n}`);return t}function Rn(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function qE(n,e){for(let t=0;t<n.length;t++){const s=n[t];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function KE(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function O2(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function cs(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}function ug(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function XE(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function Eo(n){return typeof n=="string"||n instanceof String}function JE(n){return typeof n=="boolean"}function cg(n){return typeof n=="number"}function Ju(n){return Array.isArray(n)?Ju(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":cg(n)?"float32":Eo(n)?"string":JE(n)?"bool":"float32"}function aa(n){return!!(n&&n.constructor&&n.call&&n.apply)}function dg(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function et(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let s=e-3;s>=0;--s)t[s]=t[s+1]*n[s+1];return t}function YE(n,e,t,s=!1){const r=new Array;if(e.length===1){const o=e[0]*(s?2:1);for(let i=0;i<o;i++)r[i]=t[n+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,u)=>l*u)*(s?2:1);for(let l=0;l<o;l++)r[l]=YE(n+l*a,i,t,s)}return r}function gr(n,e,t=!1){if(n.length===0)return e[0];const s=n.reduce((r,o)=>r*o)*(t?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return YE(0,n,e,t)}function Kg(n,e){const t=es(n,e);for(let s=0;s<t.length;s++)t[s]=1;return t}function es(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function V2(n,e){const t=n.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return gr(n,new Float32Array(t));if(e==="int32")return gr(n,new Int32Array(t));if(e==="bool")return gr(n,new Uint8Array(t));throw new Error(`Unknown data type ${e}`)}function B2(n){n.forEach(e=>{B(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function so(n,e,t){if(e===0)return 0;if(e===1)return n[0];let s=n[n.length-1];for(let r=0;r<n.length-1;++r)s+=t[r]*n[r];return s}function kl(n,e,t){if(e===0)return[];if(e===1)return[n];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(n/t[r]),n-=s[r]*t[r];return s[s.length-1]=n,s}function cl(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gk="tfjsflags";class QE{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=c8,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,s){if(this.flagRegistry[e]={evaluationFn:t,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(cl(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);gk in e&&e[gk].split(",").forEach(s=>{const[r,o]=s.split(":");this.urlFlags[r]=f8(r,o)})}}function c8(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...s)=>(d8(e,s[0],s[1]),s.join("="))),e}function d8(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function f8(n,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${n}.`)}function me(){return z2}let z2=null;function h8(n){z2=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Gx;function ZE(){if(Gx==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");Gx=n}return Gx}function p8(){const n=ZE();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function U2(n,e){const t=p8();if(t.has(n))return t.get(n);{const s=e();return t.set(n,s),t.get(n)}}const Ef="Abs",Yu="Acos",Qu="Acosh",Nl="Add",$f="AddN",Xg="All",Jg="Any",Af="ArgMax",_f="ArgMin",Zu="Asin",ju="Asinh",ec="Atan",tc="Atanh",nc="Atan2",Rf="AvgPool",Yg="AvgPoolGrad",Df="AvgPool3D",Qg="AvgPool3DGrad",Ff="BatchMatMul",Mf="BatchToSpaceND",Zg="Bincount",jE="BroadcastTo",jg="BroadcastArgs",sc="Cast",rc="Ceil",oc="ClipByValue",ey="Complex",Pf="ComplexAbs",Lf="Concat",Of="Conv2D",ty="Conv2DBackpropFilter",Vf="Conv2DBackpropInput",Bf="Conv3D",ny="Conv3DBackpropFilterV2",sy="Conv3DBackpropInputV2",ic="Cos",ac="Cosh",ry="Cumprod",zf="Cumsum",oy="CropAndResize",iy="DenseBincount",ay="DepthToSpace",Uf="DepthwiseConv2dNative",ly="DepthwiseConv2dNativeBackpropFilter",uy="DepthwiseConv2dNativeBackpropInput",cy="Diag",Wf="Dilation2D",fg="Dilation2DBackpropInput",hg="Dilation2DBackpropFilter",lc="RealDiv",dy="Einsum",uc="Elu",fy="EluGrad",cc="Erf",Gf="Equal",dc="Exp",Hf="ExpandDims",fc="Expm1",hy="FFT",py="Fill",my="FlipLeftRight",hc="Floor",pc="FloorDiv",qf="FusedBatchNorm",Kf="GatherV2",gy="GatherNd",Xf="Greater",mc="GreaterEqual",gc="Identity",yy="IFFT",xy="Imag",yc="IsFinite",xc="IsInf",vc="IsNan",Jf="LeakyRelu",Yf="Less",Qf="LessEqual",vy="LinSpace",wc="Log",Cc="Log1p",Zf="LogicalAnd",jf="LogicalNot",eh="LogicalOr",m8="LogicalXor",e3="LogSoftmax",g8="LowerBound",th="LRN",wy="LRNGrad",nh="Max",Tc="Maximum",sh="MaxPool",Cy="MaxPoolGrad",rh="MaxPool3D",Ty="MaxPool3DGrad",Sy="MaxPoolWithArgmax",oh="Mean",ih="Min",Sc="Minimum",ah="MirrorPad",bc="Mod",by="Multinomial",Ic="Multiply",lh="Neg",uh="NotEqual",Iy="NonMaxSuppressionV3",ky="NonMaxSuppressionV4",Ny="NonMaxSuppressionV5",ch="OnesLike",dh="OneHot",fh="Pack",hh="PadV2",y8="Pool",kc="Pow",ph="Prelu",mh="Prod",Ey="RaggedGather",$y="RaggedTensorToTensor",Ay="Range",_y="Real",Nc="Reciprocal",Ec="Relu",gh="Reshape",yh="ResizeNearestNeighbor",Ry="ResizeNearestNeighborGrad",xh="ResizeBilinear",Dy="ResizeBilinearGrad",$c="Relu6",vh="Reverse",Ac="Round",_c="Rsqrt",Fy="ScatterNd",My="SearchSorted",wh="Select",Rc="Selu",Ch="Slice",Dc="Sin",Fc="Sinh",Mc="Sign",Pc="Sigmoid",Lc="Softplus",Oc="Sqrt",Th="Sum",Sh="SpaceToBatchND",bh="SplitV",Ih="Softmax",Py="SparseFillEmptyRows",Ly="SparseReshape",Oy="SparseSegmentMean",Vy="SparseSegmentSum",By="SparseToDense",Vc="SquaredDifference",zy="Square",Uy="StridedSlice",Wy="StringNGrams",Gy="StringSplit",Hy="StringToHashBucketFast",Bc="Sub",zc="Tan",Uc="Tanh",Wc="Tile",qy="TopK",Ky="Transform",sl="Transpose",Xy="Unique",kh="Unpack",Nh="UnsortedSegmentSum",x8="UpperBound",Eh="ZerosLike",Gc="Step",pg="FromPixels",Jy="RotateWithOffset",lf="_FusedMatMul",uf="FusedConv2D",cf="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fr(...n){me().getBool("IS_TEST")||me().getBool("PROD")||console.warn(...n)}function v8(...n){me().getBool("IS_TEST")||me().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _u=U2("kernelRegistry",()=>new Map),df=U2("gradRegistry",()=>new Map);function mg(n,e){const t=W2(n,e);return _u.get(t)}function Rv(n){return df.get(n)}function gg(n){const e=_u.entries(),t=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[o,i]=r,[a]=o.split("_");a===n&&t.push(i)}return t}function Yy(n){const{kernelName:e,backendName:t}=n,s=W2(e,t);_u.has(s)&&fr(`The kernel '${e}' for backend '${t}' is already registered`),_u.set(s,n)}function t3(n){const{kernelName:e}=n;df.has(e)&&me().getBool("DEBUG")&&fr(`Overriding the gradient for '${e}'`),df.set(e,n)}function w8(n,e){const t=W2(n,e);if(!_u.has(t))throw new Error(`The kernel '${n}' for backend '${e}' is not registered`);_u.delete(t)}function C8(n){if(!df.has(n))throw new Error(`The gradient '${n}' for backend is not registered`);df.delete(n)}function T8(n,e){gg(n).forEach(s=>{const r=Object.assign({},s,{backendName:e});Yy(r)})}function W2(n,e){return`${e}_${n}`}var Hx,yk;function S8(){if(yk)return Hx;yk=1,Hx=e;var n=null;try{n=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e(P,F,q){this.low=P|0,this.high=F|0,this.unsigned=!!q}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function t(P){return(P&&P.__isLong__)===!0}e.isLong=t;var s={},r={};function o(P,F){var q,ee,ue;return F?(P>>>=0,(ue=0<=P&&P<256)&&(ee=r[P],ee)?ee:(q=a(P,(P|0)<0?-1:0,!0),ue&&(r[P]=q),q)):(P|=0,(ue=-128<=P&&P<128)&&(ee=s[P],ee)?ee:(q=a(P,P<0?-1:0,!1),ue&&(s[P]=q),q))}e.fromInt=o;function i(P,F){if(isNaN(P))return F?b:S;if(F){if(P<0)return b;if(P>=v)return L}else{if(P<=-w)return z;if(P+1>=w)return R}return P<0?i(-P,F).neg():a(P%y|0,P/y|0,F)}e.fromNumber=i;function a(P,F,q){return new e(P,F,q)}e.fromBits=a;var l=Math.pow;function u(P,F,q){if(P.length===0)throw Error("empty string");if(P==="NaN"||P==="Infinity"||P==="+Infinity"||P==="-Infinity")return S;if(typeof F=="number"?(q=F,F=!1):F=!!F,q=q||10,q<2||36<q)throw RangeError("radix");var ee;if((ee=P.indexOf("-"))>0)throw Error("interior hyphen");if(ee===0)return u(P.substring(1),F,q).neg();for(var ue=i(l(q,8)),ie=S,de=0;de<P.length;de+=8){var ae=Math.min(8,P.length-de),J=parseInt(P.substring(de,de+ae),q);if(ae<8){var te=i(l(q,ae));ie=ie.mul(te).add(i(J))}else ie=ie.mul(ue),ie=ie.add(i(J))}return ie.unsigned=F,ie}e.fromString=u;function d(P,F){return typeof P=="number"?i(P,F):typeof P=="string"?u(P,F):a(P.low,P.high,typeof F=="boolean"?F:P.unsigned)}e.fromValue=d;var f=65536,p=1<<24,y=f*f,v=y*y,w=v/2,C=o(p),S=o(0);e.ZERO=S;var b=o(0,!0);e.UZERO=b;var E=o(1);e.ONE=E;var N=o(1,!0);e.UONE=N;var A=o(-1);e.NEG_ONE=A;var R=a(-1,2147483647,!1);e.MAX_VALUE=R;var L=a(-1,-1,!0);e.MAX_UNSIGNED_VALUE=L;var z=a(0,-2147483648,!1);e.MIN_VALUE=z;var M=e.prototype;return M.toInt=function(){return this.unsigned?this.low>>>0:this.low},M.toNumber=function(){return this.unsigned?(this.high>>>0)*y+(this.low>>>0):this.high*y+(this.low>>>0)},M.toString=function(F){if(F=F||10,F<2||36<F)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(z)){var q=i(F),ee=this.div(q),ue=ee.mul(q).sub(this);return ee.toString(F)+ue.toInt().toString(F)}else return"-"+this.neg().toString(F);for(var ie=i(l(F,6),this.unsigned),de=this,ae="";;){var J=de.div(ie),te=de.sub(J.mul(ie)).toInt()>>>0,oe=te.toString(F);if(de=J,de.isZero())return oe+ae;for(;oe.length<6;)oe="0"+oe;ae=""+oe+ae}},M.getHighBits=function(){return this.high},M.getHighBitsUnsigned=function(){return this.high>>>0},M.getLowBits=function(){return this.low},M.getLowBitsUnsigned=function(){return this.low>>>0},M.getNumBitsAbs=function(){if(this.isNegative())return this.eq(z)?64:this.neg().getNumBitsAbs();for(var F=this.high!=0?this.high:this.low,q=31;q>0&&(F&1<<q)==0;q--);return this.high!=0?q+33:q+1},M.isZero=function(){return this.high===0&&this.low===0},M.eqz=M.isZero,M.isNegative=function(){return!this.unsigned&&this.high<0},M.isPositive=function(){return this.unsigned||this.high>=0},M.isOdd=function(){return(this.low&1)===1},M.isEven=function(){return(this.low&1)===0},M.equals=function(F){return t(F)||(F=d(F)),this.unsigned!==F.unsigned&&this.high>>>31===1&&F.high>>>31===1?!1:this.high===F.high&&this.low===F.low},M.eq=M.equals,M.notEquals=function(F){return!this.eq(F)},M.neq=M.notEquals,M.ne=M.notEquals,M.lessThan=function(F){return this.comp(F)<0},M.lt=M.lessThan,M.lessThanOrEqual=function(F){return this.comp(F)<=0},M.lte=M.lessThanOrEqual,M.le=M.lessThanOrEqual,M.greaterThan=function(F){return this.comp(F)>0},M.gt=M.greaterThan,M.greaterThanOrEqual=function(F){return this.comp(F)>=0},M.gte=M.greaterThanOrEqual,M.ge=M.greaterThanOrEqual,M.compare=function(F){if(t(F)||(F=d(F)),this.eq(F))return 0;var q=this.isNegative(),ee=F.isNegative();return q&&!ee?-1:!q&&ee?1:this.unsigned?F.high>>>0>this.high>>>0||F.high===this.high&&F.low>>>0>this.low>>>0?-1:1:this.sub(F).isNegative()?-1:1},M.comp=M.compare,M.negate=function(){return!this.unsigned&&this.eq(z)?z:this.not().add(E)},M.neg=M.negate,M.add=function(F){t(F)||(F=d(F));var q=this.high>>>16,ee=this.high&65535,ue=this.low>>>16,ie=this.low&65535,de=F.high>>>16,ae=F.high&65535,J=F.low>>>16,te=F.low&65535,oe=0,G=0,ne=0,ye=0;return ye+=ie+te,ne+=ye>>>16,ye&=65535,ne+=ue+J,G+=ne>>>16,ne&=65535,G+=ee+ae,oe+=G>>>16,G&=65535,oe+=q+de,oe&=65535,a(ne<<16|ye,oe<<16|G,this.unsigned)},M.subtract=function(F){return t(F)||(F=d(F)),this.add(F.neg())},M.sub=M.subtract,M.multiply=function(F){if(this.isZero())return S;if(t(F)||(F=d(F)),n){var q=n.mul(this.low,this.high,F.low,F.high);return a(q,n.get_high(),this.unsigned)}if(F.isZero())return S;if(this.eq(z))return F.isOdd()?z:S;if(F.eq(z))return this.isOdd()?z:S;if(this.isNegative())return F.isNegative()?this.neg().mul(F.neg()):this.neg().mul(F).neg();if(F.isNegative())return this.mul(F.neg()).neg();if(this.lt(C)&&F.lt(C))return i(this.toNumber()*F.toNumber(),this.unsigned);var ee=this.high>>>16,ue=this.high&65535,ie=this.low>>>16,de=this.low&65535,ae=F.high>>>16,J=F.high&65535,te=F.low>>>16,oe=F.low&65535,G=0,ne=0,ye=0,Te=0;return Te+=de*oe,ye+=Te>>>16,Te&=65535,ye+=ie*oe,ne+=ye>>>16,ye&=65535,ye+=de*te,ne+=ye>>>16,ye&=65535,ne+=ue*oe,G+=ne>>>16,ne&=65535,ne+=ie*te,G+=ne>>>16,ne&=65535,ne+=de*J,G+=ne>>>16,ne&=65535,G+=ee*oe+ue*te+ie*J+de*ae,G&=65535,a(ye<<16|Te,G<<16|ne,this.unsigned)},M.mul=M.multiply,M.divide=function(F){if(t(F)||(F=d(F)),F.isZero())throw Error("division by zero");if(n){if(!this.unsigned&&this.high===-2147483648&&F.low===-1&&F.high===-1)return this;var q=(this.unsigned?n.div_u:n.div_s)(this.low,this.high,F.low,F.high);return a(q,n.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?b:S;var ee,ue,ie;if(this.unsigned){if(F.unsigned||(F=F.toUnsigned()),F.gt(this))return b;if(F.gt(this.shru(1)))return N;ie=b}else{if(this.eq(z)){if(F.eq(E)||F.eq(A))return z;if(F.eq(z))return E;var de=this.shr(1);return ee=de.div(F).shl(1),ee.eq(S)?F.isNegative()?E:A:(ue=this.sub(F.mul(ee)),ie=ee.add(ue.div(F)),ie)}else if(F.eq(z))return this.unsigned?b:S;if(this.isNegative())return F.isNegative()?this.neg().div(F.neg()):this.neg().div(F).neg();if(F.isNegative())return this.div(F.neg()).neg();ie=S}for(ue=this;ue.gte(F);){ee=Math.max(1,Math.floor(ue.toNumber()/F.toNumber()));for(var ae=Math.ceil(Math.log(ee)/Math.LN2),J=ae<=48?1:l(2,ae-48),te=i(ee),oe=te.mul(F);oe.isNegative()||oe.gt(ue);)ee-=J,te=i(ee,this.unsigned),oe=te.mul(F);te.isZero()&&(te=E),ie=ie.add(te),ue=ue.sub(oe)}return ie},M.div=M.divide,M.modulo=function(F){if(t(F)||(F=d(F)),n){var q=(this.unsigned?n.rem_u:n.rem_s)(this.low,this.high,F.low,F.high);return a(q,n.get_high(),this.unsigned)}return this.sub(this.div(F).mul(F))},M.mod=M.modulo,M.rem=M.modulo,M.not=function(){return a(~this.low,~this.high,this.unsigned)},M.and=function(F){return t(F)||(F=d(F)),a(this.low&F.low,this.high&F.high,this.unsigned)},M.or=function(F){return t(F)||(F=d(F)),a(this.low|F.low,this.high|F.high,this.unsigned)},M.xor=function(F){return t(F)||(F=d(F)),a(this.low^F.low,this.high^F.high,this.unsigned)},M.shiftLeft=function(F){return t(F)&&(F=F.toInt()),(F&=63)===0?this:F<32?a(this.low<<F,this.high<<F|this.low>>>32-F,this.unsigned):a(0,this.low<<F-32,this.unsigned)},M.shl=M.shiftLeft,M.shiftRight=function(F){return t(F)&&(F=F.toInt()),(F&=63)===0?this:F<32?a(this.low>>>F|this.high<<32-F,this.high>>F,this.unsigned):a(this.high>>F-32,this.high>=0?0:-1,this.unsigned)},M.shr=M.shiftRight,M.shiftRightUnsigned=function(F){if(t(F)&&(F=F.toInt()),F&=63,F===0)return this;var q=this.high;if(F<32){var ee=this.low;return a(ee>>>F|q<<32-F,q>>>F,this.unsigned)}else return F===32?a(q,0,this.unsigned):a(q>>>F-32,0,this.unsigned)},M.shru=M.shiftRightUnsigned,M.shr_u=M.shiftRightUnsigned,M.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},M.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},M.toBytes=function(F){return F?this.toBytesLE():this.toBytesBE()},M.toBytesLE=function(){var F=this.high,q=this.low;return[q&255,q>>>8&255,q>>>16&255,q>>>24,F&255,F>>>8&255,F>>>16&255,F>>>24]},M.toBytesBE=function(){var F=this.high,q=this.low;return[F>>>24,F>>>16&255,F>>>8&255,F&255,q>>>24,q>>>16&255,q>>>8&255,q&255]},e.fromBytes=function(F,q,ee){return ee?e.fromBytesLE(F,q):e.fromBytesBE(F,q)},e.fromBytesLE=function(F,q){return new e(F[0]|F[1]<<8|F[2]<<16|F[3]<<24,F[4]|F[5]<<8|F[6]<<16|F[7]<<24,q)},e.fromBytesBE=function(F,q){return new e(F[4]<<24|F[5]<<16|F[6]<<8|F[7],F[0]<<24|F[1]<<16|F[2]<<8|F[3],q)},Hx}var n3=S8();const s3=N2(n3),b8=sM({__proto__:null,default:s3},[n3]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qa=s3||b8;function $h(n){return Qa.fromString(n,!0,16)}const r3=$h("c3a5c85c97cb3127"),Ja=$h("b492b66fbe98f273"),Cs=$h("9ae16a3b2f90404f");function Dv(n){return n.xor(n.shru(47))}function o3(n,e,t){const s=n.slice(e,e+t);return Qa.fromBytes(Array.from(s),!0,!0)}function Ht(n,e){return o3(n,e,8)}function xk(n,e){return o3(n,e,4)}function zn(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function sa(n,e,t=$h("9ddfea08eb382d69")){let s=n.xor(e).mul(t);s=s.xor(s.shru(47));let r=e.xor(s).mul(t);return r=r.xor(r.shru(47)),r=r.mul(t),r}function I8(n,e,t,s,r,o){r=r.add(n),o=zn(o.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(t),o=o.add(zn(r,44)),[r.add(s),o.add(i)]}function Rm(n,e,t,s){return I8(Ht(n,e),Ht(n,e+8),Ht(n,e+16),Ht(n,e+24),t,s)}function k8(n,e=n.length){if(e>=8){const t=Cs.add(e*2),s=Ht(n,0).add(Cs),r=Ht(n,e-8),o=zn(r,37).mul(t).add(s),i=zn(s,25).add(r).mul(t);return sa(o,i,t)}if(e>=4){const t=Cs.add(e*2),s=xk(n,0);return sa(s.shl(3).add(e),xk(n,e-4),t)}if(e>0){const t=n[0],s=n[e>>1],r=n[e-1],o=t+(s<<8),i=e+(r<<2);return Dv(Cs.mul(o).xor(r3.mul(i))).mul(Cs)}return Cs}function N8(n,e=n.length){const t=Cs.add(e*2),s=Ht(n,0).mul(Ja),r=Ht(n,8),o=Ht(n,e-8).mul(t),i=Ht(n,e-16).mul(Cs);return sa(zn(s.add(r),43).add(zn(o,30)).add(i),s.add(zn(r.add(Cs),18)).add(o),t)}function E8(n,e=n.length){const t=Cs.add(e*2),s=Ht(n,0).mul(Cs),r=Ht(n,8),o=Ht(n,e-8).mul(t),i=Ht(n,e-16).mul(Cs),a=zn(s.add(r),43).add(zn(o,30)).add(i),l=sa(a,s.add(zn(r.add(Cs),18)).add(o),t),u=Ht(n,16).mul(t),d=Ht(n,24),f=a.add(Ht(n,e-32)).mul(t),p=l.add(Ht(n,e-24)).mul(t);return sa(zn(u.add(d),43).add(zn(f,30)).add(p),u.add(zn(d.add(s),18)).add(f),t)}function i3(n,e=n.length){const t=Qa.fromNumber(81,!0);if(e<=32)return e<=16?k8(n,e):N8(n,e);if(e<=64)return E8(n,e);let s=t,r=t.mul(Ja).add(113),o=Dv(r.mul(Cs).add(113)).mul(Cs),i=[Qa.UZERO,Qa.UZERO],a=[Qa.UZERO,Qa.UZERO];s=s.mul(Cs).add(Ht(n,0));let l=0;const u=(e-1>>6)*64,d=u+(e-1&63)-63;do s=zn(s.add(r).add(i[0]).add(Ht(n,l+8)),37).mul(Ja),r=zn(r.add(i[1]).add(Ht(n,l+48)),42).mul(Ja),s=s.xor(a[1]),r=r.add(i[0]).add(Ht(n,l+40)),o=zn(o.add(a[0]),33).mul(Ja),i=Rm(n,l,i[1].mul(Ja),s.add(a[0])),a=Rm(n,l+32,o.add(a[1]),r.add(Ht(n,l+16))),[o,s]=[s,o],l+=64;while(l!==u);const f=Ja.add(o.and(255).shl(1));return l=d,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=zn(s.add(r).add(i[0]).add(Ht(n,l+8)),37).mul(f),r=zn(r.add(i[1]).add(Ht(n,l+48)),42).mul(f),s=s.xor(a[1].mul(9)),r=r.add(i[0].mul(9).add(Ht(n,l+40))),o=zn(o.add(a[0]),33).mul(f),i=Rm(n,l,i[1].mul(f),s.add(a[0])),a=Rm(n,l+32,o.add(a[1]),r.add(Ht(n,l+16))),[o,s]=[s,o],sa(sa(i[0],a[0],f).add(Dv(r).mul(r3)).add(o),sa(i[1],a[1],f).add(s),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ci(n,e){return e==="string"?_o(n):ma([n],e)}function $8(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function ma(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=di(n)),me().getBool("DEBUG")&&qE(n,e),$8(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let s=0;s<t.length;++s)Math.round(n[s])!==0&&(t[s]=1);return t}else throw new Error(`Unknown data type ${e}`)}function vs(){return me().platform.now()}function A8(n,e){return me().platform.fetch(n,e)}function _o(n,e="utf-8"){return e=e||"utf-8",me().platform.encode(n,e)}function fi(n,e="utf-8"){return e=e||"utf-8",me().platform.decode(n,e)}const _8=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:Ct,assert:B,assertNonNegativeIntegerDimensions:B2,assertNonNull:Il,assertShapesMatch:ns,bytesFromStringArray:XE,bytesPerElement:ug,checkConversionForErrors:qE,clamp:ia,computeStrides:et,createScalarValue:Ci,createShuffledIndices:u8,decodeString:fi,distSquared:i8,encodeString:_o,fetch:A8,fingerPrint64:i3,flatten:di,getArrayFromDType:Rn,getTypedArrayFromDType:On,hasEncodingLoss:O2,hexToLong:$h,indexToLoc:kl,inferDtype:Ju,inferFromImplicitShape:L2,isBoolean:JE,isFunction:aa,isInt:ul,isNumber:cg,isPromise:cl,isScalarShape:a8,isString:Eo,isTypedArray:cs,isValidDtype:KE,locToIndex:so,makeOnesTypedArray:Kg,makeZerosNestedTypedArray:V2,makeZerosTypedArray:es,nearestDivisor:dg,nearestLargerEven:qg,now:vs,parseAxisParam:gt,randUniform:o8,repeatedTry:_v,rightPad:nl,shuffle:P2,shuffleCombo:r8,sizeFromShape:we,sizeToSquarishShape:lg,squeezeShape:wi,sum:HE,swap:ri,tanh:l8,toNestedArray:gr,toTypedArray:ma},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R8{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new F8)}profileKernel(e,t,s){let r;const o=()=>{r=s()};let i;const a=vs();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const u of r)u.dataSync();i=Promise.resolve({kernelMs:vs()-a})}if(me().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const d=r[u];d.data().then(f=>{D8(f,d.dtype,e)})}return{kernelName:e,outputs:r,inputs:t,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:s,timeMs:r,inputs:o,extraInfo:i}=e;s.forEach(a=>{Promise.all([a.data(),r,i]).then(l=>{this.logger.logKernelProfile(t,a,l[0],l[1],o,l[2])})})}}function D8(n,e,t){if(e!=="float32")return!1;for(let s=0;s<n.length;s++){const r=n[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${t}'`),!0}return!1}class F8{logKernelProfile(e,t,s,r,o,i){const a=typeof r=="number"?nl(`${r}ms`,9):r.error,l=nl(e,25),u=t.rank,d=t.size,f=nl(t.shape.toString(),14);let p="";for(const y in o){const v=o[y];if(v!=null){const w=v.shape||t.shape,C=w.length;p+=`${y}: ${C}D ${C>0?w:""} `}}console.log(`%c${l}	%c${a}	%c${u}D ${f}	%c${d}	%c${p}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M8(n,e,t){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<n.length;l++){const u=n[l],d=u.inputs;for(const f in d){const p=d[f];let y=!1;for(let v=0;v<e.length;v++)if(s[p.id]){u.outputs.forEach(w=>s[w.id]=!0),y=!0,r[u.id]=!0;break}if(y)break}}const o={};o[t.id]=!0;const i={};for(let l=n.length-1;l>=0;l--){const u=n[l],d=u.inputs;for(let f=0;f<u.outputs.length;f++)if(o[u.outputs[f].id]){for(const p in d)o[d[p].id]=!0,i[u.id]=!0;break}}const a=[];for(let l=0;l<n.length;l++){const u=n[l];if(r[u.id]&&i[u.id]){const d={};for(const p in u.inputs){const y=u.inputs[p];s[y.id]&&(d[p]=y)}const f=Object.assign({},u);f.inputs=d,f.outputs=u.outputs,a.push(f)}}return a}function P8(n,e,t,s){for(let r=e.length-1;r>=0;r--){const o=e[r],i=[];if(o.outputs.forEach(l=>{const u=n[l.id];u!=null?i.push(u):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const u=t(()=>a[l]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${u.dtype}'`);const d=o.inputs[l];if(!Ct(u.shape,d.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${u.shape}', which does not match the shape of the input '${d.shape}'`);if(n[d.id]==null)n[d.id]=u;else{const f=n[d.id];n[d.id]=s(f,u),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vk=20,Xd=3,qx=7;function L8(n,e,t,s){const r=et(e),o=O8(n,e,t,r),i=e.length,a=Xm(n,e,t,r,o),l=["Tensor"];return s&&(l.push(`  dtype: ${t}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(u=>"    "+u).join(`
`)),l.join(`
`)}function O8(n,e,t,s){const r=we(e),o=s[s.length-1],i=new Array(o).fill(0),a=e.length,l=t==="complex64"?jd(n):n;if(a>1)for(let u=0;u<r/o;u++){const d=u*o;for(let f=0;f<o;f++)i[f]=Math.max(i[f],Zd(l[d+f],0,t).length)}return i}function Zd(n,e,t){let s;return Array.isArray(n)?s=`${parseFloat(n[0].toFixed(qx))} + ${parseFloat(n[1].toFixed(qx))}j`:Eo(n)?s=`'${n}'`:t==="bool"?s=a3(n):s=parseFloat(n.toFixed(qx)).toString(),nl(s,e)}function a3(n){return n===0?"false":"true"}function Xm(n,e,t,s,r,o=!0){const i=t==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(t==="complex64"){const w=jd(n);return[Zd(w[0],0,t)]}return t==="bool"?[a3(n[0])]:[n[0].toString()]}if(l===1){if(a>vk){const C=Xd*i;let S=Array.from(n.slice(0,C)),b=Array.from(n.slice((a-Xd)*i,a*i));return t==="complex64"&&(S=jd(S),b=jd(b)),["["+S.map((E,N)=>Zd(E,r[N],t)).join(", ")+", ..., "+b.map((E,N)=>Zd(E,r[a-Xd+N],t)).join(", ")+"]"]}return["["+(t==="complex64"?jd(n):Array.from(n)).map((C,S)=>Zd(C,r[S],t)).join(", ")+"]"]}const u=e.slice(1),d=s.slice(1),f=s[0]*i,p=[];if(a>vk){for(let w=0;w<Xd;w++){const C=w*f,S=C+f;p.push(...Xm(n.slice(C,S),u,t,d,r,!1))}p.push("...");for(let w=a-Xd;w<a;w++){const C=w*f,S=C+f;p.push(...Xm(n.slice(C,S),u,t,d,r,w===a-1))}}else for(let w=0;w<a;w++){const C=w*f,S=C+f;p.push(...Xm(n.slice(C,S),u,t,d,r,w===a-1))}const y=l===2?",":"";p[0]="["+p[0]+y;for(let w=1;w<p.length-1;w++)p[w]=" "+p[w]+y;let v=`,
`;for(let w=2;w<l;w++)v+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(o?"":v),p}function jd(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mn{constructor(e,t,s){if(this.dtype=t,this.shape=e.slice(),this.size=we(e),s!=null){const r=s.length;B(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Rn(t,this.size),this.strides=et(e)}set(e,...t){t.length===0&&(t=[0]),B(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const s=this.locToIndex(t);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const r of e){if(r<0||r>=this.shape[t]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}t++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let s=0;s<e.length-1;++s)t+=this.strides[s]*e[s];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let s=0;s<t.length-1;++s)t[s]=Math.floor(e/this.strides[s]),e-=t[s]*this.strides[s];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return jr().makeTensor(this.values,this.shape,this.dtype)}}let jr=null,wu=null;function V8(n){jr=n}function B8(n){wu=n}class St{constructor(e,t,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=we(e),this.strides=et(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return wu.buffer(this.shape,this.dtype,e)}bufferSync(){return wu.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return gr(this.shape,e,this.dtype==="complex64")}arraySync(){return gr(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=jr().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(s=>fi(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),jr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=jr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>fi(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await jr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(jr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return wu.print(this,e)}clone(){return this.throwIfDisposed(),wu.clone(this)}toString(e=!1){const t=this.dataSync();return L8(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),wu.cast(this,e)}variable(e=!0,t,s){return this.throwIfDisposed(),jr().makeVariable(this,e,t,s)}}Object.defineProperty(St,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function Ce(){return U2("Tensor",()=>St)}Ce();class ff extends St{constructor(e,t,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=t,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Ct(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);jr().disposeTensor(this),this.dataId=e.dataId,jr().incRef(this,null)}dispose(){jr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(ff,Symbol.hasInstance,{value:n=>n instanceof St&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Fv;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(Fv||(Fv={}));var Mv;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(Mv||(Mv={}));var Pv;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(Pv||(Pv={}));var Lv;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(Lv||(Lv={}));var Ov;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(Ov||(Ov={}));const z8={float32:Lv,int32:Mv,bool:Pv,complex64:Ov};function Os(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return z8[n][e]}function Qy(n){return Os(n,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fn(n,e){if(n.dtype===e.dtype)return[n,e];const t=Os(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function l3(n,e){B(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function U8(n,e){return e.some(t=>t.id===n.id)}function G2(n){const e=[];return u3(n,e,new Set),e}function u3(n,e,t){if(n==null)return;if(n instanceof St){e.push(n);return}if(!W8(n))return;const s=n;for(const r in s){const o=s[r];t.has(o)||(t.add(o),u3(o,e,t))}}function W8(n){return Array.isArray(n)||typeof n=="object"}const G8=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:l3,getTensorsInContainer:G2,isTensorInList:U8,makeTypesMatch:fn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kx(n){return n.kernelName!=null}class wk{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Ru{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new wk}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,s=1){return e in this.registryFactory?(fr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:s}=this.initializeBackend(e);if(!(s?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new R8(this.backendInstance),!0}setupRegisteredKernels(){gg(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){gg(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=t.factory();if(s&&!(s instanceof Hg)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,o=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,fr(`Initialization of backend ${e} failed`),fr(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return fr(`Initialization of backend ${e} failed`),fr(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const s=e[t],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const s=this.state.tensorInfo.get(t),r=s.backend,o=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),s.backend=e,e.move(t,o,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let s=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=t(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,t,s){e();try{const r=s();return t(),r}catch(r){throw t(),r}}nextTensorId(){return Ru.nextTensorId++}nextVariableId(){return Ru.nextVariableId++}clone(e){const t=Q.runKernel(gc,{x:e}),s={x:e},r=i=>({x:()=>{const a="float32",l={x:i},u={dtype:a};return Q.runKernel(sc,l,u)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[t],r,o,{}),t}runKernel(e,t,s){if(this.backendName==null&&this.backend,!(mg(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,s){const r=this.backend.numDataIds();let o=0;s.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-t-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,s=[];const r=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const u=Kx(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Kx(e)){const{kernelName:v,inputs:w,attrs:C}=e;this.backendName==null&&this.backend;const S=mg(v,this.backendName);B(S!=null,()=>`Cannot find registered kernel '${v}' for backend '${this.backendName}'`),a=()=>{const b=this.backend.numDataIds();l=S.kernelFunc({inputs:w,attrs:C,backend:this.backend});const E=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(v,b,E);const N=E.map(A=>A.rank!=null?A:this.makeTensorFromTensorInfo(A));if(r){const A=this.getTensorsForGradient(v,w,N);s=this.saveTensorsForBackwardMode(A)}return N}}else{const{forwardFunc:v}=e,w=C=>{r&&(s=C.map(S=>this.keep(this.clone(S))))};a=()=>{const C=this.backend.numDataIds();l=this.tidy(()=>v(this.backend,w));const S=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,C,S),S}}const{inputs:d,attrs:f}=e,p=Kx(e)?null:e.backwardsFunc;let y;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=a():(y=this.profiler.profileKernel(u,d,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(y),t=y.outputs)}),r&&this.addTapeNode(u,d,t,p,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(d).map(v=>d[v]!=null?d[v].shape:null),outputShapes:t.map(v=>v.shape),kernelTimeMs:y.timeMs,extraInfo:y.extraInfo}),Array.isArray(l)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,t,s){const r=Rv(e);if(r!=null){const o=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(B(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(u=>t[u])):a=o.map(u=>t[u]);const l=s.filter((u,d)=>i[d]);return a.concat(l)}return[]}makeTensor(e,t,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let o=e;s==="string"&&Eo(e[0])&&(o=e.map(l=>_o(l)));const i=r.write(o,t,s),a=new St(t,s,i,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(i),u=XE(o);this.state.numBytes+=u-l.bytes,l.bytes=u}return a}makeTensorFromDataId(e,t,s,r){s=s||"float32";const o={dataId:e,shape:t,dtype:s};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(e,t){const{dataId:s,shape:r,dtype:o}=e,i=new St(r,o,s,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const o=new ff(e,t,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*ug(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof ff||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*ug(e.dtype);this.state.numBytes-=s}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,s,r,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:s,saved:o},l=Rv(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=u=>(u=u.map((d,f)=>{if(d==null){const p=s[f],y=es(p.size,p.dtype);return this.makeTensor(y,p.shape,p.dtype)}return d}),r(u.length>1?u:u[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=G2(e),s=new Set(t.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(e,t,s,r=!1){if(B(t.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));B(o instanceof St,()=>"The result y returned by f() must be a tensor.");const i=M8(this.state.activeTape,t,o);if(!r&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=s??H8(o.shape),P8(a,i,u=>this.tidy(u),q8);const l=t.map(u=>a[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const d of u.saved)d.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return B(aa(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{B(t.every(a=>a instanceof St),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};t.forEach((a,l)=>{r[l]=a});const o=(a,l)=>(s=e(...t,l),B(s.value instanceof St,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),B(aa(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,l)=>{const u=s.gradFunc(a,l),d=Array.isArray(u)?u:[u];B(d.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),B(d.every(p=>p instanceof St),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return d.forEach((p,y)=>{f[y]=()=>p}),f};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=vs(),s=await this.backend.time(e);return s.wallMs=vs()-t,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new wk;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Ru.nextTensorId=0;Ru.nextVariableId=0;function H8(n){const e=Kg(we(n),"float32");return Q.makeTensor(e,n,"float32")}function c3(){const n=ZE();if(n._tfengine==null){const e=new QE(n);n._tfengine=new Ru(e)}return h8(n._tfengine.ENV),V8(()=>n._tfengine),n._tfengine}const Q=c3();function q8(n,e){const t={a:n,b:e};return Q.runKernel(Nl,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(){return typeof navigator<"u"&&navigator!=null}let Vv;function X8(n){Vv=n}function H2(n){if(Vv!==void 0)return Vv;if(n||K8()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function q2(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const J8=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:q2,isMobile:H2,mockIsMobile:X8},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zs=me();Zs.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Zs.registerFlag("IS_BROWSER",()=>q2());Zs.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Zs.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Zs.registerFlag("PROD",()=>!1);Zs.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Zs.getBool("DEBUG"));Zs.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Zs.registerFlag("IS_TEST",()=>!1);Zs.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Zs.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Zs.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);Zs.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Zs.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mo(n,e){let t=n;if(cs(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];const s=[];for(;Array.isArray(t)||cs(t)&&e!=="string";)s.push(t.length),t=t[0];return Array.isArray(n)&&me().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&d3(n,s,[]),s}function d3(n,e,t){if(t=t||[],!Array.isArray(n)&&!cs(n)){B(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}B(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),B(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const s=e.slice(1);for(let r=0;r<n.length;++r)d3(n[r],s,t.concat(r))}function Ck(n,e,t,s){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${s}' must be ${n} tensor, but got ${e} tensor`)}}function U(n,e,t,s="numeric"){if(n instanceof St)return Ck(s,n.dtype,e,t),n;let r=Ju(n);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),Ck(s,r,e,t),n==null||!cs(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const l=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Mo(n,r);!cs(n)&&!Array.isArray(n)&&(n=[n]);const a=r!=="string"?ma(n,r):di(n,[],!0);return Q.makeTensor(a,o,r)}function hf(n,e,t,s="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((o,i)=>U(o,`${e}[${i}]`,t,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K2="__op";function Z(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const s=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+K2;const r=(...o)=>{Q.startScope(t);try{const i=s(...o);return cl(i)&&console.error("Cannot return a Promise inside of tidy."),Q.endScope(i),i}catch(i){throw Q.endScope(null),i}};return Object.defineProperty(r,"name",{value:t,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y8(n,e){const t=U(n,"real","complex"),s=U(e,"imag","complex");ns(t.shape,s.shape,`real and imag shapes, ${t.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:t,imag:s};return Q.runKernel(ey,r)}const hi=Z({complex_:Y8});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ga(n,e,t,s){if(s==null&&(s=Ju(n)),s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!cs(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){B2(e);const r=we(e),o=we(t);B(r===o,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${o}`);for(let i=0;i<t.length;++i){const a=t[i],l=i===t.length-1?a!==we(e.slice(i)):!0;B(t[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!cs(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=s!=="string"?ma(n,s):di(n,[],!0),Q.makeTensor(n,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ro(n,e,t){const s=Mo(n,t);return ga(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bv={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yg=4;async function zv(n,e){const t=[],s=[],r=Array.isArray(n)?n.map(i=>i.name):Object.keys(n);for(let i=0;i<r.length;++i){const a=r[i],l=Array.isArray(n)?n[i].tensor:n[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const u={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const d=new Promise(async f=>{const p=await l.bytes(),y=p.reduce((C,S)=>C+S.length,0)+yg*p.length,v=new Uint8Array(y);let w=0;for(let C=0;C<p.length;C++){const S=p[C],b=new Uint8Array(new Uint32Array([S.length]).buffer);v.set(b,w),w+=yg,v.set(S,w),w+=S.length}f(v)});s.push(d)}else s.push(l.data());e!=null&&(u.group=e),t.push(u)}const o=await Promise.all(s);return{data:Q8(o),specs:t}}function f3(n,e){const t={};let s,r=0;for(const o of e){const i=o.name,a=o.dtype,l=o.shape,u=we(l);let d;if("quantization"in o){const f=o.quantization;if(f.dtype==="uint8"||f.dtype==="uint16"){if(!("min"in f&&"scale"in f))throw new Error(`Weight ${o.name} with quantization ${f.dtype} doesn't have corresponding metadata min and scale.`)}else if(f.dtype==="float16"){if(a!=="float32")throw new Error(`Weight ${o.name} is quantized with ${f.dtype} which only supports weights of type float32 not ${a}.`)}else throw new Error(`Weight ${o.name} has unknown quantization dtype ${f.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const p=Bv[f.dtype],y=n.slice(r,r+u*p),v=f.dtype==="uint8"?new Uint8Array(y):new Uint16Array(y);if(a==="float32")if(f.dtype==="uint8"||f.dtype==="uint16"){d=new Float32Array(v.length);for(let w=0;w<v.length;w++){const C=v[w];d[w]=C*f.scale+f.min}}else if(f.dtype==="float16")s===void 0&&(s=s7()),d=s(v);else throw new Error(`Unsupported quantization type ${f.dtype} for weight type float32.`);else if(a==="int32"){if(f.dtype!=="uint8"&&f.dtype!=="uint16")throw new Error(`Unsupported quantization type ${f.dtype} for weight type int32.`);d=new Int32Array(v.length);for(let w=0;w<v.length;w++){const C=v[w];d[w]=Math.round(C*f.scale+f.min)}}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);r+=u*p}else if(a==="string"){const f=we(o.shape);d=[];for(let p=0;p<f;p++){const y=new Uint32Array(n.slice(r,r+yg))[0];r+=yg;const v=new Uint8Array(n.slice(r,r+y));d.push(v),r+=y}}else{const f=Bv[a],p=n.slice(r,r+u*f);if(a==="float32")d=new Float32Array(p);else if(a==="int32")d=new Int32Array(p);else if(a==="bool")d=new Uint8Array(p);else if(a==="complex64"){d=new Float32Array(p);const y=new Float32Array(d.length/2),v=new Float32Array(d.length/2);for(let S=0;S<y.length;S++)y[S]=d[S*2],v[S]=d[S*2+1];const w=ro(y,l,"float32"),C=ro(v,l,"float32");t[i]=hi(w,C),w.dispose(),C.dispose()}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);r+=u*f}a!=="complex64"&&(t[i]=ro(d,l,a))}return t}function Q8(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(o=>{if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const s=new Uint8Array(e);let r=0;return t.forEach(o=>{s.set(new Uint8Array(o.buffer),r),r+=o.byteLength}),s.buffer}const X2=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function Tk(n){return X2?Buffer.byteLength(n):new Blob([n]).size}function Z8(n){if(X2)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let s=0,r=e.length;s<r;s++)t+=String.fromCharCode(e[s]);return btoa(t)}function j8(n){if(X2){const s=Buffer.from(n,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let s=0;s<e.length;++s)t.set([e.charCodeAt(s)],s);return t.buffer}function Zy(n){if(n.length===1)return n[0];let e=0;n.forEach(r=>{e+=r.byteLength});const t=new Uint8Array(e);let s=0;return n.forEach(r=>{t.set(new Uint8Array(r),s),s+=r.byteLength}),t.buffer}function Sk(n){for(n=n.trim();n.endsWith("/");)n=n.slice(0,n.length-1);const t=n.split("/");return t[t.length-1]}function h3(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function J2(n,e,t){const s={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(s.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=t}return n.signature!=null&&(s.signature=n.signature),n.userDefinedMetadata!=null&&(s.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(s.modelInitializer=n.modelInitializer),s}async function Y2(n,e){let t,s;return n.weightsManifest!=null&&([t,s]=await e(n.weightsManifest)),J2(n,t,s)}function Ah(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:Tk(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:Tk(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}function Q2(n){const e=[];for(const t of n)e.push(...t.weights);return e}function e7(){const n=t=>{let s=t<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function t7(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function n7(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function s7(){const n=e7(),e=t7(),t=n7();return s=>{const r=new ArrayBuffer(4*s.length),o=new Uint32Array(r);for(let i=0;i<s.length;i++){const a=s[i],l=n[t[a>>10]+(a&1023)]+e[a>>10];o[i]=l}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ln{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return ln.instance==null&&(ln.instance=new ln),ln.instance}static registerSaveRouter(e){ln.getInstance().saveRouters.push(e)}static registerLoadRouter(e){ln.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return ln.getHandlers(e,"save")}static getLoadHandlers(e,t){return ln.getHandlers(e,"load",t)}static getHandlers(e,t,s){const r=[];return(t==="load"?ln.getInstance().loadRouters:ln.getInstance().saveRouters).forEach(i=>{const a=i(e,s);a!==null&&r.push(a)}),r}}const r7=n=>ln.registerSaveRouter(n),o7=n=>ln.registerLoadRouter(n),p3=n=>ln.getSaveHandlers(n),i7=(n,e)=>ln.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uv="tensorflowjs",Wv=1,el="models_store",ta="model_info_store";function m3(){if(!me().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Gv(n){const e=n.result;e.createObjectStore(el,{keyPath:"modelPath"}),e.createObjectStore(ta,{keyPath:"modelPath"})}class dl{constructor(e){if(this.indexedDB=m3(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((s,r)=>{const o=this.indexedDB.open(Uv,Wv);o.onupgradeneeded=()=>Gv(o),o.onsuccess=()=>{const i=o.result;if(t==null){const a=i.transaction(el,"readonly"),u=a.objectStore(el).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=d=>(i.close(),r(u.error)),a.oncomplete=()=>i.close()}else{const a=Ah(t),l=i.transaction(ta,"readwrite");let u=l.objectStore(ta);const d=u.put({modelPath:this.modelPath,modelArtifactsInfo:a});let f;d.onsuccess=()=>{f=i.transaction(el,"readwrite");const y=f.objectStore(el).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a});y.onsuccess=()=>s({modelArtifactsInfo:a}),y.onerror=v=>{u=l.objectStore(ta);const w=u.delete(this.modelPath);w.onsuccess=()=>(i.close(),r(y.error)),w.onerror=C=>(i.close(),r(y.error))}},d.onerror=p=>(i.close(),r(d.error)),l.oncomplete=()=>{f==null?i.close():f.oncomplete=()=>i.close()}}},o.onerror=i=>r(o.error)})}}dl.URL_SCHEME="indexeddb://";const g3=n=>me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(dl.URL_SCHEME)?a7(n.slice(dl.URL_SCHEME.length)):null;ln.registerSaveRouter(g3);ln.registerLoadRouter(g3);function a7(n){return new dl(n)}function l7(n){return n.startsWith(dl.URL_SCHEME)?n.slice(dl.URL_SCHEME.length):n}class u7{constructor(){this.indexedDB=m3()}async listModels(){return new Promise((e,t)=>{const s=this.indexedDB.open(Uv,Wv);s.onupgradeneeded=()=>Gv(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(ta,"readonly"),a=o.objectStore(ta).getAll();a.onsuccess=()=>{const l={};for(const u of a.result)l[u.modelPath]=u.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),t(a.error)),o.oncomplete=()=>r.close()},s.onerror=r=>t(s.error)})}async removeModel(e){return e=l7(e),new Promise((t,s)=>{const r=this.indexedDB.open(Uv,Wv);r.onupgradeneeded=()=>Gv(r),r.onsuccess=()=>{const o=r.result,i=o.transaction(ta,"readwrite"),a=i.objectStore(ta),l=a.get(e);let u;l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const d=a.delete(e),f=()=>{u=o.transaction(el,"readwrite");const y=u.objectStore(el).delete(e);y.onsuccess=()=>t(l.result.modelArtifactsInfo),y.onerror=v=>s(l.error)};d.onsuccess=f,d.onerror=p=>(f(),o.close(),s(l.error))}},l.onerror=d=>(o.close(),s(l.error)),i.oncomplete=()=>{u==null?o.close():u.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oi="/",Cu="tensorflowjs_models",y3="info",c7="model_topology",d7="weight_specs",f7="weight_data",h7="model_metadata";function x3(n){return{info:[Cu,n,y3].join(oi),topology:[Cu,n,c7].join(oi),weightSpecs:[Cu,n,d7].join(oi),weightData:[Cu,n,f7].join(oi),modelMetadata:[Cu,n,h7].join(oi)}}function v3(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function p7(n){const e=n.split(oi);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(oi)}function m7(n){return n.startsWith(fl.URL_SCHEME)?n.slice(fl.URL_SCHEME.length):n}class fl{constructor(e){if(!me().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=x3(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Ah(e);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,Z8(e.weightData));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:r}}catch{throw v3(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,a.signature!=null&&(t.signature=a.signature),a.userDefinedMetadata!=null&&(t.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(t.modelInitializer=a.modelInitializer),a.trainingConfig!=null&&(t.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=j8(i),t}}fl.URL_SCHEME="localstorage://";const w3=n=>me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(fl.URL_SCHEME)?g7(n.slice(fl.URL_SCHEME.length)):null;ln.registerSaveRouter(w3);ln.registerLoadRouter(w3);function g7(n){return new fl(n)}class y7{constructor(){B(me().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),B(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=Cu+oi,s=oi+y3;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(t)&&o.endsWith(s)){const i=p7(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=m7(e);const t=x3(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(t.info));return v3(t),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nu="://";class ws{constructor(){this.managers={}}static getInstance(){return ws.instance==null&&(ws.instance=new ws),ws.instance}static registerManager(e,t){B(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Nu)&&(e=e.slice(0,e.indexOf(Nu))),B(e.length>0,()=>"scheme must not be an empty string.");const s=ws.getInstance();B(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=t}static getManager(e){const t=ws.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(ws.getInstance().managers)}}function Jm(n){if(n.indexOf(Nu)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ws.getSchemes().join(",")}`);return{scheme:n.split(Nu)[0],path:n.split(Nu)[1]}}async function C3(n,e,t=!1){B(n!==e,()=>`Old path and new path are the same: '${n}'`);const s=ln.getLoadHandlers(n);B(s.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),B(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${n}.`);const r=s[0],o=ln.getSaveHandlers(e);B(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),B(o.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const i=o[0],a=Jm(n).scheme,l=Jm(n).path,u=a===Jm(n).scheme,d=await r.load();t&&u&&await ws.getManager(a).removeModel(l);const f=await i.save(d);return t&&!u&&await ws.getManager(a).removeModel(l),f.modelArtifactsInfo}async function x7(){const n=ws.getSchemes(),e={};for(const t of n){const s=await ws.getManager(t).listModels();for(const r in s){const o=t+Nu+r;e[o]=s[r]}}return e}async function v7(n){const e=Jm(n);return ws.getManager(e.scheme).removeModel(e.path)}async function w7(n,e){return C3(n,e,!1)}async function C7(n,e){return C3(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T7{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(!window||!me().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(me().get("IS_BROWSER")){me().setPlatform("browser",new T7);try{ws.registerManager(fl.URL_SCHEME,new y7)}catch{}try{ws.registerManager(dl.URL_SCHEME,new u7)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S7={importFetch:()=>require("node-fetch")};let Xx;class b7{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return me().global.fetch!=null?me().global.fetch(e,t):(Xx==null&&(Xx=S7.importFetch()),Xx(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}}me().get("IS_NODE")&&!me().get("IS_BROWSER")&&me().setPlatform("node",new b7);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ht(n,e="float32",t){return e=e||"float32",B2(n),new Mn(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I7(n,e){const t=U(n,"x","cast");if(!KE(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:t},r={dtype:e};return Q.runKernel(sc,s,r)}const Me=Z({cast_:I7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7(n){const t={x:U(n,"x","clone","string_or_numeric")};return Q.runKernel(gc,t)}const Ro=Z({clone_:k7});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z2(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */c3();const N7={buffer:ht,cast:Me,clone:Ro,print:Z2};B8(N7);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E7="model",$7=".json",A7=".weights.bin";function bk(n){return new Promise(e=>setTimeout(e)).then(n)}class hl{constructor(e){if(!me().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(hl.URL_SCHEME)&&(e=e.slice(hl.URL_SCHEME.length)),(e==null||e.length===0)&&(e=E7),this.modelJsonFileName=e+$7,this.weightDataFileName=e+A7}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const s=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r=h3(e,s),o=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=o,await bk(()=>i.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;a.download=this.weightDataFileName,a.href=t,await bk(()=>a.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Ah(e)}}}}hl.URL_SCHEME="downloads://";class _7{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const s=new FileReader;s.onload=r=>{const o=JSON.parse(r.target.result),i=o.modelTopology;if(i==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const l=Y2(o,u=>this.loadWeights(u));e(l)},s.onerror=r=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const t=[],s=[];for(const i of e)t.push(...i.weights),s.push(...i.paths);const r=this.checkManifestAndWeightFiles(e),o=s.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(o).then(i=>[t,Zy(i)])}loadWeightsFile(e,t){return new Promise((s,r)=>{const o=new FileReader;o.onload=i=>{const a=i.target.result;s(a)},o.onerror=i=>r(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],s=this.weightsFiles.map(o=>Sk(o.name)),r={};for(const o of e)o.paths.forEach(i=>{const a=Sk(i);if(t.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(t.push(a),s.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);r[i]=this.weightsFiles[s.indexOf(a)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const R7=n=>me().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(hl.URL_SCHEME)?D7(n.slice(hl.URL_SCHEME.length)):null;ln.registerSaveRouter(R7);function D7(n="model"){return new hl(n)}function F7(n){return new _7(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ik(n,e,t,s){i(n),t=t??0,s=s??1,a(t,s);let r=0;const o=l=>(l.then(u=>{const d=t+ ++r/n.length*(s-t);return e(d),u}),l);function i(l){B(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function a(l,u){B(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),B(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),B(u>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${u}`)}return Promise.all(n.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function T3(n,e){e==null&&(e={});const t=e.fetchFunc==null?me().platform.fetch:e.fetchFunc,s=n.map(f=>t(f,e.requestInit,{isBinary:!0})),a=(e.onProgress==null?await Promise.all(s):await Ik(s,e.onProgress,0,.5)).map(f=>f.arrayBuffer());return e.onProgress==null?await Promise.all(a):await Ik(a,e.onProgress,.5,1)}async function M7(n,e="",t,s){return S3(i=>T3(i,{requestInit:s}))(n,e,t)}function S3(n){return async(e,t="",s)=>{const r=e.map(()=>!1),o={},i=s!=null?s.map(()=>!1):[],a=[];if(e.forEach((y,v)=>{let w=0;y.weights.forEach(C=>{const S="quantization"in C?C.quantization.dtype:C.dtype,b=Bv[S]*we(C.shape),E=()=>{r[v]=!0,o[v]==null&&(o[v]=[]),o[v].push({manifestEntry:C,groupOffset:w,sizeBytes:b})};s!=null?s.forEach((N,A)=>{N===C.name&&(E(),i[A]=!0)}):E(),a.push(C.name),w+=b})}),!i.every(y=>y)){const y=s.filter((v,w)=>!i[w]);throw new Error(`Could not find weights in manifest with names: ${y.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const l=r.reduce((y,v,w)=>(v&&y.push(w),y),[]),u=[];l.forEach(y=>{e[y].paths.forEach(v=>{const w=t+(t.endsWith("/")?"":"/")+v;u.push(w)})});const d=await n(u),f={};let p=0;return l.forEach(y=>{const v=e[y].paths.length;let w=0;for(let N=0;N<v;N++)w+=d[p+N].byteLength;const C=new ArrayBuffer(w),S=new Uint8Array(C);let b=0;for(let N=0;N<v;N++){const A=new Uint8Array(d[p+N]);S.set(A,b),b+=A.byteLength}o[y].forEach(N=>{const A=C.slice(N.groupOffset,N.groupOffset+N.sizeBytes),R=f3(A,[N.manifestEntry]);for(const L in R)f[L]=R[L]}),p+=v}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P7="application/octet-stream",L7="application/json";class j2{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(B(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=me().platform.fetch,B(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&B(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=h3(e,s);t.body.append("model.json",new Blob([JSON.stringify(r)],{type:L7}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:P7}),"model.weights.bin");const o=await this.fetch(this.path,t);if(o.ok)return{modelArtifactsInfo:Ah(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=t.modelTopology,r=t.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return Y2(t,o=>this.loadWeights(o))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=O7(t),o=this.weightPathPrefix||s,i=Q2(e),a=[],l=[];for(const d of e)for(const f of d.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(f)):a.push(o+f+r);this.weightUrlConverter&&a.push(...await Promise.all(l));const u=await T3(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,Zy(u)]}}j2.URL_SCHEME_REGEX=/^https?:\/\//;function O7(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),s=n.substring(0,e),r=t>e?n.substring(t):"";return[s+"/",r]}function Hv(n){return n.match(j2.URL_SCHEME_REGEX)!=null}const b3=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(s=>Hv(s)):t=Hv(n),t)return ew(n,e)}return null};ln.registerSaveRouter(b3);ln.registerLoadRouter(b3);function ew(n,e){return new j2(n,e)}function V7(n,e){return ew(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jx{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class I3{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class B7{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function z7(n,e,t,s){const r=arguments;return new B7(xg(...r))}function xg(n,e,t,s){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new Jx(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jx({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Jx({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:s}))}function U7(n){return new I3(n)}function W7(n){return new I3(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tw=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:F7,browserHTTPRequest:V7,concatenateArrayBuffers:Zy,copyModel:w7,decodeWeights:f3,encodeWeights:zv,fromMemory:z7,fromMemorySync:xg,getLoadHandlers:i7,getModelArtifactsForJSON:Y2,getModelArtifactsForJSONSync:J2,getModelArtifactsInfoForJSON:Ah,getSaveHandlers:p3,getWeightSpecs:Q2,http:ew,isHTTPScheme:Hv,listModels:x7,loadWeights:M7,moveModel:C7,registerLoadRouter:o7,registerSaveRouter:r7,removeModel:v7,weightsLoaderFactory:S3,withSaveHandler:U7,withSaveHandlerSync:W7},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7(n,e,t=!1,s=!1){let r=U(n,"a","matMul"),o=U(e,"b","matMul");[r,o]=fn(r,o);const i={a:r,b:o},a={transposeA:t,transposeB:s};return Q.runKernel(Ff,i,a)}const mt=Z({matMul_:G7});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H7(n,e,t=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:U(n,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:t,offValue:s};return Q.runKernel(dh,i,a)}const Du=Z({oneHot_:H7});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q7(){me().set("PROD",!0)}function K7(){me().set("DEBUG",!0)}function X7(){me().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function J7(n){me().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(n+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Y7(){Q.disposeVariables()}function ti(){return Q}function qv(){return Q.memory()}function Q7(n){return Q.profile(n)}function he(n,e){return Q.tidy(n,e)}function lt(n){G2(n).forEach(t=>t.dispose())}function Un(n){return Q.keep(n)}function Z7(n){return Q.time(n)}function k3(n){return Q.setBackend(n)}function N3(){return Q.ready()}function j7(){return Q.backendName}function eW(n){Q.removeBackend(n)}function tW(n){return Q.findBackend(n)}function nW(n){return Q.findBackendFactory(n)}function nw(n,e,t=1){return Q.registerBackend(n,e,t)}function E3(){return Q.backend}function sW(n,e){me().setPlatform(n,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rW(n){const t={input:U(n,"input","imag")};return Q.runKernel(xy,t)}const _h=Z({imag_:rW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oW(n){const t={x:U(n,"x","neg")};return Q.runKernel(lh,t)}const Qt=Z({neg_:oW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iW(n){const t={input:U(n,"input","real")};return Q.runKernel(_y,t)}const Fu=Z({real_:iW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aW(n,e,t){const s=U(n,"x","transpose");if(e==null&&(e=s.shape.map((i,a)=>a).reverse()),B(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{B(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},o={perm:e};return s.dtype==="complex64"?he(()=>{let i=Fu(s),a=_h(s);return i=Q.runKernel(sl,{x:i},o),a=Q.runKernel(sl,{x:a},o),t&&(a=Qt(a)),hi(i,a)}):Q.runKernel(sl,r,o)}const xt=Z({transpose_:aW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lW(n,e,t){const s=U(n,"labels","confusionMatrix"),r=U(e,"predictions","confusionMatrix");B(t==null||t>0&&Number.isInteger(t),()=>`If provided, numClasses must be a positive integer, but got ${t}`),B(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),B(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),B(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),B(t>0&&Number.isInteger(t),()=>`numClasses is required to be a positive integer, but got ${t}`);const o=Du(Me(s,"int32"),t),i=Du(Me(r,"int32"),t),a=xt(o),l=mt(a,i);return Me(l,"int32")}const uW=Z({confusionMatrix_:lW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cW=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:uW},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pl(n,e){const t=n.length,s=[];for(let r=0;r<t;r++){const o=t-1-r,i=n[o]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(o)}return s}function En(n,e){const t=[];for(let s=0;s<e.length;s++){const r=n[n.length-s-1],o=e.length-s-1,i=e[o];(r==null||r===1&&i>1)&&t.unshift(o)}return t}function dt(n,e){const t=[],s=Math.max(n.length,e.length);for(let r=0;r<s;r++){let o=n[n.length-r-1];o==null&&(o=1);let i=e[e.length-r-1];if(i==null&&(i=1),o===1)t.unshift(i);else if(i===1)t.unshift(o);else if(o!==i){const a=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(a)}else t.unshift(o)}return t}const dW=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:dt,getBroadcastDims:pl,getReductionAxes:En},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sw(n,e,t){if(Il(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Mo(n,t);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return ga(n,e,s,t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Ha;function $3(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,s=!1,r=!1,o=!1,i=!1,a=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)o=!0;else if(n.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(mg(pg,Q.backendName)!=null){const v={pixels:n},w={numChannels:e};return Q.runKernel(pg,v,w)}const[u,d]=r?[n.videoWidth,n.videoHeight]:[n.width,n.height];let f;if(i)f=n.getContext("2d").getImageData(0,0,u,d).data;else if(s||t)f=n.data;else if(o||r||a){if(Ha==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Ha=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Ha=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Ha.canvas.width=u,Ha.canvas.height=d,Ha.drawImage(n,0,0,u,d),f=Ha.getImageData(0,0,u,d).data}let p;if(e===4)p=new Int32Array(f);else{const v=u*d;p=new Int32Array(v*e);for(let w=0;w<v;w++)for(let C=0;C<e;++C)p[w*e+C]=f[w*4+C]}return sw(p,[d,u,e],"int32")}function fW(n){return n!=null&&n.data instanceof Uint8Array}function hW(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function pW(n){return n!=null&&n.width!==0&&n.height!==0}function mW(n){return hW()&&!(n instanceof ImageBitmap)&&pW(n)&&!fW(n)}async function gW(n,e=3){let t=null;if(me().getBool("WRAP_TO_IMAGEBITMAP")&&mW(n)){let s;try{s=await createImageBitmap(n,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===n.width&&s.height===n.height?t=s:t=n}else t=n;return $3(t,e)}async function rw(n,e){let t=U(n,"img","toPixels");if(!(n instanceof St)){const u=t;t=Me(u,"int32"),u.dispose()}if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const[s,r]=t.shape.slice(0,2),o=t.rank===2?1:t.shape[2];if(o>4||o===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${o}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`);const i=await t.data(),a=t.dtype==="float32"?255:1,l=new Uint8ClampedArray(r*s*4);for(let u=0;u<s*r;++u){const d=[0,0,0,255];for(let p=0;p<o;p++){const y=i[u*o+p];if(t.dtype==="float32"){if(y<0||y>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${y}.`)}else if(t.dtype==="int32"&&(y<0||y>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${y}.`);o===1?(d[0]=y*a,d[1]=y*a,d[2]=y*a):d[p]=y*a}const f=u*4;l[f+0]=Math.round(d[0]),l[f+1]=Math.round(d[1]),l[f+2]=Math.round(d[2]),l[f+3]=Math.round(d[3])}if(e!=null){e.width=r,e.height=s;const u=e.getContext("2d"),d=new ImageData(l,r,s);u.putImageData(d,0,0)}return t!==n&&t.dispose(),l}const ow=Z({fromPixels_:$3}),yW=Object.freeze(Object.defineProperty({__proto__:null,fromPixels:ow,fromPixelsAsync:gW,toPixels:rw},Symbol.toStringTag,{value:"Module"}));function jy(n,e){const t=n.shape.length,s=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${t}`);if(we(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const r=e.shape,o=r[r.length-1];let i=1;for(let f=0;f<r.length-1;++f)i*=r[f];const a=n.shape,l=r.slice();l.pop();let u=1;for(let f=o;f<t;++f)u*=a[f],l.push(a[f]);const d=[...et(n.shape).map(f=>f/u),1].slice(0,o);return[l,i,u,d]}const xW=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:jy},Symbol.toStringTag,{value:"Module"}));function iw(n,e,t){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${s}, and batchDim: ${r}.`;if(t.rank<r)throw new Error(o+` update.rank < ${r}. `);if(n.length<s+(t.rank-r))throw new Error(o+` Output shape length < ${s+(t.rank-r)}`);if(t.rank!==r+n.length-s)throw new Error(o+` update.rank != ${r+n.length-s}`);for(let i=0;i<r;++i)if(t.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${t.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<t.rank-r;++i)if(t.shape[i+r]!==n[i+s])throw new Error(o+` updates.shape[${i+r}] (${t.shape[i+r]}) != shape[${i+r}] (${n[i+r]})`)}function aw(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}iw(t,e,n)}function Hc(n,e,t){const s=e.shape.length,r=s>1?e.shape[s-1]:1,o=t.length;let i=1;for(let f=r;f<o;++f)i*=t[f];const a=r<1?1:r,l=we(e.shape)/a,u=[...et(t.slice(0,r)),1],d=we(t);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:u,outputSize:d}}const vW=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:Hc,validateInput:aw,validateUpdateShape:iw},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kv=-2,wW=-1;function lw(n,e,t){const s=n.shape.length;B(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),B(s===t.length,()=>`Error in slice${s}D: Length of size ${t} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)B(e[r]+t[r]<=n.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+t[r]}) would overflow input.shape[${r}] (${n.shape[r]})`)}function CW(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function uw(n,e,t){const s=[];for(let r=0;r<n.length;r++)s[r]=Math.ceil((e[r]-n[r])/t[r]);return s}function A3(n,e,t,s){const r=[...n];for(let o=r.length;o<s.length;o++)r.push(1);for(let o=0;o<t;o++)o===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function _3(n,e,t){return t<=n?t:t-(e-1)}function R3(n,e){const t=[];for(let s=0;s<n;s++)t.push(e+s);return t}function TW(n,e,t,s,r,o,i,a,l){const u=n.length;let d=new Array(u),f=new Array(u),p=new Array(u);if(e.length&&t>0){const y=e[0],v=t+1;d=D3(i,y,v,s,n),f=F3(a,y,v,r,n),p=A3(o,y,v,n)}else for(let y=0;y<u;y++)d[y]=P3(i,s,o,n,y,l),f[y]=L3(a,r,o,n,y,l),p[y]=M3(o,y,l);return{begin:d,end:f,strides:p}}function D3(n,e,t,s,r){const o=[...r],i=R3(t,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=_3(e,t,a);let u=s[l];n&1<<l&&(u=0),o[a]=u}return o}function F3(n,e,t,s,r){const o=[...r],i=R3(t,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=_3(e,t,a);let u=s[l];n&1<<l&&(u=Number.MAX_SAFE_INTEGER),o[a]=u}for(let a=0;a<o.length;a++){const l=r[a];o[a]<0&&(o[a]+=l),o[a]=ia(0,o[a],r[a])}return o}function M3(n,e,t){let s=n[e];return(t&1<<e||s==null)&&(s=1),s}function P3(n,e,t,s,r,o){let i=e[r];const a=t[r]||1;(n&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=ia(0,i,l-1),i}function L3(n,e,t,s,r,o){let i=e[r];const a=t[r]||1;(n&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),a>0?i=ia(0,i,l):i=ia(-1,i,l-1),i}function cw(n,e,t){let s=t.length;for(let r=0;r<t.length;r++)if(t[r]>1){s=r;break}for(let r=s+1;r<t.length;r++)if(e[r]>0||t[r]!==n[r])return!1;return!0}function dw(n,e){let t=n.length>0?n[n.length-1]:1;for(let s=0;s<n.length-1;s++)t+=n[s]*e[s];return t}function e1(n,e,t){let s;const r=n.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{B(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return t==null?o=new Array(r).fill(-1):typeof t=="number"?o=[t,...new Array(r-1).fill(-1)]:t.length<r?o=t.concat(new Array(r-t.length).fill(-1)):o=t,o=o.map((i,a)=>i>=0?i:(B(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),n.shape[a]-s[a])),[s,o]}function fw(n,e,t,s,r,o,i,a,l){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let d=!1;const f={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:u.slice(),beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let E=0;E<f.dims;E++)d&&(1<<E&a)!==0&&f.numAddAxisAfterEllipsis++,1<<E&i&&(d=!0);d||(f.ellipsisMask|=1<<f.dims,f.dims++);const p={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};SW(f,p);let y=!0,v=!0,w=!0;const C=[],S=[];for(let E=0;E<n.length;++E){if(p.strides[E]===0)throw Error(`strides[${E}] must be non-zero`);const N=!!(p.shrinkAxisMask&1<<E),A=n[E];if(A===-1){C.push(N?1:-1);continue}const R=[p.beginMask&1<<E,p.endMask&1<<E],L=[p.strides[E]>0?0:-1,p.strides[E]>0?A:A-1];if(N&&p.strides[E]<=0)throw Error("only stride 1 allowed on non-range indexing.");w=w&&p.strides[E]===1;const z=!!(p.beginMask&1<<E&&p.endMask&1<<E);if(p.beginValid&&p.endValid){if(N){const q=p.begin[E]<0?A+p.begin[E]:p.begin[E];if(p.begin[E]=q,p.end[E]=p.begin[E]+1,q<0||q>=A)throw Error(`slice index ${p.begin[E]} of dimension ${E} out of bounds.`)}else p.begin[E]=kk(p.begin[E],0,p.strides[E],A,R,L),p.end[E]=kk(p.end[E],1,p.strides[E],A,R,L);const F=p.strides[E]===1&&p.begin[E]===0&&p.end[E]===A;y=y&&F,v=v&&(E===0&&p.strides[E]===1||F)}else y=y&&p.strides[E]===1&&z,v=v&&(E===0&&p.strides[E]===1||z);let M,P=!1;if(p.beginValid&&p.endValid?(M=p.end[E]-p.begin[E],P=!0):N?(M=1,P=!0):z&&A>=0&&(p.strides[E]<0?M=-A:M=A,P=!0),P){let F;M===0||M<0!=p.strides[E]<0?F=0:F=Math.trunc(M/p.strides[E])+(M%p.strides[E]!==0?1:0),C.push(F)}else C.push(-1)}for(let E=0;E<p.finalShapeGatherIndices.length;++E){const N=p.finalShapeGatherIndices[E];N>=0?S.push(C[N]):N===Kv&&S.push(1)}return{finalShapeSparse:S.filter((E,N)=>p.finalShapeGatherIndices[N]!==Kv),finalShape:S,isIdentity:y,sliceDim0:v,isSimpleSlice:w,begin:p.begin,end:p.end,strides:p.strides}}function SW(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<n.dims;s++)if(1<<s&n.ellipsisMask){const r=Math.min(e.dims-(n.dims-s)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<r;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=s}else if(1<<s&n.newAxisMask)e.finalShapeGatherIndices.push(Kv),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[s]),n.end!=null&&(e.end[t]=n.end[s]),e.strides[t]=n.strides[s],n.beginMask&1<<s&&(e.beginMask|=1<<t),n.endMask&1<<s&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(wW),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[t]=s,t++}}function kk(n,e,t,s,r,o){if(r[e])return t>0?o[e]:o[e+1&1];{const i=n<0?s+n:n;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const O3=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:lw,computeFlatOffset:dw,computeOutShape:uw,getNormalizedAxes:TW,isSliceContinous:cw,maskToAxes:CW,parseSliceParams:e1,sliceInfo:fw,startForAxis:P3,startIndicesWithElidedDims:D3,stopForAxis:L3,stopIndicesWithElidedDims:F3,stridesForAxis:M3,stridesWithElidedDims:A3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class El{getClassName(){return this.constructor.className}static fromConfig(e,t){return new e(t)}}class hr{constructor(){this.classNameMap={}}static getMap(){return hr.instance==null&&(hr.instance=new hr),hr.instance}static register(e){hr.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ne(n){B(n.className!=null,()=>"Class being registered does not have the static className property defined."),B(typeof n.className=="string",()=>"className is required to be a string, but got type "+typeof n.className),B(n.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),hr.register(n)}const bW=Object.freeze(Object.defineProperty({__proto__:null,Serializable:El,SerializationMap:hr,registerClass:Ne},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IW=.001,V3=.1;function kW(n,e,t){return t==null&&(t=hw()),Xv(n,e,(s,r)=>pw(s,r,t))}function hw(){return Q.backend.floatPrecision()===32?IW:V3}function Xv(n,e,t){let s=!0;if((cs(n)||cs(e))&&(s=!1),cs(n)&&cs(e)&&(s=!0),s){const i=n.constructor.name,a=e.constructor.name;if(i!==a)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${a}`)}if(Array.isArray(n)&&Array.isArray(e)){const i=Mo(n),a=Mo(e);if(!Ct(i,a))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${a}]`)}const r=cs(n)?n:di(n),o=cs(e)?e:di(e);if(r.length!==o.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${o.length}.
Actual:   ${r}.
Expected: ${o}.`);for(let i=0;i<o.length;++i){const a=r[i],l=o[i];if(!t(a,l))throw new Error(`Arrays differ: actual[${i}] = ${a}, expected[${i}] = ${l}.
Actual:   ${r}.
Expected: ${o}.`)}typeof expect<"u"&&expect().nothing()}function NW(n,e){n().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function EW(n,e){const t=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Eo(n)||Eo(n[0])||Eo(e)||Eo(e[0])?Xv(n,t,(s,r)=>s==r):Xv(n,e,(s,r)=>pw(s,r,0))}function $W(n,e,t){if(t==null&&(t=hw()),!pw(n,e,t))throw new Error(`Numbers differ: actual === ${n}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function pw(n,e,t){return!isFinite(n)&&!isFinite(e)?!0:!(isNaN(n)||isNaN(e)||Math.abs(n-e)>t)}function AW(n,e,t){for(let s=0;s<n.length;s++)if(n[s]<e||n[s]>t)throw new Error(`Value out of range:${n[s]} low: ${e}, high: ${t}`)}function _W(n,e){const t=new Float32Array(n),s=new Float32Array(e);if(t.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${t.length}`);for(let r=0;r<s.length;r++)if(t[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${t[r]} instead`)}function B3(n){for(let e=0;e<n.length;e++){const t=n[e];Array.isArray(t)?B3(t):n[e]=_o(t)}return n}function RW(n){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(n),new Promise(t=>{e.addEventListener("loadeddata",s=>t(e)),e.load()})}async function DW(n){await n.play(),"requestVideoFrameCallback"in n&&await new Promise(e=>{n.requestVideoFrameCallback(e)})}const FW=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:V3,createVideoElement:RW,encodeStrings:B3,expectArrayBuffersEqual:_W,expectArraysClose:kW,expectArraysEqual:EW,expectNumbersClose:$W,expectPromiseToFail:NW,expectValuesInRange:AW,play:DW,testEpsilon:hw},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const MW="3.21.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PW(n,e){let t=U(n,"a","add"),s=U(e,"b","add");[t,s]=fn(t,s);const r={a:t,b:s};return Q.runKernel(Nl,r)}const ke=Z({add_:PW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(n,e){let t=U(n,"a","floorDiv"),s=U(e,"b","floorDiv");[t,s]=fn(t,s);const r={a:t,b:s};return Q.runKernel(pc,r)}const t1=Z({floorDiv_:LW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OW(n,e){let t=U(n,"a","div"),s=U(e,"b","div");if([t,s]=fn(t,s),t.dtype==="int32"&&s.dtype==="int32")return t1(t,s);const r={a:t,b:s},o={};return Q.runKernel(lc,r,o)}const Be=Z({div_:OW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VW(n,e){let t=U(n,"a","mul"),s=U(e,"b","mul");[t,s]=fn(t,s);const r={a:t,b:s};return Q.runKernel(Ic,r)}const j=Z({mul_:VW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BW(n){const e=U(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return Q.runKernel(Pf,t)}else{const t={x:e};return Q.runKernel(Ef,t)}}const In=Z({abs_:BW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(n){const t={x:U(n,"x","acos")};return Q.runKernel(Yu,t)}const mw=Z({acos_:zW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UW(n){const t={x:U(n,"x","acosh")};return Q.runKernel(Qu,t)}const gw=Z({acosh_:UW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WW(n){B(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),B(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((r,o)=>U(r,`tensors${o}`,"addN")),t=e[0];e.forEach(r=>{if(r.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!Ct(r.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return Q.runKernel($f,s)}const z3=Z({addN_:WW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GW(n,e=null,t=!1){const r={x:U(n,"x","all","bool")},o={axis:e,keepDims:t};return Q.runKernel(Xg,r,o)}const n1=Z({all_:GW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HW(n,e=null,t=!1){const r={x:U(n,"x","any","bool")},o={axis:e,keepDims:t};return Q.runKernel(Jg,r,o)}const pf=Z({any_:HW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qW(n,e=0){const s={x:U(n,"x","argMax")},r={axis:e};return Q.runKernel(Af,s,r)}const ml=Z({argMax_:qW});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KW(n,e=0){const s={x:U(n,"x","argMin")},r={axis:e};return Q.runKernel(_f,s,r)}const yw=Z({argMin_:KW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XW(n){const t={x:U(n,"x","asin")};return Q.runKernel(Zu,t)}const xw=Z({asin_:XW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JW(n){const t={x:U(n,"x","asinh")};return Q.runKernel(ju,t)}const vw=Z({asinh_:JW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YW(n){const t={x:U(n,"x","atan")};return Q.runKernel(ec,t)}const ww=Z({atan_:YW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QW(n,e){let t=U(n,"a","atan2"),s=U(e,"b","atan2");[t,s]=fn(t,s);const r={a:t,b:s};return Q.runKernel(nc,r)}const Cw=Z({atan2_:QW});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(n){const t={x:U(n,"x","atanh")};return Q.runKernel(tc,t)}const Tw=Z({atanh_:ZW});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rh(n,e,t,s,r="NHWC",o){const i=n[3],a=[...e,i],l=Si(r);return Gn(n,a,t,o,s,null,null,l)}function Ur(n,e,t,s,r,o,i="channelsLast"){const[a,l]=vg(e);let u;if(i==="channelsLast")u=[a,l,n[3],n[3]];else if(i==="channelsFirst")u=[a,l,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Gn(n,u,t,s,r,o,!1,i)}function Ti(n,e,t,s,r,o,i="NDHWC"){const[a,l,u]=Jv(e);let d,f;if(i==="NDHWC")f="channelsLast",d=[a,l,u,n[4],n[4]];else if(i==="NCDHW")f="channelsFirst",d=[a,l,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return ya(n,d,t,s,r,!1,f,o)}function Gn(n,e,t,s,r,o,i=!1,a="channelsLast"){let[l,u,d,f]=[-1,-1,-1,-1];if(a==="channelsLast")[l,u,d,f]=n;else if(a==="channelsFirst")[l,f,u,d]=n;else throw new Error(`Unknown dataFormat ${a}`);const[p,y,,v]=e,[w,C]=vg(t),[S,b]=vg(s),E=Eu(p,S),N=Eu(y,b),{padInfo:A,outHeight:R,outWidth:L}=t9(r,u,d,w,C,E,N,o,a),z=i?v*f:v;let M;return a==="channelsFirst"?M=[l,z,R,L]:a==="channelsLast"&&(M=[l,R,L,z]),{batchSize:l,dataFormat:a,inHeight:u,inWidth:d,inChannels:f,outHeight:R,outWidth:L,outChannels:z,padInfo:A,strideHeight:w,strideWidth:C,filterHeight:p,filterWidth:y,effectiveFilterHeight:E,effectiveFilterWidth:N,dilationHeight:S,dilationWidth:b,inShape:n,outShape:M,filterShape:e}}function ya(n,e,t,s,r,o=!1,i="channelsLast",a){let[l,u,d,f,p]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,u,d,f,p]=n;else if(i==="channelsFirst")[l,p,u,d,f]=n;else throw new Error(`Unknown dataFormat ${i}`);const[y,v,w,,C]=e,[S,b,E]=Jv(t),[N,A,R]=Jv(s),L=Eu(y,N),z=Eu(v,A),M=Eu(w,R),{padInfo:P,outDepth:F,outHeight:q,outWidth:ee}=n9(r,u,d,f,S,b,E,L,z,M,a),ue=o?C*p:C;let ie;return i==="channelsFirst"?ie=[l,ue,F,q,ee]:i==="channelsLast"&&(ie=[l,F,q,ee,ue]),{batchSize:l,dataFormat:i,inDepth:u,inHeight:d,inWidth:f,inChannels:p,outDepth:F,outHeight:q,outWidth:ee,outChannels:ue,padInfo:P,strideDepth:S,strideHeight:b,strideWidth:E,filterDepth:y,filterHeight:v,filterWidth:w,effectiveFilterDepth:L,effectiveFilterHeight:z,effectiveFilterWidth:M,dilationDepth:N,dilationHeight:A,dilationWidth:R,inShape:n,outShape:ie,filterShape:e}}function jW(n,e,t,s,r){s==null&&(s=Sw(n,e,t));const o=n[0],i=n[1],a=rl((o-e+2*s)/t+1,r),l=rl((i-e+2*s)/t+1,r);return[a,l]}function e9(n,e,t,s,r,o){r==null&&(r=Sw(n,e,s));const i=n[0],a=n[1],l=n[2],u=rl((i-e+2*r)/s+1,o),d=rl((a-e+2*r)/s+1,o),f=rl((l-e+2*r)/s+1,o);return[u,d,f,t]}function Sw(n,e,t,s=1){const r=Eu(e,s);return Math.floor((n[0]*(t-1)-t+r)/2)}function vg(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function Jv(n){return typeof n=="number"?[n,n,n]:n}function Eu(n,e){return e<=1?n:n+(n-1)*(e-1)}function t9(n,e,t,s,r,o,i,a,l){let u,d,f;if(typeof n=="number"){u={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const y=jW([e,t],o,s,n,a);d=y[0],f=y[1]}else if(n==="same"){d=Math.ceil(e/s),f=Math.ceil(t/r);const p=Math.max(0,(d-1)*s+o-e),y=Math.max(0,(f-1)*r+i-t),v=Math.floor(p/2),w=p-v,C=Math.floor(y/2),S=y-C;u={top:v,bottom:w,left:C,right:S,type:"SAME"}}else if(n==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((e-o+1)/s),f=Math.ceil((t-i+1)/r);else if(typeof n=="object"){const p=l==="channelsLast"?n[1][0]:n[2][0],y=l==="channelsLast"?n[1][1]:n[2][1],v=l==="channelsLast"?n[2][0]:n[3][0],w=l==="channelsLast"?n[2][1]:n[3][1];u={top:p,bottom:y,left:v,right:w,type:p===0&&y===0&&v===0&&w===0?"VALID":"EXPLICIT"},d=rl((e-o+p+y)/s+1,a),f=rl((t-i+v+w)/r+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:u,outHeight:d,outWidth:f}}function n9(n,e,t,s,r,o,i,a,l,u,d){let f,p,y,v;if(typeof n=="number"){f={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const C=e9([e,t,s,1],a,1,r,n,d);p=C[0],y=C[1],v=C[2]}else if(n==="same"){p=Math.ceil(e/r),y=Math.ceil(t/o),v=Math.ceil(s/i);const w=(p-1)*r+a-e,C=(y-1)*o+l-t,S=(v-1)*i+u-s,b=Math.floor(w/2),E=w-b,N=Math.floor(C/2),A=C-N,R=Math.floor(S/2),L=S-R;f={top:N,bottom:A,left:R,right:L,front:b,back:E,type:"SAME"}}else if(n==="valid")f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((e-a+1)/r),y=Math.ceil((t-l+1)/o),v=Math.ceil((s-u+1)/i);else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:f,outDepth:p,outHeight:y,outWidth:v}}function rl(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function la(n){const[e,t,s]=vg(n);return e===1&&t===1&&s===1}function ss(n,e){return la(n)||la(e)}function Si(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function As(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")B(ul(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{B(ul(r),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${r}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(n,e){const s={x:U(n,"x","reshape","string_or_numeric")},r={shape:e};return Q.runKernel(gh,s,r)}const se=Z({reshape_:s9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r9(n,e,t,s,r){const o=U(n,"x","avgPool","float32"),i=1;B(ss(t,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=se(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),As("avgPool",s,r);const u={x:a},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r};let f=Q.runKernel(Rf,u,d);return f=Me(f,o.dtype),l?se(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Dh=Z({avgPool_:r9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o9(n,e,t,s,r,o="NDHWC"){const i=U(n,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=se(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),B(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),B(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),As("avgPool3d",s,r);const u={x:a},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:o};let f=Q.runKernel(Df,u,d);return f=Me(f,a.dtype),l?se(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const bw=Z({avgPool3d_:o9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i9(n,e=0){B(n.length>=1,()=>"Pass at least one tensor to concat");const t=hf(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),t.length===1)return Ro(t[0]);const s=t,r={axis:e};return Q.runKernel(Lf,s,r)}const dn=Z({concat_:i9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a9(n){const t={x:U(n,"x","sigmoid","float32")};return Q.runKernel(Pc,t)}const Or=Z({sigmoid_:a9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(n,e,t){const s=U(n,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},o={begin:e,size:t};return Q.runKernel(Ch,r,o)}const it=Z({slice_:l9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u9(n){const t={x:U(n,"x","tanh","float32")};return Q.runKernel(Uc,t)}const gl=Z({tanh_:u9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c9(n,e,t,s,r,o){const i=U(n,"forgetBias","basicLSTMCell"),a=U(e,"lstmKernel","basicLSTMCell"),l=U(t,"lstmBias","basicLSTMCell"),u=U(s,"data","basicLSTMCell"),d=U(r,"c","basicLSTMCell"),f=U(o,"h","basicLSTMCell"),p=dn([u,f],1),y=mt(p,a),v=ke(y,l),w=v.shape[0],C=v.shape[1]/4,S=[w,C],b=it(v,[0,0],S),E=it(v,[0,C],S),N=it(v,[0,C*2],S),A=it(v,[0,C*3],S),R=ke(j(Or(b),gl(E)),j(d,Or(ke(i,N)))),L=j(gl(R),Or(A));return[R,L]}const U3=Z({basicLSTMCell_:c9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d9(n,e,t){const s=U(n,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);B(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),B(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),B(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const o={x:s},i={blockShape:e,crops:t};return Q.runKernel(Mf,o,i)}const Fh=Z({batchToSpaceND_:d9});function f9(n){let e;return n.rank===0||n.rank===1?e=se(n,[1,1,1,n.size]):n.rank===2?e=se(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=se(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h9(n,e,t,s,r,o){o==null&&(o=.001);const i=U(n,"x","batchNorm"),a=U(e,"mean","batchNorm"),l=U(t,"variance","batchNorm");let u;r!=null&&(u=U(r,"scale","batchNorm"));let d;s!=null&&(d=U(s,"offset","batchNorm")),B(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(d==null||a.rank===d.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:f9(i),scale:u,offset:d,mean:a,variance:l},y={varianceEpsilon:o},v=Q.runKernel(qf,p,y);return se(v,i.shape)}const qc=Z({batchNorm_:h9});function p9(n,e,t,s,r,o){const i=U(n,"x","batchNorm"),a=U(e,"mean","batchNorm"),l=U(t,"variance","batchNorm");let u;r!=null&&(u=U(r,"scale","batchNorm"));let d;return s!=null&&(d=U(s,"offset","batchNorm")),B(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),B(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),B(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),d!=null&&B(d.rank===2||d.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${d.rank}.`),qc(i,a,l,d,u,o)}const Iw=Z({batchNorm2d_:p9});function m9(n,e,t,s,r,o){const i=U(n,"x","batchNorm"),a=U(e,"mean","batchNorm"),l=U(t,"variance","batchNorm");let u;r!=null&&(u=U(r,"scale","batchNorm"));let d;return s!=null&&(d=U(s,"offset","batchNorm")),B(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),B(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),B(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),d!=null&&B(d.rank===3||d.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${d.rank}.`),qc(i,a,l,d,u,o)}const kw=Z({batchNorm3d_:m9});function g9(n,e,t,s,r,o){const i=U(n,"x","batchNorm"),a=U(e,"mean","batchNorm"),l=U(t,"variance","batchNorm");let u;r!=null&&(u=U(r,"scale","batchNorm"));let d;return s!=null&&(d=U(s,"offset","batchNorm")),B(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),B(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),B(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),u!=null&&B(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),d!=null&&B(d.rank===4||d.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${d.rank}.`),qc(i,a,l,d,u,o)}const Nw=Z({batchNorm4d_:g9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y9(n,e,t){const s=U(n,"x","bincount"),r=U(e,"weights","bincount");B(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),B(t>=0,()=>`size must be non-negative, but got ${t}.`),B(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const o={x:s,weights:r},i={size:t};return Q.runKernel(Zg,o,i)}const Ew=Z({bincount_:y9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(n,e){const t=U(n,"s0","broadcastArgs","int32"),s=U(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:t,s1:s};return Q.runKernel(jg,r)}const W3=Z({broadcastArgs_:x9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v9(n,e){let t=U(n,"broadcastTo","x");const s=t.shape;if(e.some(u=>!(u>0)||u%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const u=t.shape.slice();for(;u.length<e.length;)u.unshift(1);t=se(t,u)}const r=t.shape,o=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])o[u]=1;else if(t.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(o.map((u,d)=>u>1?d:-1).filter(u=>u>=0).length===0)return Ro(t);const a={x:t},l={reps:o};return Q.runKernel(Wc,a,l)}const ol=Z({broadcastTo_:v9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w9(n){const t={x:U(n,"x","ceil","float32")};return Q.runKernel(rc,t)}const $w=Z({ceil_:w9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $l(n,e,t){const s={shape:n,value:e,dtype:t};return Q.runKernel(py,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C9(n,e,t){const s=U(n,"x","clipByValue");if(B(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return $l(s.shape,e,s.dtype);const r={x:s},o={clipValueMin:e,clipValueMax:t};return Q.runKernel(oc,r,o)}const ks=Z({clipByValue_:C9});function T9(n){return dn(n,0)}const Aw=Z({concat1d_:T9});function S9(n,e){return dn(n,e)}const _w=Z({concat2d_:S9});function b9(n,e){return dn(n,e)}const Rw=Z({concat3d_:b9});function I9(n,e){return dn(n,e)}const Dw=Z({concat4d_:I9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k9(n,e,t,s,r="NHWC",o=[1,1],i){const a=U(n,"x","conv2d","float32"),l=U(e,"filter","conv2d","float32");let u=a,d=!1;a.rank===3&&(d=!0,u=se(a,[1,a.shape[0],a.shape[1],a.shape[2]])),B(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),B(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),As("conv2d",s,i);const f=r==="NHWC"?u.shape[3]:u.shape[1];B(f===l.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${l.shape[2]}.`),B(ss(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);const p={x:u,filter:l},y={strides:t,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},v=Q.runKernel(Of,p,y);return d?se(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const pi=Z({conv2d_:k9});function N9(n,e,t,s,r="NWC",o=1,i){const a=U(n,"x","conv1d"),l=U(e,"filter","conv1d");let u=a,d=!1;a.rank===2&&(d=!0,u=se(a,[1,a.shape[0],a.shape[1]])),B(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),B(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),As("conv1d",s,i),B(u.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${l.shape[1]}.`),B(ss(t,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${o}'`),B(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const f=se(l,[1,l.shape[0],l.shape[1],l.shape[2]]),p=se(u,[u.shape[0],1,u.shape[1],u.shape[2]]),C=pi(p,f,[1,t],s,"NHWC",[1,o],i);return d?se(C,[C.shape[2],C.shape[3]]):se(C,[C.shape[0],C.shape[2],C.shape[3]])}const s1=Z({conv1d_:N9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E9(n,e,t,s,r,o="NHWC",i){B(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,l=e,u=!1;e.rank===3&&(u=!0,l=se(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,n[0],n[1],n[2]]),B(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),B(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),B(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const d=o==="NHWC"?a[3]:a[1],f=o==="NHWC"?l.shape[3]:l.shape[1];B(d===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${d}) must match input depth for filter ${t.shape[2]}.`),B(f===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${t.shape[3]}.`),As("conv2dDerInput",r,i);const p={dy:l,filter:t},y={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,inputShape:a},v=Q.runKernel(Vf,p,y);return u?se(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const Fw=Z({conv2DBackpropInput_:E9});function $9(n,e,t,s,r,o){const i=U(n,"x","conv2dTranspose"),a=U(e,"filter","conv2dTranspose");return Fw(t,i,a,s,r,"NHWC",o)}const r1=Z({conv2dTranspose_:$9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A9(n,e,t,s,r="NDHWC",o=[1,1,1]){const i=U(n,"x","conv3d"),a=U(e,"filter","conv3d");let l=i,u=!1;i.rank===4&&(u=!0,l=se(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),B(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),B(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),B(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),B(ss(t,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),B(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`);const d={x:l,filter:a},f={strides:t,pad:s,dataFormat:r,dilations:o},p=Q.runKernel(Bf,d,f);return u?se(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const Mw=Z({conv3d_:A9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9(n,e,t,s,r){B(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,i=e,a=!1;e.rank===4&&(a=!0,i=se(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,n[0],n[1],n[2],n[3]]);const l=o[4],u=i.shape[4];B(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),B(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),B(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),B(l===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[3]}.`),B(u===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${t.shape[4]}.`);const d={dy:i,filter:t},f={pad:r,strides:s,inputShape:o},p=Q.runKernel(sy,d,f);return a?se(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const G3=Z({conv3DBackpropInput_:_9});function R9(n,e,t,s,r){const o=U(n,"x","conv3dTranspose"),i=U(e,"filter","conv3dTranspose");return G3(t,o,i,s,r)}const Pw=Z({conv3dTranspose_:R9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D9(n){const t={x:U(n,"x","cos","float32")};return Q.runKernel(ic,t)}const Mh=Z({cos_:D9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F9(n){const t={x:U(n,"x","cosh","float32")};return Q.runKernel(ac,t)}const o1=Z({cosh_:F9});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M9(n,e=0,t=!1,s=!1){const o={x:U(n,"x","cumprod")},i={axis:e,exclusive:t,reverse:s};return Q.runKernel(ry,o,i)}const mf=Z({cumprod_:M9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(n,e=0,t=!1,s=!1){const o={x:U(n,"x","cumsum")},i={axis:e,exclusive:t,reverse:s};return Q.runKernel(zf,o,i)}const i1=Z({cumsum_:P9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L9(n,e,t,s=!1){const r=U(n,"x","denseBincount"),o=U(e,"weights","denseBincount");B(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),B(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),B(t>=0,()=>`size must be non-negative, but got ${t}.`),B(o.size===r.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${o.shape}.`);const i={x:r,weights:o},a={size:t,binaryOutput:s};return Q.runKernel(iy,i,a)}const H3=Z({denseBincount_:L9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(n,e,t="NHWC"){const s=U(n,"x","depthToSpace","float32"),r=t==="NHWC"?s.shape[1]:s.shape[2],o=t==="NHWC"?s.shape[2]:s.shape[3],i=t==="NHWC"?s.shape[3]:s.shape[1];B(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),B(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),B(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${s.shape}`),B(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:t};return Q.runKernel(ay,a,l)}const Lw=Z({depthToSpace_:O9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V9(n,e,t,s,r="NHWC",o=[1,1],i){const a=U(n,"x","depthwiseConv2d","float32"),l=U(e,"filter","depthwiseConv2d","float32");let u=a,d=!1;a.rank===3&&(d=!0,u=se(a,[1,a.shape[0],a.shape[1],a.shape[2]])),B(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),B(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const f=r==="NHWC"?u.shape[3]:u.shape[1];B(f===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${l.shape[2]}.`),As("depthwiseConv2d",s,i);const p={x:u,filter:l},y={strides:t,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},v=Q.runKernel(Uf,p,y);return d?se(v,[v.shape[1],v.shape[2],v.shape[3]]):v}const Kc=Z({depthwiseConv2d_:V9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(n){const t={x:U(n,"x","diag")};return Q.runKernel(cy,t)}const q3=Z({diag_:B9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9(n,e,t,s,r=[1,1],o="NHWC"){const i=U(n,"x","dilation2d"),a=U(e,"filter","dilation2d");B(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),B(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),B(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,u=!1;i.rank===3&&(l=se(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0);const d={x:l,filter:a},f={strides:t,pad:s,dilations:r},p=Q.runKernel(Wf,d,f);return u?se(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const Ow=Z({dilation2d_:z9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9(n,e){let t=U(n,"a","equal","string_or_numeric"),s=U(e,"b","equal","string_or_numeric");[t,s]=fn(t,s),dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(Gf,r)}const Br=Z({equal_:U9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(n,e,t){const s=U(e,"a","where"),r=U(t,"b","where"),o=U(n,"condition","where","bool"),i=dt(dt(o.shape,s.shape),r.shape),a=ol(o,i),l=ol(s,i),u=ol(r,i),d={condition:a,t:l,e:u};return Q.runKernel(wh,d)}const Ns=Z({where_:W9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(n){const t={x:U(n,"x","zerosLike")};return Q.runKernel(Eh,t)}const bt=Z({zerosLike_:G9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H9(n,e){let t=U(n,"a","div"),s=U(e,"b","div");[t,s]=fn(t,s);const r=Be(t,s),o=bt(r),i=Br(s,o);return Ns(i,o,r)}const Vw=Z({divNoNan_:H9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(n,e){const t=U(n,"t1","dot"),s=U(e,"t2","dot");B((t.rank===1||t.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${s.rank}.`);const r=t.rank===1?t.size:t.shape[1],o=s.rank===1?s.size:s.shape[0];if(B(r===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${o}.`),t.rank===1&&s.rank===1){const i=se(t,[1,-1]),a=se(s,[-1,1]),l=mt(i,a);return se(l,[])}else if(t.rank===1&&s.rank===2){const i=se(t,[1,-1]),a=se(s,[s.shape[0],s.shape[1]]),l=mt(i,a);return se(l,[l.size])}else if(t.rank===2&&s.rank===1){const i=se(s,[-1,1]),a=mt(t,i);return se(a,[a.size])}else{const i=se(s,[s.shape[0],s.shape[1]]);return mt(t,i)}}const Bw=Z({dot_:q9});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9(n,...e){const t=e.map((r,o)=>U(r,`tensors${o}`,"einsum")),s={equation:n};return Q.runKernel(dy,t,s)}const K3=Z({einsum_:K9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X9(n){const t={x:U(n,"x","elu","float32")};return Q.runKernel(uc,t)}const Xc=Z({elu_:X9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J9(n){let e=U(n,"x","erf");B(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=Me(e,"float32"));const t={x:e};return Q.runKernel(cc,t)}const zw=Z({erf_:J9});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uw(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function X3(n,e,t){const s=n.length+e.length,r=[];let o=0,i=0;for(let a=0;a<s;a++)t.indexOf(a)===-1?r.push(n[o++]):r.push(e[i++]);return r}function Hn(n,e){const t=[],s=n.length;for(let o=0;o<s;o++)e.indexOf(o)===-1&&t.push(n[o]);const r=e.map(o=>n[o]);return[t,r]}function wn(n,e){const t=e.map(s=>1);return X3(n,t,e)}function rs(n,e,t){B(Uw(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function hn(n,e){if(Uw(n,e))return null;const t=[];for(let s=0;s<e;++s)n.indexOf(s)===-1&&t.push(s);return n.forEach(s=>t.push(s)),t}function xa(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function Cn(n,e){const t=[];for(let s=e-n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(n,e=null,t=!1){const r={x:U(n,"x","max")},o={reductionIndices:e,keepDims:t};return Q.runKernel(nh,r,o)}const Vr=Z({max_:Y9});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q9(n,e=null,t=!1){const r={x:U(n,"x","min")},o={axis:e,keepDims:t};return Q.runKernel(ih,r,o)}const gf=Z({min_:Q9});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(n,e){let t=U(n,"base","pow"),s=U(e,"exp","pow");[t,s]=fn(t,s);const r={a:t,b:s};return Q.runKernel(kc,r)}const mi=Z({pow_:Z9});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tt(n,e){if((cs(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&cs(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return ga(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j9(n){const t={x:U(n,"x","sqrt","float32")};return Q.runKernel(Oc,t)}const ts=Z({sqrt_:j9});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(n){const e=U(n,"x","square"),t={};return Q.runKernel("Square",{x:e},t)}const Ut=Z({square_:eG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tG(n,e=null,t=!1){let s=U(n,"x","sum");s.dtype==="bool"&&(s=Me(s,"int32"));const r={x:s},o={axis:e,keepDims:t};return Q.runKernel(Th,r,o)}const Ge=Z({sum_:tG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(n,e="euclidean",t=null,s=!1){n=U(n,"x","norm");const r=J3(n,e,t);let o=r.shape;if(s){const i=gt(t,n.shape);o=wn(r.shape,i)}return se(r,o)}function J3(n,e,t=null){if(n.rank===0)return In(n);if(n.rank!==1&&t===null)return J3(se(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return Ge(In(n),t);if(e===1/0)return Vr(In(n),t);if(e===-1/0)return gf(In(n),t);if(e==="euclidean"||e===2)return ts(Ge(mi(In(n),tt(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return Vr(Ge(In(n),t[0]),t[1]-1);if(e===1/0)return Vr(Ge(In(n),t[1]),t[0]);if(e===-1/0)return gf(Ge(In(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return ts(Ge(Ut(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const Jc=Z({norm_:nG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sG(n,e=null,t=!1){return Jc(n,"euclidean",e,t)}const Ww=Z({euclideanNorm_:sG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rG(n){const t={x:U(n,"x","exp")};return Q.runKernel(dc,t)}const Es=Z({exp_:rG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oG(n,e=0){const t=U(n,"x","expandDims","string_or_numeric");B(e<=t.rank,()=>"Axis must be <= rank of the tensor");const s={input:t},r={dim:e};return Q.runKernel(Hf,s,r)}const Zn=Z({expandDims_:oG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iG(n){const t={x:U(n,"x","expm1")};return Q.runKernel(fc,t)}const Gw=Z({expm1_:iG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aG(n,e){const t=U(n,"x","tile","string_or_numeric");B(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const s={x:t},r={reps:e};return Q.runKernel(Wc,s,r)}const pr=Z({tile_:aG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(n,e,t,s="float32"){e==null&&(e=n);const r=ht([n,e],s),o=n<=e?n:e;for(let a=0;a<o;++a)r.set(1,a,a);const i=se(r.toTensor(),[n,e]);if(t==null)return i;if(t.length===1)return pr(Zn(i,0),[t[0],1,1]);if(t.length===2)return pr(Zn(Zn(i,0),0),[t[0],t[1],1,1]);if(t.length===3)return pr(Zn(Zn(Zn(i,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const a1=Z({eye_:lG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(n){const t={x:U(n,"x","floor","float32")};return Q.runKernel(hc,t)}const Yc=Z({floor_:uG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cG(n,e,t=0,s=0){const r=U(n,"x","gather"),o=U(e,"indices","gather","int32"),i={x:r,indices:o},a={axis:t,batchDims:s};return Q.runKernel(Kf,i,a)}const Qc=Z({gather_:cG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(n,e){let t=U(n,"a","greater","string_or_numeric"),s=U(e,"b","greater","string_or_numeric");[t,s]=fn(t,s),dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(Xf,r)}const sr=Z({greater_:dG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(n,e){let t=U(n,"a","greaterEqual","string_or_numeric"),s=U(e,"b","greaterEqual","string_or_numeric");[t,s]=fn(t,s),dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(mc,r)}const va=Z({greaterEqual_:fG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hG(n){const t={x:U(n,"x","isFinite")};return Q.runKernel(yc,t)}const Hw=Z({isFinite_:hG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pG(n){const t={x:U(n,"x","isInf")};return Q.runKernel(xc,t)}const qw=Z({isInf_:pG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG(n){const t={x:U(n,"x","isNaN")};return Q.runKernel(vc,t)}const Kw=Z({isNaN_:mG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gG(n,e=.2){const s={x:U(n,"x","leakyRelu")},r={alpha:e};return Q.runKernel(Jf,s,r)}const Ph=Z({leakyRelu_:gG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yG(n,e){let t=U(n,"a","less","string_or_numeric"),s=U(e,"b","less","string_or_numeric");[t,s]=fn(t,s),dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(Yf,r)}const l1=Z({less_:yG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(n,e){let t=U(n,"a","lessEqual","string_or_numeric"),s=U(e,"b","lessEqual","string_or_numeric");[t,s]=fn(t,s),dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(Qf,r)}const wa=Z({lessEqual_:xG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y3(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const s={start:n,stop:e,num:t};return Q.runKernel(vy,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(n,e=5,t=1,s=1,r=.5){const o=U(n,"x","localResponseNormalization");B(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),B(ul(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=se(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},u={depthRadius:e,bias:t,alpha:s,beta:r},d=Q.runKernel(th,l,u);return a?se(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Xw=Z({localResponseNormalization_:vG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(n){const t={x:U(n,"x","log","float32")};return Q.runKernel(wc,t)}const js=Z({log_:wG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CG(n){const t={x:U(n,"x","log1p")};return Q.runKernel(Cc,t)}const Lh=Z({log1p_:CG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(n){return B(aa(n),()=>"The f passed in grad(f) must be a function"),(e,t)=>{const s=U(e,"x","tf.grad","string_or_numeric"),r=t!=null?U(t,"dy","tf.grad"):null;return Q.tidy(()=>{const{value:o,grads:i}=Q.gradients(()=>n(s),[s],r);return r!=null&&ns(o.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),u1(i),i[0]})}}function SG(n){return B(aa(n),()=>"The f passed in grads(f) must be a function"),(e,t)=>{B(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=hf(e,"args","tf.grads","string_or_numeric"),r=t!=null?U(t,"dy","tf.grads"):null;return Q.tidy(()=>{const{value:o,grads:i}=Q.gradients(()=>n(...s),s,r);return r!=null&&ns(o.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),u1(i),i})}}function bG(n){return B(aa(n),()=>"The f passed in valueAndGrad(f) must be a function"),(e,t)=>{B(e instanceof St,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),B(t==null||t instanceof St,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=Q.gradients(()=>n(e),[e],t);return u1(s),{grad:s[0],value:r}}}function IG(n){return B(aa(n),()=>"The f passed in valueAndGrads(f) must be a function"),(e,t)=>{B(Array.isArray(e)&&e.every(r=>r instanceof St),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),B(t==null||t instanceof St,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=Q.gradients(()=>n(...e),e,t);return t!=null&&ns(s.value.shape,t.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),u1(s.grads),s}}function Q3(n,e){B(aa(n),()=>"The f passed in variableGrads(f) must be a function"),B(e==null||Array.isArray(e)&&e.every(u=>u instanceof ff),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const t=e!=null;if(!t){e=[];for(const u in Q.registeredVariables)e.push(Q.registeredVariables[u])}const s=t?e.filter(u=>!u.trainable):null,r=e.length;e=e.filter(u=>u.trainable),B(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const o=!0,{value:i,grads:a}=Q.gradients(n,e,null,o);B(a.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),B(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((u,d)=>{a[d]!=null&&(l[u.name]=a[d])}),s!=null&&s.forEach(u=>l[u.name]=null),{value:i,grads:l}}function Po(n){return Q.customGrad(n)}function u1(n){if(n.filter(t=>t==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(n){const t={x:U(n,"x","softplus")};return Q.runKernel(Lc,t)}const Al=Z({softplus_:kG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(n){const e=U(n,"x","logSigmoid");return Po(s=>({value:Qt(Al(Qt(s))),gradFunc:i=>j(i,Or(Qt(s)))}))(e)}const Jw=Z({logSigmoid_:NG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EG(n,e){let t=U(n,"a","sub"),s=U(e,"b","sub");[t,s]=fn(t,s);const r={a:t,b:s};return Q.runKernel(Bc,r)}const ze=Z({sub_:EG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(n,e=-1){const t=U(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Po((r,o)=>{const a=Vr(r,e,!0),l=ze(r,a),u=ze(Me(l,"float32"),js(Ge(Es(l),e,!0)));return o([u]),{value:u,gradFunc:(f,p)=>{const[y]=p,v=!0,w=Es(y);return ze(f,j(Ge(f,e,v),w))}}})(t)}const c1=Z({logSoftmax_:$G});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(n,e=null,t=!1){const s=U(n,"x","logSumExp"),r=gt(e,s.shape),o=Vr(s,r,!0),i=ze(s,o),a=Es(i),l=Ge(a,r),u=js(l),d=ke(se(o,u.shape),u);if(t){const f=wn(d.shape,r);return se(d,f)}return d}const d1=Z({logSumExp_:AG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _G(n,e){const t=U(n,"a","logicalAnd","bool"),s=U(e,"b","logicalAnd","bool");dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(Zf,r)}const ao=Z({logicalAnd_:_G});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(n){const t={x:U(n,"x","logicalNot","bool")};return Q.runKernel(jf,t)}const Oh=Z({logicalNot_:RG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(n,e){const t=U(n,"a","logicalOr","bool"),s=U(e,"b","logicalOr","bool");dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(eh,r)}const f1=Z({logicalOr_:DG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FG(n,e){const t=U(n,"a","logicalXor","bool"),s=U(e,"b","logicalXor","bool");return dt(t.shape,s.shape),ao(f1(n,e),Oh(ao(n,e)))}const Yw=Z({logicalXor_:FG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dm=2147483648;function MG(n,e,t="left"){const s=U(n,"sortedSequence","searchSorted"),r=U(e,"values","searchSorted"),o=s.shape[s.shape.length-1],i=r.shape[r.shape.length-1],a=se(s,[-1,o]),l=se(r,[-1,i]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(we(l.shape)>=Dm)throw new Error(`values tensor size must less than ${Dm}`);if(a.shape[1]>=Dm)throw new Error(`trailing dim_size must less than ${Dm} for int32 output type, was ${a.shape[1]}`);const u={sortedSequence:a,values:l},d={side:t};return Q.runKernel(My,u,d)}const h1=Z({searchSorted_:MG});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z3(n,e){return h1(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(n,e,t,s,r){const o=U(n,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=se(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),B(ss(t,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),As("maxPool",s,r);const u={x:a},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r},f=Q.runKernel(sh,u,d);return l?se(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Vh=Z({maxPool_:PG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LG(n,e=[1,1,1],t,s,r,o="NDHWC"){const i=U(n,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=se(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),B(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),B(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),As("maxPool3d",s,r);const u={x:a},d={filterSize:e,strides:t,pad:s,dimRoundingMode:r,dataFormat:o},f=Q.runKernel(rh,u,d);return l?se(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const Qw=Z({maxPool3d_:LG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(n,e,t,s,r=!1){const i={x:U(n,"x","maxPoolWithArgmax")},a={filterSize:e,strides:t,pad:s,includeBatchInIndex:r},l=Q.runKernel(Sy,i,a);return{result:l[0],indexes:l[1]}}const j3=Z({maxPoolWithArgmax_:OG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VG(n,e){let t=U(n,"a","maximum"),s=U(e,"b","maximum");[t,s]=fn(t,s),t.dtype==="bool"&&(t=Me(t,"int32"),s=Me(s,"int32")),dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(Tc,r)}const Vo=Z({maximum_:VG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG(n,e=null,t=!1){const r={x:U(n,"x","mean")},o={axis:e,keepDims:t};return Q.runKernel(oh,r,o)}const un=Z({mean_:BG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kn(n,e="float32"){if(e==="complex64"){const s=kn(n,"float32"),r=kn(n,"float32");return hi(s,r)}const t=es(we(n),e);return Q.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qs(n,e="float32"){if(e==="complex64"){const s=Qs(n,"float32"),r=kn(n,"float32");return hi(s,r)}const t=Kg(we(n),e);return Q.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e$(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let s=U(n,"x","meshgrid",n instanceof St?n.dtype:"float32");if(e===void 0)return[s];let r=U(e,"y","meshgrid",e instanceof St?e.dtype:"float32");const o=we(s.shape),i=we(r.shape);return t==="xy"?(s=se(s,[1,-1]),r=se(r,[-1,1]),[mt(Qs([i,1],s.dtype),s),mt(r,Qs([1,o],r.dtype))]):(s=se(s,[-1,1]),r=se(r,[1,-1]),[mt(s,Qs([1,i],s.dtype)),mt(Qs([o,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zG(n,e){let t=U(n,"a","minimum"),s=U(e,"b","minimum");[t,s]=fn(t,s),t.dtype==="bool"&&(t=Me(t,"int32"),s=Me(s,"int32")),dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(Sc,r)}const Zc=Z({minimum_:zG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(n,e,t){B(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const s=U(n,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");B(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=t==="reflect"?1:0;for(let a=0;a<s.rank;a++)B(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),B(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const o={paddings:e,mode:t},i={x:s};return Q.runKernel(ah,i,o)}const Zw=Z({mirrorPad_:UG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(n,e){let t=U(n,"a","mod"),s=U(e,"b","mod");[t,s]=fn(t,s);const r={a:t,b:s};return Q.runKernel(bc,r)}const jw=Z({mod_:WG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(n,e=null,t=!1){n=U(n,"x","moments");const s=gt(e,n.shape),r=un(n,s,t);let o=r.shape;t||(o=wn(r.shape,s));const i=Ut(ze(Me(n,"float32"),se(r,o))),a=un(i,s,t);return{mean:r,variance:a}}const Bh=Z({moments_:GG});function HG(n,e,t,s){const r=U(e,"data","multiRNNCell"),o=hf(t,"c","multiRNNCell"),i=hf(s,"h","multiRNNCell");let a=r;const l=[];for(let f=0;f<n.length;f++){const p=n[f](a,o[f],i[f]);l.push(p[0]),l.push(p[1]),a=p[1]}const u=[],d=[];for(let f=0;f<l.length;f+=2)u.push(l[f]),d.push(l[f+1]);return[u,d]}const t$=Z({multiRNNCell_:HG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qG(n,e,t,s=!1){const r=U(n,"logits","multinomial"),o=r.size,i=r.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);t=t||Math.random();const l={logits:i===1?se(r,[1,-1]):r},u={numSamples:e,seed:t,normalized:s},d=Q.runKernel(by,l,u);return i===1?se(d,[d.size]):d}const n$=Z({multinomial_:qG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(n,e){let t=U(n,"a","notEqual","string_or_numeric"),s=U(e,"b","notEqual","string_or_numeric");[t,s]=fn(t,s),dt(t.shape,s.shape);const r={a:t,b:s};return Q.runKernel(uh,r)}const yl=Z({notEqual_:KG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XG(n){const t={x:U(n,"x","onesLike")};return Q.runKernel(ch,t)}const er=Z({onesLike_:XG});function JG(n,e){const t=U(n,"v1","outerProduct"),s=U(e,"v2","outerProduct");B(t.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${s.rank}.`);const r=se(t,[-1,1]),o=se(s,[1,-1]);return mt(r,o)}const s$=Z({outerProduct_:JG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(n,e,t=0){const s=U(n,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:t},o={x:s};return Q.runKernel(hh,o,r)}const bi=Z({pad_:YG});function QG(n,e,t=0){return B(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),bi(n,[e],t)}const r$=Z({pad1d_:QG});function ZG(n,e,t=0){return B(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),bi(n,e,t)}const o$=Z({pad2d_:ZG});function jG(n,e,t=0){return B(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),bi(n,e,t)}const i$=Z({pad3d_:jG});function eH(n,e,t=0){return B(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),bi(n,e,t)}const a$=Z({pad4d_:eH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tH(n,e,t){const s=U(n,"x","spaceToBatchND");B(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),B(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),B(s.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+t[l-1][0]+t[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},o={blockShape:e,paddings:t};return Q.runKernel(Sh,r,o)}const zh=Z({spaceToBatchND_:tH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nH(n,e,t,s,r,o,i){r==null&&(r=[1,1]),o==null&&(o=1),s===0&&(s="valid");const a=U(n,"x","maxPool");let l=a,u=!1;a.rank===3&&(u=!0,l=se(a,[1,a.shape[0],a.shape[1],a.shape[2]])),B(ss(o,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${r}'`);const d=Ur(l.shape,e,o,r,s),f=[d.dilationHeight,d.dilationWidth];let p;s==="same"?p=rH([d.filterHeight,d.filterWidth],f):p=[[0,0],[0,0]];const y=f[0]===1&&f[1]===1,[v,w]=sH([d.inHeight,d.inWidth],f,p),C=y?s:"valid",S=y?l:zh(l,f,v),E=(t==="avg"?()=>Dh(S,e,o,C,i):()=>Vh(S,e,o,C,i))(),N=y?E:Fh(E,f,w);return u?se(N,[N.shape[1],N.shape[2],N.shape[3]]):N}function sH(n,e,t){const s=t.map(d=>d[0]),r=t.map(d=>d[1]),o=n.concat(s,r),i=e.map((d,f)=>(d-o[f]%d)%d),a=r.map((d,f)=>d+i[f]),l=e.map((d,f)=>[s[f],a[f]]),u=e.map((d,f)=>[0,i[f]]);return[l,u]}function rH(n,e){const s=n.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),o=s.map((i,a)=>i-r[a]);return s.map((i,a)=>[r[a],o[a]])}const eC=Z({pool_:nH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oH(n,e){const t=U(n,"x","prelu"),s=U(e,"alpha","prelu"),r={x:t,alpha:s};return Q.runKernel(ph,r)}const Uh=Z({prelu_:oH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iH(n,e=null,t=!1){let s=U(n,"x","prod");s.dtype==="bool"&&(s=Me(s,"int32"));const r={x:s},o={axis:e,keepDims:t};return Q.runKernel(mh,r,o)}const tC=Z({prod_:iH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(n,e,t,s){const r=n.map((d,f)=>U(d,`tensors${f}`,"raggedGather","int32")),o=U(e,"paramsDenseValues","raggedGather"),i=U(t,"indices","raggedGather","int32"),a={paramsNestedSplits:r,paramsDenseValues:o,indices:i},l={outputRaggedRank:s},u=Q.runKernel(Ey,a,l);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const l$=Z({raggedGather_:aH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lH(n,e,t,s,r){const o=U(n,"shape","raggedTensorToTensor","int32"),i=U(e,"values","raggedTensorToTensor"),a=U(t,"defaultValue","raggedTensorToTensor",i.dtype),l=s.map((f,p)=>U(f,`tensors${p}`,"raggedTensorToTensor","int32")),u={shape:o,values:i,defaultValue:a,rowPartitionTensors:l},d={rowPartitionTypes:r};return Q.runKernel($y,u,d)}const u$=Z({raggedTensorToTensor_:lH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uH(n,e,t){const s=we(n);let r=null;if(t==null||t==="float32")r=new Float32Array(s);else if(t==="int32")r=new Int32Array(s);else if(t==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${t}`);for(let o=0;o<s;o++)r[o]=e();return Q.makeTensor(r,n,t)}const c$=Z({rand_:uH});var Ym={exports:{}},cH=Ym.exports,Nk;function dH(){return Nk||(Nk=1,(function(n){(function(e,t,s){function r(l){var u=this,d=a();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=d(" "),u.s1=d(" "),u.s2=d(" "),u.s0-=d(l),u.s0<0&&(u.s0+=1),u.s1-=d(l),u.s1<0&&(u.s1+=1),u.s2-=d(l),u.s2<0&&(u.s2+=1),d=null}function o(l,u){return u.c=l.c,u.s0=l.s0,u.s1=l.s1,u.s2=l.s2,u}function i(l,u){var d=new r(l),f=u&&u.state,p=d.next;return p.int32=function(){return d.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,f&&(typeof f=="object"&&o(f,d),p.state=function(){return o(d,{})}),p}function a(){var l=4022871197,u=function(d){d=String(d);for(var f=0;f<d.length;f++){l+=d.charCodeAt(f);var p=.02519603282416938*l;l=p>>>0,p-=l,p*=l,l=p>>>0,p-=l,l+=p*4294967296}return(l>>>0)*23283064365386963e-26};return u}t&&t.exports?t.exports=i:this.alea=i})(cH,n)})(Ym)),Ym.exports}var Qm={exports:{}},fH=Qm.exports,Ek;function hH(){return Ek||(Ek=1,(function(n){(function(e,t,s){function r(a){var l=this,u="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var f=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^f^f>>>8},a===(a|0)?l.x=a:u+=a;for(var d=0;d<u.length+64;d++)l.x^=u.charCodeAt(d)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var u=new r(a),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,y=(u.next()>>>0)/4294967296,v=(p+y)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,d&&(typeof d=="object"&&o(d,u),f.state=function(){return o(u,{})}),f}t&&t.exports?t.exports=i:this.xor128=i})(fH,n)})(Qm)),Qm.exports}var Zm={exports:{}},pH=Zm.exports,$k;function mH(){return $k||($k=1,(function(n){(function(e,t,s){function r(a){var l=this,u="";l.next=function(){var f=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(f^f<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:u+=a;for(var d=0;d<u.length+64;d++)l.x^=u.charCodeAt(d)|0,d==u.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var u=new r(a),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,y=(u.next()>>>0)/4294967296,v=(p+y)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,d&&(typeof d=="object"&&o(d,u),f.state=function(){return o(u,{})}),f}t&&t.exports?t.exports=i:this.xorwow=i})(pH,n)})(Zm)),Zm.exports}var jm={exports:{}},gH=jm.exports,Ak;function yH(){return Ak||(Ak=1,(function(n){(function(e,t,s){function r(a){var l=this;l.next=function(){var d=l.x,f=l.i,p,y;return p=d[f],p^=p>>>7,y=p^p<<24,p=d[f+1&7],y^=p^p>>>10,p=d[f+3&7],y^=p^p>>>3,p=d[f+4&7],y^=p^p<<7,p=d[f+7&7],p=p^p<<13,y^=p^p<<9,d[f]=y,l.i=f+1&7,y};function u(d,f){var p,y=[];if(f===(f|0))y[0]=f;else for(f=""+f,p=0;p<f.length;++p)y[p&7]=y[p&7]<<15^f.charCodeAt(p)+y[p+1&7]<<13;for(;y.length<8;)y.push(0);for(p=0;p<8&&y[p]===0;++p);for(p==8?y[7]=-1:y[p],d.x=y,d.i=0,p=256;p>0;--p)d.next()}u(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var u=new r(a),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,y=(u.next()>>>0)/4294967296,v=(p+y)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,d&&(d.x&&o(d,u),f.state=function(){return o(u,{})}),f}t&&t.exports?t.exports=i:this.xorshift7=i})(gH,n)})(jm)),jm.exports}var eg={exports:{}},xH=eg.exports,_k;function vH(){return _k||(_k=1,(function(n){(function(e,t,s){function r(a){var l=this;l.next=function(){var d=l.w,f=l.X,p=l.i,y,v;return l.w=d=d+1640531527|0,v=f[p+34&127],y=f[p=p+1&127],v^=v<<13,y^=y<<17,v^=v>>>15,y^=y>>>12,v=f[p]=v^y,l.i=p,v+(d^d>>>16)|0};function u(d,f){var p,y,v,w,C,S=[],b=128;for(f===(f|0)?(y=f,f=null):(f=f+"\0",y=0,b=Math.max(b,f.length)),v=0,w=-32;w<b;++w)f&&(y^=f.charCodeAt((w+32)%f.length)),w===0&&(C=y),y^=y<<10,y^=y>>>15,y^=y<<4,y^=y>>>13,w>=0&&(C=C+1640531527|0,p=S[w&127]^=y+C,v=p==0?v+1:0);for(v>=128&&(S[(f&&f.length||0)&127]=-1),v=127,w=512;w>0;--w)y=S[v+34&127],p=S[v=v+1&127],y^=y<<13,p^=p<<17,y^=y>>>15,p^=p>>>12,S[v]=y^p;d.w=C,d.X=S,d.i=v}u(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var u=new r(a),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,y=(u.next()>>>0)/4294967296,v=(p+y)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,d&&(d.X&&o(d,u),f.state=function(){return o(u,{})}),f}t&&t.exports?t.exports=i:this.xor4096=i})(xH,n)})(eg)),eg.exports}var tg={exports:{}},wH=tg.exports,Rk;function CH(){return Rk||(Rk=1,(function(n){(function(e,t,s){function r(a){var l=this,u="";l.next=function(){var f=l.b,p=l.c,y=l.d,v=l.a;return f=f<<25^f>>>7^p,p=p-y|0,y=y<<24^y>>>8^v,v=v-f|0,l.b=f=f<<20^f>>>12^p,l.c=p=p-y|0,l.d=y<<16^p>>>16^v,l.a=v-f|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):u+=a;for(var d=0;d<u.length+20;d++)l.b^=u.charCodeAt(d)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var u=new r(a),d=l&&l.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,y=(u.next()>>>0)/4294967296,v=(p+y)/(1<<21);while(v===0);return v},f.int32=u.next,f.quick=f,d&&(typeof d=="object"&&o(d,u),f.state=function(){return o(u,{})}),f}t&&t.exports?t.exports=i:this.tychei=i})(wH,n)})(tg)),tg.exports}var ng={exports:{}};const TH={},SH=Object.freeze(Object.defineProperty({__proto__:null,default:TH},Symbol.toStringTag,{value:"Module"})),bH=E2(SH);var IH=ng.exports,Dk;function kH(){return Dk||(Dk=1,(function(n){(function(e,t,s){var r=256,o=6,i=52,a="random",l=s.pow(r,o),u=s.pow(2,i),d=u*2,f=r-1,p;function y(N,A,R){var L=[];A=A==!0?{entropy:!0}:A||{};var z=S(C(A.entropy?[N,E(t)]:N??b(),3),L),M=new v(L),P=function(){for(var F=M.g(o),q=l,ee=0;F<u;)F=(F+ee)*r,q*=r,ee=M.g(1);for(;F>=d;)F/=2,q/=2,ee>>>=1;return(F+ee)/q};return P.int32=function(){return M.g(4)|0},P.quick=function(){return M.g(4)/4294967296},P.double=P,S(E(M.S),t),(A.pass||R||function(F,q,ee,ue){return ue&&(ue.S&&w(ue,M),F.state=function(){return w(M,{})}),ee?(s[a]=F,q):F})(P,z,"global"in A?A.global:this==s,A.state)}function v(N){var A,R=N.length,L=this,z=0,M=L.i=L.j=0,P=L.S=[];for(R||(N=[R++]);z<r;)P[z]=z++;for(z=0;z<r;z++)P[z]=P[M=f&M+N[z%R]+(A=P[z])],P[M]=A;(L.g=function(F){for(var q,ee=0,ue=L.i,ie=L.j,de=L.S;F--;)q=de[ue=f&ue+1],ee=ee*r+de[f&(de[ue]=de[ie=f&ie+q])+(de[ie]=q)];return L.i=ue,L.j=ie,ee})(r)}function w(N,A){return A.i=N.i,A.j=N.j,A.S=N.S.slice(),A}function C(N,A){var R=[],L=typeof N,z;if(A&&L=="object")for(z in N)try{R.push(C(N[z],A-1))}catch{}return R.length?R:L=="string"?N:N+"\0"}function S(N,A){for(var R=N+"",L,z=0;z<R.length;)A[f&z]=f&(L^=A[f&z]*19)+R.charCodeAt(z++);return E(A)}function b(){try{var N;return p&&(N=p.randomBytes)?N=N(r):(N=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(N)),E(N)}catch{var A=e.navigator,R=A&&A.plugins;return[+new Date,e,R,e.screen,E(t)]}}function E(N){return String.fromCharCode.apply(0,N)}if(S(s.random(),t),n.exports){n.exports=y;try{p=bH}catch{}}else s["seed"+a]=y})(typeof self<"u"?self:IH,[],Math)})(ng)),ng.exports}var Yx,Fk;function NH(){if(Fk)return Yx;Fk=1;var n=dH(),e=hH(),t=mH(),s=yH(),r=vH(),o=CH(),i=kH();return i.alea=n,i.xor128=e,i.xorwow=t,i.xorshift7=s,i.xor4096=r,i.tychei=o,Yx=i,Yx}var p1=NH();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nC{constructor(e,t,s,r,o){this.mean=e,this.stdDev=t,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=p1.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,t,s=!1;for(;!s;){let r,o,i;do r=2*this.random()-1,o=2*this.random()-1,i=r*r+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*a,t=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class EH{constructor(e,t,s,r){this.alpha=e,this.beta=1/t,this.dtype=s;const o=r||Math.random();this.randu=p1.alea(o.toString()),this.randn=new nC(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,s,r,o,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,e=r*r,t=1-.331*e*e,s=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<t||Math.log(o)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class $H{constructor(e=0,t=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=p1.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(n,e,t=1,s="float32",r){if(t==null&&(t=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const o=new EH(e,t,s,r),i=ht(n,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const d$=Z({randomGamma_:AH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _H(n,e=0,t=1,s,r){if(s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const o=new nC(e,t,s,!1,r),i=ht(n,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const m1=Z({randomNormal_:_H});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return m1(n,0,1,e,t)}const f$=Z({randomStandardNormal_:RH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DH(n,e=0,t=1,s="float32",r){const o=ht(n,s),i=new $H(e,t,null,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const jc=Z({randomUniform_:DH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mu(n,e,t=1,s="float32"){if(t===0)throw new Error("Cannot have a step of zero");const r={start:n,stop:e,step:t,dtype:s};return Q.runKernel(Ay,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(n){const t={x:U(n,"x","reciprocal")};return Q.runKernel(Nc,t)}const sC=Z({reciprocal_:FH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MH(n){const t={x:U(n,"x","relu")};return Q.runKernel(Ec,t)}const fo=Z({relu_:MH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PH(n){const t={x:U(n,"x","relu6")};return Q.runKernel($c,t)}const g1=Z({relu6_:PH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(n,e){const s={x:U(n,"x","reverse")},r={dims:e};return Q.runKernel(vh,s,r)}const yr=Z({reverse_:LH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(n){const e=U(n,"x","reverse");return B(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),yr(e,0)}const h$=Z({reverse1d_:OH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VH(n,e){const t=U(n,"x","reverse");return B(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),yr(t,e)}const p$=Z({reverse2d_:VH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BH(n,e){const t=U(n,"x","reverse");return B(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),yr(t,e)}const m$=Z({reverse3d_:BH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zH(n,e){const t=U(n,"x","reverse");return B(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),yr(t,e)}const g$=Z({reverse4d_:zH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UH(n){const t={x:U(n,"x","round")};return Q.runKernel(Ac,t)}const y1=Z({round_:UH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(n){const t={x:U(n,"x","rsqrt","float32")};return Q.runKernel(_c,t)}const x1=Z({rsqrt_:WH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(n){const t={x:U(n,"x","selu")};return Q.runKernel(Rc,t)}const v1=Z({selu_:GH});function HH(n,e,t,s,r,o=[1,1],i="NHWC"){const a=U(n,"x","separableConv2d"),l=U(e,"depthwiseFilter","separableConv2d"),u=U(t,"pointwiseFilter","separableConv2d");let d=a,f=!1;if(a.rank===3&&(f=!0,d=se(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");B(d.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${d.rank}.`),B(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),B(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),B(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),B(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const p=l.shape[2],y=l.shape[3];B(u.shape[2]===p*y,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*y}, but got ${u.shape[2]}.`);const v=Kc(d,l,s,r,i,o),C=pi(v,u,1,"valid",i);return f?se(C,[C.shape[1],C.shape[2],C.shape[3]]):C}const w1=Z({separableConv2d_:HH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function qH(n,e){const t=U(n,"x","setdiff1d"),s=U(e,"y","setdiff1d");B(t.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${s.dtype}).`),B(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),B(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await t.data(),o=await s.data(),i=new Set(o);let a=0;for(let d=0;d<r.length;d++)i.has(r[d])||a++;const l=new Mn([a],t.dtype),u=new Mn([a],"int32");for(let d=0,f=0;d<r.length;d++)i.has(r[d])||(l.values[f]=r[d],u.values[f]=d,f++);return[l.toTensor(),u.toTensor()]}const y$=qH;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(n){const t={x:U(n,"x","sign")};return Q.runKernel(Mc,t)}const rC=Z({sign_:KH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(n){const t={x:U(n,"x","sin","float32")};return Q.runKernel(Dc,t)}const C1=Z({sin_:XH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(n){const t={x:U(n,"x","sinh")};return Q.runKernel(Fc,t)}const T1=Z({sinh_:JH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(n,e,t){const s=U(n,"x","slice1d");return B(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),it(s,[e],[t])}const Wh=Z({slice1d_:YH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(n,e,t){const s=U(n,"x","slice2d");return B(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),it(s,e,t)}const S1=Z({slice2d_:QH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(n,e,t){const s=U(n,"x","slice3d");return B(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),it(s,e,t)}const Gh=Z({slice3d_:ZH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(n,e,t){const s=U(n,"x","slice4d");return B(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),it(s,e,t)}const Pu=Z({slice4d_:jH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eq(n,e=-1){const t=U(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const s={logits:t},r={dim:e};return Q.runKernel(Ih,s,r)}const Hh=Z({softmax_:eq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tq(n){B(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Q.runKernel(hy,e)}const qh=Z({fft_:tq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nq(n){B(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Q.runKernel(yy,e)}const Lu=Z({ifft_:nq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sq(n){const e=n.shape[n.shape.length-1],t=n.size/e;let s;if(e<=2){const r=se(n,[t,e]);s=Lu(r)}else{const r=[t,2*(e-1)],o=se(Fu(n),[t,e]),i=se(_h(n),[t,e]),a=yr(it(o,[0,1],[t,e-2]),1),l=j(yr(it(i,[0,1],[t,e-2]),1),tt(-1)),u=dn([o,a],1),d=dn([i,l],1),f=se(hi(u,d),[r[0],r[1]]);s=Lu(f)}if(s=Fu(s),n.rank===3&&n.shape[0]!==0){const r=s,o=n.shape[0];s=se(s,[o,s.shape[0]/o,s.shape[1]]),r.dispose()}return s}const b1=Z({irfft_:sq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rq(n,e,t=0){const r={x:U(n,"x","split")},o={numOrSizeSplits:e,axis:t};return Q.runKernel(bh,r,o)}const Ls=Z({split_:rq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(n,e){B(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const s=n.size/t;let r;if(e!=null&&e<t){const v=n.shape.map(C=>0),w=n.shape.map(C=>C);w[n.shape.length-1]=e,r=it(n,v,w),t=e}else if(e!=null&&e>t){const v=n.shape.map(w=>w);v[n.shape.length-1]=e-t,r=dn([n,kn(v)],n.shape.length-1),t=e}else r=n;const o=bt(r),i=se(hi(r,o),[s,t]),a=qh(i),l=Math.floor(t/2)+1,u=Fu(a),d=_h(a),f=Ls(u,[l,t-l],u.shape.length-1),p=Ls(d,[l,t-l],d.shape.length-1),y=r.shape.slice();return y[r.shape.length-1]=l,se(hi(f[0],p[0]),y)}const Kh=Z({rfft_:oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iq(n,e){let t=U(n,"a","squaredDifference"),s=U(e,"b","squaredDifference");[t,s]=fn(t,s),dt(t.shape,s.shape);const r={a:t,b:s},o={};return Q.runKernel(Vc,r,o)}const I1=Z({squaredDifference_:iq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aq(n,e){const t=U(n,"x","squeeze","string_or_numeric");return se(t,wi(t.shape,e).newShape)}const an=Z({squeeze_:aq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lq(n,e=0){const t=hf(n,"tensors","stack","string_or_numeric");B(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&B(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const s=t,r={axis:e};return Q.runKernel(fh,s,r)}const xr=Z({stack_:lq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uq(n,e=0){const s={x:U(n,"x","step")},r={alpha:e};return Q.runKernel(Gc,s,r)}const _l=Z({step_:uq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cq(n,e,t,s,r=0,o=0,i=0,a=0,l=0){const d={x:U(n,"x","stridedSlice","string_or_numeric")},f={begin:e,end:t,strides:s,beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return Q.runKernel(Uy,d,f)}const oC=Z({stridedSlice_:cq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dq(n){const t={x:U(n,"x","tan","float32")};return Q.runKernel(zc,t)}const iC=Z({tan_:dq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nn(n,e){Il(n);const t=Mo(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return ga(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ui(n,e,t){if(Il(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Mo(n,t);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return ga(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x$(n,e,t){if(Il(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Mo(n,t);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return ga(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v$(n,e,t){if(Il(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Mo(n,t);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return ga(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w$(n,e,t){if(Il(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Mo(n,t);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,ga(n,e,s,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fq(n,e=1,t=!0){const s=U(n,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const o={x:s},i={k:e,sorted:t},[a,l]=Q.runKernel(qy,o,i);return{values:a,indices:l}}const aC=Z({topk_:fq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hq(n,e=0,t=1,s,r){if(s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new nC(e,t,s,!0,r),i=ht(n,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const k1=Z({truncatedNormal_:hq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pq(n,e=0){const t=U(n,"x","unique","string_or_numeric");B(t.rank>0,()=>"The input tensor must be at least 1D");const s={x:t},r={axis:e},[o,i]=Q.runKernel(Xy,s,r);return{values:o,indices:i}}const lC=Z({unique_:pq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mq(n,e,t){const s=U(n,"x","unsortedSegmentSum"),r=U(e,"segmentIds","unsortedSegmentSum","int32");B(ul(t),()=>"numSegments must be of dtype int");const o={x:s,segmentIds:r},i={numSegments:t};return Q.runKernel(Nh,o,i)}const N1=Z({unsortedSegmentSum_:mq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gq(n,e=0){const t=U(n,"x","unstack","string_or_numeric");B(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const s={value:t},r={axis:e};return Q.runKernel(kh,s,r)}const zr=Z({unstack_:gq});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C$(n,e){return h1(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uC(n,e=!0,t,s){return Q.makeVariable(n,e,t,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E1(n,e){const t=[];for(let o=0;o<e.length;o++)e[o]&&t.push(o);const s=ht(n,"int32"),r=ht([t.length,n.length],"int32");for(let o=0;o<t.length;o++){const i=s.indexToLoc(t[o]),a=o*n.length;r.values.set(i,a)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function yq(n){const e=U(n,"condition","whereAsync","bool"),t=await e.data(),s=E1(e.shape,t);return n!==e&&e.dispose(),s}const cC=yq;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function xq(n,e,t){const s=U(n,"tensor","boolMask"),r=U(e,"mask","boolMask","bool"),o=t??0,i=r.rank,a=s.shape;B(i>0,()=>"mask cannot be scalar"),ns(a.slice(o,o+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let w=o;w<o+i;w++)l*=a[w];const u=a.slice(0,o).concat([l],a.slice(o+i)),d=se(s,u),f=se(r,[-1]),p=await cC(f),y=an(p,[1]),v=Qc(d,y,o);return n!==s&&s.dispose(),e!==r&&r.dispose(),y.dispose(),d.dispose(),f.dispose(),p.dispose(),v}const T$=xq;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vq(n,e,t,s,r=!0){const o=U(n,"v","movingAverage"),i=U(e,"x","movingAverage"),a=U(t,"decay","movingAverage");l3(o,i),B(Ct(o.shape,i.shape),()=>"Shape mismatch in v and x");const l=tt(1),u=ze(l,a);let d=j(ze(i,o),u);if(r){B(s!=null,()=>"When using zeroDebias: true, step is required.");const f=U(s,"step","movingAverage");d=Be(d,ze(l,mi(a,f)))}return ke(o,d)}const S$=Z({movingAverage_:vq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wq(n,e,t){const s=U(n,"indices","scatterND","int32"),r=U(e,"updates","scatterND");aw(r,s,t);const o={indices:s,updates:r},i={shape:t};return Q.runKernel(Fy,o,i)}const b$=Z({scatterND_:wq});function Cq(n,e,t,s){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const r=n.rank>0?n.shape[0]:1,o=n.rank>1?n.shape[1]:1;if(t.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${o}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tq(n,e,t,s=0){const r=U(n,"sparseIndices","sparseToDense","int32"),o=U(e,"sparseValues","sparseToDense","string_or_numeric"),i=U(s,"defaultValue","sparseToDense",o.dtype);Cq(r,o,t,i);const a={sparseIndices:r,sparseValues:o,defaultValue:i},l={outputShape:t};return Q.runKernel(By,a,l)}const I$=Z({sparseToDense_:Tq});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sq(n,e){const t=U(e,"indices","gatherND","int32"),r={params:U(n,"x","gatherND","string_or_numeric"),indices:t};return Q.runKernel(gy,r)}const k$=Z({gatherND_:Sq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bq(n,e){if(e==null)return n.shape.slice();if(Ct(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let s=0;s<n.shape.length;s++)e[s]==null&&n.shape[s]!=null?t.push(n.shape[s]):t.push(e[s]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iq(n,e,t,s){const r=U(n,"x","dropout");if(B(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),B(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof St?r.clone():r;const o=bq(r,t),i=1-e,a=Be(Yc(ke(jc(o,0,1,"float32",s),i)),i);return j(r,a)}const dC=Z({dropout_:Iq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fC(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function $1(n,e,t){const s=1-n%2,r=new Float32Array(n);for(let o=0;o<n;++o){const i=2*Math.PI*o/(n+s-1);r[o]=e-t*Math.cos(i)}return Nn(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function kq(n,e,t=1){const s=U(n,"predictions","inTopK"),r=U(e,"targets","inTopK");B(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),B(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),ns(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=s.shape[s.shape.length-1];B(t>0&&t<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${t}`);const i=await s.data(),a=await r.data(),[l,u]=[i.length/o,o],d=On("bool",l);for(let f=0;f<l;f++){const p=f*u,y=i.subarray(p,p+u),v=[];for(let w=0;w<y.length;w++)v.push({value:y[w],index:w});v.sort((w,C)=>C.value-w.value),d[f]=0;for(let w=0;w<t;w++)if(v[w].index===a[f]){d[f]=1;break}}return n!==s&&s.dispose(),e!==r&&r.dispose(),ro(d,r.shape,"bool")}const N$=kq;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nq(n,e,t,s,r,o="NHWC",i){let a=n;n.rank===3&&(a=se(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=se(e,[1,e.shape[0],e.shape[1],e.shape[2]])),B(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),B(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),B(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const u=o==="NHWC"?a.shape[3]:a.shape[1],d=o==="NHWC"?l.shape[3]:l.shape[1];B(u===t[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${t[2]}.`),B(d===t[3],()=>`Error in conv2dDerFilter: depth of dy (${d}) must match output depth for filter (${t[3]}).`),As("conv2dDerFilter",r,i);const f={x:a,dy:l},p={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,filterShape:t};return Q.runKernel(ty,f,p)}const hC=Z({conv2DBackpropFilter_:Nq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A1(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return j(n,_l(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function _1(n,e){let t=e;const s=En(n.shape,e.shape);return s.length>0&&(t=Ge(t,s)),se(t,n.shape)}function R1(n,e,t,s){if(e==="linear")return n;if(e==="relu")return fo(n);if(e==="elu")return Xc(n);if(e==="relu6")return g1(n);if(e==="prelu")return Uh(n,t);if(e==="leakyrelu")return Ph(n,s);if(e==="sigmoid")return Or(n);throw new Error(`Unknown fused activation ${e}.`)}const D1=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eq({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}){if(l=l||"linear",D1(Q.state.gradientDepth,l)===!1){B(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let R=pi(n,e,t,s,r,o,i);return a!=null&&(R=ke(R,a)),R1(R,l,u,d)}const f=U(n,"x","conv2d","float32"),p=U(e,"filter","conv2d","float32");let y=f,v=!1;f.rank===3&&(v=!0,y=se(f,[1,f.shape[0],f.shape[1],f.shape[2]])),B(y.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${y.rank}.`),B(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),As("fused conv2d",s,i);const w=r==="NHWC"?y.shape[3]:y.shape[1];B(p.shape[2]===w,()=>`Error in conv2d: depth of input (${w}) must match input depth for filter ${p.shape[2]}.`),B(ss(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);const C=Gn(y.shape,p.shape,t,o,s,i);let S;a!=null&&(S=U(a,"bias","fused conv2d"),[S]=fn(S,f),r==="NHWC"?dt(C.outShape,S.shape):(B(S.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${S.shape.length}.`),B(S.shape.length===0||S.shape[0]===C.outChannels||S.shape[0]===1,()=>`Error in fused conv2d: bias shape (${S.shape}) is not compatible with the number of output channels (${C.outChannels})`)));let b;if(u!=null){const R=u.shape;if(B(R.length<=1||R.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${R.length}.`),R.length===1)B(R[0]===1||R[0]===C.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${R}) is not compatible with the number of output channels (${C.outChannels}).`);else if(R.length===3)try{dt(R,C.outShape)}catch{const z=`Error in fused conv2d: PReLU activation weights (${R}) is not compatible with the output shape of the conv2d (${C.outShape}).`;throw Error(z)}b=U(u,"prelu weights","fused conv2d")}const E=(R,L)=>{B(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[z,M,P,F]=L,q=A1(R,P,l);B(la(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const ee=Fw(M.shape,q,z,t,s),ue=hC(M,q,z.shape,t,s),ie=[ee,ue];if(F!=null){const de=_1(F,q);ie.push(de)}return ie},N={x:y,filter:p,bias:S,preluActivationWeights:b},A={strides:t,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:d};return a==null?Po((L,z,M)=>{let P=Q.runKernel(uf,N,A);return M([z,L,P]),v&&(P=se(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:E}})(y,p):Po((L,z,M,P)=>{let F=Q.runKernel(uf,N,A);return P([z,L,F,M]),v&&(F=se(F,[F.shape[1],F.shape[2],F.shape[3]])),{value:F,gradFunc:E}})(y,p,S)}const E$=Z({fusedConv2d_:Eq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $q(n,e,t,s,r,o=[1,1],i){let a=n;n.rank===3&&(a=se(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let l=e;l.rank===3&&(l=se(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:a,dy:l},d={strides:s,pad:r,dimRoundingMode:i,dilations:o,filterShape:t};return Q.runKernel(ly,u,d)}const $$=Z({depthwiseConv2dNativeBackpropFilter_:$q});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aq(n,e,t,s,r,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=se(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:a,filter:t},d={strides:s,pad:r,dimRoundingMode:i,dilations:o,inputShape:n},f=Q.runKernel(uy,u,d);return l?se(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const A$=Z({depthwiseConv2dNativeBackpropInput_:Aq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _q({x:n,filter:e,strides:t,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:u,leakyreluAlpha:d}){if(D1(Q.state.gradientDepth,l)===!1){let A=Kc(n,e,t,s,r,o,i);return a!=null&&(A=ke(A,a)),R1(A,l,u,d)}const f=U(n,"x","depthwiseConv2d","float32"),p=U(e,"filter","depthwiseConv2d","float32");let y=f,v=!1;f.rank===3&&(v=!0,y=se(f,[1,f.shape[0],f.shape[1],f.shape[2]])),B(y.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${y.rank}.`),B(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),B(y.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${y.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),o==null&&(o=[1,1]),B(ss(t,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),As("fused depthwiseConv2d",s,i);const w=Gn(y.shape,p.shape,t,o,s,i,!0);let C;a!=null&&(C=U(a,"bias","fused conv2d"),[C]=fn(C,f),dt(w.outShape,C.shape));let S;u!=null&&(S=U(u,"prelu weights","fused depthwiseConv2d"));const b=(A,R)=>{B(la(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[L,z,M,P]=R,F=A1(A,M,l),q=A$(z.shape,F,L,t,s,o,i),ee=$$(z,F,L.shape,t,s,o,i);if(P!=null){const ue=_1(C,F);return[q,ee,ue]}return[q,ee]},E={x:y,filter:p,bias:C,preluActivationWeights:S},N={strides:t,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:d};return a==null?Po((R,L,z)=>{let M=Q.runKernel(cf,E,N);return z([L,R,M]),v&&(M=se(M,[M.shape[1],M.shape[2],M.shape[3]])),{value:M,gradFunc:b}})(y,p):Po((R,L,z,M)=>{let P=Q.runKernel(cf,E,N);return M([L,R,P,z]),v&&(P=se(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:b}})(y,p,C)}const Rq=Z({fusedDepthwiseConv2d_:_q});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dq({a:n,b:e,transposeA:t=!1,transposeB:s=!1,bias:r,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(D1(Q.state.gradientDepth,o)===!1){let F=mt(n,e,t,s);return r!=null&&(F=ke(F,r)),R1(F,o,i,a)}let l=U(n,"a","fused matMul"),u=U(e,"b","fused matMul");[l,u]=fn(l,u);const d=t?l.shape[l.rank-2]:l.shape[l.rank-1],f=s?u.shape[u.rank-1]:u.shape[u.rank-2],p=t?l.shape[l.rank-1]:l.shape[l.rank-2],y=s?u.shape[u.rank-2]:u.shape[u.rank-1],v=l.shape.slice(0,-2),w=u.shape.slice(0,-2),C=we(v),S=we(w);B(d===f,()=>`Error in fused matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${l.shape} and ${u.shape} and transposeA=${t} and transposeB=${s} must match.`);const E=dt(l.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,y]),N=t?se(l,[C,d,p]):se(l,[C,p,d]),A=s?se(u,[S,y,f]):se(u,[S,f,y]);let R;r!=null&&(R=U(r,"bias","fused matMul"),[R]=fn(R,l),dt(E,R.shape));let L;i!=null&&(L=U(i,"prelu weights","fused matMul"));const z=(F,q)=>{const[ee,ue,ie,de]=q,ae=A1(se(F,ie.shape),ie,o);let J,te;if(!t&&!s?(J=mt(ae,ue,!1,!0),te=mt(ee,ae,!0,!1)):!t&&s?(J=mt(ae,ue,!1,!1),te=mt(ae,ee,!0,!1)):t&&!s?(J=mt(ue,ae,!1,!0),te=mt(ee,ae,!1,!1)):(J=mt(ue,ae,!0,!0),te=mt(ae,ee,!0,!0)),r!=null){const oe=_1(de,ae);return[J,te,oe]}else return[J,te]},M={a:N,b:A,bias:R,preluActivationWeights:L},P={transposeA:t,transposeB:s,activation:o,leakyreluAlpha:a};return r==null?Po((q,ee,ue)=>{const ie=Q.runKernel(lf,M,P);return ue([q,ee,ie]),{value:se(ie,E),gradFunc:z}})(N,A):Po((q,ee,ue,ie)=>{const de=Q.runKernel(lf,M,P);return ie([q,ee,de,ue]),{value:se(de,E),gradFunc:z}})(N,A,R)}const Yv=Z({fusedMatMul_:Dq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _$=Object.freeze(Object.defineProperty({__proto__:null,conv2d:E$,depthwiseConv2d:Rq,matMul:Yv},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fq(n){return $1(n,.54,.46)}const Mq=Z({hammingWindow_:Fq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pq(n){return $1(n,.5,.5)}const R$=Z({hannWindow_:Pq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lq(n,e,t,s=!1,r=0){let o=0;const i=[];for(;o+e<=n.size;)i.push(it(n,o,e)),o+=t;if(s)for(;o<n.size;){const a=o+e-n.size,l=dn([it(n,o,e-a),$l([a],r)]);i.push(l),o+=t}return i.length===0?ui([],[0,e]):se(dn(i),[i.length,e])}const D$=Z({frame_:Lq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oq(n,e,t,s,r=R$){s==null&&(s=fC(e));const o=D$(n,e,t),i=j(o,r(e));return Kh(i,s)}const Vq=Z({stft_:Oq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bq(n,e,t,s,r="bilinear",o=0){const i=U(n,"image","cropAndResize"),a=U(e,"boxes","cropAndResize","float32"),l=U(t,"boxInd","cropAndResize","int32"),u=a.shape[0];B(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),B(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${a.shape}.`),B(l.rank===1&&l.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${a.shape}.`),B(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),B(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),B(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const d={image:i,boxes:a,boxInd:l},f={method:r,extrapolationValue:o,cropSize:s};return Q.runKernel(oy,d,f)}const zq=Z({cropAndResize_:Bq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uq(n){const e=U(n,"image","flipLeftRight","float32");B(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return Q.runKernel(my,t,{})}const Wq=Z({flipLeftRight_:Uq});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gq(n){const e=U(n,"image","grayscaleToRGB"),t=e.rank-1,s=e.shape[t];B(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),B(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,t),r[t]=3,pr(e,r)}const Hq=Z({grayscaleToRGB_:Gq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qq(n,e,t=0,s=.5){const r=U(n,"image","rotateWithOffset","float32");B(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const o={image:r},i={radians:e,fillValue:t,center:s};return Q.runKernel(Jy,o,i)}const Kq=Z({rotateWithOffset_:qq});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ed(n,e,t,s,r,o){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=n.shape[0];return t=Math.min(t,i),B(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),B(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),B(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),B(e.rank===1,()=>"scores must be a 1D tensor"),B(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),B(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xq(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const o=U(n,"boxes","nonMaxSuppression","float32"),i=U(e,"scores","nonMaxSuppression","float32"),a=ed(o,i,t,s,r);t=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:t,iouThreshold:s,scoreThreshold:r};return Q.runKernel(Iy,{boxes:o,scores:i},l)}const Jq=Z({nonMaxSuppression_:Xq});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yq(n,e,t){const s=Qq(n,e,t),r=s<0?-(s+1):s;n.splice(r,0,e)}function Qq(n,e,t){return jq(n,e,t||Zq)}function Zq(n,e){return n>e?1:n<e?-1:0}function jq(n,e,t){let s=0,r=n.length,o=0,i=!1;for(;s<r;){o=s+(r-s>>>1);const a=t(e,n[o]);a>0?s=o+1:(r=o,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F1(n,e,t,s,r){return pC(n,e,t,s,r,0)}function M1(n,e,t,s,r,o){return pC(n,e,t,s,r,0,!1,o,!0)}function P1(n,e,t,s,r,o){return pC(n,e,t,s,r,o,!0)}function pC(n,e,t,s,r,o,i=!1,a=!1,l=!1){const u=[];for(let C=0;C<e.length;C++)e[C]>r&&u.push({score:e[C],boxIndex:C,suppressBeginIndex:0});u.sort(Mk);const d=o>0?-.5/o:0,f=[],p=[];for(;f.length<t&&u.length>0;){const C=u.pop(),{score:S,boxIndex:b,suppressBeginIndex:E}=C;if(S<r)break;let N=!1;for(let A=f.length-1;A>=E;--A){const R=eK(n,b,f[A]);if(R>=s){N=!0;break}if(C.score=C.score*tK(s,d,R),C.score<=r)break}C.suppressBeginIndex=f.length,N||(C.score===S?(f.push(b),p.push(C.score)):C.score>r&&Yq(u,C,Mk))}const y=f.length,v=t-y;a&&v>0&&(f.push(...new Array(v).fill(0)),p.push(...new Array(v).fill(0)));const w={selectedIndices:f};return i&&(w.selectedScores=p),l&&(w.validOutputs=y),w}function eK(n,e,t){const s=n.subarray(e*4,e*4+4),r=n.subarray(t*4,t*4+4),o=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),d=Math.min(r[1],r[3]),f=Math.max(r[0],r[2]),p=Math.max(r[1],r[3]),y=(a-o)*(l-i),v=(f-u)*(p-d);if(y<=0||v<=0)return 0;const w=Math.max(o,u),C=Math.max(i,d),S=Math.min(a,f),b=Math.min(l,p),E=Math.max(S-w,0)*Math.max(b-C,0);return E/(y+v-E)}function tK(n,e,t){const s=Math.exp(e*t*t);return t<=n?s:0}function Mk(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function nK(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY){const o=U(n,"boxes","nonMaxSuppressionAsync"),i=U(e,"scores","nonMaxSuppressionAsync"),a=ed(o,i,t,s,r);t=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),u=l[0],d=l[1],{selectedIndices:f}=F1(u,d,t,s,r);return o!==n&&o.dispose(),i!==e&&i.dispose(),Nn(f,"int32")}const sK=nK;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rK(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=U(n,"boxes","nonMaxSuppression"),a=U(e,"scores","nonMaxSuppression"),l=ed(i,a,t,s,r,o);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const u={boxes:i,scores:a},d={maxOutputSize:t,iouThreshold:s,scoreThreshold:r,softNmsSigma:o},f=Q.runKernel(Ny,u,d);return{selectedIndices:f[0],selectedScores:f[1]}}const oK=Z({nonMaxSuppressionWithScore_:rK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function iK(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=U(n,"boxes","nonMaxSuppressionAsync"),a=U(e,"scores","nonMaxSuppressionAsync"),l=ed(i,a,t,s,r,o);t=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const u=await Promise.all([i.data(),a.data()]),d=u[0],f=u[1],{selectedIndices:p,selectedScores:y}=P1(d,f,t,s,r,o);return i!==n&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Nn(p,"int32"),selectedScores:Nn(y)}}const aK=iK;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=U(n,"boxes","nonMaxSuppression"),a=U(e,"scores","nonMaxSuppression"),l=ed(i,a,t,s,r,null),u=l.maxOutputSize,d=l.iouThreshold,f=l.scoreThreshold,p={boxes:i,scores:a},y={maxOutputSize:u,iouThreshold:d,scoreThreshold:f,padToMaxOutputSize:o},v=Q.runKernel(ky,p,y);return{selectedIndices:v[0],validOutputs:v[1]}}const uK=Z({nonMaxSuppressionPadded_:lK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function cK(n,e,t,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=U(n,"boxes","nonMaxSuppressionAsync"),a=U(e,"scores","nonMaxSuppressionAsync"),l=ed(i,a,t,s,r,null),u=l.maxOutputSize,d=l.iouThreshold,f=l.scoreThreshold,[p,y]=await Promise.all([i.data(),a.data()]),{selectedIndices:v,validOutputs:w}=M1(p,y,u,d,f,o);return i!==n&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Nn(v,"int32"),validOutputs:tt(w,"int32")}}const dK=cK;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fK(n,e,t=!1,s=!1){const r=U(n,"images","resizeBilinear");B(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),B(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),B(s===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=se(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:t,halfPixelCenters:s,size:e},u=Q.runKernel(xh,a,l);return i?se(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const F$=Z({resizeBilinear_:fK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hK(n,e,t=!1,s=!1){const r=U(n,"images","resizeNearestNeighbor");B(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),B(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),B(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),B(s===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=se(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:t,halfPixelCenters:s,size:e},u=Q.runKernel(yh,a,l);return i?se(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const M$=Z({resizeNearestNeighbor_:hK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pK(n,e="binary",t=!1,s=.5){const r=U(n,"image","threshold"),o=.2989,i=.587,a=.114,l=r.shape[0]*r.shape[1];let u=j(Nn([s]),255),d,f,p,y;if(B(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),B(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),B(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),B(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[d,f,p]=Ls(r,[1,1,1],-1);const C=j(d,o),S=j(f,i),b=j(p,a);y=ke(ke(C,S),b)}else y=n;if(e==="otsu"){const C=Ew(Me(y1(y),"int32"),ro([]),256);u=mK(C,l)}const v=t?wa(y,u):sr(y,u);return Me(j(v,255),"int32")}function mK(n,e){let t=Nn([-1]),s=Nn([0]),r=Nn([0]),o,i,a,l,u,d;for(let f=0;f<n.size-1;f++){o=it(n,0,f+1),i=it(n,f+1),u=Be(Ge(o),e),d=Be(Ge(i),e);const p=Ge(j(o,Mu(0,o.size)));a=Be(p,Ge(o));const y=$l(i.shape,o.size),v=ke(Mu(0,i.size),y),w=j(i,v);l=Be(Ge(w),Ge(i));const C=ze(a,l),S=ze(a,l),b=j(u,d);r=j(j(b,C),S);const E=sr(r,s);s=Ns(E,r,s),t=Ns(E,Nn([f]),t)}return t}const gK=Z({threshold_:pK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yK(n,e,t="nearest",s="constant",r=0,o){const i=U(n,"image","transform","float32"),a=U(e,"transforms","transform","float32");B(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),B(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),B(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},u={interpolation:t,fillMode:s,fillValue:r,outputShape:o};return Q.runKernel(Ky,l,u)}const xK=Z({transform_:yK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vK(n,e,t){B(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),B(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`);const s=U(n,"a","bandPart");B(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[o,i]=s.shape.slice(-2);if(!(e<=o))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`);if(!(t<=i))throw new Error(`bandPart(): numUpper (${t}) must not be greater than the number of columns (${i}).`);e<0&&(e=o),t<0&&(t=i);const a=se(Mu(0,o,1,"int32"),[-1,1]),l=Mu(0,i,1,"int32"),u=ze(a,l),d=ao(wa(u,tt(+e,"int32")),va(u,tt(-t,"int32"))),f=kn([o,i],s.dtype);return se(xr(zr(se(s,[-1,o,i])).map(p=>Ns(d,p,f))),r)}const wK=Z({bandPart_:vK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CK(n){let e;if(Array.isArray(n)){e=!1,B(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=n[0].shape[0];for(let o=1;o<n.length;++o)B(n[o].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[o].shape[0]} vs. ${r})`)}else e=!0,n=Ls(n,n.shape[0],0).map(r=>an(r,[0]));B(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],s=n;for(let r=0;r<n.length;++r)t.push(Q.tidy(()=>{let o=s[r];if(r>0)for(let i=0;i<r;++i){const a=j(Ge(j(t[i],o)),t[i]);o=ze(o,a)}return Be(o,Jc(o,"euclidean"))}));return e?xr(t,0):t}const TK=Z({gramSchmidt_:CK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SK(n,e=!1){if(B(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return Pk(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((l,u)=>l*u),s=zr(se(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),r=[],o=[];s.forEach(l=>{const[u,d]=Pk(l,e);r.push(u),o.push(d)});const i=se(xr(r,0),n.shape),a=se(xr(o,0),n.shape);return[i,a]}}function Pk(n,e=!1){return Q.tidy(()=>{B(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],s=n.shape[1];let r=a1(t),o=Ro(n);const i=ui([[1]],[1,1]);let a=Ro(i);const l=t>=s?s:t;for(let u=0;u<l;++u){const d=o,f=a,p=r;[a,o,r]=Q.tidy(()=>{const y=it(o,[u,u],[t-u,1]),v=Jc(y),w=it(o,[u,u],[1,1]),C=Ns(sr(w,0),ui([[-1]]),ui([[1]])),S=ze(w,j(C,v)),b=Be(y,S);b.shape[0]===1?a=Ro(i):a=dn([i,it(b,[1,0],[b.shape[0]-1,b.shape[1]])],0);const E=Qt(Be(mt(C,S),v)),N=it(o,[u,0],[t-u,s]),A=j(E,a),R=xt(a);if(u===0)o=ze(N,mt(A,mt(R,N)));else{const M=ze(N,mt(A,mt(R,N)));o=dn([it(o,[0,0],[u,s]),M],0)}const L=xt(A),z=it(r,[0,u],[t,r.shape[1]-u]);if(u===0)r=ze(z,mt(mt(z,a),L));else{const M=ze(z,mt(mt(z,a),L));r=dn([it(r,[0,0],[t,u]),M],1)}return[a,o,r]}),lt([d,f,p])}return!e&&t>s&&(r=it(r,[0,0],[t,s]),o=it(o,[0,0],[s,s])),[r,o]})}const bK=Z({qr_:SK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ts;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Ts||(Ts={}));function IK(n,e,t=Ts.SUM_BY_NONZERO_WEIGHTS){const s=U(n,"losses","computeWeightedLoss");let r=null;e!=null&&(r=U(e,"weights","computeWeightedLoss"));const o=r==null?s:j(s,r);if(t===Ts.NONE)return o;if(t===Ts.SUM)return Ge(o);if(t===Ts.MEAN){if(r==null)return un(o);{const i=s.size/r.size,a=Be(Ge(o),Ge(r));return i>1?Be(a,tt(i)):a}}if(t===Ts.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Be(Ge(o),tt(s.size));{const i=j(r,Qs(s.shape)),a=Me(Ge(yl(i,tt(0))),"float32");return Be(Ge(o),a)}}throw Error(`Unknown reduction: ${t}`)}const Ii=Z({computeWeightedLoss_:IK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kK(n,e,t,s=Ts.SUM_BY_NONZERO_WEIGHTS){const r=U(n,"labels","absoluteDifference"),o=U(e,"predictions","absoluteDifference");let i=null;t!=null&&(i=U(t,"weights","absoluteDifference")),ns(r.shape,o.shape,"Error in absoluteDifference: ");const a=In(ze(r,o));return Ii(a,i,s)}const NK=Z({absoluteDifference_:kK});function EK(n,e,t,s,r=Ts.SUM_BY_NONZERO_WEIGHTS){const o=U(n,"labels","cosineDistance"),i=U(e,"predictions","cosineDistance");let a=null;s!=null&&(a=U(s,"weights","cosineDistance")),ns(o.shape,i.shape,"Error in cosineDistance: ");const l=tt(1),u=ze(l,Ge(j(o,i),t,!0));return Ii(u,a,r)}const $K=Z({cosineDistance_:EK});function AK(n,e,t,s=Ts.SUM_BY_NONZERO_WEIGHTS){let r=U(n,"labels","hingeLoss");const o=U(e,"predictions","hingeLoss");let i=null;t!=null&&(i=U(t,"weights","hingeLoss")),ns(r.shape,o.shape,"Error in hingeLoss: ");const a=tt(1);r=ze(j(tt(2),r),a);const l=fo(ze(a,j(r,o)));return Ii(l,i,s)}const _K=Z({hingeLoss_:AK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RK(n,e,t,s=1,r=Ts.SUM_BY_NONZERO_WEIGHTS){const o=U(n,"labels","huberLoss"),i=U(e,"predictions","huberLoss");let a=null;t!=null&&(a=U(t,"weights","huberLoss")),ns(o.shape,i.shape,"Error in huberLoss: ");const l=tt(s),u=In(ze(i,o)),d=Zc(u,l),f=ze(u,d),p=ke(j(tt(.5),Ut(d)),j(l,f));return Ii(p,a,r)}const DK=Z({huberLoss_:RK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FK(n,e,t,s=1e-7,r=Ts.SUM_BY_NONZERO_WEIGHTS){const o=U(n,"labels","logLoss"),i=U(e,"predictions","logLoss");let a=null;t!=null&&(a=U(t,"weights","logLoss")),ns(o.shape,i.shape,"Error in logLoss: ");const l=tt(1),u=tt(s),d=Qt(j(o,js(ke(i,u)))),f=j(ze(l,o),js(ke(ze(l,i),u))),p=ze(d,f);return Ii(p,a,r)}const MK=Z({logLoss_:FK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PK(n,e,t,s=Ts.SUM_BY_NONZERO_WEIGHTS){const r=U(n,"labels","meanSquaredError"),o=U(e,"predictions","meanSquaredError");let i=null;t!=null&&(i=U(t,"weights","meanSquaredError")),ns(r.shape,o.shape,"Error in meanSquaredError: ");const a=I1(r,o);return Ii(a,i,s)}const LK=Z({meanSquaredError_:PK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OK(n,e){const t=U(n,"labels","sigmoidCrossEntropyWithLogits"),s=U(e,"logits","sigmoidCrossEntropyWithLogits");ns(t.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=fo(s),o=j(s,t),i=Lh(Es(Qt(In(s))));return ke(ze(r,o),i)}function VK(n,e,t,s=0,r=Ts.SUM_BY_NONZERO_WEIGHTS){let o=U(n,"multiClassLabels","sigmoidCrossEntropy");const i=U(e,"logits","sigmoidCrossEntropy");let a=null;if(t!=null&&(a=U(t,"weights","sigmoidCrossEntropy")),ns(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const u=tt(s),d=tt(1),f=tt(.5);o=ke(j(o,ze(d,u)),j(f,u))}const l=OK(o,i);return Ii(l,a,r)}const BK=Z({sigmoidCrossEntropy_:VK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zK(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Po((r,o,i)=>{const l=d1(o,[t],!0),u=ze(Me(o,"float32"),l);i([r,u]);const d=Qt(j(u,r));return{value:Ge(d,[t]),gradFunc:(y,v)=>{const[w,C]=v,S=wn(y.shape,[t]);return[j(se(y,S),ze(Me(w,"float32"),Es(C))),j(se(y,S),ze(Es(C),Me(w,"float32")))]}}})(n,e)}function UK(n,e,t,s=0,r=Ts.SUM_BY_NONZERO_WEIGHTS){let o=U(n,"onehotLabels","softmaxCrossEntropy");const i=U(e,"logits","softmaxCrossEntropy");let a=null;if(t!=null&&(a=U(t,"weights","softmaxCrossEntropy")),ns(o.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const u=tt(s),d=tt(1),f=tt(o.shape[1]);o=ke(j(o,ze(d,u)),Be(u,f))}const l=zK(o,i);return Ii(l,a,r)}const WK=Z({softmaxCrossEntropy_:UK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GK(n,e,t,s){const r=U(n,"indices","sparseFillEmptyRows","int32"),o=U(e,"values","sparseFillEmptyRows"),i=U(t,"denseShape","sparseFillEmptyRows","int32"),a=U(s,"defaultValue","sparseFillEmptyRows",o.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const l={indices:r,values:o,denseShape:i,defaultValue:a},u=Q.runKernel(Py,l);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const HK=Z({sparseFillEmptyRows_:GK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qK(n,e,t){const s=U(n,"inputIndices","sparseReshape","int32"),r=U(e,"inputShape","sparseReshape","int32"),o=U(t,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const i={inputIndices:s,inputShape:r,newShape:o},a=Q.runKernel(Ly,i);return{outputIndices:a[0],outputShape:a[1]}}const KK=Z({sparseReshape_:qK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XK(n,e,t){const s=U(n,"data","sparseSegmentMean"),r=U(e,"indices","sparseSegmentMean","int32"),o=U(t,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const i={data:s,indices:r,segmentIds:o};return Q.runKernel(Oy,i)}const JK=Z({sparseSegmentMean_:XK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YK(n,e,t){const s=U(n,"data","sparseSegmentSum"),r=U(e,"indices","sparseSegmentSum","int32"),o=U(t,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const i={data:s,indices:r,segmentIds:o};return Q.runKernel(Vy,i)}const QK=Z({sparseSegmentSum_:YK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZK(n,e,t,s,r,o,i,a){const l=U(n,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const u=U(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const d={separator:t,nGramWidths:s,leftPad:r,rightPad:o,padWidth:i,preserveShortSequences:a},f={data:l,dataSplits:u},p=Q.runKernel(Wy,f,d);return{nGrams:p[0],nGramsSplits:p[1]}}const jK=Z({stringNGrams_:ZK});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(n,e,t=!0){const s=U(n,"input","stringSplit","string"),r=U(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const o={skipEmpty:t},i={input:s,delimiter:r},a=Q.runKernel(Gy,i,o);return{indices:a[0],values:a[1],shape:a[2]}}const tX=Z({stringSplit_:eX});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nX(n,e){const t=U(n,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:t};return Q.runKernel(Hy,r,s)}const sX=Z({stringToHashBucketFast_:nX});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P$={fft:qh,ifft:Lu,rfft:Kh,irfft:b1},L$={hammingWindow:Mq,hannWindow:R$,frame:D$,stft:Vq},no={flipLeftRight:Wq,grayscaleToRGB:Hq,resizeNearestNeighbor:M$,resizeBilinear:F$,rotateWithOffset:Kq,cropAndResize:zq,nonMaxSuppression:Jq,nonMaxSuppressionAsync:sK,nonMaxSuppressionWithScore:oK,nonMaxSuppressionWithScoreAsync:aK,nonMaxSuppressionPadded:uK,nonMaxSuppressionPaddedAsync:dK,threshold:gK,transform:xK},mC={bandPart:wK,gramSchmidt:TK,qr:bK},O$={absoluteDifference:NK,computeWeightedLoss:Ii,cosineDistance:$K,hingeLoss:_K,huberLoss:DK,logLoss:MK,meanSquaredError:LK,sigmoidCrossEntropy:BK,softmaxCrossEntropy:WK},V$={sparseFillEmptyRows:HK,sparseReshape:KK,sparseSegmentMean:JK,sparseSegmentSum:QK},B$={stringNGrams:jK,stringSplit:tX,stringToHashBucketFast:sX};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ki extends El{minimize(e,t=!1,s){const{value:r,grads:o}=this.computeGradients(e,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return lt(o),t?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,t){return Q3(e,t)}dispose(){this.iterations_!=null&&lt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:tt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(ki,Symbol.hasInstance,{value:n=>n.minimize!=null&&n.computeGradients!=null&&n.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L1 extends ki{constructor(e,t,s=null){super(),this.learningRate=e,this.rho=t,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Q.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:he(()=>bt(o).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:he(()=>bt(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,u=this.accumulatedUpdates[r].variable;he(()=>{const d=ke(j(l,this.rho),j(Ut(a),1-this.rho)),f=j(Be(ts(ke(u,this.epsilon)),ts(ke(l,this.epsilon))),a),p=ke(j(u,this.rho),j(Ut(f),1-this.rho));l.assign(d),u.assign(p);const y=ke(j(f,-this.learningRate),o);o.assign(y)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(lt(this.accumulatedGrads.map(e=>e.variable)),lt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}L1.className="Adadelta";Ne(L1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class O1 extends ki{constructor(e,t=.1){super(),this.learningRate=e,this.initialAccumulatorValue=t,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Q.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:he(()=>$l(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=this.accumulatedGrads[r].variable;he(()=>{const l=ke(a,Ut(i));a.assign(l);const u=ke(j(Be(i,ts(ke(l,Q.backend.epsilon()))),-this.learningRate),o);o.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&lt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}O1.className="Adagrad";Ne(O1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V1 extends ki{constructor(e,t,s,r=null){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],he(()=>{this.accBeta1=tt(t).variable(),this.accBeta2=tt(s).variable()}),r==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);he(()=>{const s=ze(1,this.accBeta1),r=ze(1,this.accBeta2);t.forEach((o,i)=>{const a=Q.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:he(()=>bt(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:he(()=>bt(a).variable(l))});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const d=this.accumulatedFirstMoment[i].variable,f=this.accumulatedSecondMoment[i].variable,p=ke(j(d,this.beta1),j(u,1-this.beta1)),y=ke(j(f,this.beta2),j(Ut(u),1-this.beta2)),v=Be(p,s),w=Be(y,r);d.assign(p),f.assign(y);const C=ke(j(Be(v,ke(ts(w),this.epsilon)),-this.learningRate),a);a.assign(C)}),this.accBeta1.assign(j(this.accBeta1,this.beta1)),this.accBeta2.assign(j(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&lt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&lt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e),he(()=>{this.accBeta1.assign(mi(this.beta1,this.iterations_+1)),this.accBeta2.assign(mi(this.beta2,this.iterations_+1))});const t=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}V1.className="Adam";Ne(V1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B1 extends ki{constructor(e,t,s,r=null,o=0){super(),this.learningRate=e,this.beta1=t,this.beta2=s,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],he(()=>{this.iteration=tt(0).variable(),this.accBeta1=tt(t).variable()}),r==null&&(this.epsilon=Q.backend.epsilon())}applyGradients(e){const t=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);he(()=>{const s=ze(1,this.accBeta1),r=Be(-this.learningRate,ke(j(this.iteration,this.decay),1));t.forEach((o,i)=>{const a=Q.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:bt(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:bt(a).variable(l)});const u=Array.isArray(e)?e[i].tensor:e[o];if(u==null)return;const d=this.accumulatedFirstMoment[i].variable,f=this.accumulatedWeightedInfNorm[i].variable,p=ke(j(d,this.beta1),j(u,1-this.beta1)),y=j(f,this.beta2),v=In(u),w=Vo(y,v);d.assign(p),f.assign(w);const C=ke(j(Be(r,s),Be(p,ke(w,this.epsilon))),a);a.assign(C)}),this.iteration.assign(ke(this.iteration,1)),this.accBeta1.assign(j(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&lt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&lt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}B1.className="Adamax";Ne(B1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xh extends ki{constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const i=Q.registeredVariables[s];he(()=>{const a=ke(j(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=Un(tt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,t){return new e(t.learningRate)}}Xh.className="SGD";Ne(Xh);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z1 extends Xh{constructor(e,t,s=!1){super(e),this.learningRate=e,this.momentum=t,this.useNesterov=s,this.accumulations=[],this.m=tt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Q.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:he(()=>bt(o).variable(!1))});const i=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&he(()=>{let l;const u=ke(j(this.m,i),a);this.useNesterov?l=ke(j(this.c,ke(a,j(u,this.m))),o):l=ke(j(this.c,u),o),i.assign(u),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&lt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(t)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}z1.className="Momentum";Ne(z1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U1 extends ki{constructor(e,t=.9,s=0,r=null,o=!1){if(super(),this.learningRate=e,this.decay=t,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,r==null&&(this.epsilon=Q.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Q.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:he(()=>bt(o).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:he(()=>bt(o).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:he(()=>bt(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,u=this.accumulatedMoments[r].variable;he(()=>{const d=ke(j(l,this.decay),j(Ut(a),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[r].variable,p=ke(j(f,this.decay),j(a,1-this.decay)),y=Be(j(a,this.learningRate),ts(ze(d,ke(Ut(p),this.epsilon)))),v=ke(j(u,this.momentum),y);l.assign(d),f.assign(p),u.assign(v);const w=ze(o,v);o.assign(w)}else{const f=ke(j(l,this.decay),j(Ut(a),1-this.decay)),p=ke(j(u,this.momentum),Be(j(a,this.learningRate),ts(ke(f,this.epsilon))));l.assign(f),u.assign(p);const y=ze(o,p);o.assign(y)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&lt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&lt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&lt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(t=>({name:t.originalName,tensor:t.variable})))}async setWeights(e){e=await this.extractIterations(e);const t=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,t).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(t,t*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(t*2,t*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}U1.className="RMSProp";Ne(U1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ji{static sgd(e){return new Xh(e)}static momentum(e,t,s=!1){return new z1(e,t,s)}static rmsprop(e,t=.9,s=0,r=null,o=!1){return new U1(e,t,s,r,o)}static adam(e=.001,t=.9,s=.999,r=null){return new V1(e,t,s,r)}static adadelta(e=.001,t=.95,s=null){return new L1(e,t,s)}static adamax(e=.002,t=.9,s=.999,r=null,o=0){return new B1(e,t,s,r,o)}static adagrad(e,t=.1){return new O1(e,t)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ya={sgd:ji.sgd,momentum:ji.momentum,adadelta:ji.adadelta,adagrad:ji.adagrad,rmsprop:ji.rmsprop,adamax:ji.adamax,adam:ji.adam};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rX=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n();function gC(){return new Promise(n=>rX(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yC(n,e){const t=n[0].length;n.forEach((r,o)=>{B(r.length===t,()=>`Error in concat${t}D: rank of tensors[${o}] must be the same as the rank of the rest (${t})`)}),B(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const s=n[0];n.forEach((r,o)=>{for(let i=0;i<t;i++)B(i===e||r[i]===s[i],()=>`Error in concat${t}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function Do(n,e){const t=n[0].slice();for(let s=1;s<n.length;s++)t[e]+=n[s][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var eo;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(eo||(eo={}));function z$(n,e,t){let s=new Array;if(t==null&&e==null)return s;if(e==null)for(;s.length<n+t.length;)s.push(-1);else s=e.slice();if(t==null)return s;if(n+t.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${s.length}`);for(let r=1;r<t.length;++r){const o=t[r],i=s[s.length-t.length+r],a=s[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+n}] = ${o} but shape[${r+n}] = ${a}`)}else s[i]=o}return s}function U$(n){const e={FIRST_DIM_SIZE:eo.FIRST_DIM_SIZE,VALUE_ROWIDS:eo.VALUE_ROWIDS,ROW_LENGTHS:eo.ROW_LENGTHS,ROW_SPLITS:eo.ROW_SPLITS,ROW_LIMITS:eo.ROW_LIMITS,ROW_STARTS:eo.ROW_STARTS},t=[];for(const s of n)if(s in e)t.push(e[s]);else break;return t}function W$(n){return n.length===0?0:n[0]===eo.FIRST_DIM_SIZE?n.length-1:n.length}function G$(n,e){if(n==null||e==null)return;const t=n.length,s=e.length;if(t>=s)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(t,s-1);++r){const o=n[r],i=e[r+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-n.length}] = ${o} but ragged tensor input.flatValues.shape[${r-n.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xC=30;function W1(n){return n<=xC?n:dg(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vC(n,e,t){const s=t*(typeof n=="number"?n:n[0]),r=e*(typeof n=="number"?n:n[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jh(n,e,t,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(n[0]/t),r=r.concat(n.slice(1));else{r=r.concat(n[0]);const o=e.length;for(let i=0;i<o;++i)r=r.concat([n[i+1]/e[i],e[i]]);r=r.concat(n.slice(o+1))}return r}function Yh(n,e,t=!0){const s=[];if(t){s.push(e);for(let r=e+1;r<n;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],o=[];for(let i=1;i<n;++i)i>=e*2+1||i%2===1?o.push(i):r.push(i);s.push(...r),s.push(0),s.push(...o)}return s}function Qh(n,e,t,s=!0){const r=[];s?r.push(n[0]/t):r.push(n[0]*t);for(let o=1;o<n.length;++o)o<=e.length?s?r.push(e[o-1]*n[o]):r.push(n[o]/e[o-1]):r.push(n[o]);return r}function wC(n,e){const t=[0];for(let s=0;s<e;++s)t.push(n[s][0]);return t}function CC(n,e,t){const s=n.slice(0,1);for(let r=0;r<t;++r)s.push(n[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G1=1.7580993408473768,H1=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TC=.3275911,SC=.254829592,bC=-.284496736,IC=1.421413741,kC=-1.453152027,NC=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gi(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let s=0;s<t.length;s+=2)t[s]=n[s/2],t[s+1]=e[s/2];return t}function H$(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let s=0;s<n.length;s+=2)e[s/2]=n[s],t[s/2]=n[s+1];return{real:e,imag:t}}function q$(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function K$(n){const e=Math.floor(n.length/4),t=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<n.length;r+=4)t[Math.floor(r/4)]=n[r],s[Math.floor(r/4)]=n[r+1];return{real:t,imag:s}}function EC(n,e){const t=n[e*2],s=n[e*2+1];return{real:t,imag:s}}function X$(n,e,t,s){n[s*2]=e,n[s*2+1]=t}function J$(n,e){const t=new Float32Array(n/2),s=new Float32Array(n/2);for(let r=0;r<Math.ceil(n/2);r++){const o=(e?2:-2)*Math.PI*(r/n);t[r]=Math.cos(o),s[r]=Math.sin(o)}return{real:t,imag:s}}function Y$(n,e,t){const s=(t?2:-2)*Math.PI*(n/e),r=Math.cos(s),o=Math.sin(s);return{real:r,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qx="->",oX=/->/g,Lk=",",Ok="...";function $C(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(oX,"").length)/Qx.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${Qx}").`);const[s,r]=n.split(Qx);B(s.indexOf(Ok)===-1,()=>`The ellipsis notation ("${Ok}") is not supported yet.`);const o=s.split(Lk),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let p=0;p<r.length;++p){const y=r[p];if(!o.some(v=>v.indexOf(y)!==-1))throw new Error(`Output subscripts contain the label ${y} not present in the input subscripts.`);a.indexOf(y)===-1&&a.push(y)}for(let p=0;p<s.length;++p){const y=s[p];a.indexOf(y)===-1&&y!==Lk&&a.push(y)}const l=new Array(o.length);for(let p=0;p<i;++p){if(new Set(o[p].split("")).size!==o[p].length)throw new Error(`Found duplicate axes in input component ${o[p]}. Support for duplicate axes in input is not implemented yet.`);l[p]=[];for(let y=0;y<o[p].length;++y)l[p].push(a.indexOf(o[p][y]))}const u=a.length,d=r.length,f=[];for(let p=d;p<u;++p)f.push(p);return{allDims:a,summedDims:f,idDims:l}}function AC(n,e){let t=new Array(n);t.fill(-1);for(let r=0;r<e.length;++r)t[e[r]]=r;const s=[];for(let r=0;r<n;++r)t[r]===-1&&s.push(r);return t=t.filter(r=>r!==-1),{permutationIndices:t,expandDims:s}}function _C(n,e,t){const s=new Array(n);for(let r=0;r<t.length;++r){const o=t[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=o[i]:B(s[e[r][i]]===o[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function RC(n,e){const t=n,s=[];let r=0;n.length===0&&t.push(-1),r=n.length+1;for(let i=0;i<r;++i)s.push([]);const o=[];for(let i=0;i<t.length;++i){const a=t[i],l=iX(e,a);for(const u of l)o.indexOf(u)===-1&&(s[i].push(u),o.push(u))}return{path:t,steps:s}}function DC(n){return n.every((e,t)=>e===t)}function iX(n,e){const t=[];for(let s=0;s<n.length;++s)(n[s].length===0||n[s].indexOf(e)!==-1||e===-1)&&t.push(s);return t}function FC(n,e,t=0){let s=[];if(typeof e=="number")B(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(n.shape[t]/e);else{const r=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);B(r<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=n.shape[t]-i}B(n.shape[t]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function Z$(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function j$(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eA(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function tA(n,e){return`size ${n} must be non-negative, not ${e}`}function nA(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function sA(n,e){const t=we(n),s=we(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${n} outputShape= ${e}`}function rA(n,e){const t=we(n),s=we(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${s}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qv(){return"segment ids must be >= 0"}function oA(){return"segment ids are not increasing"}function iA(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function aA(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lA(n,e){let t=!1,s;for(n<=xC?(s=n,t=!0):s=dg(n,Math.floor(Math.sqrt(n)));!t;)s>e||s===n?t=!0:s=dg(n,s+1);return s}function uA(n,e,t){const s=[],r=n.length;for(let o=0;o<r;o++)o!==e?s.push(n[o]):s.push(t);return s}function MC(n,e,t,s){const r=e.shape.length,o=n.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(t<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${t}).`);for(let f=0;f<s;++f)if(n.shape[f]!==e.shape[f])throw new Error(`x.shape[${f}]: ${n.shape[f]} should be equal to indices.shape[${f}]: ${e.shape[f]}.`);const i=n.shape[t],a=[];let l=1,u=1,d=1;for(let f=0;f<s;++f)a.push(n.shape[f]),l*=n.shape[f];for(let f=s;f<t;f++)a.push(n.shape[f]),u*=n.shape[f];for(let f=s;f<r;f++)a.push(e.shape[f]);for(let f=t+1;f<o;f++)a.push(n.shape[f]),d*=n.shape[f];return{batchSize:l,sliceSize:d,outerSize:u,dimSize:i,outputShape:a}}const aX=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:MC,computeOutShape:uA,segOpComputeOptimalWindowSize:lA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xl(n){try{return n.map(e=>fi(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function cA(n){return n.map(e=>_o(e))}const dA=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:SC,ERF_A2:bC,ERF_A3:IC,ERF_A4:kC,ERF_A5:NC,ERF_P:TC,PARALLELIZE_THRESHOLD:xC,get RowPartitionType(){return eo},SELU_SCALE:H1,SELU_SCALEALPHA:G1,applyActivation:R1,assertAndGetBroadcastShape:dt,assertAxesAreInnerMostDims:rs,assertParamsConsistent:yC,assignToTypedArray:X$,axesAreInnerMostDims:Uw,calculateShapes:Hc,checkEinsumDimSizes:_C,checkPadOnDimRoundingMode:As,combineLocations:X3,combineRaggedTensorToTensorShapes:z$,complexWithEvenIndex:q$,complexWithOddIndex:K$,computeConv2DInfo:Gn,computeConv3DInfo:ya,computeDefaultPad:Sw,computeDilation2DInfo:Rh,computeOptimalWindowSize:W1,computeOutAndReduceShapes:Hn,computeOutShape:Do,computePool2DInfo:Ur,computePool3DInfo:Ti,convertConv2DDataFormat:Si,decodeEinsumEquation:$C,eitherStridesOrDilationsAreOne:ss,expandShapeToKeepDim:wn,exponent:Y$,exponents:J$,fromStringArrayToUint8:cA,fromUint8ToStringArray:xl,getAxesPermutation:hn,getBroadcastDims:pl,getComplexWithIndex:EC,getEinsumComputePath:RC,getEinsumPermutation:AC,getFusedBiasGradient:_1,getFusedDyActivation:A1,getImageCenter:vC,getInnerMostAxes:Cn,getPermuted:Yh,getRaggedRank:W$,getReductionAxes:En,getReshaped:Jh,getReshapedPermuted:Qh,getRowPartitionTypesHelper:U$,getSliceBeginCoords:wC,getSliceSize:CC,getSparseFillEmptyRowsIndicesDenseShapeMismatch:Q$,getSparseFillEmptyRowsNegativeIndexErrorMessage:Z$,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:j$,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:nA,getSparseReshapeInputOutputMismatchErrorMessage:rA,getSparseReshapeInputOutputMultipleErrorMessage:sA,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:eA,getSparseReshapeNegativeOutputDimErrorMessage:tA,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:aA,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:Qv,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:oA,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:iA,getUndoAxesPermutation:xa,isIdentityPermutation:DC,log:v8,mergeRealAndImagArrays:gi,prepareAndValidate:jy,prepareSplitSize:FC,segment_util:aX,shouldFuse:D1,slice_util:O3,splitRealAndImagArrays:H$,tupleValuesAreOne:la,upcastType:Os,validateDefaultValueShape:G$,validateInput:aw,validateUpdateShape:iw,warn:fr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:F1,nonMaxSuppressionV4Impl:M1,nonMaxSuppressionV5Impl:P1,whereImpl:E1},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uX=Object.freeze(Object.defineProperty({__proto__:null,Abs:Ef,Acos:Yu,Acosh:Qu,AdadeltaOptimizer:L1,AdagradOptimizer:O1,AdamOptimizer:V1,AdamaxOptimizer:B1,Add:Nl,AddN:$f,All:Xg,Any:Jg,ArgMax:Af,ArgMin:_f,Asin:Zu,Asinh:ju,Atan:ec,Atan2:nc,Atanh:tc,AvgPool:Rf,AvgPool3D:Df,AvgPool3DGrad:Qg,AvgPoolGrad:Yg,BatchMatMul:Ff,BatchToSpaceND:Mf,Bincount:Zg,BroadcastArgs:jg,BroadcastTo:jE,Cast:sc,Ceil:rc,ClipByValue:oc,Complex:ey,ComplexAbs:Pf,Concat:Lf,Conv2D:Of,Conv2DBackpropFilter:ty,Conv2DBackpropInput:Vf,Conv3D:Bf,Conv3DBackpropFilterV2:ny,Conv3DBackpropInputV2:sy,Cos:ic,Cosh:ac,CropAndResize:oy,Cumprod:ry,Cumsum:zf,DataStorage:M2,DenseBincount:iy,DepthToSpace:ay,DepthwiseConv2dNative:Uf,DepthwiseConv2dNativeBackpropFilter:ly,DepthwiseConv2dNativeBackpropInput:uy,Diag:cy,Dilation2D:Wf,Dilation2DBackpropFilter:hg,Dilation2DBackpropInput:fg,get ENV(){return z2},Einsum:dy,Elu:uc,EluGrad:fy,Environment:QE,Equal:Gf,Erf:cc,Exp:dc,ExpandDims:Hf,Expm1:fc,FFT:hy,Fill:py,FlipLeftRight:my,Floor:hc,FloorDiv:pc,FromPixels:pg,FusedBatchNorm:qf,FusedConv2D:uf,FusedDepthwiseConv2D:cf,GatherNd:gy,GatherV2:Kf,Greater:Xf,GreaterEqual:mc,IFFT:yy,Identity:gc,Imag:xy,IsFinite:yc,IsInf:xc,IsNan:vc,KernelBackend:Hg,LRN:th,LRNGrad:wy,LeakyRelu:Jf,Less:Yf,LessEqual:Qf,LinSpace:vy,Log:wc,Log1p:Cc,LogSoftmax:e3,LogicalAnd:Zf,LogicalNot:jf,LogicalOr:eh,LogicalXor:m8,LowerBound:g8,Max:nh,MaxPool:sh,MaxPool3D:rh,MaxPool3DGrad:Ty,MaxPoolGrad:Cy,MaxPoolWithArgmax:Sy,Maximum:Tc,Mean:oh,Min:ih,Minimum:Sc,MirrorPad:ah,Mod:bc,MomentumOptimizer:z1,Multinomial:by,Multiply:Ic,Neg:lh,NonMaxSuppressionV3:Iy,NonMaxSuppressionV4:ky,NonMaxSuppressionV5:Ny,NotEqual:uh,OP_SCOPE_SUFFIX:K2,OneHot:dh,OnesLike:ch,Optimizer:ki,OptimizerConstructors:ji,Pack:fh,PadV2:hh,Pool:y8,Pow:kc,Prelu:ph,Prod:mh,RMSPropOptimizer:U1,RaggedGather:Ey,RaggedTensorToTensor:$y,Range:Ay,get Rank(){return Fv},Real:_y,RealDiv:lc,Reciprocal:Nc,get Reduction(){return Ts},Relu:Ec,Relu6:$c,Reshape:gh,ResizeBilinear:xh,ResizeBilinearGrad:Dy,ResizeNearestNeighbor:yh,ResizeNearestNeighborGrad:Ry,Reverse:vh,RotateWithOffset:Jy,Round:Ac,Rsqrt:_c,SGDOptimizer:Xh,ScatterNd:Fy,SearchSorted:My,Select:wh,Selu:Rc,Sigmoid:Pc,Sign:Mc,Sin:Dc,Sinh:Fc,Slice:Ch,Softmax:Ih,Softplus:Lc,SpaceToBatchND:Sh,SparseFillEmptyRows:Py,SparseReshape:Ly,SparseSegmentMean:Oy,SparseSegmentSum:Vy,SparseToDense:By,SplitV:bh,Sqrt:Oc,Square:zy,SquaredDifference:Vc,Step:Gc,StridedSlice:Uy,StringNGrams:Wy,StringSplit:Gy,StringToHashBucketFast:Hy,Sub:Bc,Sum:Th,Tan:zc,Tanh:Uc,Tensor:St,TensorBuffer:Mn,Tile:Wc,TopK:qy,Transform:Ky,Transpose:sl,Unique:Xy,Unpack:kh,UnsortedSegmentSum:Nh,UpperBound:x8,Variable:ff,ZerosLike:Eh,_FusedMatMul:lf,abs:In,acos:mw,acosh:gw,add:ke,addN:z3,all:n1,any:pf,argMax:ml,argMin:yw,asin:xw,asinh:vw,atan:ww,atan2:Cw,atanh:Tw,avgPool:Dh,avgPool3d:bw,backend:E3,backend_util:dA,basicLSTMCell:U3,batchNorm:qc,batchNorm2d:Iw,batchNorm3d:kw,batchNorm4d:Nw,batchToSpaceND:Fh,bincount:Ew,booleanMaskAsync:T$,broadcastArgs:W3,broadcastTo:ol,broadcast_util:dW,browser:yW,buffer:ht,cast:Me,ceil:$w,clipByValue:ks,clone:Ro,complex:hi,concat:dn,concat1d:Aw,concat2d:_w,concat3d:Rw,concat4d:Dw,conv1d:s1,conv2d:pi,conv2dTranspose:r1,conv3d:Mw,conv3dTranspose:Pw,copyRegisteredKernels:T8,cos:Mh,cosh:o1,cosineWindow:$1,cumprod:mf,cumsum:i1,customGrad:Po,denseBincount:H3,deprecationWarn:J7,depthToSpace:Lw,depthwiseConv2d:Kc,device_util:J8,diag:q3,dilation2d:Ow,disableDeprecationWarnings:X7,dispose:lt,disposeVariables:Y7,div:Be,divNoNan:Vw,dot:Bw,dropout:dC,einsum:K3,elu:Xc,enableDebugMode:K7,enableProdMode:q7,enclosingPowerOfTwo:fC,engine:ti,env:me,equal:Br,erf:zw,euclideanNorm:Ww,exp:Es,expandDims:Zn,expm1:Gw,eye:a1,fft:qh,fill:$l,findBackend:tW,findBackendFactory:nW,floor:Yc,floorDiv:t1,fused:_$,gather:Qc,gatherND:k$,gather_util:xW,getBackend:j7,getGradient:Rv,getKernel:mg,getKernelsForBackend:gg,grad:TG,grads:SG,greater:sr,greaterEqual:va,ifft:Lu,imag:_h,image:no,inTopKAsync:N$,io:tw,irfft:b1,isFinite:Hw,isInf:qw,isNaN:Kw,keep:Un,kernel_impls:lX,leakyRelu:Ph,less:l1,lessEqual:wa,linalg:mC,linspace:Y3,localResponseNormalization:Xw,log:js,log1p:Lh,logSigmoid:Jw,logSoftmax:c1,logSumExp:d1,logicalAnd:ao,logicalNot:Oh,logicalOr:f1,logicalXor:Yw,losses:O$,lowerBound:Z3,matMul:mt,math:cW,max:Vr,maxPool:Vh,maxPool3d:Qw,maxPoolWithArgmax:j3,maximum:Vo,mean:un,memory:qv,meshgrid:e$,min:gf,minimum:Zc,mirrorPad:Zw,mod:jw,moments:Bh,movingAverage:S$,mul:j,multiRNNCell:t$,multinomial:n$,neg:Qt,nextFrame:gC,norm:Jc,notEqual:yl,oneHot:Du,ones:Qs,onesLike:er,op:Z,outerProduct:s$,pad:bi,pad1d:r$,pad2d:o$,pad3d:i$,pad4d:a$,pool:eC,pow:mi,prelu:Uh,print:Z2,prod:tC,profile:Q7,raggedGather:l$,raggedTensorToTensor:u$,rand:c$,randomGamma:d$,randomNormal:m1,randomStandardNormal:f$,randomUniform:jc,range:Mu,ready:N3,real:Fu,reciprocal:sC,registerBackend:nw,registerGradient:t3,registerKernel:Yy,relu:fo,relu6:g1,removeBackend:eW,reshape:se,reverse:yr,reverse1d:h$,reverse2d:p$,reverse3d:m$,reverse4d:g$,rfft:Kh,round:y1,rsqrt:x1,scalar:tt,scatterND:b$,scatter_util:vW,searchSorted:h1,selu:v1,separableConv2d:w1,serialization:bW,setBackend:k3,setPlatform:sW,setdiff1dAsync:y$,sigmoid:Or,sign:rC,signal:L$,sin:C1,sinh:T1,slice:it,slice1d:Wh,slice2d:S1,slice3d:Gh,slice4d:Pu,slice_util:O3,softmax:Hh,softplus:Al,spaceToBatchND:zh,sparse:V$,sparseToDense:I$,spectral:P$,split:Ls,sqrt:ts,square:Ut,squaredDifference:I1,squeeze:an,stack:xr,step:_l,stridedSlice:oC,string:B$,sub:ze,sum:Ge,sumOutType:Qy,tan:iC,tanh:gl,tensor:ro,tensor1d:Nn,tensor2d:ui,tensor3d:sw,tensor4d:x$,tensor5d:v$,tensor6d:w$,tensor_util:G8,test_util:FW,tidy:he,tile:pr,time:Z7,topk:aC,train:Ya,transpose:xt,truncatedNormal:k1,unique:lC,unregisterGradient:C8,unregisterKernel:w8,unsortedSegmentSum:N1,unstack:zr,upcastType:Os,upperBound:C$,util:_8,valueAndGrad:bG,valueAndGrads:IG,variable:uC,variableGrads:Q3,version_core:MW,where:Ns,whereAsync:cC,zeros:kn,zerosLike:bt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cX=me();cX.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var _r;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(_r||(_r={}));var Vk;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(Vk||(Vk={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PC={};function dX(n,e){const t={tfOpName:n,category:"custom",inputs:[],attrs:[],customExecutor:e};PC[n]=t}function fA(n){return PC[n]}function fX(n){delete PC[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _(n,e,t,s,r){const o=e.inputParams[n];if(o&&o.inputIndexStart!==void 0){const a=o.inputIndexStart,l=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?a+1:o.inputIndexEnd;if(o.type==="tensor")return Ss(e.inputNames[o.inputIndexStart],t,s,r);if(o.type==="tensors")return e.inputNames.slice(a,l).map(p=>Ss(p,t,s,r));const u=Ss(e.inputNames.slice(a)[0],t,s,r),d=u.dataSync();return o.type==="number"?d[0]:gr(u.shape,d)}const i=e.attrParams[n];return i&&i.value}function Ss(n,e,t,s){const[r,o]=Js(n);if(s!=null){const a=s.getHashTableHandleByName(r);if(a!=null)return a}const i=t.currentContextIds.find(a=>!!e[wg(r,a)]);return i!==void 0?e[wg(r,i)][o]:void 0}function hX(n,e,t){return e[wg(n,t.currentContextId)]}function bo(n,e){const[t,s,r]=Js(n);return[wg(t,e&&e.currentContextId),s,r]}function wg(n,e){return e?`${n}-${e}`:n}function Js(n){const e=n.split(":");if(e.length===1)return[n,0,void 0];const t=e[0],s=e.length===3?e[1]:void 0,r=Number(e[e.length-1]);return[t,r,s]}function sg(n,e,t){let s=_("pad",n,e,t);if(s==="explicit"){s=_("explicitPaddings",n,e,t);const r=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)r[o][0]=s[o*2],r[o][1]=s[o*2+1];return r}return s}function ni(n){return n.kept?n:Ro(n)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],mX=Object.freeze(Object.defineProperty({__proto__:null,json:pX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],yX=Object.freeze(Object.defineProperty({__proto__:null,json:gX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],vX=Object.freeze(Object.defineProperty({__proto__:null,json:xX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],CX=Object.freeze(Object.defineProperty({__proto__:null,json:wX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],SX=Object.freeze(Object.defineProperty({__proto__:null,json:TX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],IX=Object.freeze(Object.defineProperty({__proto__:null,json:bX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],NX=Object.freeze(Object.defineProperty({__proto__:null,json:kX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EX=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],$X=Object.freeze(Object.defineProperty({__proto__:null,json:EX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],_X=Object.freeze(Object.defineProperty({__proto__:null,json:AX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RX=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],DX=Object.freeze(Object.defineProperty({__proto__:null,json:RX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FX=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],MX=Object.freeze(Object.defineProperty({__proto__:null,json:FX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],LX=Object.freeze(Object.defineProperty({__proto__:null,json:PX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],VX=Object.freeze(Object.defineProperty({__proto__:null,json:OX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BX=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],zX=Object.freeze(Object.defineProperty({__proto__:null,json:BX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UX=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],WX=Object.freeze(Object.defineProperty({__proto__:null,json:UX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GX=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],HX=Object.freeze(Object.defineProperty({__proto__:null,json:GX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qX=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],KX=Object.freeze(Object.defineProperty({__proto__:null,json:qX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XX=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],JX=Object.freeze(Object.defineProperty({__proto__:null,json:XX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YX=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],QX=Object.freeze(Object.defineProperty({__proto__:null,json:YX},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bk{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[mX,yX,vX,CX,SX,IX,NX,$X,_X,DX,MX,LX,VX,zX,WX,HX,KX,JX,QX],t=[].concat(...e.map(s=>s.json));this.opMappers=t.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,t={}){const s=e.node,r=[],o=[],i=[],a=s.reduce((w,C)=>(w[C.name]=this.mapNode(C),C.op.startsWith("Placeholder")?r.push(w[C.name]):C.op==="Const"?o.push(w[C.name]):(C.input==null||C.input.length===0)&&i.push(w[C.name]),w),{});let l=[];const u=[];let d={},f={};t!=null&&(d=this.mapSignatureEntries(t.inputs),f=this.mapSignatureEntries(t.outputs));const p=Object.keys(a);p.forEach(w=>{const C=a[w];C.inputNames.forEach((S,b)=>{const[E,,N]=bo(S),A=a[E];if(A.outputs!=null){const R=A.outputs.indexOf(N);if(R!==-1){const L=`${E}:${R}`;C.inputNames[b]=L}}C.inputs.push(A),A.children.push(C)})}),Object.keys(f).length===0?p.forEach(w=>{const C=a[w];C.children.length===0&&u.push(C)}):Object.keys(f).forEach(w=>{const[C]=bo(w),S=a[C];S!=null&&(S.signatureKey=f[w],u.push(S))}),Object.keys(d).length>0?Object.keys(d).forEach(w=>{const[C]=bo(w),S=a[C];S&&(S.signatureKey=d[w],l.push(S))}):l=r;let y={};e.library!=null&&e.library.function!=null&&(y=e.library.function.reduce((w,C)=>(w[C.signature.name]=this.mapFunction(C),w),{}));const v={nodes:a,inputs:l,outputs:u,weights:o,placeholders:r,signature:t,functions:y};return i.length>0&&(v.initNodes=i),v}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,s)=>(t[e[s].name]=s,t),{})}mapNode(e){const t=fA(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(s.inputParams=t.inputs.reduce((r,o)=>(r[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},r),{})),t.attrs!=null&&(s.attrParams=t.attrs.reduce((r,o)=>{const i=o.type;let a;switch(o.type){case"string":a=Zv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=Zv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":a=o2(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=o2(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":a=e2(e.attr,o.tfName,o.defaultValue||0),a===void 0&&o.tfDeprecatedName&&(a=e2(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":a=r2(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=r2(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":a=jv(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=jv(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":a=a2(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=a2(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":a=s2(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=s2(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":a=i2(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=i2(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":a=t2(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=t2(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":a=n2(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=n2(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":a=zk(e.attr,o.tfName,o.defaultValue),a===void 0&&o.tfDeprecatedName&&(a=zk(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return r[o.name]={value:a,type:i},r},{})),s}mapFunction(e){const t=e.nodeDef,s=[],r=[];let o={};t!=null&&(o=t.reduce((f,p)=>(f[p.name]=this.mapNode(p),p.op==="Const"&&r.push(f[p.name]),f),{}));const i=[],a=[];e.signature.inputArg.forEach(f=>{const[p]=bo(f.name),y={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:LC(f.type),type:"dtype"}},children:[]};y.signatureKey=f.name,i.push(y),o[p]=y}),Object.keys(o).forEach(f=>{const p=o[f];p.inputNames.forEach((y,v)=>{const[w,,C]=bo(y),S=o[w];if(S.outputs!=null){const b=S.outputs.indexOf(C);if(b!==-1){const E=`${w}:${b}`;p.inputNames[v]=E}}p.inputs.push(S),S.children.push(p)})});const u=e.ret;e.signature.outputArg.forEach(f=>{const[p,y]=bo(u[f.name]),v=o[p];v!=null&&(v.defaultOutput=y,a.push(v))});const d=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:a,weights:r,placeholders:s,signature:d}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s),t),{}),outputs:e.signature.outputArg.reduce((t,s)=>(t[s.name]=this.mapArgToTensorInfo(s,e.ret),t),{})}}mapArgToTensorInfo(e,t){let s=e.name;return t!=null&&(s=t[s]),{name:s,dtype:e.type}}}function ZX(n){const e=me().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function hA(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):ZX(n);return e?t:t.toLowerCase()}function Zv(n,e,t,s=!1){const r=n[e];return r!=null?hA(r.s,s):t}function jv(n,e,t){const s=n[e];return s?s.b:t}function e2(n,e,t){const s=n[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:t;return typeof r=="number"?r:parseInt(r,10)}function LC(n){switch(typeof n=="string"&&(n=_r[n]),n){case _r.DT_FLOAT:case _r.DT_HALF:return"float32";case _r.DT_INT32:case _r.DT_INT64:case _r.DT_INT8:case _r.DT_UINT8:return"int32";case _r.DT_BOOL:return"bool";case _r.DT_DOUBLE:return"float32";case _r.DT_STRING:return"string";default:return null}}function zk(n,e,t){const s=n[e];return s&&s.func?s.func.name:t}function t2(n,e,t){const s=n[e];return s&&s.type?LC(s.type):t}function n2(n,e,t){const s=n[e];return s&&s.list&&s.list.type?s.list.type.map(r=>LC(r)):t}function pA(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function s2(n,e,t){const s=n[e];return s&&s.shape?pA(s.shape):t}function r2(n,e,t){const s=n[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):t}function o2(n,e,t,s=!1){const r=n[e];return r&&r.list&&r.list.s?r.list.s.map(o=>hA(o,s)):t}function i2(n,e,t){const s=n[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>pA(r)):t}function a2(n,e,t){const s=n[e];return s&&s.list&&s.list.b?s.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jX{constructor(e,t,s){this.node=e,this.tensorMap=t,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,o)=>(r[o]=this.getAttr(o),r),{}))}getInput(e){return Ss(e,this.tensorMap,this.context)}getAttr(e,t){const s=this.node.rawAttrs[e];if(s.tensor!=null)return Ss(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return e2(this.node.rawAttrs,e,t);if(s.s!=null)return Zv(this.node.rawAttrs,e,t);if(s.b!=null)return jv(this.node.rawAttrs,e,t);if(s.shape!=null)return s2(this.node.rawAttrs,e,t);if(s.type!=null)return t2(this.node.rawAttrs,e,t);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return r2(this.node.rawAttrs,e,t);if(s.list.s!=null)return o2(this.node.rawAttrs,e,t);if(s.list.shape!=null)return i2(this.node.rawAttrs,e,t);if(s.list.b!=null)return a2(this.node.rawAttrs,e,t);if(s.list.type!=null)return n2(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ds=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:K2,abs:In,acos:mw,acosh:gw,add:ke,addN:z3,all:n1,any:pf,argMax:ml,argMin:yw,asin:xw,asinh:vw,atan:ww,atan2:Cw,atanh:Tw,avgPool:Dh,avgPool3d:bw,basicLSTMCell:U3,batchNorm:qc,batchNorm2d:Iw,batchNorm3d:kw,batchNorm4d:Nw,batchToSpaceND:Fh,bincount:Ew,booleanMaskAsync:T$,broadcastArgs:W3,broadcastTo:ol,buffer:ht,cast:Me,ceil:$w,clipByValue:ks,clone:Ro,complex:hi,concat:dn,concat1d:Aw,concat2d:_w,concat3d:Rw,concat4d:Dw,conv1d:s1,conv2d:pi,conv2dTranspose:r1,conv3d:Mw,conv3dTranspose:Pw,cos:Mh,cosh:o1,cosineWindow:$1,cumprod:mf,cumsum:i1,denseBincount:H3,depthToSpace:Lw,depthwiseConv2d:Kc,diag:q3,dilation2d:Ow,div:Be,divNoNan:Vw,dot:Bw,dropout:dC,einsum:K3,elu:Xc,enclosingPowerOfTwo:fC,equal:Br,erf:zw,euclideanNorm:Ww,exp:Es,expandDims:Zn,expm1:Gw,eye:a1,fft:qh,fill:$l,floor:Yc,floorDiv:t1,fused:_$,gather:Qc,gatherND:k$,greater:sr,greaterEqual:va,ifft:Lu,imag:_h,image:no,inTopKAsync:N$,irfft:b1,isFinite:Hw,isInf:qw,isNaN:Kw,leakyRelu:Ph,less:l1,lessEqual:wa,linalg:mC,linspace:Y3,localResponseNormalization:Xw,log:js,log1p:Lh,logSigmoid:Jw,logSoftmax:c1,logSumExp:d1,logicalAnd:ao,logicalNot:Oh,logicalOr:f1,logicalXor:Yw,losses:O$,lowerBound:Z3,matMul:mt,max:Vr,maxPool:Vh,maxPool3d:Qw,maxPoolWithArgmax:j3,maximum:Vo,mean:un,meshgrid:e$,min:gf,minimum:Zc,mirrorPad:Zw,mod:jw,moments:Bh,movingAverage:S$,mul:j,multiRNNCell:t$,multinomial:n$,neg:Qt,norm:Jc,notEqual:yl,oneHot:Du,ones:Qs,onesLike:er,op:Z,outerProduct:s$,pad:bi,pad1d:r$,pad2d:o$,pad3d:i$,pad4d:a$,pool:eC,pow:mi,prelu:Uh,print:Z2,prod:tC,raggedGather:l$,raggedTensorToTensor:u$,rand:c$,randomGamma:d$,randomNormal:m1,randomStandardNormal:f$,randomUniform:jc,range:Mu,real:Fu,reciprocal:sC,relu:fo,relu6:g1,reshape:se,reverse:yr,reverse1d:h$,reverse2d:p$,reverse3d:m$,reverse4d:g$,rfft:Kh,round:y1,rsqrt:x1,scalar:tt,scatterND:b$,searchSorted:h1,selu:v1,separableConv2d:w1,setdiff1dAsync:y$,sigmoid:Or,sign:rC,signal:L$,sin:C1,sinh:T1,slice:it,slice1d:Wh,slice2d:S1,slice3d:Gh,slice4d:Pu,softmax:Hh,softplus:Al,spaceToBatchND:zh,sparse:V$,sparseToDense:I$,spectral:P$,split:Ls,sqrt:ts,square:Ut,squaredDifference:I1,squeeze:an,stack:xr,step:_l,stridedSlice:oC,string:B$,sub:ze,sum:Ge,tan:iC,tanh:gl,tensor:ro,tensor1d:Nn,tensor2d:ui,tensor3d:sw,tensor4d:x$,tensor5d:v$,tensor6d:w$,tile:pr,topk:aC,transpose:xt,truncatedNormal:k1,unique:lC,unsortedSegmentSum:N1,unstack:zr,upperBound:C$,variable:uC,where:Ns,whereAsync:cC,zeros:kn,zerosLike:bt},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eJ=(n,e,t,s=ds)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(_("a",n,e,t),_("b",n,e,t))];case"AddN":return[s.addN(_("tensors",n,e,t))];case"FloorMod":case"Mod":return[s.mod(_("a",n,e,t),_("b",n,e,t))];case"Mul":return[s.mul(_("a",n,e,t),_("b",n,e,t))];case"RealDiv":case"Div":return[s.div(_("a",n,e,t),_("b",n,e,t))];case"DivNoNan":return[s.divNoNan(_("a",n,e,t),_("b",n,e,t))];case"FloorDiv":return[s.floorDiv(_("a",n,e,t),_("b",n,e,t))];case"Sub":return[s.sub(_("a",n,e,t),_("b",n,e,t))];case"Minimum":return[s.minimum(_("a",n,e,t),_("b",n,e,t))];case"Maximum":return[s.maximum(_("a",n,e,t),_("b",n,e,t))];case"Pow":return[s.pow(_("a",n,e,t),_("b",n,e,t))];case"SquaredDifference":return[s.squaredDifference(_("a",n,e,t),_("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tJ=(n,e,t,s=ds)=>{switch(n.op){case"Abs":case"ComplexAbs":return[s.abs(_("x",n,e,t))];case"Acos":return[s.acos(_("x",n,e,t))];case"Acosh":return[s.acosh(_("x",n,e,t))];case"Asin":return[s.asin(_("x",n,e,t))];case"Asinh":return[s.asinh(_("x",n,e,t))];case"Atan":return[s.atan(_("x",n,e,t))];case"Atan2":return[s.atan2(_("x",n,e,t),_("y",n,e,t))];case"Atanh":return[s.atanh(_("x",n,e,t))];case"Ceil":return[s.ceil(_("x",n,e,t))];case"Complex":return[s.complex(_("real",n,e,t),_("imag",n,e,t))];case"Cos":return[s.cos(_("x",n,e,t))];case"Cosh":return[s.cosh(_("x",n,e,t))];case"Elu":return[s.elu(_("x",n,e,t))];case"Erf":return[s.erf(_("x",n,e,t))];case"Exp":return[s.exp(_("x",n,e,t))];case"Expm1":return[s.expm1(_("x",n,e,t))];case"Floor":return[s.floor(_("x",n,e,t))];case"Log":return[s.log(_("x",n,e,t))];case"Log1p":return[s.log1p(_("x",n,e,t))];case"Imag":return[s.imag(_("x",n,e,t))];case"Neg":return[s.neg(_("x",n,e,t))];case"Reciprocal":return[s.reciprocal(_("x",n,e,t))];case"Real":return[s.real(_("x",n,e,t))];case"Relu":return[s.relu(_("x",n,e,t))];case"Round":return[s.round(_("x",n,e,t))];case"Selu":return[s.selu(_("x",n,e,t))];case"Sigmoid":return[s.sigmoid(_("x",n,e,t))];case"Sin":return[s.sin(_("x",n,e,t))];case"Sign":return[s.sign(_("x",n,e,t))];case"Sinh":return[s.sinh(_("x",n,e,t))];case"Softplus":return[s.softplus(_("x",n,e,t))];case"Sqrt":return[s.sqrt(_("x",n,e,t))];case"Square":return[s.square(_("x",n,e,t))];case"Tanh":return[s.tanh(_("x",n,e,t))];case"Tan":return[s.tan(_("x",n,e,t))];case"ClipByValue":return[s.clipByValue(_("x",n,e,t),_("clipValueMin",n,e,t),_("clipValueMax",n,e,t))];case"Relu6":return[s.relu6(_("x",n,e,t))];case"Rsqrt":return[s.rsqrt(Ss(n.inputNames[0],e,t))];case"Prod":return[s.prod(_("x",n,e,t),_("axes",n,e,t))];case"LeakyRelu":return[s.leakyRelu(_("x",n,e,t),_("alpha",n,e,t))];case"Prelu":return[s.prelu(_("x",n,e,t),_("alpha",n,e,t))];case"IsNan":return[s.isNaN(Ss(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dr(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){B(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let s=0;s<n.length;s++){const r=n[s],o=e[s];B(r<0||o<0||r===o,()=>t+` Shapes ${n} and ${e} must match`)}}}function Uk(n){return!(typeof n=="number"||n.some(e=>e<0))}function Jd(n,e,t){let s=l2(n,t);const r=!Uk(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(o=>{s=l2(o.shape,s)}),!Uk(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function l2(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let s=0;s<n.length;++s){const r=n[s],o=e[s];if(r>=0&&o>=0&&r!==o)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[s]=r>=0?r:o}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nJ{constructor(e,t,s,r,o,i,a){this.name=e,this.dtype=t,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=tt(0),Un(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),Dr(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=t,Un(t),s.written=!0,this.tensors[e]=s}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((s,r)=>this.write(s,t[r]))}gather(e,t){if(t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return ro([],[0].concat(this.elementShape));const s=this.readMany(e);return Dr(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),xr(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return ro([],[0].concat(this.elementShape));const t=[];for(let r=0;r<this.size();r++)t.push(r);const s=this.readMany(t);return Dr(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),dn(s,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,zr(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let s=0;const r=e.map(l=>(s+=l,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=s===0?0:t.size/s,i=[];he(()=>{t=se(t,[1,s,o]);for(let l=0;l<e.length;++l){const d=[0,l===0?0:r[l-1],0],f=[1,e[l],o];i[l]=se(it(t,d,f),this.elementShape)}return i});const a=[];for(let l=0;l<e.length;l++)a[l]=l;this.writeMany(a,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vl{constructor(e,t,s,r=-1){this.tensors=e,this.elementShape=t,this.elementDtype=s,e!=null&&e.forEach(o=>{if(s!==o.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${o.dtype}`);Dr(t,o.shape,"TensorList shape mismatch: "),Un(o)}),this.idTensor=tt(0),this.maxNumElements=r,Un(this.idTensor)}get id(){return this.idTensor.id}copy(){return new vl([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,s=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);Dr(e,this.elementShape,"TensorList shape mismatch: ");const r=Jd(this.elementShape,this.tensors,e);return he(()=>{const o=this.tensors.map(i=>se(i,r));return xr(o,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=Jd(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,Dr(r.shape,e,"TensorList shape mismatch: "),se(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(Dr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Un(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new vl([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)t.tensors[s]=this.tensors[s];return t}getItem(e,t,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);Dr(this.tensors[e].shape,t,"TensorList shape mismatch: ");const r=Jd(this.elementShape,this.tensors,t);return se(this.tensors[e],r)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);Dr(this.elementShape,t.shape,"TensorList shape mismatch: "),Un(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,s){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);Dr(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=Jd(this.elementShape,this.tensors,s);return e.length===0?ro([],[0].concat(r)):he(()=>{const o=e.map(i=>se(this.tensors[i],r));return xr(o,0)})}concat(e,t){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);Dr(this.elementShape,t,"TensorList shape mismatch: ");const s=Jd(this.elementShape,this.tensors,t);return this.size()===0?ro([],[0].concat(s)):he(()=>{const r=this.tensors.map(o=>se(o,s));return dn(r,0)})}}function sJ(n,e,t){const s=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const r=n.shape.slice(1);Dr(r,e,"TensorList shape mismatch: ");const o=zr(n);return new vl(o,e,s)}function rJ(n,e,t,s){return new vl([],n,e,s)}function oJ(n,e,t,s){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const o=new vl([],t,n.dtype,s),i=zr(n,0);return e.forEach((a,l)=>{o.setItem(a,i[l])}),o}function iJ(n,e,t){let s=0;const r=e.map(d=>(s+=d,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);const o=n.shape.slice(1),i=l2(o,t),a=s===0?0:n.size/s,l=he(()=>{const d=[];n=se(n,[1,s,a]);for(let f=0;f<e.length;++f){const y=[0,f===0?0:r[f-1],0],v=[1,e[f],a];d[f]=se(it(n,y,v),i)}return n.dispose(),d}),u=new vl([],t,n.dtype,e.length);for(let d=0;d<l.length;d++)u.setItem(d,l[d]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const s=_("thenBranch",n,e,t),r=_("elseBranch",n,e,t),o=_("cond",n,e,t),i=_("args",n,e,t);return(await o.data())[0]?t.functionMap[s].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap):t.functionMap[r].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const s=_("body",n,e,t),r=_("cond",n,e,t),o=_("args",n,e,t),i=await t.functionMap[r].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap),a=o.map(d=>d.id);let l=await i[0].data();i.forEach(d=>{!d.kept&&a.indexOf(d.id)===-1&&d.dispose()});let u=o;for(;l[0];){const d=u;u=await t.functionMap[s].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);const f=u.map(y=>y.id);d.forEach(y=>{!y.kept&&a.indexOf(y.id)===-1&&f.indexOf(y.id)===-1&&y.dispose()});const p=await t.functionMap[r].executeFunctionAsync(u,t.tensorArrayMap,t.tensorListMap);l=await p[0].data(),p.forEach(y=>{!y.kept&&a.indexOf(y.id)===-1&&f.indexOf(y.id)===-1&&y.dispose()})}return u}case"LoopCond":{const s=_("pred",n,e,t);return[ni(s)]}case"Switch":{const s=_("pred",n,e,t);let r=_("data",n,e,t);return r.kept||(r=ni(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=n.inputNames.find(r=>Ss(r,e,t)!==void 0);if(s){const r=Ss(s,e,t);return[ni(r)]}return}case"Enter":{const s=_("frameName",n,e,t),r=_("tensor",n,e,t);return t.enterFrame(s),[ni(r)]}case"Exit":{const s=_("tensor",n,e,t);return t.exitFrame(),[ni(s)]}case"NextIteration":{const s=_("tensor",n,e,t);return t.nextIteration(),[ni(s)]}case"TensorArrayV3":{const s=_("size",n,e,t),r=_("dtype",n,e,t),o=_("elementShape",n,e,t),i=_("dynamicSize",n,e,t),a=_("clearAfterRead",n,e,t),l=_("identicalElementShapes",n,e,t),u=_("name",n,e,t),d=new nJ(u,r,s,o,l,i,a);return t.addTensorArray(d),[d.idTensor,tt(1)]}case"TensorArrayWriteV3":{const s=_("tensorArrayId",n,e,t),r=_("index",n,e,t),o=_("tensor",n,e,t),i=t.getTensorArray(s.id);return i.write(r,o),[i.idTensor]}case"TensorArrayReadV3":{const s=_("tensorArrayId",n,e,t),r=_("index",n,e,t);return[t.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=_("tensorArrayId",n,e,t),r=_("indices",n,e,t),o=_("dtype",n,e,t);return[t.getTensorArray(s.id).gather(r,o)]}case"TensorArrayScatterV3":{const s=_("tensorArrayId",n,e,t),r=_("indices",n,e,t),o=_("tensor",n,e,t),i=t.getTensorArray(s.id);return i.scatter(r,o),[i.idTensor]}case"TensorArrayConcatV3":{const s=_("tensorArrayId",n,e,t),r=t.getTensorArray(s.id),o=_("dtype",n,e,t);return[r.concat(o)]}case"TensorArraySplitV3":{const s=_("tensorArrayId",n,e,t),r=_("tensor",n,e,t),o=_("lengths",n,e,t),i=t.getTensorArray(s.id);return i.split(o,r),[i.idTensor]}case"TensorArraySizeV3":{const s=_("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return[tt(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=_("tensorArrayId",n,e,t),r=t.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=_("tensorListId",n,e,t),r=_("index",n,e,t),o=_("tensor",n,e,t),i=t.getTensorList(s.id);return i.setItem(r,o),[i.idTensor]}case"TensorListGetItem":{const s=_("tensorListId",n,e,t),r=_("index",n,e,t),o=_("elementShape",n,e,t),i=_("elementDType",n,e,t);return[t.getTensorList(s.id).getItem(r,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=_("indices",n,e,t),r=_("tensor",n,e,t),o=_("elementShape",n,e,t),i=_("numElements",n,e,t),a=oJ(r,s,o,i);return t.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=_("elementShape",n,e,t),r=_("elementDType",n,e,t);let o;n.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=_(o,n,e,t),a=n.op==="TensorListReserve"?-1:i,l=rJ(s,r,i,a);return t.addTensorList(l),[l.idTensor]}case"TensorListGather":{const s=_("tensorListId",n,e,t),r=_("indices",n,e,t),o=_("elementShape",n,e,t),i=_("elementDType",n,e,t);return[t.getTensorList(s.id).gather(r,i,o)]}case"TensorListStack":{const s=_("tensorListId",n,e,t),r=_("elementShape",n,e,t),o=_("elementDType",n,e,t),i=_("numElements",n,e,t);return[t.getTensorList(s.id).stack(r,o,i)]}case"TensorListFromTensor":{const s=_("tensor",n,e,t),r=_("elementShape",n,e,t),o=_("elementDType",n,e,t),i=sJ(s,r,o);return t.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=_("tensorListId",n,e,t),r=t.getTensorList(s.id),o=_("dtype",n,e,t),i=_("elementShape",n,e,t);return[r.concat(o,i)]}case"TensorListPushBack":{const s=_("tensorListId",n,e,t),r=_("tensor",n,e,t),o=t.getTensorList(s.id);return o.pushBack(r),[o.idTensor]}case"TensorListPopBack":{const s=_("tensorListId",n,e,t),r=_("elementShape",n,e,t),o=_("elementDType",n,e,t);return[t.getTensorList(s.id).popBack(r,o)]}case"TensorListSplit":{const s=_("tensor",n,e,t),r=_("elementShape",n,e,t),o=_("lengths",n,e,t),i=iJ(s,o,r);return t.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=_("tensorListId",n,e,t),r=t.getTensorList(s.id);return[tt(r.size(),"int32")]}case"TensorListResize":{const s=_("tensorListId",n,e,t),r=_("size",n,e,t),i=t.getTensorList(s.id).resize(r);return t.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wk(n,e,t){const[s,r]=_("fusedOps",n,e,t),o=s==="biasadd",i=!o,a=r==="prelu",l=s==="fusedbatchnorm",u=_("numArgs",n,e,t);if(o){if(a&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&o&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const d=_("strides",n,e,t),f=sg(n,e,t),p=_("dataFormat",n,e,t).toUpperCase(),y=_("dilations",n,e,t);let[v,w]=_("args",n,e,t);i&&(w=v,v=void 0);const C=_("leakyreluAlpha",n,e,t);return{stride:d,pad:f,dataFormat:p,dilations:y,biasArg:v,preluArg:w,activationFunc:r,leakyreluAlpha:C}}const lJ=(n,e,t,s=ds)=>{switch(n.op){case"Conv1D":{const r=_("stride",n,e,t),o=_("pad",n,e,t),i=_("dataFormat",n,e,t).toUpperCase(),a=_("dilation",n,e,t);return[s.conv1d(_("x",n,e,t),_("filter",n,e,t),r,o,i,a)]}case"Conv2D":{const r=_("strides",n,e,t),o=sg(n,e,t),i=_("dataFormat",n,e,t).toUpperCase(),a=_("dilations",n,e,t);return[s.conv2d(_("x",n,e,t),_("filter",n,e,t),[r[1],r[2]],o,i,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:r,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:d,leakyreluAlpha:f}=Wk(n,e,t);return[s.fused.conv2d({x:_("x",n,e,t),filter:_("filter",n,e,t),strides:[r[1],r[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:d,preluActivationWeights:u,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:o,dataFormat:i,dilations:a,biasArg:l,preluArg:u,activationFunc:d,leakyreluAlpha:f}=Wk(n,e,t);return[s.fused.depthwiseConv2d({x:_("x",n,e,t),filter:_("filter",n,e,t),strides:[r[1],r[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:l,activation:d,preluActivationWeights:u,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=_("outputShape",n,e,t),o=_("strides",n,e,t),i=sg(n,e,t);return[s.conv2dTranspose(_("x",n,e,t),_("filter",n,e,t),r,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=_("strides",n,e,t),o=sg(n,e,t),i=_("dilations",n,e,t),a=_("dataFormat",n,e,t).toUpperCase();return[s.depthwiseConv2d(_("input",n,e,t),_("filter",n,e,t),[r[1],r[2]],o,a,[i[1],i[2]])]}case"Conv3D":{const r=_("strides",n,e,t),o=_("pad",n,e,t),i=_("dataFormat",n,e,t).toUpperCase(),a=_("dilations",n,e,t);return[s.conv3d(_("x",n,e,t),_("filter",n,e,t),[r[1],r[2],r[3]],o,i,[a[1],a[2],a[3]])]}case"AvgPool":{const r=_("strides",n,e,t),o=_("pad",n,e,t),i=_("kernelSize",n,e,t);return[s.avgPool(_("x",n,e,t),[i[1],i[2]],[r[1],r[2]],o)]}case"MaxPool":{const r=_("strides",n,e,t),o=_("pad",n,e,t),i=_("kernelSize",n,e,t);return[s.maxPool(_("x",n,e,t),[i[1],i[2]],[r[1],r[2]],o)]}case"MaxPoolWithArgmax":{const r=_("strides",n,e,t),o=_("pad",n,e,t),i=_("kernelSize",n,e,t),a=_("includeBatchInIndex",n,e,t),{result:l,indexes:u}=s.maxPoolWithArgmax(_("x",n,e,t),[i[1],i[2]],[r[1],r[2]],o,a);return[l,u]}case"AvgPool3D":{const r=_("strides",n,e,t),o=_("pad",n,e,t),i=_("kernelSize",n,e,t);return[s.avgPool3d(_("x",n,e,t),[i[1],i[2],i[3]],[r[1],r[2],r[3]],o)]}case"MaxPool3D":{const r=_("strides",n,e,t),o=_("pad",n,e,t),i=_("kernelSize",n,e,t);return[s.maxPool3d(_("x",n,e,t),[i[1],i[2],i[3]],[r[1],r[2],r[3]],o)]}case"Dilation2D":{const r=_("strides",n,e,t),o=_("pad",n,e,t),i=_("dilations",n,e,t),a=r[1],l=r[2],u=i[1],d=i[2];return[s.dilation2d(_("x",n,e,t),_("filter",n,e,t),[a,l],o,[u,d],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJ=(n,e,t,s=ds)=>{switch(n.op){case"Fill":{const r=_("shape",n,e,t),o=_("dtype",n,e,t),i=_("value",n,e,t);return[s.fill(r,i,o)]}case"LinSpace":{const r=_("start",n,e,t),o=_("stop",n,e,t),i=_("num",n,e,t);return[s.linspace(r,o,i)]}case"Multinomial":{const r=_("logits",n,e,t),o=_("numSamples",n,e,t),i=_("seed",n,e,t);return[s.multinomial(r,o,i)]}case"OneHot":{const r=_("indices",n,e,t),o=_("depth",n,e,t),i=_("onValue",n,e,t),a=_("offValue",n,e,t),l=_("dtype",n,e,t);return[s.oneHot(r,o,i,a,l)]}case"Ones":return[s.ones(_("shape",n,e,t),_("dtype",n,e,t))];case"OnesLike":return[s.onesLike(_("x",n,e,t))];case"RandomStandardNormal":return[s.randomStandardNormal(_("shape",n,e,t),_("dtype",n,e,t),_("seed",n,e,t))];case"RandomUniform":return[s.randomUniform(_("shape",n,e,t),_("minval",n,e,t),_("maxval",n,e,t),_("dtype",n,e,t))];case"Range":{const r=_("start",n,e,t),o=_("stop",n,e,t),i=_("step",n,e,t);return[s.range(r,o,i,_("dtype",n,e,t))]}case"TruncatedNormal":{const r=_("shape",n,e,t),o=_("mean",n,e,t),i=_("stdDev",n,e,t),a=_("seed",n,e,t);return[s.truncatedNormal(r,o,i,_("dtype",n,e,t),a)]}case"Zeros":return[s.zeros(_("shape",n,e,t),_("dtype",n,e,t))];case"ZerosLike":return[s.zerosLike(_("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zx(n,e,t){const s=_("boxes",n,e,t),r=_("scores",n,e,t),o=_("maxOutputSize",n,e,t),i=_("iouThreshold",n,e,t),a=_("scoreThreshold",n,e,t),l=_("softNmsSigma",n,e,t);return{boxes:s,scores:r,maxOutputSize:o,iouThreshold:i,scoreThreshold:a,softNmsSigma:l}}const cJ=async(n,e,t,s,r=ds)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u,softNmsSigma:d}=Zx(n,e,t),f=await r.image.nonMaxSuppressionWithScoreAsync(o,i,a,l,u,d);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=Zx(n,e,t),d=_("padToMaxOutputSize",n,e,t),f=await r.image.nonMaxSuppressionPaddedAsync(o,i,a,l,u,d);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:l,scoreThreshold:u}=Zx(n,e,t);return[await r.image.nonMaxSuppressionAsync(o,i,a,l,u)]}case"Where":{const o=r.cast(_("condition",n,e,t),"bool"),i=[await r.whereAsync(o)];return o.dispose(),i}case"ListDiff":return r.setdiff1dAsync(_("x",n,e,t),_("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dJ=(n,e,t,s=ds)=>{switch(n.op){case"LowerBound":{const r=_("sortedSequence",n,e,t),o=_("values",n,e,t);return[s.lowerBound(r,o)]}case"TopKV2":{const r=_("x",n,e,t),o=_("k",n,e,t),i=_("sorted",n,e,t),a=s.topk(r,o,i);return[a.values,a.indices]}case"UpperBound":{const r=_("sortedSequence",n,e,t),o=_("values",n,e,t);return[s.upperBound(r,o)]}case"Unique":{const r=_("x",n,e,t),o=s.unique(r);return[o.values,o.indices]}case"UniqueV2":{const r=_("x",n,e,t),o=_("axis",n,e,t),i=s.unique(r,o);return[i.values,i.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fJ=(n,e,t,s=ds)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const r=_("default",n,e,t);return[Ss(n.name,e,t)||r];case"Placeholder":return[Ss(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const d=_("x",n,e,t);return[ni(d)]}case"IdentityN":return _("x",n,e,t).map(d=>ni(d));case"Snapshot":const o=_("x",n,e,t);return[ni(o)];case"Shape":return[s.tensor1d(_("x",n,e,t).shape,"int32")];case"ShapeN":return _("x",n,e,t).map(d=>s.tensor1d(d.shape));case"Size":return[s.scalar(_("x",n,e,t).size,"int32")];case"Rank":return[s.scalar(_("x",n,e,t).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=_("x",n,e,t),a=_("data",n,e,t),l=_("message",n,e,t),u=_("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let d=0;d<a.length;d++)console.log(Array.prototype.slice.call(a[d].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hJ{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=tt(0),this.tensorMap=new Map,Un(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return tt(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),he(()=>{const r=zr(t),o=s.length,i=r.length;B(o===i,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${i} elements.`);for(let a=0;a<o;a++){const l=s[a],u=r[a];Un(u),this.tensorMap.set(l,u)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const s=await e.data();return he(()=>{const r=[];for(let o=0;o<s.length;o++){const i=s[o],a=this.findWithDefault(i,t);r.push(a)}return xr(r)})}findWithDefault(e,t){const s=this.tensorMap.get(e);return s??t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pJ=async(n,e,t,s)=>{switch(n.op){case"HashTable":case"HashTableV2":{const r=_("keyDType",n,e,t),o=_("valueDType",n,e,t),i=new hJ(r,o);return s.addHashTable(n.name,i),[i.handle]}case"LookupTableImport":case"LookupTableImportV2":{const r=_("tableHandle",n,e,t,s),o=_("keys",n,e,t),i=_("values",n,e,t);return[await s.getHashTableById(r.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const r=_("tableHandle",n,e,t,s),o=_("keys",n,e,t),i=_("defaultValue",n,e,t);return[await s.getHashTableById(r.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=_("tableHandle",n,e,t,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mJ=(n,e,t,s=ds)=>{switch(n.op){case"ResizeBilinear":{const r=_("images",n,e,t),o=_("size",n,e,t),i=_("alignCorners",n,e,t),a=_("halfPixelCenters",n,e,t);return[s.image.resizeBilinear(r,[o[0],o[1]],i,a)]}case"ResizeNearestNeighbor":{const r=_("images",n,e,t),o=_("size",n,e,t),i=_("alignCorners",n,e,t),a=_("halfPixelCenters",n,e,t);return[s.image.resizeNearestNeighbor(r,[o[0],o[1]],i,a)]}case"CropAndResize":{const r=_("image",n,e,t),o=_("boxes",n,e,t),i=_("boxInd",n,e,t),a=_("cropSize",n,e,t),l=_("method",n,e,t),u=_("extrapolationValue",n,e,t);return[s.image.cropAndResize(r,o,i,a,l,u)]}case"ImageProjectiveTransformV3":{const r=_("images",n,e,t),o=_("transforms",n,e,t),i=_("outputShape",n,e,t),a=_("fillValue",n,e,t),l=_("interpolation",n,e,t),u=_("fillMode",n,e,t);return[s.image.transform(r,o,l.toLowerCase(),u.toLowerCase(),a,i)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gJ=(n,e,t,s=ds)=>{switch(n.op){case"Equal":return[s.equal(_("a",n,e,t),_("b",n,e,t))];case"NotEqual":return[s.notEqual(_("a",n,e,t),_("b",n,e,t))];case"Greater":return[s.greater(_("a",n,e,t),_("b",n,e,t))];case"GreaterEqual":return[s.greaterEqual(_("a",n,e,t),_("b",n,e,t))];case"Less":return[s.less(_("a",n,e,t),_("b",n,e,t))];case"LessEqual":return[s.lessEqual(_("a",n,e,t),_("b",n,e,t))];case"LogicalAnd":return[s.logicalAnd(_("a",n,e,t),_("b",n,e,t))];case"LogicalNot":return[s.logicalNot(_("a",n,e,t))];case"LogicalOr":return[s.logicalOr(_("a",n,e,t),_("b",n,e,t))];case"Select":case"SelectV2":return[s.where(_("condition",n,e,t),_("a",n,e,t),_("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yJ=(n,e,t,s=ds)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(_("a",n,e,t),_("b",n,e,t),_("transposeA",n,e,t),_("transposeB",n,e,t))];case"Einsum":return[s.einsum(_("equation",n,e,t),..._("tensors",n,e,t))];case"Transpose":return[s.transpose(_("x",n,e,t),_("perm",n,e,t))];case"_FusedMatMul":const[r,o]=_("fusedOps",n,e,t),i=r==="biasadd",a=o==="prelu",l=_("numArgs",n,e,t),u=_("leakyreluAlpha",n,e,t);if(i){if(a&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[d,f]=_("args",n,e,t);return[s.fused.matMul({a:_("a",n,e,t),b:_("b",n,e,t),transposeA:_("transposeA",n,e,t),transposeB:_("transposeB",n,e,t),bias:d,activation:o,preluActivationWeights:f,leakyreluAlpha:u})];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xJ=(n,e,t,s=ds)=>{switch(n.op){case"EuclideanNorm":return[s.euclideanNorm(_("x",n,e,t),_("axis",n,e,t),_("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(_("x",n,e,t),_("mean",n,e,t),_("variance",n,e,t),_("offset",n,e,t),_("scale",n,e,t),_("epsilon",n,e,t))];case"FusedBatchNormV3":return[s.batchNorm(_("x",n,e,t),_("mean",n,e,t),_("variance",n,e,t),_("offset",n,e,t),_("scale",n,e,t),_("epsilon",n,e,t))];case"LRN":return[s.localResponseNormalization(_("x",n,e,t),_("radius",n,e,t),_("bias",n,e,t),_("alpha",n,e,t),_("beta",n,e,t))];case"Softmax":return[s.softmax(_("x",n,e,t))];case"LogSoftmax":return[s.logSoftmax(_("x",n,e,t))];case"SparseToDense":return[s.sparseToDense(_("sparseIndices",n,e,t),_("outputShape",n,e,t),_("sparseValues",n,e,t),_("defaultValue",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vJ=(n,e,t,s=ds)=>{switch(n.op){case"Max":{const a=_("axis",n,e,t),l=_("keepDims",n,e,t);return[s.max(_("x",n,e,t),a,l)]}case"Mean":{const a=_("axis",n,e,t),l=_("keepDims",n,e,t);return[s.mean(_("x",n,e,t),a,l)]}case"Min":{const a=_("axis",n,e,t),l=_("keepDims",n,e,t);return[s.min(_("x",n,e,t),a,l)]}case"Sum":{const a=_("axis",n,e,t),l=_("keepDims",n,e,t);return[s.sum(_("x",n,e,t),a,l)]}case"All":{const a=_("axis",n,e,t),l=_("keepDims",n,e,t);return[s.all(_("x",n,e,t),a,l)]}case"Any":{const a=_("axis",n,e,t),l=_("keepDims",n,e,t);return[s.any(_("x",n,e,t),a,l)]}case"ArgMax":{const a=_("axis",n,e,t);return[s.argMax(_("x",n,e,t),a)]}case"ArgMin":{const a=_("axis",n,e,t);return[s.argMin(_("x",n,e,t),a)]}case"Prod":{const a=_("axis",n,e,t),l=_("keepDims",n,e,t);return[s.prod(_("x",n,e,t),a,l)]}case"Cumprod":{const a=_("axis",n,e,t),l=_("exclusive",n,e,t),u=_("reverse",n,e,t);return[s.cumprod(_("x",n,e,t),a,l,u)]}case"Cumsum":{const a=_("axis",n,e,t),l=_("exclusive",n,e,t),u=_("reverse",n,e,t);return[s.cumsum(_("x",n,e,t),a,l,u)]}case"Bincount":const r=_("x",n,e,t),o=_("weights",n,e,t),i=_("size",n,e,t);return[s.bincount(r,o,i)];case"DenseBincount":{const a=_("x",n,e,t),l=_("weights",n,e,t),u=_("size",n,e,t),d=_("binaryOutput",n,e,t);return[s.denseBincount(a,l,u,d)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wJ=(n,e,t,s=ds)=>{switch(n.op){case"ConcatV2":case"Concat":{const r=_("n",n,e,t),o=_("axis",n,e,t);let i=_("tensors",n,e,t);return i=i.slice(0,r),[s.concat(i,o)]}case"Gather":{const r=_("x",n,e,t),o=_("indices",n,e,t);return[s.gather(r,s.cast(o,"int32"),0)]}case"GatherV2":{const r=_("axis",n,e,t),o=_("batchDims",n,e,t),i=_("x",n,e,t),a=_("indices",n,e,t);return[s.gather(i,s.cast(a,"int32"),r,o)]}case"Reverse":{const r=_("dims",n,e,t),o=[];for(let a=0;a<r.length;a++)r[a]&&o.push(a);const i=_("x",n,e,t);return[s.reverse(i,o)]}case"ReverseV2":{const r=_("axis",n,e,t),o=_("x",n,e,t);return[s.reverse(o,r)]}case"Slice":{const r=_("begin",n,e,t),o=_("size",n,e,t);return[s.slice(_("x",n,e,t),r,o)]}case"StridedSlice":{const r=_("begin",n,e,t),o=_("end",n,e,t),i=_("strides",n,e,t),a=_("beginMask",n,e,t),l=_("endMask",n,e,t),u=_("ellipsisMask",n,e,t),d=_("newAxisMask",n,e,t),f=_("shrinkAxisMask",n,e,t),p=_("x",n,e,t);return[s.stridedSlice(p,r,o,i,a,l,u,d,f)]}case"Pack":return he(()=>{const r=_("axis",n,e,t),o=_("tensors",n,e,t),i=o[0].shape,a=s.squeeze(o[0]).shape,l=o.map(u=>{const d=Ct(u.shape,i);if(!d&&!Ct(s.squeeze(u).shape,a))throw new Error("the input tensors shape does not match");return d?u:s.reshape(u,i)});return[s.stack(l,r)]});case"Unpack":{const r=_("axis",n,e,t),o=_("tensor",n,e,t);return s.unstack(o,r)}case"Tile":{const r=_("reps",n,e,t);return[s.tile(_("x",n,e,t),r)]}case"Split":case"SplitV":{const r=_("axis",n,e,t),o=_("numOrSizeSplits",n,e,t),i=_("x",n,e,t);return s.split(i,o,r)}case"ScatterNd":{const r=_("indices",n,e,t),o=_("values",n,e,t),i=_("shape",n,e,t);return[s.scatterND(r,o,i)]}case"GatherNd":{const r=_("x",n,e,t),o=_("indices",n,e,t);return[s.gatherND(r,o)]}case"SparseToDense":{const r=_("sparseIndices",n,e,t),o=_("outputShape",n,e,t),i=_("sparseValues",n,e,t),a=_("defaultValue",n,e,t);return[s.sparseToDense(r,i,o,i.dtype===a.dtype?a:s.cast(a,i.dtype))]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CJ=(n,e,t,s=ds)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:o,emptyRowIndicator:i,reverseIndexMap:a}=s.sparse.sparseFillEmptyRows(_("indices",n,e,t),_("values",n,e,t),_("denseShape",n,e,t),_("defaultValue",n,e,t));return[r,o,i,a]}case"SparseReshape":{const{outputIndices:r,outputShape:o}=s.sparse.sparseReshape(_("inputIndices",n,e,t),_("inputShape",n,e,t),_("newShape",n,e,t));return[r,o]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(_("data",n,e,t),_("indices",n,e,t),_("segmentIds",n,e,t))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(_("data",n,e,t),_("indices",n,e,t),_("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TJ=(n,e,t,s=ds)=>{switch(n.op){case"FFT":return[s.fft(_("x",n,e,t))];case"IFFT":return[s.ifft(_("x",n,e,t))];case"RFFT":return[s.rfft(_("x",n,e,t))];case"IRFFT":return[s.irfft(_("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SJ=(n,e,t,s=ds)=>{switch(n.op){case"StringNGrams":{const{nGrams:r,nGramsSplits:o}=s.string.stringNGrams(_("data",n,e,t),_("dataSplits",n,e,t),_("separator",n,e,t),_("nGramWidths",n,e,t),_("leftPad",n,e,t),_("rightPad",n,e,t),_("padWidth",n,e,t),_("preserveShortSequences",n,e,t));return[r,o]}case"StringSplit":{const{indices:r,values:o,shape:i}=s.string.stringSplit(_("input",n,e,t),_("delimiter",n,e,t),_("skipEmpty",n,e,t));return[r,o,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(_("input",n,e,t),_("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bJ=(n,e,t,s=ds)=>{switch(n.op){case"Cast":return[s.cast(_("x",n,e,t),_("dtype",n,e,t))];case"ExpandDims":{const r=_("axis",n,e,t);return[s.expandDims(_("x",n,e,t),r)]}case"Squeeze":{const r=_("axis",n,e,t);return[s.squeeze(_("x",n,e,t),r)]}case"Reshape":return[s.reshape(_("x",n,e,t),_("shape",n,e,t))];case"MirrorPad":return[s.mirrorPad(_("x",n,e,t),_("padding",n,e,t),_("mode",n,e,t))];case"PadV2":case"Pad":return[s.pad(_("x",n,e,t),_("padding",n,e,t),_("constantValue",n,e,t))];case"SpaceToBatchND":{const r=_("blockShape",n,e,t),o=_("paddings",n,e,t);return[s.spaceToBatchND(_("x",n,e,t),r,o)]}case"BatchToSpaceND":{const r=_("blockShape",n,e,t),o=_("crops",n,e,t);return[s.batchToSpaceND(_("x",n,e,t),r,o)]}case"DepthToSpace":{const r=_("blockSize",n,e,t),o=_("dataFormat",n,e,t).toUpperCase();return[s.depthToSpace(_("x",n,e,t),r,o)]}case"BroadcastTo":return[s.broadcastTo(_("x",n,e,t),_("shape",n,e,t))];case"BroadcastArgs":return[s.broadcastArgs(_("s0",n,e,t),_("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gk(n,e,t,s,r=he){const o=((i,a,l)=>{switch(i.category){case"arithmetic":return r(()=>eJ(i,a,l));case"basic_math":return r(()=>tJ(i,a,l));case"control":return aJ(i,a,l);case"convolution":return r(()=>lJ(i,a,l));case"creation":return r(()=>uJ(i,a,l));case"dynamic":return cJ(i,a,l);case"evaluation":return r(()=>dJ(i,a,l));case"image":return r(()=>mJ(i,a,l));case"graph":return r(()=>fJ(i,a,l));case"logical":return r(()=>gJ(i,a,l));case"matrices":return r(()=>yJ(i,a,l));case"normalization":return r(()=>xJ(i,a,l));case"reduction":return r(()=>vJ(i,a,l));case"slice_join":return r(()=>wJ(i,a,l));case"sparse":return r(()=>CJ(i,a,l));case"spectral":return r(()=>TJ(i,a,l));case"string":return r(()=>SJ(i,a,l));case"transformation":return r(()=>bJ(i,a,l));case"hash_table":return pJ(i,a,l,s);case"custom":const u=fA(i.op);if(u&&u.customExecutor)return u.customExecutor(new jX(i,a,l));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return cl(o)?o.then(i=>[].concat(i)):[].concat(o)}class Hk{constructor(e={},t={},s={},r={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=s,this.functionMap=r,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const s=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qk(n,e,t,s){const r=new Set,o=[];let i=null,a=null;const l=new Set,u=Object.keys(n).map(p=>Js(p)[0]);let d=[];s!=null&&(d=s.map(p=>Js(p.name)[0]));const f=[...e];for(;f.length>0;){const p=f.pop();if((mA(p)||$J(p)||AJ(p))&&i==null&&(i=p,a=i.children.map(y=>y.name).filter(y=>r.has(y))),r.add(p.name),t[p.name]==null&&u.indexOf(p.name)===-1&&d.indexOf(p.name)===-1){if(p.inputs.length===0){o.push(p.name);continue}p.inputs.forEach(y=>{l.has(y.name)||(l.add(y.name),f.push(y))})}}return{inputs:n,outputs:e,usedNodes:r,missingInputs:o,dynamicNode:i,syncInputs:a}}function IJ(n,e,t){const{usedNodes:s,inputs:r}=t,o=[],i=Object.keys(r).map(d=>Js(d)[0]).map(d=>n.nodes[d]),a=n.initNodes;i.forEach(d=>{s.has(d.name)&&o.push(d)}),n.weights.forEach(d=>{s.has(d.name)&&o.push(d)}),a!=null&&a.forEach(d=>{s.has(d.name)&&o.push(d)});const l=new Set,u=[];for(;o.length>0;){const d=o.pop();l.add(d.name),e[d.name]||u.push(d),d.children.forEach(f=>{!l.has(f.name)&&s.has(f.name)&&f.inputs.every(p=>l.has(p.name))&&o.push(f)})}return u}const kJ=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],NJ=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],EJ=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function mA(n){return kJ.indexOf(n.op)>=0}function $J(n){return NJ.indexOf(n.op)>=0}function AJ(n){return EJ.indexOf(n.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cg{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new Cg(e.functions[s],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}getCompilationKey(e,t){const s=e.map(o=>o.name).sort(),r=t.map(o=>o.name).sort();return s.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}compile(e,t){const s=qk(e,t,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:o,syncInputs:i}=s;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const a=t.map(u=>u.name),l=Object.keys(e);throw new Error(`Cannot compute the outputs [${a}] from the provided inputs [${l}]. Missing the following inputs: [${r}]`)}return IJ(this.graph,this.weightMap,s)}execute(e,t){e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const r=s.map(f=>this.graph.nodes[Js(f)[0]]),o=t.map(f=>Js(f)[0]);let i=o.map(f=>this.graph.nodes[f]);this.resetIntermediateTensors(),i.length===0&&(i=this._outputs);const a=this.getCompilationKey(r,i);let l=this.compiledMap.get(a);l==null&&(l=this.compile(e,i),this.compiledMap.set(a,l));const u={},d={};return he(()=>{const f=new Hk(this.weightMap,u,d,this.functionExecutorMap),p=Object.assign({},this.weightMap);Object.keys(e).forEach(w=>{const[C,S]=Js(w),b=[];b[S]=e[w],p[C]=b});const y=this.getFrozenTensorIds(p),v={};for(let w=0;w<l.length;w++){const C=l[w];if(!p[C.name]){const S=Gk(C,p,f,this._resourceManager);if(cl(S))throw new Error(`The execution of the op '${C.op}' returned a promise. Please use model.executeAsync() instead.`);p[C.name]=S,this.checkTensorForDisposal(C.name,C,p,f,y,o,v)}}return this.parent==null&&f.dispose(y),t.map(w=>Ss(w,p,f))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(t)}checkTensorForDisposal(e,t,s,r,o,i,a){t.category==="control"||i.indexOf(e)!==-1||(s[e].forEach(l=>{l!=null&&(a[l.id]=(a[l.id]||0)+t.children.length)}),t.inputs.forEach(l=>{if(l.category!=="control"){const u=hX(l.name,s,r);u!=null&&u.forEach(d=>{if(d&&!d.kept&&!o.has(d.id)){const f=a[d.id];if(f===1){if(!this.keepTensorForDebug)d.dispose();else{const[p,y]=bo(t.name,r);this.intermediateTensors[p]?this.intermediateTensors[p][y]=d:(this.intermediateTensors[p]=[],this.intermediateTensors[p][y]=d)}delete a[d.id]}else f!=null&&a[d.id]--}})}}))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){this.intermediateTensors&&(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){this.tensorsMap&&Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(s=>{s&&!s.kept&&!s.isDisposed&&!this.keepIds.has(s.id)&&s.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(t=>t.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,t,s=!1,r={},o={}){s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=me().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(d){console.warn(d.message)}this.resetIntermediateTensors();const i=new Hk(this.weightMap,r,o,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,i,t,s);const a=t.map(d=>Ss(d,this.tensorsMap,i)),l=a.map(d=>d.id),u=Object.keys(e).map(d=>e[d].id);return this.keepIds=new Set([...l,...u,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&i.dispose(this.keepIds),a}async executeFunctionAsync(e,t,s){const r=e.reduce((o,i,a)=>(o[this.inputs[a].name]=i,o),{});return this._executeAsync(r,this.outputNodes,!0,t,s)}async executeWithControlFlow(e,t,s,r){const o=Object.keys(e),i=o.map(E=>this.graph.nodes[Js(E)[0]]),a=s.map(E=>Js(E)[0]);let l=a.map(E=>this.graph.nodes[E]);l.length===0&&(l=this._outputs);const{usedNodes:u,missingInputs:d,dynamicNode:f,syncInputs:p}=qk(e,l,this.weightMap,this._initNodes),y=[...i,...this.graph.weights,...this._initNodes||[]].map(E=>({node:E,contexts:t.currentContext})),v=Object.assign({},this.weightMap);Object.keys(e).forEach(E=>{const[N,A]=Js(E),R=[];R[A]=e[E],v[N]=R});const w={},C=this.getFrozenTensorIds(v),S={};for(;y.length>0;){const E=this.processStack(i,y,t,v,S,C,a,w,u);await Promise.all(E)}f==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=l.filter(E=>!mA(E)&&!Ss(E.name,v,t)).map(E=>E.name);if(b.length>0){let E="";throw f!=null&&(E=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${p}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${o}]. Consider providing the following inputs: [${d}]. ${E}`)}return v}processStack(e,t,s,r,o,i,a,l,u){const d=[];for(;t.length>0;){const f=t.pop();s.currentContext=f.contexts;let p="";if(f.node.op==="Enter"&&_("isConstant",f.node,r,s)&&([p]=bo(f.node.name,s)),r[f.node.name]==null){const y=Gk(f.node,r,s,this._resourceManager);p||([p]=bo(f.node.name,s));const v=s.currentContext;cl(y)?d.push(y.then(w=>(r[p]=w,s.currentContext=v,this.checkTensorForDisposal(p,f.node,r,s,i,a,l),this.processChildNodes(f.node,t,s,r,o,u),w))):(r[p]=y,this.checkTensorForDisposal(p,f.node,r,s,i,a,l),this.processChildNodes(f.node,t,s,r,o,u))}else this.processChildNodes(f.node,t,s,r,o,u)}return d}processChildNodes(e,t,s,r,o,i){e.children.forEach(a=>{const[l]=bo(a.name,s);o[l]||!i.has(a.name)||(a.op==="Merge"?a.inputNames.some(u=>!!Ss(u,r,s))&&(o[l]=!0,t.push({contexts:s.currentContext,node:a})):a.inputNames.every(u=>!!Ss(u,r,s))&&(o[l]=!0,t.push({contexts:s.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const s=e[t],[r]=Js(t),o=this.graph.nodes[r];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,a=i.length===s.shape.length&&s.shape.every((l,u)=>i[u]===-1||i[u]===l);B(a,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&B(s.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){const t={};for(const s in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[s]!=null){const r=this._signature.inputs[s];t[r.name]=e[s]}else t[s]=e[s];return t}checkInputs(e){const t=Object.keys(e).filter(s=>{const[r]=Js(s);return this.graph.nodes[r]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[t]!=null?this._signature.outputs[t].name:t,{})}checkOutputs(e){e.forEach(t=>{const[s]=Js(t);if(!this.graph.nodes[s])throw new Error(`The output '${t}' is not found in the graph`)})}}class _J{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RJ="?tfjs-format=file",DJ="model.json";class OC{constructor(e,t={},s=tw){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=s,t==null&&(this.loadOptions={}),this.resourceManager=new _J}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return cl(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let s=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(s=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}this.signature=s,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const r=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new Cg(Bk.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=Bk.Instance.transformGraph(e.modelInitializer);this.initializer=new Cg(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){const s=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const r=s instanceof St?[s]:s,o={};return r.forEach((i,a)=>o[this.structuredOutputKeys[a]]=i),o}return s}normalizeInputs(e){if(!(e instanceof St)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((t,s,r)=>(t[s]=e[r],t),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=this.executor.execute(e,t);return s.length>1?s:s[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const s=await this.executor.executeAsync(e,t);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,s)=>(t[s]=[e[s]],t),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function VC(n,e={},t=tw){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=MJ(n));const s=new OC(n,e,t);return await s.load(),s}function FJ(n){if(n==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(n instanceof Array){const[s,r]=n;if(!s)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const o=Q2(s.weightsManifest),i=J2(s,o,r);e=xg(i)}else if("load"in n)e=n;else if("modelTopology"in n&&"weightSpecs"in n&&"weightData"in n)e=xg(n);else throw new Error("Unknown model format");const t=new OC(e);return t.load(),t}function MJ(n){return n.endsWith("/")||(n=n+"/"),`${n}${DJ}${RJ}`}/** @license See the LICENSE file. */const PJ="3.21.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LJ=Object.freeze(Object.defineProperty({__proto__:null,GraphModel:OC,deregisterOp:fX,loadGraphModel:VC,loadGraphModelSync:FJ,registerOp:dX,version_converter:PJ},Symbol.toStringTag,{value:"Module"})),OJ=E2(LJ),VJ=E2(uX);/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var BJ=Qd.exports,Kk;function zJ(){return Kk||(Kk=1,(function(n,e){(function(t,s){s(e,OJ,VJ)})(BJ,(function(t,s,r){const o={1:{name:"/m/01g317",id:1,displayName:"person"},2:{name:"/m/0199g",id:2,displayName:"bicycle"},3:{name:"/m/0k4j",id:3,displayName:"car"},4:{name:"/m/04_sv",id:4,displayName:"motorcycle"},5:{name:"/m/05czz6l",id:5,displayName:"airplane"},6:{name:"/m/01bjv",id:6,displayName:"bus"},7:{name:"/m/07jdr",id:7,displayName:"train"},8:{name:"/m/07r04",id:8,displayName:"truck"},9:{name:"/m/019jd",id:9,displayName:"boat"},10:{name:"/m/015qff",id:10,displayName:"traffic light"},11:{name:"/m/01pns0",id:11,displayName:"fire hydrant"},13:{name:"/m/02pv19",id:13,displayName:"stop sign"},14:{name:"/m/015qbp",id:14,displayName:"parking meter"},15:{name:"/m/0cvnqh",id:15,displayName:"bench"},16:{name:"/m/015p6",id:16,displayName:"bird"},17:{name:"/m/01yrx",id:17,displayName:"cat"},18:{name:"/m/0bt9lr",id:18,displayName:"dog"},19:{name:"/m/03k3r",id:19,displayName:"horse"},20:{name:"/m/07bgp",id:20,displayName:"sheep"},21:{name:"/m/01xq0k1",id:21,displayName:"cow"},22:{name:"/m/0bwd_0j",id:22,displayName:"elephant"},23:{name:"/m/01dws",id:23,displayName:"bear"},24:{name:"/m/0898b",id:24,displayName:"zebra"},25:{name:"/m/03bk1",id:25,displayName:"giraffe"},27:{name:"/m/01940j",id:27,displayName:"backpack"},28:{name:"/m/0hnnb",id:28,displayName:"umbrella"},31:{name:"/m/080hkjn",id:31,displayName:"handbag"},32:{name:"/m/01rkbr",id:32,displayName:"tie"},33:{name:"/m/01s55n",id:33,displayName:"suitcase"},34:{name:"/m/02wmf",id:34,displayName:"frisbee"},35:{name:"/m/071p9",id:35,displayName:"skis"},36:{name:"/m/06__v",id:36,displayName:"snowboard"},37:{name:"/m/018xm",id:37,displayName:"sports ball"},38:{name:"/m/02zt3",id:38,displayName:"kite"},39:{name:"/m/03g8mr",id:39,displayName:"baseball bat"},40:{name:"/m/03grzl",id:40,displayName:"baseball glove"},41:{name:"/m/06_fw",id:41,displayName:"skateboard"},42:{name:"/m/019w40",id:42,displayName:"surfboard"},43:{name:"/m/0dv9c",id:43,displayName:"tennis racket"},44:{name:"/m/04dr76w",id:44,displayName:"bottle"},46:{name:"/m/09tvcd",id:46,displayName:"wine glass"},47:{name:"/m/08gqpm",id:47,displayName:"cup"},48:{name:"/m/0dt3t",id:48,displayName:"fork"},49:{name:"/m/04ctx",id:49,displayName:"knife"},50:{name:"/m/0cmx8",id:50,displayName:"spoon"},51:{name:"/m/04kkgm",id:51,displayName:"bowl"},52:{name:"/m/09qck",id:52,displayName:"banana"},53:{name:"/m/014j1m",id:53,displayName:"apple"},54:{name:"/m/0l515",id:54,displayName:"sandwich"},55:{name:"/m/0cyhj_",id:55,displayName:"orange"},56:{name:"/m/0hkxq",id:56,displayName:"broccoli"},57:{name:"/m/0fj52s",id:57,displayName:"carrot"},58:{name:"/m/01b9xk",id:58,displayName:"hot dog"},59:{name:"/m/0663v",id:59,displayName:"pizza"},60:{name:"/m/0jy4k",id:60,displayName:"donut"},61:{name:"/m/0fszt",id:61,displayName:"cake"},62:{name:"/m/01mzpv",id:62,displayName:"chair"},63:{name:"/m/02crq1",id:63,displayName:"couch"},64:{name:"/m/03fp41",id:64,displayName:"potted plant"},65:{name:"/m/03ssj5",id:65,displayName:"bed"},67:{name:"/m/04bcr3",id:67,displayName:"dining table"},70:{name:"/m/09g1w",id:70,displayName:"toilet"},72:{name:"/m/07c52",id:72,displayName:"tv"},73:{name:"/m/01c648",id:73,displayName:"laptop"},74:{name:"/m/020lf",id:74,displayName:"mouse"},75:{name:"/m/0qjjc",id:75,displayName:"remote"},76:{name:"/m/01m2v",id:76,displayName:"keyboard"},77:{name:"/m/050k8",id:77,displayName:"cell phone"},78:{name:"/m/0fx9l",id:78,displayName:"microwave"},79:{name:"/m/029bxz",id:79,displayName:"oven"},80:{name:"/m/01k6s3",id:80,displayName:"toaster"},81:{name:"/m/0130jx",id:81,displayName:"sink"},82:{name:"/m/040b_t",id:82,displayName:"refrigerator"},84:{name:"/m/0bt_c3",id:84,displayName:"book"},85:{name:"/m/01x3z",id:85,displayName:"clock"},86:{name:"/m/02s195",id:86,displayName:"vase"},87:{name:"/m/01lsmm",id:87,displayName:"scissors"},88:{name:"/m/0kmg4",id:88,displayName:"teddy bear"},89:{name:"/m/03wvsk",id:89,displayName:"hair drier"},90:{name:"/m/012xff",id:90,displayName:"toothbrush"}};class i{constructor(l,u){this.modelPath=u||`https://storage.googleapis.com/tfjs-models/savedmodel/${this.getPrefix(l)}/model.json`}getPrefix(l){return l==="lite_mobilenet_v2"?`ssd${l}`:`ssd_${l}`}async load(){this.model=await s.loadGraphModel(this.modelPath);const l=r.zeros([1,300,300,3],"int32"),u=await this.model.executeAsync(l);await Promise.all(u.map((d=>d.data()))),u.map((d=>d.dispose())),l.dispose()}async infer(l,u,d){const f=r.tidy((()=>(l instanceof r.Tensor||(l=r.browser.fromPixels(l)),r.expandDims(l)))),p=f.shape[1],y=f.shape[2],v=await this.model.executeAsync(f),w=v[0].dataSync(),C=v[1].dataSync();f.dispose(),r.dispose(v);const[S,b]=this.calculateMaxScores(w,v[0].shape[1],v[0].shape[2]),E=r.getBackend();r.getBackend()==="webgl"&&r.setBackend("cpu");const N=r.tidy((()=>{const R=r.tensor2d(C,[v[1].shape[1],v[1].shape[3]]);return r.image.nonMaxSuppression(R,S,u,d,d)})),A=N.dataSync();return N.dispose(),E!==r.getBackend()&&r.setBackend(E),this.buildDetectedObjects(y,p,C,S,A,b)}buildDetectedObjects(l,u,d,f,p,y){const v=p.length,w=[];for(let C=0;C<v;C++){const S=[];for(let R=0;R<4;R++)S[R]=d[4*p[C]+R];const b=S[0]*u,E=S[1]*l,N=S[2]*u,A=S[3]*l;S[0]=E,S[1]=b,S[2]=A-E,S[3]=N-b,w.push({bbox:S,class:o[y[p[C]]+1].displayName,score:f[p[C]]})}return w}calculateMaxScores(l,u,d){const f=[],p=[];for(let y=0;y<u;y++){let v=Number.MIN_VALUE,w=-1;for(let C=0;C<d;C++)l[y*d+C]>v&&(v=l[y*d+C],w=C);f[y]=v,p[y]=w}return[f,p]}async detect(l,u=20,d=.5){return this.infer(l,u,d)}dispose(){this.model!=null&&this.model.dispose()}}t.ObjectDetection=i,t.load=async function(a={}){if(r==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");const l=a.base||"lite_mobilenet_v2",u=a.modelUrl;if(["mobilenet_v1","mobilenet_v2","lite_mobilenet_v2"].indexOf(l)===-1)throw new Error(`ObjectDetection constructed with invalid base model ${l}. Valid names are 'mobilenet_v1', 'mobilenet_v2' and 'lite_mobilenet_v2'.`);const d=new i(l,u);return await d.load(),d},t.version="2.2.3",Object.defineProperty(t,"__esModule",{value:!0})}))})(Qd,Qd.exports)),Qd.exports}var UJ=zJ();/**
    * @license
    * Copyright 2024 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var oo=function(){return oo=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},oo.apply(this,arguments)};function ii(n,e,t,s){return new(t||(t=Promise))((function(r,o){function i(u){try{l(s.next(u))}catch(d){o(d)}}function a(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){var d;u.done?r(u.value):(d=u.value,d instanceof t?d:new t((function(f){f(d)}))).then(i,a)}l((s=s.apply(n,[])).next())}))}function ai(n,e){var t,s,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return(function(d){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(r=2&d[0]?s.return:d[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,d[1])).done)return r;switch(s=0,r&&(d=[2&d[0],r.value]),d[0]){case 0:case 1:r=d;break;case 4:return i.label++,{value:d[1],done:!1};case 5:i.label++,s=d[1],d=[0];continue;case 7:d=i.ops.pop(),i.trys.pop();continue;default:if(r=i.trys,!((r=r.length>0&&r[r.length-1])||d[0]!==6&&d[0]!==2)){i=0;continue}if(d[0]===3&&(!r||d[1]>r[0]&&d[1]<r[3])){i.label=d[1];break}if(d[0]===6&&i.label<r[1]){i.label=r[1],r=d;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(d);break}r[2]&&i.ops.pop(),i.trys.pop();continue}d=e.call(n,i)}catch(f){d=[6,f],s=0}finally{t=r=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}})([l,u])}}}function Zi(n){var e=n.map((function(t){return t[0]}));return e.push(n[n.length-1][1]),e}var WJ={lips:Zi([[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]]),leftEye:Zi([[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]]),leftEyebrow:Zi([[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]]),leftIris:Zi([[474,475],[475,476],[476,477],[477,474]]),rightEye:Zi([[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]]),rightEyebrow:Zi([[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]]),rightIris:Zi([[469,470],[470,471],[471,472],[472,469]]),faceOval:Zi([[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]])},GJ=Object.entries(WJ).map((function(n){var e=n[0];return n[1].map((function(t){return[t,e]}))})).flat(),gA=new Map(GJ);function u2(n){for(var e={locationData:{relativeKeypoints:[]}},t=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,r=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,i=0;i<n.length;++i){var a=n[i];t=Math.min(t,a.x),s=Math.max(s,a.x),r=Math.min(r,a.y),o=Math.max(o,a.y),e.locationData.relativeKeypoints.push({x:a.x,y:a.y})}return e.locationData.relativeBoundingBox={xMin:t,yMin:r,xMax:s,yMax:o,width:s-t,height:o-r},e}var jx={runtime:"mediapipe",maxFaces:1,refineLandmarks:!1},HJ=(function(){function n(e){var t=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceMeshSolution=new nM.FaceMesh({locateFile:function(s,r){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+s:r+"/"+s}}),this.faceMeshSolution.setOptions({refineLandmarks:e.refineLandmarks,selfieMode:this.selfieMode,maxNumFaces:e.maxFaces}),this.faceMeshSolution.onResults((function(s){if(t.height=s.image.height,t.width=s.image.width,t.faces=[],s.multiFaceLandmarks!==null)for(var r=s.multiFaceLandmarks,o=0;o<r.length;o++){var i=t.translateOutput(r[o]);t.faces.push({keypoints:i,box:u2(i).locationData.relativeBoundingBox})}}))}return n.prototype.translateOutput=function(e){var t=this;return e.map((function(s,r){var o={x:s.x*t.width,y:s.y*t.height,z:s.z*t.width},i=gA.get(r);return i!=null&&(o.name=i),o}))},n.prototype.estimateFaces=function(e,t){return ii(this,void 0,void 0,(function(){var s,r;return ai(this,(function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.faceMeshSolution.setOptions({selfieMode:this.selfieMode})),e instanceof St?(r=ImageData.bind,[4,rw(e)]):[3,2];case 1:return s=new(r.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:s=e,o.label=3;case 3:return e=s,[4,this.faceMeshSolution.send({image:e})];case 4:return o.sent(),[2,this.faces]}}))}))},n.prototype.dispose=function(){this.faceMeshSolution.close()},n.prototype.reset=function(){this.faceMeshSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},n.prototype.initialize=function(){return this.faceMeshSolution.initialize()},n})();function qJ(n){return ii(this,void 0,void 0,(function(){var e,t;return ai(this,(function(s){switch(s.label){case 0:return e=(function(r){if(r==null)return oo({},jx);var o=oo({},r);return o.runtime="mediapipe",o.maxFaces==null&&(o.maxFaces=jx.maxFaces),o.refineLandmarks==null&&(o.refineLandmarks=jx.refineLandmarks),o})(n),[4,(t=new HJ(e)).initialize()];case 1:return s.sent(),[2,t]}}))}))}var ev=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},KJ={};(function(){var n;function e(I){var D=0;return function(){return D<I.length?{done:!1,value:I[D++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(I,D,V){return I==Array.prototype||I==Object.prototype||(I[D]=V.value),I},s=(function(I){I=[typeof globalThis=="object"&&globalThis,I,typeof window=="object"&&window,typeof self=="object"&&self,typeof ev=="object"&&ev];for(var D=0;D<I.length;++D){var V=I[D];if(V&&V.Math==Math)return V}throw Error("Cannot find global object")})(this);function r(I,D){if(D)e:{var V=s;I=I.split(".");for(var W=0;W<I.length-1;W++){var X=I[W];if(!(X in V))break e;V=V[X]}(D=D(W=V[I=I[I.length-1]]))!=W&&D!=null&&t(V,I,{configurable:!0,writable:!0,value:D})}}function o(I){return(I={next:I})[Symbol.iterator]=function(){return this},I}function i(I){var D=typeof Symbol<"u"&&Symbol.iterator&&I[Symbol.iterator];return D?D.call(I):{next:e(I)}}function a(I){if(!(I instanceof Array)){I=i(I);for(var D,V=[];!(D=I.next()).done;)V.push(D.value);I=V}return I}r("Symbol",(function(I){function D(X,H){this.g=X,t(this,"description",{configurable:!0,writable:!0,value:H})}if(I)return I;D.prototype.toString=function(){return this.g};var V="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",W=0;return function X(H){if(this instanceof X)throw new TypeError("Symbol is not a constructor");return new D(V+(H||"")+"_"+W++,H)}})),r("Symbol.iterator",(function(I){if(I)return I;I=Symbol("Symbol.iterator");for(var D="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),V=0;V<D.length;V++){var W=s[D[V]];typeof W=="function"&&typeof W.prototype[I]!="function"&&t(W.prototype,I,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return I}));var l,u=typeof Object.create=="function"?Object.create:function(I){function D(){}return D.prototype=I,new D};if(typeof Object.setPrototypeOf=="function")l=Object.setPrototypeOf;else{var d;e:{var f={};try{f.__proto__={a:!0},d=f.a;break e}catch{}d=!1}l=d?function(I,D){if(I.__proto__=D,I.__proto__!==D)throw new TypeError(I+" is not extensible");return I}:null}var p=l;function y(I,D){if(I.prototype=u(D.prototype),I.prototype.constructor=I,p)p(I,D);else for(var V in D)if(V!="prototype")if(Object.defineProperties){var W=Object.getOwnPropertyDescriptor(D,V);W&&Object.defineProperty(I,V,W)}else I[V]=D[V];I.na=D.prototype}function v(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function w(I){if(I.l)throw new TypeError("Generator is already running");I.l=!0}function C(I,D){I.j={da:D,ea:!0},I.g=I.o||I.u}function S(I,D,V){return I.g=V,{value:D}}function b(I){this.g=new v,this.h=I}function E(I,D,V,W){try{var X=D.call(I.g.i,V);if(!(X instanceof Object))throw new TypeError("Iterator result "+X+" is not an object");if(!X.done)return I.g.l=!1,X;var H=X.value}catch(Y){return I.g.i=null,C(I.g,Y),N(I)}return I.g.i=null,W.call(I.g,H),N(I)}function N(I){for(;I.g.g;)try{var D=I.h(I.g);if(D)return I.g.l=!1,{value:D.value,done:!1}}catch(V){I.g.h=void 0,C(I.g,V)}if(I.g.l=!1,I.g.j){if(D=I.g.j,I.g.j=null,D.ea)throw D.da;return{value:D.return,done:!0}}return{value:void 0,done:!0}}function A(I){this.next=function(D){return w(I.g),I.g.i?D=E(I,I.g.i.next,D,I.g.s):(I.g.s(D),D=N(I)),D},this.throw=function(D){return w(I.g),I.g.i?D=E(I,I.g.i.throw,D,I.g.s):(C(I.g,D),D=N(I)),D},this.return=function(D){return(function(V,W){w(V.g);var X=V.g.i;return X?E(V,"return"in X?X.return:function(H){return{value:H,done:!0}},W,V.g.return):(V.g.return(W),N(V))})(I,D)},this[Symbol.iterator]=function(){return this}}function R(I){return(function(D){function V(X){return D.next(X)}function W(X){return D.throw(X)}return new Promise((function(X,H){(function Y(fe){fe.done?X(fe.value):Promise.resolve(fe.value).then(V,W).then(Y,H)})(D.next())}))})(new A(new b(I)))}v.prototype.s=function(I){this.h=I},v.prototype.return=function(I){this.j={return:I},this.g=this.u},r("Promise",(function(I){function D(Y){this.h=0,this.i=void 0,this.g=[],this.s=!1;var fe=this.j();try{Y(fe.resolve,fe.reject)}catch(be){fe.reject(be)}}function V(){this.g=null}function W(Y){return Y instanceof D?Y:new D((function(fe){fe(Y)}))}if(I)return I;V.prototype.h=function(Y){if(this.g==null){this.g=[];var fe=this;this.i((function(){fe.l()}))}this.g.push(Y)};var X=s.setTimeout;V.prototype.i=function(Y){X(Y,0)},V.prototype.l=function(){for(;this.g&&this.g.length;){var Y=this.g;this.g=[];for(var fe=0;fe<Y.length;++fe){var be=Y[fe];Y[fe]=null;try{be()}catch(_e){this.j(_e)}}}this.g=null},V.prototype.j=function(Y){this.i((function(){throw Y}))},D.prototype.j=function(){function Y(_e){return function(Oe){be||(be=!0,_e.call(fe,Oe))}}var fe=this,be=!1;return{resolve:Y(this.D),reject:Y(this.l)}},D.prototype.D=function(Y){if(Y===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(Y instanceof D)this.H(Y);else{e:switch(typeof Y){case"object":var fe=Y!=null;break e;case"function":fe=!0;break e;default:fe=!1}fe?this.A(Y):this.o(Y)}},D.prototype.A=function(Y){var fe=void 0;try{fe=Y.then}catch(be){return void this.l(be)}typeof fe=="function"?this.I(fe,Y):this.o(Y)},D.prototype.l=function(Y){this.u(2,Y)},D.prototype.o=function(Y){this.u(1,Y)},D.prototype.u=function(Y,fe){if(this.h!=0)throw Error("Cannot settle("+Y+", "+fe+"): Promise already settled in state"+this.h);this.h=Y,this.i=fe,this.h===2&&this.G(),this.B()},D.prototype.G=function(){var Y=this;X((function(){if(Y.C()){var fe=s.console;fe!==void 0&&fe.error(Y.i)}}),1)},D.prototype.C=function(){if(this.s)return!1;var Y=s.CustomEvent,fe=s.Event,be=s.dispatchEvent;return be===void 0||(typeof Y=="function"?Y=new Y("unhandledrejection",{cancelable:!0}):typeof fe=="function"?Y=new fe("unhandledrejection",{cancelable:!0}):(Y=s.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,Y),Y.promise=this,Y.reason=this.i,be(Y))},D.prototype.B=function(){if(this.g!=null){for(var Y=0;Y<this.g.length;++Y)H.h(this.g[Y]);this.g=null}};var H=new V;return D.prototype.H=function(Y){var fe=this.j();Y.M(fe.resolve,fe.reject)},D.prototype.I=function(Y,fe){var be=this.j();try{Y.call(fe,be.resolve,be.reject)}catch(_e){be.reject(_e)}},D.prototype.then=function(Y,fe){function be(st,Le){return typeof st=="function"?function(at){try{_e(st(at))}catch(ct){Oe(ct)}}:Le}var _e,Oe,nt=new D((function(st,Le){_e=st,Oe=Le}));return this.M(be(Y,_e),be(fe,Oe)),nt},D.prototype.catch=function(Y){return this.then(void 0,Y)},D.prototype.M=function(Y,fe){function be(){switch(_e.h){case 1:Y(_e.i);break;case 2:fe(_e.i);break;default:throw Error("Unexpected state: "+_e.h)}}var _e=this;this.g==null?H.h(be):this.g.push(be),this.s=!0},D.resolve=W,D.reject=function(Y){return new D((function(fe,be){be(Y)}))},D.race=function(Y){return new D((function(fe,be){for(var _e=i(Y),Oe=_e.next();!Oe.done;Oe=_e.next())W(Oe.value).M(fe,be)}))},D.all=function(Y){var fe=i(Y),be=fe.next();return be.done?W([]):new D((function(_e,Oe){function nt(at){return function(ct){st[at]=ct,--Le==0&&_e(st)}}var st=[],Le=0;do st.push(void 0),Le++,W(be.value).M(nt(st.length-1),Oe),be=fe.next();while(!be.done)}))},D}));var L=typeof Object.assign=="function"?Object.assign:function(I,D){for(var V=1;V<arguments.length;V++){var W=arguments[V];if(W)for(var X in W)Object.prototype.hasOwnProperty.call(W,X)&&(I[X]=W[X])}return I};r("Object.assign",(function(I){return I||L})),r("Object.is",(function(I){return I||function(D,V){return D===V?D!==0||1/D==1/V:D!=D&&V!=V}})),r("Array.prototype.includes",(function(I){return I||function(D,V){var W=this;W instanceof String&&(W=String(W));var X=W.length;for(0>(V=V||0)&&(V=Math.max(V+X,0));V<X;V++){var H=W[V];if(H===D||Object.is(H,D))return!0}return!1}})),r("String.prototype.includes",(function(I){return I||function(D,V){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(D instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(D,V||0)!==-1}})),r("Array.prototype.keys",(function(I){return I||function(){return(function(D,V){D instanceof String&&(D+="");var W=0,X=!1,H={next:function(){if(!X&&W<D.length){var Y=W++;return{value:V(Y,D[Y]),done:!1}}return X=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H})(this,(function(D){return D}))}}));var z=this||self;function M(I,D){I=I.split(".");var V,W=z;for((I[0]in W)||W.execScript===void 0||W.execScript("var "+I[0]);I.length&&(V=I.shift());)I.length||D===void 0?W=W[V]&&W[V]!==Object.prototype[V]?W[V]:W[V]={}:W[V]=D}function P(){throw Error("Invalid UTF8")}function F(I,D){return D=String.fromCharCode.apply(null,D),I==null?D:I+D}var q,ee,ue=typeof TextDecoder<"u",ie=typeof TextEncoder<"u",de={},ae=null;function J(I){var D;D===void 0&&(D=0),oe(),D=de[D];for(var V=Array(Math.floor(I.length/3)),W=D[64]||"",X=0,H=0;X<I.length-2;X+=3){var Y=I[X],fe=I[X+1],be=I[X+2],_e=D[Y>>2];Y=D[(3&Y)<<4|fe>>4],fe=D[(15&fe)<<2|be>>6],be=D[63&be],V[H++]=_e+Y+fe+be}switch(_e=0,be=W,I.length-X){case 2:be=D[(15&(_e=I[X+1]))<<2]||W;case 1:I=I[X],V[H]=D[I>>2]+D[(3&I)<<4|_e>>4]+be+W}return V.join("")}function te(I){var D=I.length,V=3*D/4;V%3?V=Math.floor(V):"=.".indexOf(I[D-1])!=-1&&(V="=.".indexOf(I[D-2])!=-1?V-2:V-1);var W=new Uint8Array(V),X=0;return(function(H,Y){function fe(Le){for(;be<H.length;){var at=H.charAt(be++),ct=ae[at];if(ct!=null)return ct;if(!/^[\s\xa0]*$/.test(at))throw Error("Unknown base64 encoding at char: "+at)}return Le}oe();for(var be=0;;){var _e=fe(-1),Oe=fe(0),nt=fe(64),st=fe(64);if(st===64&&_e===-1)break;Y(_e<<2|Oe>>4),nt!=64&&(Y(Oe<<4&240|nt>>2),st!=64&&Y(nt<<6&192|st))}})(I,(function(H){W[X++]=H})),X!==V?W.subarray(0,X):W}function oe(){if(!ae){ae={};for(var I="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),D=["+/=","+/","-_=","-_.","-_"],V=0;5>V;V++){var W=I.concat(D[V].split(""));de[V]=W;for(var X=0;X<W.length;X++){var H=W[X];ae[H]===void 0&&(ae[H]=X)}}}}var G,ne=typeof Uint8Array=="function";function ye(I){return ne&&I!=null&&I instanceof Uint8Array}function Te(I){if(this.L=I,I!==null&&I.length===0)throw Error("ByteString should be constructed with non-empty values")}var Se=typeof Uint8Array.prototype.slice=="function",Ie=0;function Re(I,D){return Error("Invalid wire type: "+I+" (at position "+D+")")}function Fe(){return Error("Failed to read varint, encoding is invalid.")}function Pe(I,D){D=(D=D===void 0?{}:D).v!==void 0&&D.v,this.h=null,this.g=this.i=this.j=0,this.v=D,I&&Qe(this,I)}function Qe(I,D){I.h=(function(V,W){if(V.constructor===Uint8Array)return V;if(V.constructor===ArrayBuffer)return new Uint8Array(V);if(V.constructor===Array)return new Uint8Array(V);if(V.constructor===String)return te(V);if(V.constructor===Te)return!W&&(W=V.L)&&W.constructor===Uint8Array?W:(W=(W=V.L)==null||ye(W)?W:typeof W=="string"?te(W):null,(V=V.L=W)?new Uint8Array(V):G||(G=new Uint8Array(0)));if(V instanceof Uint8Array)return new Uint8Array(V.buffer,V.byteOffset,V.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")})(D,I.v),I.j=0,I.i=I.h.length,I.g=I.j}function je(I){if(I.g>I.i)throw Error("Tried to read past the end of the data "+I.g+" > "+I.i)}function yt(I){var D=I.h,V=D[I.g],W=127&V;if(128>V)return I.g+=1,je(I),W;if(W|=(127&(V=D[I.g+1]))<<7,128>V)return I.g+=2,je(I),W;if(W|=(127&(V=D[I.g+2]))<<14,128>V)return I.g+=3,je(I),W;if(W|=(127&(V=D[I.g+3]))<<21,128>V)return I.g+=4,je(I),W;if(V=D[I.g+4],I.g+=5,W|=(15&V)<<28,128>V)return je(I),W;if(128<=D[I.g++]&&128<=D[I.g++]&&128<=D[I.g++]&&128<=D[I.g++]&&128<=D[I.g++])throw Fe();return je(I),W}Pe.prototype.reset=function(){this.g=this.j};var Nt=[];function At(){this.g=[]}function It(I,D){for(;127<D;)I.g.push(127&D|128),D>>>=7;I.g.push(D)}function Et(I){var D={},V=D.W!==void 0&&D.W;this.l={v:D.v!==void 0&&D.v},this.W=V,D=this.l,Nt.length?(V=Nt.pop(),D&&(V.v=D.v),I&&Qe(V,I),I=V):I=new Pe(I,D),this.g=I,this.j=this.g.g,this.h=this.i=-1}function Lt(I){var D=I.g;if(D.g==D.i)return!1;I.j=I.g.g;var V=yt(I.g)>>>0;if(D=V>>>3,!(0<=(V&=7)&&5>=V))throw Re(V,I.j);if(1>D)throw Error("Invalid field number: "+D+" (at position "+I.j+")");return I.i=D,I.h=V,!0}function Ot(I){switch(I.h){case 0:if(I.h!=0)Ot(I);else e:{for(var D=(I=I.g).g,V=D+10;D<V;)if((128&I.h[D++])==0){I.g=D,je(I);break e}throw Fe()}break;case 1:(I=I.g).g+=8,je(I);break;case 2:I.h!=2?Ot(I):(D=yt(I.g)>>>0,(I=I.g).g+=D,je(I));break;case 5:(I=I.g).g+=4,je(I);break;case 3:for(D=I.i;;){if(!Lt(I))throw Error("Unmatched start-group tag: stream EOF");if(I.h==4){if(I.i!=D)throw Error("Unmatched end-group tag");break}Ot(I)}break;default:throw Re(I.h,I.j)}}At.prototype.length=function(){return this.g.length},At.prototype.end=function(){var I=this.g;return this.g=[],I},Et.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};var Kn=[];function Xt(){this.i=[],this.h=0,this.g=new At}function yn(I,D){D.length!==0&&(I.i.push(D),I.h+=D.length)}var xn=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol(void 0):void 0;function rr(I,D){Object.isFrozen(I)||(xn?I[xn]|=D:I.N!==void 0?I.N|=D:Object.defineProperties(I,{N:{value:D,configurable:!0,writable:!0,enumerable:!1}}))}function is(I){var D;return(D=xn?I[xn]:I.N)==null?0:D}function Xn(I){return rr(I,1),I}function as(I){return!!Array.isArray(I)&&!!(2&is(I))}function fs(I){if(!Array.isArray(I))throw Error("cannot mark non-array as immutable");rr(I,2)}function hs(I){return I!==null&&typeof I=="object"&&!Array.isArray(I)&&I.constructor===Object}var or=Object.freeze(Xn([]));function wr(I){if(as(I.m))throw Error("Cannot mutate an immutable Message")}var Cr,Ll=typeof Symbol<"u"&&Symbol.hasInstance!==void 0;function po(I){return{value:I,configurable:!1,writable:!1,enumerable:!1}}function ps(I,D,V){return D===-1?null:D>=I.i?I.g?I.g[D]:void 0:V!==void 0&&V&&I.g&&(V=I.g[D])!=null?V:I.m[D+I.h]}function pn(I,D,V,W){W=W!==void 0&&W,wr(I),D<I.i&&!W?I.m[D+I.h]=V:(I.g||(I.g=I.m[I.i+I.h]={}))[D]=V}function Ol(I,D,V,W){V=V===void 0||V;var X=ps(I,D,W=W!==void 0&&W);return X==null&&(X=or),as(I.m)?V&&(fs(X),Object.freeze(X)):(X===or||as(X))&&pn(I,D,X=Xn(X.slice()),W),X}function zs(I,D,V){return(I=(I=ps(I,D))==null?I:+I)==null?V===void 0?0:V:I}function Ei(I,D,V,W){I.j||(I.j={});var X=as(I.m),H=I.j[V];if(!H){W=Ol(I,V,!0,W!==void 0&&W),H=[],X=X||as(W);for(var Y=0;Y<W.length;Y++)H[Y]=new D(W[Y]),X&&fs(H[Y].m);X&&(fs(H),Object.freeze(H)),I.j[V]=H}return H}function Vl(I,D,V,W,X){var H=H!==void 0&&H;return wr(I),H=Ei(I,V,D,H),V=W||new V,I=Ol(I,D),X!=null?(H.splice(X,0,V),I.splice(X,0,V.m)):(H.push(V),I.push(V.m)),V}function Bl(I,D){return(I=ps(I,D))==null?0:I}function Bo(I,D){return(I=ps(I,D))==null?"":I}function zo(I){var D=mp;return dd(I,D=D===void 0?gp:D)}function cd(I,D){if(I!=null){if(Array.isArray(I))I=dd(I,D);else if(hs(I)){var V,W={};for(V in I)W[V]=cd(I[V],D);I=W}else I=D(I);return I}}function dd(I,D){for(var V=I.slice(),W=0;W<V.length;W++)V[W]=cd(V[W],D);return Array.isArray(I)&&1&is(I)&&Xn(V),V}function mp(I){return I&&typeof I=="object"&&I.toJSON?I.toJSON():(I=(function(D){switch(typeof D){case"number":return isFinite(D)?D:String(D);case"object":if(D&&!Array.isArray(D)){if(ye(D))return J(D);if(D instanceof Te){var V=D.L;return V=V==null||typeof V=="string"?V:ne&&V instanceof Uint8Array?J(V):null,(D.L=V)||""}}}return D})(I),Array.isArray(I)?zo(I):I)}function gp(I){return ye(I)?new Uint8Array(I):I}function ba(I,D,V){I||(I=Cr),Cr=null;var W=this.constructor.h;if(I||(I=W?[W]:[]),this.h=(W?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=I,I=(W=this.m.length)-1,W&&hs(W=this.m[I])?(this.i=I-this.h,this.g=W):D!==void 0&&-1<D?(this.i=Math.max(D,I+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE,V)for(D=0;D<V.length;D++)if((I=V[D])<this.i)I+=this.h,(W=this.m[I])?Array.isArray(W)&&Xn(W):this.m[I]=or;else{var X=(W=this.g||(this.g=this.m[this.i+this.h]={}))[I];X?Array.isArray(X)&&Xn(X):W[I]=or}}function $i(){ba.apply(this,arguments)}if(ba.prototype.toJSON=function(){return zo(this.m)},ba.prototype.toString=function(){return this.m.toString()},y($i,ba),Ll){var fd={};Object.defineProperties($i,(fd[Symbol.hasInstance]=po((function(){throw Error("Cannot perform instanceof checks for MutableMessage")})),fd))}function Ai(I,D,V){if(V){var W,X={};for(W in V){var H=V[W],Y=H.ha;Y||(X.F=H.la||H.fa.P,H.aa?(X.U=zl(H.aa),Y=(function(fe){return function(be,_e,Oe){return fe.F(be,_e,Oe,fe.U)}})(X)):H.ca?(X.T=xp(H.X.g,H.ca),Y=(function(fe){return function(be,_e,Oe){return fe.F(be,_e,Oe,fe.T)}})(X)):Y=X.F,H.ha=Y),Y(D,I,H.X),X={F:X.F,U:X.U,T:X.T}}}(function(fe,be){if(be=be.ba){yn(fe,fe.g.end());for(var _e=0;_e<be.length;_e++)yn(fe,be[_e])}})(D,I)}var _i=Symbol();function Ri(I,D,V){return I[_i]||(I[_i]=function(W,X){return D(W,X,V)})}function yp(I){var D=I[_i];if(!D){var V=kp(I);D=function(W,X){return sn(W,X,V)},I[_i]=D}return D}function Ia(I){var D=(function(X){var H=X.aa;return H?yp(H):(H=X.ka)?Ri(X.X.g,H,X.ca):void 0})(I),V=I.X,W=I.fa.O;return D?function(X,H){return W(X,H,V,D)}:function(X,H){return W(X,H,V)}}function ka(I,D,V,W,X,H){var Y=0;for((I=I()).length&&typeof I[0]!="number"&&(V(D,I[0]),Y++);Y<I.length;){V=I[Y++];for(var fe=Y+1;fe<I.length&&typeof I[fe]!="number";)fe++;var be=I[Y++];switch(fe-=Y){case 0:W(D,V,be);break;case 1:W(D,V,be,I[Y++]);break;case 2:X(D,V,be,I[Y++],I[Y++]);break;case 3:fe=I[Y++];var _e=I[Y++],Oe=I[Y++];Array.isArray(Oe)?X(D,V,be,fe,_e,Oe):H(D,V,be,fe,_e,Oe);break;case 4:H(D,V,be,I[Y++],I[Y++],I[Y++],I[Y++]);break;default:throw Error("unexpected number of binary field arguments: "+fe)}}return D}var Uo=Symbol();function zl(I){var D=I[Uo];if(!D){var V=Tp(I);D=function(W,X){return Ul(W,X,V)},I[Uo]=D}return D}function xp(I,D){var V=I[Uo];return V||(V=function(W,X){return Ai(W,X,D)},I[Uo]=V),V}var vp=Symbol();function u0(I,D){I.push(D)}function Wo(I,D,V){I.push(D,V.P)}function wp(I,D,V,W,X){var H=zl(X),Y=V.P;I.push(D,(function(fe,be,_e){return Y(fe,be,_e,W,H)}))}function Cp(I,D,V,W,X,H){var Y=xp(W,H),fe=V.P;I.push(D,(function(be,_e,Oe){return fe(be,_e,Oe,W,Y)}))}function Tp(I){var D=I[vp];return D||ka(I,I[vp]=[],u0,Wo,wp,Cp)}var hd=Symbol();function Sp(I,D){I[0]=D}function bp(I,D,V,W){var X=V.O;I[D]=W?function(H,Y,fe){return X(H,Y,fe,W)}:X}function Ip(I,D,V,W,X,H){var Y=V.O,fe=yp(X);I[D]=function(be,_e,Oe){return Y(be,_e,Oe,W,fe,H)}}function c0(I,D,V,W,X,H,Y){var fe=V.O,be=Ri(W,X,H);I[D]=function(_e,Oe,nt){return fe(_e,Oe,nt,W,be,Y)}}function kp(I){var D=I[hd];return D||ka(I,I[hd]={},Sp,bp,Ip,c0)}function sn(I,D,V){for(;Lt(D)&&D.h!=4;){var W=D.i,X=V[W];if(!X){var H=V[0];H&&(H=H[W])&&(X=V[W]=Ia(H))}if(!(X&&X(D,I,W)||(X=D,W=I,H=X.j,Ot(X),X.W))){var Y=X.g.h;X=H===(X=X.g.g)?G||(G=new Uint8Array(0)):Se?Y.slice(H,X):new Uint8Array(Y.subarray(H,X)),(H=W.ba)?H.push(X):W.ba=[X]}}return I}function pd(I,D,V){if(Kn.length){var W=Kn.pop();I&&(Qe(W.g,I),W.i=-1,W.h=-1),I=W}else I=new Et(I);try{return sn(new D,I,kp(V))}finally{(D=I.g).h=null,D.j=0,D.i=0,D.g=0,D.v=!1,I.i=-1,I.h=-1,100>Kn.length&&Kn.push(I)}}function Ul(I,D,V){for(var W=V.length,X=W%2==1,H=X?1:0;H<W;H+=2)(0,V[H+1])(D,I,V[H]);Ai(I,D,X?V[0]:void 0)}function Wl(I,D){var V=new Xt;Ul(I,V,Tp(D)),yn(V,V.g.end()),I=new Uint8Array(V.h);for(var W=(D=V.i).length,X=0,H=0;H<W;H++){var Y=D[H];I.set(Y,X),X+=Y.length}return V.i=[I],I}function mo(I,D){return{O:I,P:D}}var ir=mo((function(I,D,V){if(I.h!==5)return!1;var W=(I=I.g).h[I.g],X=I.h[I.g+1],H=I.h[I.g+2],Y=I.h[I.g+3];return I.g+=4,je(I),I=2*((X=(W<<0|X<<8|H<<16|Y<<24)>>>0)>>31)+1,W=X>>>23&255,X&=8388607,pn(D,V,W==255?X?NaN:1/0*I:W==0?I*Math.pow(2,-149)*X:I*Math.pow(2,W-150)*(X+Math.pow(2,23))),!0}),(function(I,D,V){if((D=ps(D,V))!=null){It(I.g,8*V+5),I=I.g;var W=D;(W=(V=0>W?1:0)?-W:W)===0?0<1/W?Ie=0:Ie=2147483648:isNaN(W)?Ie=2147483647:34028234663852886e22<W?Ie=(V<<31|2139095040)>>>0:11754943508222875e-54>W?(W=Math.round(W/Math.pow(2,-149)),Ie=(V<<31|W)>>>0):(D=Math.floor(Math.log(W)/Math.LN2),W*=Math.pow(2,-D),16777216<=(W=Math.round(8388608*W))&&++D,Ie=(V<<31|D+127<<23|8388607&W)>>>0),V=Ie,I.g.push(V>>>0&255),I.g.push(V>>>8&255),I.g.push(V>>>16&255),I.g.push(V>>>24&255)}})),Np=mo((function(I,D,V){if(I.h!==0)return!1;for(var W=I.g,X=128,H=0,Y=I=0;4>Y&&128<=X;Y++)X=W.h[W.g++],je(W),H|=(127&X)<<7*Y;if(128<=X&&(X=W.h[W.g++],je(W),H|=(127&X)<<28,I|=(127&X)>>4),128<=X)for(Y=0;5>Y&&128<=X;Y++)X=W.h[W.g++],je(W),I|=(127&X)<<7*Y+3;if(!(128>X))throw Fe();return W=H>>>0,(I=2147483648&(X=I>>>0))&&(X=~X>>>0,(W=1+~W>>>0)==0&&(X=X+1>>>0)),W=4294967296*X+(W>>>0),pn(D,V,I?-W:W),!0}),(function(I,D,V){if((D=ps(D,V))!=null&&D!=null){It(I.g,8*V),I=I.g;var W=D;for(V=0>W,D=(W=Math.abs(W))>>>0,W=Math.floor((W-D)/4294967296),W>>>=0,V&&(W=~W>>>0,4294967295<(D=1+(~D>>>0))&&(D=0,4294967295<++W&&(W=0))),V=Ie=D,D=W;0<D||127<V;)I.g.push(127&V|128),V=(V>>>7|D<<25)>>>0,D>>>=7;I.g.push(V)}})),Gl=mo((function(I,D,V){return I.h===0&&(pn(D,V,yt(I.g)),!0)}),(function(I,D,V){if((D=ps(D,V))!=null&&D!=null)if(It(I.g,8*V),I=I.g,0<=(V=D))It(I,V);else{for(D=0;9>D;D++)I.g.push(127&V|128),V>>=7;I.g.push(1)}})),ar=mo((function(I,D,V){if(I.h!==2)return!1;var W,X=yt(I.g)>>>0,H=(I=I.g).g;if(I.g+=X,je(I),I=I.h,ue)(W=q)||(W=q=new TextDecoder("utf-8",{fatal:!0})),W=W.decode(I.subarray(H,H+X));else{X=H+X;for(var Y,fe,be,_e=[],Oe=null;H<X;)128>(Y=I[H++])?_e.push(Y):224>Y?H>=X?P():(fe=I[H++],194>Y||(192&fe)!=128?(H--,P()):_e.push((31&Y)<<6|63&fe)):240>Y?H>=X-1?P():(192&(fe=I[H++]))!=128||Y===224&&160>fe||Y===237&&160<=fe||(192&(W=I[H++]))!=128?(H--,P()):_e.push((15&Y)<<12|(63&fe)<<6|63&W):244>=Y?H>=X-2?P():(192&(fe=I[H++]))!=128||fe-144+(Y<<28)>>30!=0||(192&(W=I[H++]))!=128||(192&(be=I[H++]))!=128?(H--,P()):(Y=(7&Y)<<18|(63&fe)<<12|(63&W)<<6|63&be,Y-=65536,_e.push(55296+(Y>>10&1023),56320+(1023&Y))):P(),8192<=_e.length&&(Oe=F(Oe,_e),_e.length=0);W=F(Oe,_e)}return pn(D,V,W),!0}),(function(I,D,V){if((D=ps(D,V))!=null){var W=!1;if(W=W!==void 0&&W,ie){if(W&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(D))throw Error("Found an unpaired surrogate");D=(ee||(ee=new TextEncoder)).encode(D)}else{for(var X=0,H=new Uint8Array(3*D.length),Y=0;Y<D.length;Y++){var fe=D.charCodeAt(Y);if(128>fe)H[X++]=fe;else{if(2048>fe)H[X++]=fe>>6|192;else{if(55296<=fe&&57343>=fe){if(56319>=fe&&Y<D.length){var be=D.charCodeAt(++Y);if(56320<=be&&57343>=be){fe=1024*(fe-55296)+be-56320+65536,H[X++]=fe>>18|240,H[X++]=fe>>12&63|128,H[X++]=fe>>6&63|128,H[X++]=63&fe|128;continue}Y--}if(W)throw Error("Found an unpaired surrogate");fe=65533}H[X++]=fe>>12|224,H[X++]=fe>>6&63|128}H[X++]=63&fe|128}}D=H.subarray(0,X)}It(I.g,8*V+2),It(I.g,D.length),yn(I,I.g.end()),yn(I,D)}})),Ep=mo((function(I,D,V,W,X){if(I.h!==2)return!1;D=Vl(D,V,W),V=I.g.i,W=yt(I.g)>>>0;var H=I.g.g+W,Y=H-V;if(0>=Y&&(I.g.i=H,X(D,I),Y=H-I.g.g),Y)throw Error("Message parsing ended unexpectedly. Expected to read "+W+" bytes, instead read "+(W-Y)+" bytes, either the data ended unexpectedly or the message misreported its own length");return I.g.g=H,I.g.i=V,!0}),(function(I,D,V,W,X){if((D=Ei(D,W,V))!=null)for(W=0;W<D.length;W++){var H=I;It(H.g,8*V+2);var Y=H.g.end();yn(H,Y),Y.push(H.h),H=Y,X(D[W],I),Y=I;var fe=H.pop();for(fe=Y.h+Y.g.length()-fe;127<fe;)H.push(127&fe|128),fe>>>=7,Y.h++;H.push(fe),Y.h++}}));function rn(){$i.apply(this,arguments)}if(y(rn,$i),Ll){var $p={};Object.defineProperties(rn,($p[Symbol.hasInstance]=po(Object[Symbol.hasInstance]),$p))}function Na(I){rn.call(this,I)}function Ap(){return[1,Gl,2,ir,3,ar,4,ar]}function Di(I){rn.call(this,I,-1,Ea)}function Hl(){return[1,Ep,Na,Ap]}y(Na,rn),y(Di,rn),Di.prototype.addClassification=function(I,D){return Vl(this,1,Na,I,D),this};var Ea=[1];function Go(I){rn.call(this,I)}function _p(){return[1,ir,2,ir,3,ir,4,ir,5,ir]}function Rp(I){rn.call(this,I,-1,Dp)}function md(){return[1,Ep,Go,_p]}y(Go,rn),y(Rp,rn);var Dp=[1];function $a(I){rn.call(this,I)}function Fi(){return[1,ir,2,ir,3,ir,4,ir,5,ir,6,Np]}y($a,rn);var Fp=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],ql=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],Rt=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],gd=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],yd=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Kl=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],Mp=[].concat(a(Fp),a(ql),a(Rt),a(gd),a(yd),a(Kl));function xd(I,D,V){if(V=I.createShader(V===0?I.VERTEX_SHADER:I.FRAGMENT_SHADER),I.shaderSource(V,D),I.compileShader(V),!I.getShaderParameter(V,I.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+I.getShaderInfoLog(V));return V}function Pp(I){return Ei(I,Na,1).map((function(D){return{index:Bl(D,1),ga:zs(D,2),label:ps(D,3)!=null?Bo(D,3):void 0,displayName:ps(D,4)!=null?Bo(D,4):void 0}}))}function vd(I){return{x:zs(I,1),y:zs(I,2),z:zs(I,3),visibility:ps(I,4)!=null?zs(I,4):void 0}}function Mi(I,D){this.h=I,this.g=D,this.l=0}function Hr(I,D,V){return(function(W,X){var H=W.g;if(W.o===void 0){var Y=xd(H,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),fe=xd(H,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),be=H.createProgram();if(H.attachShader(be,Y),H.attachShader(be,fe),H.linkProgram(be),!H.getProgramParameter(be,H.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+H.getProgramInfoLog(be));Y=W.o=be,H.useProgram(Y),fe=H.getUniformLocation(Y,"sampler0"),W.j={K:H.getAttribLocation(Y,"aVertex"),J:H.getAttribLocation(Y,"aTex"),ma:fe},W.u=H.createBuffer(),H.bindBuffer(H.ARRAY_BUFFER,W.u),H.enableVertexAttribArray(W.j.K),H.vertexAttribPointer(W.j.K,2,H.FLOAT,!1,0,0),H.bufferData(H.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),H.STATIC_DRAW),H.bindBuffer(H.ARRAY_BUFFER,null),W.s=H.createBuffer(),H.bindBuffer(H.ARRAY_BUFFER,W.s),H.enableVertexAttribArray(W.j.J),H.vertexAttribPointer(W.j.J,2,H.FLOAT,!1,0,0),H.bufferData(H.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),H.STATIC_DRAW),H.bindBuffer(H.ARRAY_BUFFER,null),H.uniform1i(fe,0)}Y=W.j,H.useProgram(W.o),H.canvas.width=X.width,H.canvas.height=X.height,H.viewport(0,0,X.width,X.height),H.activeTexture(H.TEXTURE0),W.h.bindTexture2d(X.glName),H.enableVertexAttribArray(Y.K),H.bindBuffer(H.ARRAY_BUFFER,W.u),H.vertexAttribPointer(Y.K,2,H.FLOAT,!1,0,0),H.enableVertexAttribArray(Y.J),H.bindBuffer(H.ARRAY_BUFFER,W.s),H.vertexAttribPointer(Y.J,2,H.FLOAT,!1,0,0),H.bindFramebuffer(H.DRAW_FRAMEBUFFER?H.DRAW_FRAMEBUFFER:H.FRAMEBUFFER,null),H.clearColor(0,0,0,0),H.clear(H.COLOR_BUFFER_BIT),H.colorMask(!0,!0,!0,!0),H.drawArrays(H.TRIANGLE_FAN,0,4),H.disableVertexAttribArray(Y.K),H.disableVertexAttribArray(Y.J),H.bindBuffer(H.ARRAY_BUFFER,null),W.h.bindTexture2d(0)})(I,D),typeof I.g.canvas.transferToImageBitmap=="function"?Promise.resolve(I.g.canvas.transferToImageBitmap()):V?Promise.resolve(I.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(I.g.canvas):(I.i===void 0&&(I.i=document.createElement("canvas")),new Promise((function(W){I.i.height=I.g.canvas.height,I.i.width=I.g.canvas.width,I.i.getContext("2d",{}).drawImage(I.g.canvas,0,0,I.g.canvas.width,I.g.canvas.height),W(I.i)})))}function go(I){this.g=I}var yo=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function Aa(I,D){return D+I}function Pi(I,D){window[I]=D}function Tr(I){if(this.g=I,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.Z=!0,this.D=Promise.resolve(),this.Y="",this.C={},this.locateFile=I&&I.locateFile||Aa,typeof window=="object")var D=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(typeof location>"u")throw Error("solutions can only be loaded on a web page or in a web worker");D=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.$=D,I.options)for(var V=(D=i(Object.keys(I.options))).next();!V.done;V=D.next()){V=V.value;var W=I.options[V].default;W!==void 0&&(this.j[V]=typeof W=="function"?W():W)}}function d0(I){var D,V,W,X,H,Y,fe,be,_e,Oe,nt;return R((function(st){switch(st.g){case 1:return I.Z?(D=I.g.files===void 0?[]:typeof I.g.files=="function"?I.g.files(I.j):I.g.files,S(st,R((function(Le){switch(Le.g){case 1:return Le.o=2,S(Le,WebAssembly.instantiate(yo),4);case 4:Le.g=3,Le.o=0;break;case 2:return Le.o=0,Le.j=null,Le.return(!1);case 3:return Le.return(!0)}})),2)):st.return();case 2:if(V=st.h,typeof window=="object")return Pi("createMediapipeSolutionsWasm",{locateFile:I.locateFile}),Pi("createMediapipeSolutionsPackedAssets",{locateFile:I.locateFile}),Y=D.filter((function(Le){return Le.data!==void 0})),fe=D.filter((function(Le){return Le.data===void 0})),be=Promise.all(Y.map((function(Le){var at=_a(I,Le.url);if(Le.path!==void 0){var ct=Le.path;at=at.then((function(Ft){return I.overrideFile(ct,Ft),Promise.resolve(Ft)}))}return at}))),_e=Promise.all(fe.map((function(Le){return Le.simd===void 0||Le.simd&&V||!Le.simd&&!V?(function(at){var ct=document.createElement("script");return ct.setAttribute("src",at),ct.setAttribute("crossorigin","anonymous"),new Promise((function(Ft){ct.addEventListener("load",(function(){Ft()}),!1),ct.addEventListener("error",(function(){Ft()}),!1),document.body.appendChild(ct)}))})(I.locateFile(Le.url,I.$)):Promise.resolve()}))).then((function(){var Le,at,ct;return R((function(Ft){if(Ft.g==1)return Le=window.createMediapipeSolutionsWasm,at=window.createMediapipeSolutionsPackedAssets,ct=I,S(Ft,Le(at),2);ct.h=Ft.h,Ft.g=0}))})),Oe=R((function(Le){return I.g.graph&&I.g.graph.url?Le=S(Le,_a(I,I.g.graph.url),0):(Le.g=0,Le=void 0),Le})),S(st,Promise.all([_e,be,Oe]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return W=D.filter((function(Le){return Le.simd===void 0||Le.simd&&V||!Le.simd&&!V})).map((function(Le){return I.locateFile(Le.url,I.$)})),importScripts.apply(null,a(W)),X=I,S(st,createMediapipeSolutionsWasm(Module),6);case 6:X.h=st.h,I.l=new OffscreenCanvas(1,1),I.h.canvas=I.l,H=I.h.GL.createContext(I.l,{antialias:!1,alpha:!1,ja:typeof WebGL2RenderingContext<"u"?2:1}),I.h.GL.makeContextCurrent(H),st.g=4;break;case 7:if(I.l=document.createElement("canvas"),!(nt=I.l.getContext("webgl2",{}))&&!(nt=I.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),st.return();I.G=nt,I.h.canvas=I.l,I.h.createContext(I.l,!0,!0,{});case 4:I.i=new I.h.SolutionWasm,I.Z=!1,st.g=0}}))}function _a(I,D){var V,W;return R((function(X){return D in I.H?X.return(I.H[D]):(V=I.locateFile(D,""),W=fetch(V).then((function(H){return H.arrayBuffer()})),I.H[D]=W,X.return(W))}))}function Ra(I,D,V){var W,X,H,Y,fe,be,_e,Oe,nt,st,Le,at,ct,Ft;return R((function(Mt){switch(Mt.g){case 1:if(!V)return Mt.return(D);for(W={},X=0,H=i(Object.keys(V)),Y=H.next();!Y.done;Y=H.next())fe=Y.value,typeof(be=V[fe])!="string"&&be.type==="texture"&&D[be.stream]!==void 0&&++X;1<X&&(I.I=!1),_e=i(Object.keys(V)),Y=_e.next();case 2:if(Y.done){Mt.g=4;break}if(Oe=Y.value,typeof(nt=V[Oe])=="string")return ct=W,Ft=Oe,S(Mt,(function(Ho,Xl,xo){var vo;return R((function(Li){return typeof xo=="number"||xo instanceof Uint8Array||xo instanceof Ho.h.Uint8BlobList?Li.return(xo):xo instanceof Ho.h.Texture2dDataOut?((vo=Ho.u[Xl])||(vo=new Mi(Ho.h,Ho.G),Ho.u[Xl]=vo),Li.return(Hr(vo,xo,Ho.I))):Li.return(void 0)}))})(I,Oe,D[nt]),14);if(st=D[nt.stream],nt.type==="detection_list"){if(st){for(var An=st.getRectList(),Ds=st.getLandmarksList(),Wt=st.getClassificationsList(),vt=[],Sn=0;Sn<An.size();++Sn){var Us=pd(An.get(Sn),$a,Fi);Us={boundingBox:{xCenter:zs(Us,1),yCenter:zs(Us,2),height:zs(Us,3),width:zs(Us,4),rotation:zs(Us,5,0),rectId:Bl(Us,6)},landmarks:Ei(pd(Ds.get(Sn),Rp,md),Go,1).map(vd),V:Pp(pd(Wt.get(Sn),Di,Hl))},vt.push(Us)}An=vt}else An=[];W[Oe]=An,Mt.g=7;break}if(nt.type==="proto_list"){if(st){for(An=Array(st.size()),Ds=0;Ds<st.size();Ds++)An[Ds]=st.get(Ds);st.delete()}else An=[];W[Oe]=An,Mt.g=7;break}if(st===void 0){Mt.g=3;break}if(nt.type==="float_list"){W[Oe]=st,Mt.g=7;break}if(nt.type==="proto"){W[Oe]=st,Mt.g=7;break}if(nt.type!=="texture")throw Error("Unknown output config type: '"+nt.type+"'");return(Le=I.u[Oe])||(Le=new Mi(I.h,I.G),I.u[Oe]=Le),S(Mt,Hr(Le,st,I.I),13);case 13:at=Mt.h,W[Oe]=at;case 7:nt.transform&&W[Oe]&&(W[Oe]=nt.transform(W[Oe])),Mt.g=3;break;case 14:ct[Ft]=Mt.h;case 3:Y=_e.next(),Mt.g=2;break;case 4:return Mt.return(W)}}))}function f0(I,D){for(var V=D.name||"$",W=[].concat(a(D.wants)),X=new I.h.StringList,H=i(D.wants),Y=H.next();!Y.done;Y=H.next())X.push_back(Y.value);H=I.h.PacketListener.implement({onResults:function(fe){for(var be={},_e=0;_e<D.wants.length;++_e)be[W[_e]]=fe.get(_e);var Oe=I.listeners[V];Oe&&(I.D=Ra(I,be,D.outs).then((function(nt){nt=Oe(nt);for(var st=0;st<D.wants.length;++st){var Le=be[W[st]];typeof Le=="object"&&Le.hasOwnProperty&&Le.hasOwnProperty("delete")&&Le.delete()}nt&&(I.D=nt)})))}}),I.i.attachMultiListener(X,H),X.delete()}function wd(I){var D=this;I=I||{};var V={url:"face_detection_short.binarypb"},W={type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}};this.g=new Tr({locateFile:I.locateFile,files:[{data:!0,url:"face_detection_short.binarypb"},{data:!0,url:"face_detection_short_range.tflite"},{simd:!0,url:"face_detection_solution_simd_wasm_bin.js"},{simd:!1,url:"face_detection_solution_wasm_bin.js"}],graph:V,listeners:[{wants:["detections","image_transformed"],outs:{image:"image_transformed",detections:{type:"detection_list",stream:"detections"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window=="object"&&window.navigator!==void 0&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},model:{type:0,onChange:function(X){var H,Y,fe,be,_e;return R((function(Oe){switch(Oe.g){case 1:H=i(X==="short"?["face_detection_short_range.tflite"]:["face_detection_full_range_sparse.tflite"]),Y=H.next();case 2:if(Y.done){Oe.g=4;break}return fe=Y.value,be="third_party/mediapipe/modules/face_detection/"+fe,S(Oe,_a(D.g,fe),5);case 5:_e=Oe.h,D.g.overrideFile(be,_e),Y=H.next(),Oe.g=2;break;case 4:return V.url=X==="short"?"face_detection_short.binarypb":"face_detection_full.binarypb",W.graphOptionXref.calculatorName=X==="short"?"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator":"facedetectionfullrangegpu__facedetectionfullrangecommon__TensorsToDetectionsCalculator",Oe.return(!0)}}))}},minDetectionConfidence:W}})}(n=Tr.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},n.reset=function(){var I=this;return R((function(D){I.i&&(I.i.reset(),I.o={},I.u={}),D.g=0}))},n.setOptions=function(I,D){var V=this;if(D=D||this.g.options){for(var W=[],X=[],H={},Y=i(Object.keys(I)),fe=Y.next();!fe.done;H={R:H.R,S:H.S},fe=Y.next()){var be=fe.value;be in this.j&&this.j[be]===I[be]||(this.j[be]=I[be],(fe=D[be])!==void 0&&(fe.onChange&&(H.R=fe.onChange,H.S=I[be],W.push((function(_e){return function(){return R((function(Oe){if(Oe.g==1)return S(Oe,_e.R(_e.S),2);Oe.h===!0&&(V.s=!0),Oe.g=0}))}})(H))),fe.graphOptionXref&&(be={valueNumber:fe.type===1?I[be]:0,valueBoolean:fe.type===0&&I[be],valueString:fe.type===2?I[be]:""},fe=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),fe.graphOptionXref),be),X.push(fe))))}W.length===0&&X.length===0||(this.s=!0,this.B=(this.B===void 0?[]:this.B).concat(X),this.A=(this.A===void 0?[]:this.A).concat(W))}},n.initialize=function(){var I=this;return R((function(D){return D.g==1?S(D,d0(I),2):D.g!=3?S(D,(function(V){var W,X,H,Y,fe,be,_e,Oe;return R((function(nt){if(nt.g==1)return V.g.graph&&V.g.graph.url&&V.Y===V.g.graph.url?nt.return():(V.s=!0,V.g.graph&&V.g.graph.url?(V.Y=V.g.graph.url,S(nt,_a(V,V.g.graph.url),3)):void(nt.g=2));for(nt.g!=2&&(W=nt.h,V.i.loadGraph(W)),X=i(Object.keys(V.C)),H=X.next();!H.done;H=X.next())Y=H.value,V.i.overrideFile(Y,V.C[Y]);if(V.C={},V.g.listeners)for(fe=i(V.g.listeners),be=fe.next();!be.done;be=fe.next())_e=be.value,f0(V,_e);Oe=V.j,V.j={},V.setOptions(Oe),nt.g=0}))})(I),3):S(D,(function(V){var W,X,H,Y,fe,be;return R((function(_e){switch(_e.g){case 1:if(!V.s)return _e.return();if(!V.A){_e.g=2;break}W=i(V.A),X=W.next();case 3:if(X.done){_e.g=5;break}return S(_e,(0,X.value)(),4);case 4:X=W.next(),_e.g=3;break;case 5:V.A=void 0;case 2:if(V.B){for(H=new V.h.GraphOptionChangeRequestList,Y=i(V.B),fe=Y.next();!fe.done;fe=Y.next())be=fe.value,H.push_back(be);V.i.changeOptions(H),H.delete(),V.B=void 0}V.s=!1,_e.g=0}}))})(I),0)}))},n.overrideFile=function(I,D){this.i?this.i.overrideFile(I,D):this.C[I]=D},n.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},n.send=function(I,D){var V,W,X,H,Y,fe,be,_e,Oe,nt=this;return R((function(st){switch(st.g){case 1:return nt.g.inputs?(V=1e3*(D??performance.now()),S(st,nt.D,2)):st.return();case 2:return S(st,nt.initialize(),3);case 3:for(W=new nt.h.PacketDataList,X=i(Object.keys(I)),H=X.next();!H.done;H=X.next())if(Y=H.value,fe=nt.g.inputs[Y]){e:{var Le=I[Y];switch(fe.type){case"video":var at=nt.o[fe.stream];if(at||(at=new Mi(nt.h,nt.G),nt.o[fe.stream]=at),at.l===0&&(at.l=at.h.createTexture()),typeof HTMLVideoElement<"u"&&Le instanceof HTMLVideoElement)var ct=Le.videoWidth,Ft=Le.videoHeight;else typeof HTMLImageElement<"u"&&Le instanceof HTMLImageElement?(ct=Le.naturalWidth,Ft=Le.naturalHeight):(ct=Le.width,Ft=Le.height);Ft={glName:at.l,width:ct,height:Ft},(ct=at.g).canvas.width=Ft.width,ct.canvas.height=Ft.height,ct.activeTexture(ct.TEXTURE0),at.h.bindTexture2d(at.l),ct.texImage2D(ct.TEXTURE_2D,0,ct.RGBA,ct.RGBA,ct.UNSIGNED_BYTE,Le),at.h.bindTexture2d(0),at=Ft;break e;case"detections":for((at=nt.o[fe.stream])||(at=new go(nt.h),nt.o[fe.stream]=at),at.data||(at.data=new at.g.DetectionListData),at.data.reset(Le.length),Ft=0;Ft<Le.length;++Ft){ct=Le[Ft];var Mt=at.data,An=Mt.setBoundingBox,Ds=Ft,Wt=ct.boundingBox,vt=new $a;if(pn(vt,1,Wt.xCenter),pn(vt,2,Wt.yCenter),pn(vt,3,Wt.height),pn(vt,4,Wt.width),pn(vt,5,Wt.rotation),pn(vt,6,Wt.rectId),Wt=Wl(vt,Fi),An.call(Mt,Ds,Wt),ct.landmarks)for(Mt=0;Mt<ct.landmarks.length;++Mt){var Sn=!!(vt=ct.landmarks[Mt]).visibility;Ds=(An=at.data).addNormalizedLandmark,Wt=Ft,vt=Object.assign(Object.assign({},vt),{visibility:Sn?vt.visibility:0}),pn(Sn=new Go,1,vt.x),pn(Sn,2,vt.y),pn(Sn,3,vt.z),vt.visibility&&pn(Sn,4,vt.visibility),vt=Wl(Sn,_p),Ds.call(An,Wt,vt)}if(ct.V)for(Mt=0;Mt<ct.V.length;++Mt)Ds=(An=at.data).addClassification,Wt=Ft,vt=ct.V[Mt],pn(Sn=new Na,2,vt.ga),vt.index&&pn(Sn,1,vt.index),vt.label&&pn(Sn,3,vt.label),vt.displayName&&pn(Sn,4,vt.displayName),vt=Wl(Sn,Ap),Ds.call(An,Wt,vt)}at=at.data;break e;default:at={}}}switch(be=at,_e=fe.stream,fe.type){case"video":W.pushTexture2d(Object.assign(Object.assign({},be),{stream:_e,timestamp:V}));break;case"detections":(Oe=be).stream=_e,Oe.timestamp=V,W.pushDetectionList(Oe);break;default:throw Error("Unknown input config type: '"+fe.type+"'")}}return nt.i.send(W),S(st,nt.D,4);case 4:W.delete(),st.g=0}}))},n.onResults=function(I,D){this.listeners[D||"$"]=I},M("Solution",Tr),M("OptionType",{BOOL:0,NUMBER:1,ia:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(n=wd.prototype).close=function(){return this.g.close(),Promise.resolve()},n.onResults=function(I){this.g.onResults(I)},n.initialize=function(){var I=this;return R((function(D){return S(D,I.g.initialize(),0)}))},n.reset=function(){this.g.reset()},n.send=function(I){var D=this;return R((function(V){return S(V,D.g.send(I),0)}))},n.setOptions=function(I){this.g.setOptions(I)},M("FaceDetection",wd),M("FACEDETECTION_LIPS",Fp),M("FACEDETECTION_LEFT_EYE",ql),M("FACEDETECTION_LEFT_EYEBROW",Rt),M("FACEDETECTION_RIGHT_EYE",gd),M("FACEDETECTION_RIGHT_EYEBROW",yd),M("FACEDETECTION_FACE_OVAL",Kl),M("FACEDETECTION_CONTOURS",Mp),M("FACEDETECTION_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),M("VERSION","0.4.1646425229")}).call(ev);var ua=function(){return ua=Object.assign||function(n){for(var e,t=1,s=arguments.length;t<s;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},ua.apply(this,arguments)};function yi(n,e,t,s){return new(t||(t=Promise))((function(r,o){function i(u){try{l(s.next(u))}catch(d){o(d)}}function a(u){try{l(s.throw(u))}catch(d){o(d)}}function l(u){var d;u.done?r(u.value):(d=u.value,d instanceof t?d:new t((function(f){f(d)}))).then(i,a)}l((s=s.apply(n,[])).next())}))}function xi(n,e){var t,s,r,o,i={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(l){return function(u){return(function(d){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,s&&(r=2&d[0]?s.return:d[0]?s.throw||((r=s.return)&&r.call(s),0):s.next)&&!(r=r.call(s,d[1])).done)return r;switch(s=0,r&&(d=[2&d[0],r.value]),d[0]){case 0:case 1:r=d;break;case 4:return i.label++,{value:d[1],done:!1};case 5:i.label++,s=d[1],d=[0];continue;case 7:d=i.ops.pop(),i.trys.pop();continue;default:if(!((r=(r=i.trys).length>0&&r[r.length-1])||d[0]!==6&&d[0]!==2)){i=0;continue}if(d[0]===3&&(!r||d[1]>r[0]&&d[1]<r[3])){i.label=d[1];break}if(d[0]===6&&i.label<r[1]){i.label=r[1],r=d;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(d);break}r[2]&&i.ops.pop(),i.trys.pop();continue}d=e.call(n,i)}catch(f){d=[6,f],s=0}finally{t=r=0}if(5&d[0])throw d[1];return{value:d[0]?d[1]:void 0,done:!0}})([l,u])}}}var yA=["rightEye","leftEye","noseTip","mouthCenter","rightEarTragion","leftEarTragion"],tv={modelType:"short",runtime:"mediapipe",maxFaces:1},XJ=(function(){function n(e){var t=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceDetectorSolution=new KJ.FaceDetection({locateFile:function(s,r){if(e.solutionPath){var o=e.solutionPath.replace(/\/+$/,"");return"".concat(o,"/").concat(s)}return"".concat(r,"/").concat(s)}}),this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode,model:e.modelType}),this.faceDetectorSolution.onResults((function(s){if(t.height=s.image.height,t.width=s.image.width,t.faces=[],s.detections!==null)for(var r=0,o=s.detections;r<o.length;r++){var i=o[r];t.faces.push(t.normalizedToAbsolute(i.landmarks,{xMin:l=(a=i.boundingBox).xCenter-a.width/2,xMax:l+a.width,yMin:u=a.yCenter-a.height/2,yMax:u+a.height,width:a.width,height:a.height}))}var a,l,u}))}return n.prototype.normalizedToAbsolute=function(e,t){var s=this;return{keypoints:e.map((function(r,o){return{x:r.x*s.width,y:r.y*s.height,name:yA[o]}})),box:{xMin:t.xMin*this.width,yMin:t.yMin*this.height,xMax:t.xMax*this.width,yMax:t.yMax*this.height,width:t.width*this.width,height:t.height*this.height}}},n.prototype.estimateFaces=function(e,t){return yi(this,void 0,void 0,(function(){var s,r;return xi(this,(function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode})),e instanceof St?(r=ImageData.bind,[4,rw(e)]):[3,2];case 1:return s=new(r.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:s=e,o.label=3;case 3:return e=s,[4,this.faceDetectorSolution.send({image:e})];case 4:return o.sent(),[2,this.faces]}}))}))},n.prototype.dispose=function(){this.faceDetectorSolution.close()},n.prototype.reset=function(){this.faceDetectorSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},n.prototype.initialize=function(){return this.faceDetectorSolution.initialize()},n})();function JJ(n){return yi(this,void 0,void 0,(function(){var e,t;return xi(this,(function(s){switch(s.label){case 0:return e=(function(r){if(r==null)return ua({},tv);var o=ua({},r);return o.runtime="mediapipe",o.modelType==null&&(o.modelType=tv.modelType),o.maxFaces==null&&(o.maxFaces=tv.maxFaces),o})(n),[4,(t=new XJ(e)).initialize()];case 1:return s.sent(),[2,t]}}))}))}function xA(n){return n instanceof St?{height:n.shape[0],width:n.shape[1]}:{height:n.height,width:n.width}}function vA(n){return n instanceof St?n:ow(n)}function nv(n,e){B(n.width!==0,(function(){return"".concat(e," width cannot be 0.")})),B(n.height!==0,(function(){return"".concat(e," height cannot be 0.")}))}function YJ(n,e,t){var s=e.outputTensorSize,r=e.keepAspectRatio,o=e.borderMode,i=e.outputTensorFloatRange,a=xA(n),l=(function(p,y){return{xCenter:.5*p.width,yCenter:.5*p.height,width:p.width,height:p.height,rotation:0}})(a),u=(function(p,y,v){if(v===void 0&&(v=!1),!v)return{top:0,left:0,right:0,bottom:0};var w=y.height,C=y.width;nv(y,"targetSize"),nv(p,"roi");var S,b,E=w/C,N=p.height/p.width,A=0,R=0;return E>N?(S=p.width,b=p.width*E,R=(1-N/E)/2):(S=p.height/E,b=p.height,A=(1-E/N)/2),p.width=S,p.height=b,{top:R,left:A,right:A,bottom:R}})(l,s,r),d=(function(p,y,v,w){var C=p.width,S=p.height,b=1,E=Math.cos(p.rotation),N=Math.sin(p.rotation),A=p.xCenter,R=p.yCenter,L=1/y,z=1/v,M=new Array(16);return M[0]=C*E*b*L,M[1]=-S*N*L,M[2]=0,M[3]=(-.5*C*E*b+.5*S*N+A)*L,M[4]=C*N*b*z,M[5]=S*E*z,M[6]=0,M[7]=(-.5*S*E-.5*C*N*b+R)*z,M[8]=0,M[9]=0,M[10]=C*L,M[11]=0,M[12]=0,M[13]=0,M[14]=0,M[15]=1,(function(P){if(P.length!==16)throw new Error("Array length must be 16 but got ".concat(P.length));return[[P[0],P[1],P[2],P[3]],[P[4],P[5],P[6],P[7]],[P[8],P[9],P[10],P[11]],[P[12],P[13],P[14],P[15]]]})(M)})(l,a.width,a.height),f=he((function(){var p=vA(n),y=ui((function(C,S,b){return nv(b,"inputResolution"),[1/b.width*C[0][0]*S.width,1/b.height*C[0][1]*S.width,C[0][3]*S.width,1/b.width*C[1][0]*S.height,1/b.height*C[1][1]*S.height,C[1][3]*S.height,0,0]})(d,a,s),[1,8]),v=o==="zero"?"constant":"nearest",w=no.transform(Zn(Me(p,"float32")),y,"bilinear",v,0,[s.height,s.width]);return i!=null?(function(C,S){var b=(function(E,N,A,R){var L=(R-A)/255;return{scale:L,offset:A-0*L}})(0,0,S[0],S[1]);return he((function(){return ke(j(C,b.scale),b.offset)}))})(w,i):w}));return{imageTensor:f,padding:u,transformationMatrix:d}}function Xk(n){n.reduceBoxesInLowestLayer==null&&(n.reduceBoxesInLowestLayer=!1),n.interpolatedScaleAspectRatio==null&&(n.interpolatedScaleAspectRatio=1),n.fixedAnchorSize==null&&(n.fixedAnchorSize=!1);for(var e=[],t=0;t<n.numLayers;){for(var s=[],r=[],o=[],i=[],a=t;a<n.strides.length&&n.strides[a]===n.strides[t];){var l=Jk(n.minScale,n.maxScale,a,n.strides.length);if(a===0&&n.reduceBoxesInLowestLayer)o.push(1),o.push(2),o.push(.5),i.push(.1),i.push(l),i.push(l);else{for(var u=0;u<n.aspectRatios.length;++u)o.push(n.aspectRatios[u]),i.push(l);if(n.interpolatedScaleAspectRatio>0){var d=a===n.strides.length-1?1:Jk(n.minScale,n.maxScale,a+1,n.strides.length);i.push(Math.sqrt(l*d)),o.push(n.interpolatedScaleAspectRatio)}}a++}for(var f=0;f<o.length;++f){var p=Math.sqrt(o[f]);s.push(i[f]/p),r.push(i[f]*p)}var y=0,v=0;if(n.featureMapHeight.length>0)y=n.featureMapHeight[t],v=n.featureMapWidth[t];else{var w=n.strides[t];y=Math.ceil(n.inputSizeHeight/w),v=Math.ceil(n.inputSizeWidth/w)}for(var C=0;C<y;++C)for(var S=0;S<v;++S)for(var b=0;b<s.length;++b){var E={xCenter:(S+n.anchorOffsetX)/v,yCenter:(C+n.anchorOffsetY)/y,width:0,height:0};n.fixedAnchorSize?(E.width=1,E.height=1):(E.width=r[b],E.height=s[b]),e.push(E)}t=a}return e}function Jk(n,e,t,s){return s===1?.5*(n+e):n+(e-n)*t/(s-1)}function Yk(n,e){var t=e[0],s=e[1];return[t*n[0]+s*n[1]+n[3],t*n[4]+s*n[5]+n[7]]}function QJ(n,e,t,s){return yi(this,void 0,void 0,(function(){var r,o,i,a,l;return xi(this,(function(u){switch(u.label){case 0:return n.sort((function(d,f){return Math.max.apply(Math,f.score)-Math.max.apply(Math,d.score)})),r=ui(n.map((function(d){return[d.locationData.relativeBoundingBox.yMin,d.locationData.relativeBoundingBox.xMin,d.locationData.relativeBoundingBox.yMax,d.locationData.relativeBoundingBox.xMax]}))),o=Nn(n.map((function(d){return d.score[0]}))),[4,no.nonMaxSuppressionAsync(r,o,e,t)];case 1:return[4,(i=u.sent()).array()];case 2:return a=u.sent(),l=n.filter((function(d,f){return a.indexOf(f)>-1})),lt([r,o,i]),[2,l]}}))}))}function ZJ(n,e,t){return yi(this,void 0,void 0,(function(){var s,r,o,i,a;return xi(this,(function(l){switch(l.label){case 0:return s=n[0],r=n[1],o=(function(u,d,f){return he((function(){var p,y,v,w;f.reverseOutputOrder?(y=an(it(u,[0,f.boxCoordOffset+0],[-1,1])),p=an(it(u,[0,f.boxCoordOffset+1],[-1,1])),w=an(it(u,[0,f.boxCoordOffset+2],[-1,1])),v=an(it(u,[0,f.boxCoordOffset+3],[-1,1]))):(p=an(it(u,[0,f.boxCoordOffset+0],[-1,1])),y=an(it(u,[0,f.boxCoordOffset+1],[-1,1])),v=an(it(u,[0,f.boxCoordOffset+2],[-1,1])),w=an(it(u,[0,f.boxCoordOffset+3],[-1,1]))),y=ke(j(Be(y,f.xScale),d.w),d.x),p=ke(j(Be(p,f.yScale),d.h),d.y),f.applyExponentialOnBoxSize?(v=j(Es(Be(v,f.hScale)),d.h),w=j(Es(Be(w,f.wScale)),d.w)):(v=j(Be(v,f.hScale),d.h),w=j(Be(w,f.wScale),d.h));var C=ze(p,Be(v,2)),S=ze(y,Be(w,2)),b=ke(p,Be(v,2)),E=ke(y,Be(w,2)),N=dn([se(C,[f.numBoxes,1]),se(S,[f.numBoxes,1]),se(b,[f.numBoxes,1]),se(E,[f.numBoxes,1])],1);if(f.numKeypoints)for(var A=0;A<f.numKeypoints;++A){var R=f.keypointCoordOffset+A*f.numValuesPerKeypoint,L=void 0,z=void 0;f.reverseOutputOrder?(L=an(it(u,[0,R],[-1,1])),z=an(it(u,[0,R+1],[-1,1]))):(z=an(it(u,[0,R],[-1,1])),L=an(it(u,[0,R+1],[-1,1])));var M=ke(j(Be(L,f.xScale),d.w),d.x),P=ke(j(Be(z,f.yScale),d.h),d.y);N=dn([N,se(M,[f.numBoxes,1]),se(P,[f.numBoxes,1])],1)}return N}))})(r,e,t),i=he((function(){var u=s;return t.sigmoidScore?(t.scoreClippingThresh!=null&&(u=ks(s,-t.scoreClippingThresh,t.scoreClippingThresh)),u=Or(u)):u})),[4,jJ(o,i,t)];case 1:return a=l.sent(),lt([o,i]),[2,a]}}))}))}function jJ(n,e,t){return yi(this,void 0,void 0,(function(){var s,r,o,i,a,l,u,d,f,p,y,v;return xi(this,(function(w){switch(w.label){case 0:return s=[],[4,n.data()];case 1:return r=w.sent(),[4,e.data()];case 2:for(o=w.sent(),i=0;i<t.numBoxes;++i)if(!(t.minScoreThresh!=null&&o[i]<t.minScoreThresh||(a=i*t.numCoords,l=eY(r[a+0],r[a+1],r[a+2],r[a+3],o[i],t.flipVertically,i),(u=l.locationData.relativeBoundingBox).width<0||u.height<0))){if(t.numKeypoints>0)for((d=l.locationData).relativeKeypoints=[],f=t.numKeypoints*t.numValuesPerKeypoint,p=0;p<f;p+=t.numValuesPerKeypoint)y=a+t.keypointCoordOffset+p,v={x:r[y+0],y:t.flipVertically?1-r[y+1]:r[y+1]},d.relativeKeypoints.push(v);s.push(l)}return[2,s]}}))}))}function eY(n,e,t,s,r,o,i){return{score:[r],ind:i,locationData:{relativeBoundingBox:{xMin:e,yMin:o?1-t:n,xMax:s,yMax:o?1-n:t,width:s-e,height:t-n}}}}var Tg,tY={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:128,inputSizeWidth:128,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1],fixedAnchorSize:!0},nY={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:0,featureMapHeight:[],featureMapWidth:[],numLayers:1,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[4],aspectRatios:[1],fixedAnchorSize:!0},sv={runtime:"tfjs",modelType:"short",maxFaces:1,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"},sY={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:896,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:128,yScale:128,hScale:128,wScale:128,minScoreThresh:.5},rY={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2304,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.6},oY={outputTensorSize:{width:128,height:128},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},iY={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},aY=(function(){function n(e,t,s){this.detectorModel=t,this.maxFaces=s,e==="full"?(this.imageToTensorConfig=iY,this.tensorsToDetectionConfig=rY,this.anchors=Xk(nY)):(this.imageToTensorConfig=oY,this.tensorsToDetectionConfig=sY,this.anchors=Xk(tY));var r=Nn(this.anchors.map((function(l){return l.width}))),o=Nn(this.anchors.map((function(l){return l.height}))),i=Nn(this.anchors.map((function(l){return l.xCenter}))),a=Nn(this.anchors.map((function(l){return l.yCenter})));this.anchorTensor={x:i,y:a,w:r,h:o}}return n.prototype.dispose=function(){this.detectorModel.dispose(),lt([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},n.prototype.reset=function(){},n.prototype.detectFaces=function(e,t){return t===void 0&&(t=!1),yi(this,void 0,void 0,(function(){var s,r,o,i,a,l,u,d,f,p,y;return xi(this,(function(v){switch(v.label){case 0:return e==null?(this.reset(),[2,[]]):(s=he((function(){var w=Me(vA(e),"float32");return t&&(w=an(no.flipLeftRight(Zn(w,0)),[0])),w})),r=YJ(s,this.imageToTensorConfig),o=r.imageTensor,i=r.transformationMatrix,a=this.detectorModel.execute(o,"Identity:0"),l=(function(w){return he((function(){var C=(function(E){return he((function(){return[it(E,[0,0,0],[1,-1,1]),it(E,[0,0,1],[1,-1,-1])]}))})(w),S=C[0],b=C[1];return{boxes:an(b),logits:an(S)}}))})(a),u=l.boxes,[4,ZJ([d=l.logits,u],this.anchorTensor,this.tensorsToDetectionConfig)]);case 1:return(f=v.sent()).length===0?(lt([s,o,a,d,u]),[2,f]):[4,QJ(f,this.maxFaces,.3)];case 2:return p=v.sent(),y=(function(w,C){w===void 0&&(w=[]);var S,b=(S=C,[].concat.apply([],S));return w.forEach((function(E){var N=E.locationData;N.relativeKeypoints.forEach((function(P){var F=Yk(b,[P.x,P.y]),q=F[0],ee=F[1];P.x=q,P.y=ee}));var A=N.relativeBoundingBox,R=Number.MAX_VALUE,L=Number.MAX_VALUE,z=Number.MIN_VALUE,M=Number.MIN_VALUE;[[A.xMin,A.yMin],[A.xMin+A.width,A.yMin],[A.xMin+A.width,A.yMin+A.height],[A.xMin,A.yMin+A.height]].forEach((function(P){var F=Yk(b,P),q=F[0],ee=F[1];R=Math.min(R,q),z=Math.max(z,q),L=Math.min(L,ee),M=Math.max(M,ee)})),N.relativeBoundingBox={xMin:R,xMax:z,yMin:L,yMax:M,width:z-R,height:M-L}})),w})(p,i),lt([s,o,a,d,u]),[2,y]}}))}))},n.prototype.estimateFaces=function(e,t){return yi(this,void 0,void 0,(function(){var s,r;return xi(this,(function(o){return s=xA(e),r=!!t&&t.flipHorizontal,[2,this.detectFaces(e,r).then((function(i){return i.map((function(a){for(var l=a.locationData.relativeKeypoints.map((function(v,w){return ua(ua({},v),{x:v.x*s.width,y:v.y*s.height,name:yA[w]})})),u=a.locationData.relativeBoundingBox,d=0,f=["width","xMax","xMin"];d<f.length;d++)u[f[d]]*=s.width;for(var p=0,y=["height","yMax","yMin"];p<y.length;p++)u[y[p]]*=s.height;return{keypoints:l,box:u}}))}))]}))}))},n})();function lY(n){return yi(this,void 0,void 0,(function(){var e,t,s;return xi(this,(function(r){switch(r.label){case 0:return e=(function(o){if(o==null)return ua({},sv);var i=ua({},o);return i.modelType==null&&(i.modelType=sv.modelType),i.maxFaces==null&&(i.maxFaces=sv.maxFaces),i.detectorModelUrl==null&&(i.modelType==="full"?i.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/full/1":i.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"),i})(n),t=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,[4,VC(e.detectorModelUrl,{fromTFHub:t})];case 1:return s=r.sent(),[2,new aY(e.modelType,s,e.maxFaces)]}}))}))}function uY(n,e){return yi(this,void 0,void 0,(function(){var t,s;return xi(this,(function(r){if(n===Tg.MediaPipeFaceDetector){if(s=void 0,(t=e)!=null){if(t.runtime==="tfjs")return[2,lY(t)];if(t.runtime==="mediapipe")return[2,JJ(t)];s=t.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(s))}throw new Error("".concat(n," is not a supported model name."))}))}))}function rv(n){return n.width*n.height}function Qk(n){var e=n.xCenter-n.width/2,t=e+n.width,s=n.yCenter-n.height/2;return{xMin:e,xMax:t,yMin:s,yMax:s+n.height,width:n.width,height:n.height}}function cY(n,e){var t=Qk(n),s=Qk(e);if(!(function(i,a){return!(i.xMax<a.xMin||a.xMax<i.xMin||i.yMax<a.yMin||a.yMax<i.yMin)})(t,s))return 0;var r=rv((function(i,a){var l=Math.max(i.xMin,a.xMin),u=Math.min(i.xMax,a.xMax),d=Math.max(i.yMin,a.yMin),f=Math.min(i.yMax,a.yMax);return{xMin:l,xMax:u,yMin:d,yMax:f,width:Math.max(u-l,0),height:Math.max(f-d,0)}})(t,s)),o=rv(t)+rv(s)-r;return o>0?r/o:0}function dY(n,e,t,s){var r=n.width,o=n.height,i=1,a=Math.cos(n.rotation),l=Math.sin(n.rotation),u=n.xCenter,d=n.yCenter,f=1/e,p=1/t,y=new Array(16);return y[0]=r*a*i*f,y[1]=-o*l*f,y[2]=0,y[3]=(-.5*r*a*i+.5*o*l+u)*f,y[4]=r*l*i*p,y[5]=o*a*p,y[6]=0,y[7]=(-.5*o*a-.5*r*l*i+d)*p,y[8]=0,y[9]=0,y[10]=r*f,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,(function(v){if(v.length!==16)throw new Error("Array length must be 16 but got "+v.length);return[[v[0],v[1],v[2],v[3]],[v[4],v[5],v[6],v[7]],[v[8],v[9],v[10],v[11]],[v[12],v[13],v[14],v[15]]]})(y)}function wA(n){return n instanceof St?{height:n.shape[0],width:n.shape[1]}:{height:n.height,width:n.width}}function CA(n){return n-2*Math.PI*Math.floor((n+Math.PI)/(2*Math.PI))}function TA(n){return n instanceof St?n:ow(n)}function ov(n,e){B(n.width!==0,(function(){return e+" width cannot be 0."})),B(n.height!==0,(function(){return e+" height cannot be 0."}))}function fY(n,e){var t=(function(s,r,o,i){var a=r-s,l=i-o,u=l/a;return{scale:u,offset:o-s*u}})(0,255,e[0],e[1]);return he((function(){return ke(j(n,t.scale),t.offset)}))}function hY(n,e,t){var s=e.outputTensorSize,r=e.keepAspectRatio,o=e.outputTensorFloatRange,i=wA(n),a=(function(f,p){return p?{xCenter:p.xCenter*f.width,yCenter:p.yCenter*f.height,width:p.width*f.width,height:p.height*f.height,rotation:p.rotation}:{xCenter:.5*f.width,yCenter:.5*f.height,width:f.width,height:f.height,rotation:0}})(i,t),l=(function(f,p,y){if(y===void 0&&(y=!1),!y)return{top:0,left:0,right:0,bottom:0};var v=p.height,w=p.width;ov(p,"targetSize"),ov(f,"roi");var C,S,b=v/w,E=f.height/f.width,N=0,A=0;return b>E?(C=f.width,S=f.width*b,A=(1-E/b)/2):(C=f.height/b,S=f.height,N=(1-b/E)/2),f.width=C,f.height=S,{top:A,left:N,right:N,bottom:A}})(a,s,r),u=dY(a,i.width,i.height),d=he((function(){var f=TA(n),p=ui((function(w,C,S){return ov(S,"inputResolution"),[1/S.width*w[0][0]*C.width,1/S.height*w[0][1]*C.width,w[0][3]*C.width,1/S.width*w[1][0]*C.height,1/S.height*w[1][1]*C.height,w[1][3]*C.height,0,0]})(u,i,s),[1,8]),y="nearest",v=no.transform(Zn(Me(f,"float32")),p,"bilinear",y,0,[s.height,s.width]);return o!=null?fY(v,o):v}));return{imageTensor:d,padding:l,transformationMatrix:u}}function Zk(n){return{xCenter:n.xMin+n.width/2,yCenter:n.yMin+n.height/2,width:n.width,height:n.height}}function pY(n){var e=n.relativeKeypoints;if(e.length<=1)throw new Error("2 or more keypoints required to calculate a rect.");var t=Number.MAX_VALUE,s=Number.MAX_VALUE,r=Number.MIN_VALUE,o=Number.MIN_VALUE;return e.forEach((function(i){t=Math.min(t,i.x),r=Math.max(r,i.x),s=Math.min(s,i.y),o=Math.max(o,i.y)})),{xCenter:(t+r)/2,yCenter:(s+o)/2,width:r-t,height:o-s}}function jk(n,e,t,s,r){var o=t==="rect"?(function(i,a,l){var u,d=i.locationData;return u=Zk(d.boundingBox),u})(n):(function(i,a){var l=i.locationData;return a==="boundingbox"?Zk(l.relativeBoundingBox):pY(l)})(n,e);return r&&(o.rotation=(function(i,a,l){var u,d=i.locationData,f=l.rotationVectorStartKeypointIndex,p=l.rotationVectorEndKeypointIndex;u=l.rotationVectorTargetAngle?l.rotationVectorTargetAngle:Math.PI*l.rotationVectorTargetAngleDegree/180;var y=d.relativeKeypoints[f].x*a.width,v=d.relativeKeypoints[f].y*a.height,w=d.relativeKeypoints[p].x*a.width,C=d.relativeKeypoints[p].y*a.height;return CA(u-Math.atan2(-(C-v),w-y))})(n,s,r)),o}function mY(n,e,t){for(var s=0;s<e.length;++s){var r=e[s],o=t[n[s]];o.x=r.x,o.y=r.y}}function gY(n,e,t,s){if(typeof e=="string"){if(e==="copy")for(var r=0;r<t.length;++r)s[n[r]].z=t[r].z}else{var o=(function(i,a){for(var l=0,u=0;u<a.length;++u)l+=i[a[u]].z;return l/a.length})(s,e);for(r=0;r<n.length;++r)s[n[r]].z=o}}function yY(n,e){for(var t=(function(a){var l=[].concat.apply([],a.map((function(y){return y.indexesMapping})));if(l.length===0)throw new Error("There should be at least one landmark in indexes mapping");var u=l[0],d=l[0],f=new Set(l);f.forEach((function(y){u=Math.min(u,y),d=Math.max(d,y)}));var p=f.size;if(u!==0)throw new Error("Indexes are expected to start with 0 instead of "+u);if(d+1!==p)throw new Error("Indexes should have no gaps but "+(d-p+1)+" indexes are missing");return p})(e),s=new Array(t).fill(null).map(Object),r=0;r<n.length;++r){var o=n[r],i=e[r];if(o.length!==i.indexesMapping.length)throw new Error("There are "+o.length+" refinement landmarks while mapping has "+i.indexesMapping.length);mY(i.indexesMapping,o,s),gY(i.indexesMapping,i.zRefinement,o,s)}return s}function xY(n,e){return n.map((function(t){var s=oo(oo({},t),{x:t.x*e.width,y:t.y*e.height});return t.z!=null&&(s.z=t.z*e.width),s}))}function vY(n,e){return n==="none"?e:(function(t){return 1/(1+Math.exp(-t))})(e)}function qa(n,e,t,s){return ii(this,void 0,void 0,(function(){var r,o,i,a,l,u,d,f;return ai(this,(function(p){switch(p.label){case 0:return t=t||e.flipHorizontally||!1,s=s||e.flipVertically||!1,r=n.size,o=r/e.numLandmarks,[4,n.data()];case 1:for(i=p.sent(),a=[],l=0;l<e.numLandmarks;++l)u=l*o,(f={x:0,y:0}).x=t?e.inputImageWidth-i[u]:i[u],o>1&&(f.y=s?e.inputImageHeight-i[u+1]:i[u+1]),o>2&&(f.z=i[u+2]),o>3&&(f.score=vY(e.visibilityActivation,i[u+3])),a.push(f);for(d=0;d<a.length;++d)(f=a[d]).x=f.x/e.inputImageWidth,f.y=f.y/e.inputImageHeight,f.z=f.z/e.inputImageWidth/(e.normalizeZ||1);return[2,a]}}))}))}function eN(n,e,t){var s=n.width,r=n.height,o=n.rotation;if(t.rotation==null&&t.rotationDegree==null||(o=(function(u,d){return d.rotation!=null?u+=d.rotation:d.rotationDegree!=null&&(u+=Math.PI*d.rotationDegree/180),CA(u)})(o,t)),o===0)n.xCenter=n.xCenter+s*t.shiftX,n.yCenter=n.yCenter+r*t.shiftY;else{var i=(e.width*s*t.shiftX*Math.cos(o)-e.height*r*t.shiftY*Math.sin(o))/e.width,a=(e.width*s*t.shiftX*Math.sin(o)+e.height*r*t.shiftY*Math.cos(o))/e.height;n.xCenter=n.xCenter+i,n.yCenter=n.yCenter+a}{var l=Math.max(s*e.width,r*e.height);s=l/e.width,r=l/e.height}return n.width=s*t.scaleX,n.height=r*t.scaleY,n}(Tg||(Tg={})).MediaPipeFaceDetector="MediaPipeFaceDetector";var iv={runtime:"tfjs",maxFaces:1,refineLandmarks:!1,landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/face_mesh/1"},av={flipHorizontal:!1,staticImageMode:!1},tN={shiftX:0,shiftY:0,scaleX:1.5,scaleY:1.5},wY={outputTensorSize:{width:192,height:192},outputTensorFloatRange:[0,1]},nN={numLandmarks:468,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},CY={numLandmarks:80,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},sN={numLandmarks:71,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},rN={numLandmarks:5,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},TY={indexesMapping:Array.from(Array(468).keys()),zRefinement:"copy"},SY={indexesMapping:[61,146,91,181,84,17,314,405,321,375,291,185,40,39,37,0,267,269,270,409,78,95,88,178,87,14,317,402,318,324,308,191,80,81,82,13,312,311,310,415,76,77,90,180,85,16,315,404,320,307,306,184,74,73,72,11,302,303,304,408,62,96,89,179,86,15,316,403,319,325,292,183,42,41,38,12,268,271,272,407],zRefinement:"none"},bY={indexesMapping:[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173,130,25,110,24,23,22,26,112,243,247,30,29,27,28,56,190,226,31,228,229,230,231,232,233,244,113,225,224,223,222,221,189,35,124,46,53,52,65,143,111,117,118,119,120,121,128,245,156,70,63,105,66,107,55,193],zRefinement:"none"},IY={indexesMapping:[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398,359,255,339,254,253,252,256,341,463,467,260,259,257,258,286,414,446,261,448,449,450,451,452,453,464,342,445,444,443,442,441,413,265,353,276,283,282,295,372,340,346,347,348,349,350,357,465,383,300,293,334,296,336,285,417],zRefinement:"none"},kY={indexesMapping:[468,469,470,471,472],zRefinement:[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173]},NY={indexesMapping:[473,474,475,476,477],zRefinement:[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398]},Sg,EY=(function(){function n(e,t,s,r){this.detector=e,this.landmarkModel=t,this.maxFaces=s,this.withAttention=r,this.prevFaceRectsFromLandmarks=null}return n.prototype.estimateFaces=function(e,t){return ii(this,void 0,void 0,(function(){var s,r,o,i,a,l,u,d,f,p,y,v,w,C=this;return ai(this,(function(S){switch(S.label){case 0:return s=(function(N){if(N==null)return oo({},av);var A=oo({},N);return A.flipHorizontal==null&&(A.flipHorizontal=av.flipHorizontal),A.staticImageMode==null&&(A.staticImageMode=av.staticImageMode),A})(t),e==null?(this.reset(),[2,[]]):(r=wA(e),o=he((function(){var N=Me(TA(e),"float32");return s.flipHorizontal&&(N=an(no.flipLeftRight(Zn(N,0)),[0])),N})),i=this.prevFaceRectsFromLandmarks,s.staticImageMode||i==null||i.length<this.maxFaces?[4,this.detector.detectFaces(o,!1)]:[3,2]);case 1:return(l=S.sent()).length===0?(this.reset(),o.dispose(),[2,[]]):(a=l.map((function(N){return C.faceDetectionFrontDetectionToRoi(N,r)})),[3,3]);case 2:a=[],S.label=3;case 3:return b=.5,E=[],[a,i||[]].forEach((function(N){return N.forEach((function(A){(E=E.filter((function(R){return cY(A,R)<=b}))).push(A)}))})),u=E,[4,Promise.all(u.map((function(N){return C.faceLandmark(N,o)})))];case 4:for(d=S.sent(),f=[],this.prevFaceRectsFromLandmarks=[],p=0;p<d.length;++p)(y=d[p])!=null&&(this.prevFaceRectsFromLandmarks.push(this.faceLandmarksToRoi(y,r)),(v=xY(y,r))!=null&&v.forEach((function(N,A){var R=gA.get(A);R!=null&&(N.name=R)})),w=u2(v),f.push({keypoints:v,box:w.locationData.relativeBoundingBox}));return o.dispose(),[2,f]}var b,E}))}))},n.prototype.dispose=function(){this.detector.dispose(),this.landmarkModel.dispose()},n.prototype.reset=function(){this.detector.reset(),this.prevFaceRectsFromLandmarks=null},n.prototype.faceDetectionFrontDetectionToRoi=function(e,t){return eN(jk(e,"boundingbox","normRect",t,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:0}),t,tN)},n.prototype.faceLandmark=function(e,t){return ii(this,void 0,void 0,(function(){var s,r,o,i,a,l,u;return ai(this,(function(d){switch(d.label){case 0:return s=hY(t,wY,e).imageTensor,r=["output_faceflag"].concat(this.withAttention?["output_mesh_identity","output_lips","Identity_6:0","Identity_1:0","Identity_2:0","Identity_5:0"]:["output_mesh"]),o=this.landmarkModel.execute(s,r),i=o[0],a=o.slice(1),[4,i.data()];case 1:return d.sent()[0]<.5?(lt(o),lt(s),[2,null]):this.withAttention?[4,this.tensorsToFaceLandmarksWithAttention(a)]:[3,3];case 2:return l=d.sent(),[3,5];case 3:return[4,this.tensorsToFaceLandmarks(a)];case 4:l=d.sent(),d.label=5;case 5:return u=(function(f,p,y){y===void 0&&(y={ignoreRotation:!1});for(var v=[],w=0,C=f;w<C.length;w++){var S=C[w],b=S.x-.5,E=S.y-.5,N=y.ignoreRotation?0:p.rotation,A=Math.cos(N)*b-Math.sin(N)*E,R=Math.sin(N)*b+Math.cos(N)*E;A=A*p.width+p.xCenter,R=R*p.height+p.yCenter;var L=S.z*p.width,z=oo({},S);z.x=A,z.y=R,z.z=L,v.push(z)}return v})(l,e),lt(o),lt(s),[2,u]}}))}))},n.prototype.tensorsToFaceLandmarks=function(e){return ii(this,void 0,void 0,(function(){return ai(this,(function(t){return[2,qa(e[0],nN)]}))}))},n.prototype.tensorsToFaceLandmarksWithAttention=function(e){return ii(this,void 0,void 0,(function(){var t,s,r,o,i,a;return ai(this,(function(l){switch(l.label){case 0:return[4,qa(e[0],nN)];case 1:return t=l.sent(),[4,qa(e[1],CY)];case 2:return s=l.sent(),[4,qa(e[3],sN)];case 3:return r=l.sent(),[4,qa(e[5],sN)];case 4:return o=l.sent(),[4,qa(e[4],rN)];case 5:return i=l.sent(),[4,qa(e[2],rN)];case 6:return a=l.sent(),[2,yY([t,s,r,o,i,a],[TY,SY,bY,IY,kY,NY])]}}))}))},n.prototype.faceLandmarksToRoi=function(e,t){return eN(jk(u2(e),"boundingbox","normRect",t,{rotationVectorStartKeypointIndex:33,rotationVectorEndKeypointIndex:263,rotationVectorTargetAngleDegree:0}),t,tN)},n})();function $Y(n){return ii(this,void 0,void 0,(function(){var e,t,s,r;return ai(this,(function(o){switch(o.label){case 0:return e=(function(i){if(i==null)return oo({},iv);var a=oo({},i);return a.runtime="tfjs",a.maxFaces==null&&(a.maxFaces=iv.maxFaces),a.refineLandmarks==null&&(a.refineLandmarks=iv.refineLandmarks),a.landmarkModelUrl==null&&(a.landmarkModelUrl=a.refineLandmarks?"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/attention_mesh/1":"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/face_mesh/1"),a})(n),t=typeof e.landmarkModelUrl=="string"&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,VC(e.landmarkModelUrl,{fromTFHub:t})];case 1:return s=o.sent(),[4,uY(Tg.MediaPipeFaceDetector,{modelType:"short",maxFaces:e.maxFaces,detectorModelUrl:e.detectorModelUrl,runtime:e.runtime})];case 2:return r=o.sent(),[2,new EY(r,s,e.maxFaces,e.refineLandmarks)]}}))}))}function AY(n,e){return ii(this,void 0,void 0,(function(){var t,s;return ai(this,(function(r){if(n===Sg.MediaPipeFaceMesh){if(s=void 0,(t=e)!=null){if(t.runtime==="tfjs")return[2,$Y(t)];if(t.runtime==="mediapipe")return[2,qJ(t)];s=t.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+s)}throw new Error(n+" is not a supported model name.")}))}))}(function(n){n.MediaPipeFaceMesh="MediaPipeFaceMesh"})(Sg||(Sg={}));const _Y=Tt.forwardRef(({stream:n,objectDetectionMode:e,isFaceDetectionOn:t},s)=>{const r=Tt.useRef(null),o=Tt.useRef(null),[i,a]=Tt.useState(null),[l,u]=Tt.useState(null),[d,f]=Tt.useState(!0),p=Tt.useRef(null);return Tt.useImperativeHandle(s,()=>({captureFrame:()=>{const y=r.current,v=document.createElement("canvas");if(y&&y.readyState>=3){v.width=y.videoWidth,v.height=y.videoHeight;const w=v.getContext("2d");if(w)return w.drawImage(y,0,0,v.width,v.height),v.toDataURL("image/jpeg").split(",")[1]}return null}})),Tt.useEffect(()=>{(async()=>{try{f(!0);const v=Sg.MediaPipeFaceMesh,w={runtime:"mediapipe",solutionPath:"https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh",refineLandmarks:!0},[C,S]=await Promise.all([UJ.load(),AY(v,w)]);a(C),u(S)}catch(v){console.error("Failed to load models:",v)}finally{f(!1)}})()},[]),Tt.useEffect(()=>{r.current&&n&&(r.current.srcObject=n)},[n]),Tt.useEffect(()=>{const y=async()=>{const v=r.current,w=o.current;if(!v||!w||v.readyState!==4)return;const C=w.getContext("2d");if(!C)return;w.width=v.videoWidth,w.height=v.videoHeight,C.clearRect(0,0,w.width,w.height);const S=i&&e!==Fr.NONE,b=l&&t;!S&&!b||(S&&(await i.detect(v)).forEach(N=>{(e===Fr.OBJECTS&&N.class!=="person"||e===Fr.PEOPLE&&N.class==="person"||e===Fr.BOTH)&&(C.beginPath(),C.rect(N.bbox[0],N.bbox[1],N.bbox[2],N.bbox[3]),C.lineWidth=2,C.strokeStyle="rgba(0, 255, 0, 0.8)",C.fillStyle="rgba(0, 255, 0, 0.2)",C.stroke(),C.fill(),C.font="16px Arial",C.fillStyle="rgba(0, 255, 0, 0.8)",C.fillText(`${N.class} (${Math.round(N.score*100)}%)`,N.bbox[0],N.bbox[1]>10?N.bbox[1]-5:10))}),b&&(await l.estimateFaces(v)).forEach(N=>{if(N.box){const{xMin:A,yMin:R,width:L,height:z}=N.box;C.beginPath(),C.rect(A,R,L,z),C.lineWidth=2,C.strokeStyle="rgba(255, 0, 0, 0.8)",C.stroke()}else N.keypoints&&(C.fillStyle="rgba(255, 0, 0, 0.8)",N.keypoints.forEach(A=>{C.beginPath(),C.arc(A.x,A.y,1,0,2*Math.PI),C.fill()}))}))};return p.current&&clearInterval(p.current),p.current=window.setInterval(y,100),()=>{p.current&&clearInterval(p.current)}},[e,t,i,l,n]),xe.jsxs("div",{className:"relative my-4 aspect-video max-w-full mx-auto bg-black rounded-lg overflow-hidden shadow-lg",children:[xe.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover"}),xe.jsx("canvas",{ref:o,className:"absolute top-0 left-0 w-full h-full"}),d&&xe.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50",children:xe.jsx("p",{className:"text-white text-lg",children:"Loading AI models..."})})]})}),RY=({content:n})=>{const e=n.trim().split(`
`),t=[];let s=!1,r="";const o=()=>{r&&(t.push(xe.jsx("pre",{className:"bg-gray-200 dark:bg-gray-800 p-4 rounded-md my-4 overflow-x-auto",children:xe.jsx("code",{className:"font-mono text-sm text-gray-800 dark:text-gray-200",children:r.trim()})},t.length)),r="")};return e.forEach((i,a)=>{if(i.startsWith("```")){s=!s,s||o();return}if(s){r+=i+`
`;return}i.startsWith("## ")?t.push(xe.jsx("h2",{className:"text-3xl font-bold mt-8 mb-4 pb-2 border-b border-gray-300 dark:border-gray-600",children:i.substring(3)},a)):i.startsWith("### ")?t.push(xe.jsx("h3",{className:"text-2xl font-bold mt-6 mb-3",children:i.substring(4)},a)):i.startsWith("- ")?t.push(xe.jsx("li",{className:"ml-6 my-1 list-disc",children:xe.jsx("span",{dangerouslySetInnerHTML:{__html:i.substring(2).replace(/`([^`]+)`/g,'<code class="bg-gray-200 dark:bg-gray-700 font-mono px-1 py-0.5 rounded text-sm">$1</code>')}})},a)):i.trim()===""?t.push(xe.jsx("div",{className:"h-4"},a)):t.push(xe.jsx("p",{className:"my-4",dangerouslySetInnerHTML:{__html:i.replace(/`([^`]+)`/g,'<code class="bg-gray-200 dark:bg-gray-700 font-mono px-1 py-0.5 rounded text-sm">$1</code>')}},a))}),o(),xe.jsx(xe.Fragment,{children:t})},DY=({onBack:n,theme:e,toggleTheme:t,language:s,setLanguage:r})=>{const o=cE[s],i=()=>{r(s==="en"?"ar":"en")};return xe.jsxs("div",{className:`min-h-screen bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-white transition-colors duration-300 font-sans ${s==="ar"?"rtl":"ltr"}`,children:[xe.jsxs("header",{className:"p-4 flex justify-between items-center",children:[xe.jsx("button",{onClick:n,className:"px-4 py-2 text-sm font-medium bg-gray-200 dark:bg-gray-700 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900 focus:ring-blue-500",children:o.backButton}),xe.jsxs("div",{className:"flex items-center space-x-4",children:[xe.jsx("button",{onClick:i,className:"px-4 py-2 text-sm font-medium bg-gray-200 dark:bg-gray-700 rounded-md hover:bg-gray-300 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-100 dark:focus:ring-offset-gray-900 focus:ring-blue-500",children:o.languageToggleLabel}),xe.jsx(A2,{theme:e,toggleTheme:t})]})]}),xe.jsx("main",{className:"p-4 sm:p-8 max-w-4xl mx-auto",children:xe.jsx("div",{className:"bg-white dark:bg-gray-950 p-6 sm:p-8 rounded-lg shadow-lg",children:xe.jsx(RY,{content:o.docsContent})})}),xe.jsx("footer",{className:"text-center p-4 text-sm text-gray-500 dark:text-gray-400",children:xe.jsxs("p",{children:["© ",ei.copyright.year," ",ei.copyright.holder,". All rights reserved."]})})]})},FY=()=>{const[n,e]=Tt.useState("website"),[t,s]=Tt.useState([]),[r,o]=Tt.useState([]),[i,a]=Tt.useState(!1),[l,u]=Tt.useState(!1),[d,f]=Tt.useState(null),[p,y]=Tt.useState(Fr.NONE),[v,w]=Tt.useState(!1),[C,S]=Tt.useState(()=>localStorage.getItem("alpa-theme")||"dark"),[b,E]=Tt.useState(()=>localStorage.getItem("alpa-lang")||"en"),[N,A]=Tt.useState([]),[R,L]=Tt.useState(!1),[z,M]=Tt.useState(null),P=Tt.useRef(null),F=Tt.useRef(null);Tt.useEffect(()=>{const ae=window.document.documentElement;C==="dark"?ae.classList.add("dark"):ae.classList.remove("dark"),localStorage.setItem("alpa-theme",C),localStorage.setItem("alpa-lang",b),ae.lang=b,ae.dir=b==="ar"?"rtl":"ltr"},[C,b]),Tt.useEffect(()=>{n==="terminal"&&t.length===0&&s([{type:zt.RESPONSE,content:qb}])},[n,t.length]),Tt.useEffect(()=>{var ae;n==="terminal"&&((ae=P.current)==null||ae.scrollIntoView({behavior:"smooth"}))},[t,i,n]),Tt.useEffect(()=>{const ae=()=>{A(window.speechSynthesis.getVoices())};return window.speechSynthesis.onvoiceschanged=ae,ae(),()=>{window.speechSynthesis.onvoiceschanged=null}},[]);const q=()=>{S(ae=>ae==="light"?"dark":"light")},ee=()=>{d&&d.getTracks().forEach(ae=>ae.stop()),u(!1),f(null),y(Fr.NONE),w(!1)},ue=async ae=>{try{const J=await navigator.mediaDevices.getUserMedia({video:!0});f(J),u(!0),ae==null||ae()}catch{s(te=>[...te,{type:zt.ERROR,content:"Error: Could not access camera. Please grant permission."}])}},ie=async ae=>{if(!l||!F.current){s(oe=>[...oe,{type:zt.ERROR,content:"Error: Camera is not open. Use camera.open first."}]);return}a(!0);const J=F.current.captureFrame();if(!J){s(oe=>[...oe,{type:zt.ERROR,content:"Error: Could not capture frame. The camera may be disconnected or the video stream has ended. Please try `camera.open` again."}]),a(!1);return}const te=await ZU(J,ae);s(oe=>[...oe,{type:zt.RESPONSE,content:te}]),a(!1)},de=async ae=>{if(R){s(G=>[...G,{type:zt.USER_INPUT,content:ae}]),a(!0);const oe=ae.toLowerCase();if(oe==="exit"||oe==="خروج"){L(!1),M(null),s(G=>[...G,{type:zt.RESPONSE,content:"Exited chat session."}]),a(!1);return}if(z){const G=await YU(z,ae);s(ne=>[...ne,{type:zt.RESPONSE,content:G}])}else s(G=>[...G,{type:zt.ERROR,content:"Error: Chat session not found. Please exit and start a new chat."}]);a(!1),o(G=>[...G,ae]);return}s(oe=>[...oe,{type:zt.COMMAND,content:ae}]),a(!0);const J=oe=>{s(G=>[...G,oe])},te=await t8(ae,l,J);if(a(!1),te.commandKey!=="CLEAR"&&o(oe=>[...oe,ae]),te.output){const oe=te.output.startsWith("Error:")?zt.ERROR:zt.RESPONSE;J({type:oe,content:te.output})}switch(te.action){case"START_CHAT":const oe=JU();M(oe),L(!0);break;case"CAMERA_START":l||await ue();break;case"CAMERA_STOP":ee();break;case"START_CAMERA_AND_DETECT":await ue(()=>{te.payload&&Object.values(Fr).includes(te.payload)&&y(te.payload)});break;case"CAMERA_CAPTURE_AND_DESCRIBE":ie(te.payload);break;case"SET_OBJECT_DETECTION_MODE":te.payload&&Object.values(Fr).includes(te.payload)&&y(te.payload);break;case"SET_FACE_DETECTION":typeof te.payload=="boolean"&&w(te.payload);break;case"CLEAR":ee(),s([{type:zt.RESPONSE,content:qb}]);break;case"SPEAK_TEXT":if(typeof te.payload=="string"&&te.payload.trim()!==""){const G=new SpeechSynthesisUtterance(te.payload);if(/[\u0600-\u06FF]/.test(te.payload)){const ye=N.find(Te=>Te.lang.startsWith("ar"));ye&&(G.voice=ye,G.lang=ye.lang)}window.speechSynthesis.speak(G)}break;case"DOWNLOAD_FILE":if(te.payload&&te.payload.filename&&typeof te.payload.content=="string"){const{filename:G,content:ne,mimeType:ye}=te.payload;try{const Te=new Blob([ne],{type:ye||"text/plain"}),Se=URL.createObjectURL(Te),Ie=document.createElement("a");Ie.href=Se,Ie.download=G,document.body.appendChild(Ie),Ie.click(),document.body.removeChild(Ie),URL.revokeObjectURL(Se)}catch(Te){console.error("Download failed:",Te),s(Se=>[...Se,{type:zt.ERROR,content:"Error: Could not trigger file download."}])}}break}};return n==="website"?xe.jsx(SM,{onLaunchTerminal:()=>e("terminal"),onShowDocs:()=>e("docs"),theme:C,toggleTheme:q,language:b,setLanguage:E}):n==="docs"?xe.jsx(DY,{onBack:()=>e("website"),theme:C,toggleTheme:q,language:b,setLanguage:E}):xe.jsxs("div",{className:"bg-white dark:bg-gray-900 text-gray-900 dark:text-white min-h-screen font-mono p-4 flex flex-col",children:[xe.jsxs("div",{className:"flex-grow overflow-y-auto",children:[xe.jsx(gM,{history:t,isLoading:i,language:b}),l&&d&&xe.jsx(_Y,{ref:F,stream:d,objectDetectionMode:p,isFaceDetectionOn:v}),xe.jsx("div",{ref:P})]}),xe.jsx(vM,{onSubmit:de,commandHistory:r,theme:C,onToggleTheme:q,language:b,isChatting:R})]})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SA={kernelName:Ef,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,_l(Me(t,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MY={kernelName:Yu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=Ut(Me(t,"float32")),r=ts(ze(tt(1),s));return Qt(Be(n,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PY={kernelName:Qu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=ts(ze(Ut(Me(t,"float32")),1));return Be(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LY={kernelName:Nl,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=dt(t.shape,s.shape);return{a:()=>{let a=n;const l=En(t.shape,r);return l.length>0&&(a=Ge(a,l)),se(a,t.shape)},b:()=>{let a=n;const l=En(s.shape,r);return l.length>0&&(a=Ge(a,l)),se(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OY={kernelName:$f,saveAllInputs:!0,gradFunc:(n,e)=>{const t={};return e.forEach((s,r)=>{t[r]=()=>n.clone()}),t}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VY={kernelName:Af,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>bt(t)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BY={kernelName:_f,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>bt(t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zY={kernelName:Zu,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Be(n,ts(ze(tt(1),Ut(Me(t,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UY={kernelName:ju,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=ts(ke(tt(1),Ut(Me(t,"float32"))));return Be(n,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WY={kernelName:nc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=dt(t.shape,s.shape);return{a:()=>{const a=ke(Ut(t),Ut(s));let l=j(n,Be(s,a));const u=En(t.shape,r);return u.length>0&&(l=Ge(l,u)),se(l,t.shape)},b:()=>{const a=ke(Ut(t),Ut(s));let l=Qt(j(n,Be(t,a)));const u=En(s.shape,r);return u.length>0&&(l=Ge(l,u)),se(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GY={kernelName:ec,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Be(n,ke(Ut(Me(t,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HY={kernelName:tc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Be(n,ze(tt(1),Ut(Me(t,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qY(n,e,t,s,r,o){const i=U(n,"dy","avgPool3dGrad"),a=U(e,"input","avgPool3dGrad");let l=i,u=a,d=!1;a.rank===4&&(d=!0,l=se(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=se(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),B(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),B(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),As("avgPool3dGrad",r,o);const f={dy:l,input:u},p={filterSize:t,strides:s,pad:r,dimRoundingMode:o},y=Q.runKernel(Qg,f,p);return d?se(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}const KY=Z({avgPool3dGrad_:qY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XY={kernelName:Df,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:o,pad:i,dimRoundingMode:a}=t;return{x:()=>KY(n,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JY(n,e,t,s,r){const o=U(n,"dy","avgPoolGrad"),i=U(e,"input","avgPoolGrad");B(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,u=!1;i.rank===3&&(u=!0,a=se(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=se(o,[1,o.shape[0],o.shape[1],o.shape[2]])),B(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),B(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const d={dy:l,input:a},f={filterSize:t,strides:s,pad:r},p=Q.runKernel(Yg,d,f);return u?se(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const YY=Z({avgPoolGrad_:JY});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QY={kernelName:Rf,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{filterSize:r,strides:o,pad:i}=t;return{x:()=>YY(n,s,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZY={kernelName:Ff,inputsToSave:["a","b"],gradFunc:(n,e,t)=>{const[s,r]=e,{transposeA:o,transposeB:i}=t;return!o&&!i?{a:()=>mt(n,r,!1,!0),b:()=>mt(s,n,!0,!1)}:!o&&i?{a:()=>mt(n,r,!1,!1),b:()=>mt(n,s,!0,!1)}:o&&!i?{a:()=>mt(r,n,!1,!0),b:()=>mt(s,n,!1,!1)}:{a:()=>mt(r,n,!0,!0),b:()=>mt(n,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jY={kernelName:Mf,gradFunc:(n,e,t)=>{const{blockShape:s,crops:r}=t;return{x:()=>zh(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eQ={kernelName:jE,gradFunc:(n,e,t)=>{const s=t,r=s.inputShape,o=s.shape,i=Array.from(o);for(let l=r.length-1;l>=0;l--)if(r[l]===o[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>Ge(n,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tQ={kernelName:sc,gradFunc:n=>({x:()=>n.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nQ={kernelName:rc,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sQ={kernelName:oc,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{clipValueMin:r,clipValueMax:o}=t;return{x:()=>Ns(ao(va(s,r),wa(s,o)),n,bt(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rQ={kernelName:Pf,inputsToSave:["x"],gradFunc:SA.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oQ={kernelName:Lf,saveAllInputs:!0,gradFunc:(n,e,t)=>{const s=e.map(l=>l.shape),{axis:r}=t,o=gt(r,e[0].shape)[0],i=s.map(l=>l[o]);return Ls(n,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iQ={kernelName:Of,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{dilations:o,strides:i,pad:a,dataFormat:l}=t;return B(la(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>Fw(s.shape,n,r,i,a,l),filter:()=>hC(s,n,r.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aQ={kernelName:Vf,inputsToSave:["dy","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=t;return{dy:()=>pi(n,r,o,i,a,1,l),filter:()=>hC(n,s,r.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lQ(n,e,t,s,r){let o=n;n.rank===4&&(o=se(n,[1,n.shape[0],n.shape[1],n.shape[2],n.shape[3]]));let i=e;i.rank===4&&(i=se(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),B(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),B(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),B(t.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${t}.`),B(o.shape[4]===t[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${t[3]}.`),B(i.shape[4]===t[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${t[4]}).`);const a={x:o,dy:i},l={strides:s,pad:r,filterShape:t};return Q.runKernel(ny,a,l)}const uQ=Z({conv3DBackpropFilter_:lQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cQ={kernelName:Bf,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:o}=t;B(la(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=e;return{x:()=>G3(i.shape,n,a,r,o),filter:()=>uQ(i,n,a.shape,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dQ={kernelName:ic,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(Qt(C1(Me(t,"float32"))),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fQ={kernelName:ac,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(T1(Me(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hQ={kernelName:zf,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r,exclusive:o,reverse:i}=t;return{x:()=>{const a=hn([r],s.rank);let l=i1(n,r,o,!i);return a!=null&&(l=xt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pQ={kernelName:Uf,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const{dilations:s,strides:r,pad:o,dimRoundingMode:i}=t,a=s??[1,1];B(la(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,u]=e;return B(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),B(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),B(l.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),B(ss(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),As("depthwiseConv2d",o,i),{x:()=>A$(l.shape,n,u,r,o,a,i),filter:()=>$$(l,n,u.shape,r,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mQ={kernelName:Wf,inputsToSave:["x","filter"],gradFunc:(n,e,t)=>{const[s,r]=e,o={x:s,filter:r,dy:n},i={x:s,filter:r,dy:n};return{x:()=>Q.runKernel(fg,o,t),filter:()=>Q.runKernel(hg,i,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gQ={kernelName:uc,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e,s={dy:n,y:t};return{x:()=>Q.runKernel(fy,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yQ={kernelName:cc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=j(Es(Qt(Ut(t))),2/Math.sqrt(Math.PI));return{x:()=>j(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xQ={kernelName:dc,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vQ={kernelName:Hf,inputsToSave:["input"],gradFunc:(n,e)=>{const[t]=e;return{input:()=>se(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wQ={kernelName:fc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,Es(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CQ={kernelName:hc,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TQ={kernelName:pc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=dt(t.shape,s.shape);return{a:()=>{const a=Be(n,Me(s,"float32")),l=En(t.shape,r);return l.length>0?se(Ge(a,l),t.shape):a},b:()=>{let a=j(n,Me(t,"float32"));const l=En(s.shape,r);l.length>0&&(a=se(Ge(a,l),s.shape));const u=Ut(s);return Qt(Be(a,Me(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SQ={kernelName:qf,inputsToSave:["x","mean","variance","scale"],gradFunc:(n,e,t)=>{const{varianceEpsilon:s}=t,[r,o,i,a]=e,l=a??tt(1),u=En(o.shape,r.shape),d=[];if(o.rank===1){for(let N=0;N<r.shape.length-1;++N)d.push(r.shape[N]);d.push(1)}const f=ze(r,o),p=j(n,l),y=x1(ke(i,tt(s))),v=j(j(j(y,y),y),tt(-.5));return{x:()=>o.rank===1?se(j(j(n,pr(se(y,[1,1,1,o.shape[0]]),d)),l),r.shape):se(j(j(n,y),l),r.shape),mean:()=>{let N=j(j(y,tt(-1)),p);return o.rank===1&&(N=Ge(N,u)),se(N,o.shape)},variance:()=>{let N=j(j(v,f),p);return o.rank===1&&(N=Ge(N,u)),se(N,o.shape)},scale:()=>{const N=j(f,y);let A=j(n,N);return o.rank===1&&(A=Ge(A,u)),se(A,o.shape)},offset:()=>{let N=n;return o.rank===1&&(N=Ge(N,u)),se(N,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bQ={kernelName:Kf,inputsToSave:["x","indices"],gradFunc:(n,e,t)=>{const[s,r]=e,{axis:o}=t,i=gt(o,s.shape)[0];return{x:()=>{const l=s.shape,u=r.size,d=l.slice(0,i),f=d.length,p=l.slice(o,l.length).slice(1),y=p.length,v=oN(0,f),w=oN(f+1,f+1+y),C=iN([d,[u],p]),S=se(n,C),b=se(r,[u]),E=iN([[f],v,w]),N=xt(S,E);let A=N1(N,b,s.shape[i]);const R=xa(E);return A=xt(A,R),A},indices:()=>r}}};function oN(n,e){const t=[];for(let s=n;s<e;++s)t.push(s);return t}function iN(n){const e=[];for(let t=0;t<n.length;++t)for(let s=0;s<n[t].length;++s)e.push(n[t][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IQ={kernelName:mc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>bt(t),b:()=>bt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kQ={kernelName:gc,gradFunc:n=>({x:()=>Me(n,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NQ={kernelName:yc,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EQ={kernelName:xc,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Q={kernelName:vc,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AQ={kernelName:Jf,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{alpha:r}=t,o=sr(s,0);return{x:()=>Ns(o,n,j(n,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Q={kernelName:Cc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Be(n,ke(t,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RQ={kernelName:wc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Be(n,Me(t,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DQ={kernelName:e3,inputsToSave:[],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;return{logits:()=>{const i=Es(s);return ze(n,j(Ge(n,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FQ(n,e,t,s=5,r=1,o=1,i=.5){const a={x:n,y:e,dy:t},l={depthRadius:s,bias:r,alpha:o,beta:i};return Q.runKernel(wy,a,l)}const MQ=Z({localResponseNormalizationBackprop_:FQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PQ={kernelName:th,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{depthRadius:o,bias:i,alpha:a,beta:l}=t;return{x:()=>MQ(s,r,n,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bA(n,e,t,s){return e.rank<t.rank&&(e=se(e,wn(e.shape,s))),n.rank<t.rank&&(n=se(n,wn(n.shape,s))),{x:()=>j(n,Me(Br(t,e),n.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aN={kernelName:nh,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{reductionIndices:r}=s,o=e[0],i=e[1],a=gt(r,o.shape),l=bA(n,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LQ={kernelName:Tc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>j(n,Me(va(t,s),"float32")),b:()=>j(n,Me(l1(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OQ(n,e,t,s,r,o,i){const a=U(n,"dy","maxPool3dGrad"),l=U(e,"input","maxPool3dGrad"),u=U(t,"output","maxPool3dGrad");let d=a,f=l,p=u,y=!1;l.rank===4&&(y=!0,d=se(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),f=se(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),p=se(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),B(d.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${d.rank}.`),B(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),B(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),As("maxPool3dGrad",o,i);const v={dy:d,input:f,output:p},w={filterSize:s,strides:r,pad:o,dimRoundingMode:i},C=Q.runKernel(Ty,v,w);return y?se(C,[C.shape[1],C.shape[2],C.shape[3],C.shape[4]]):C}const VQ=Z({maxPool3dGrad_:OQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BQ={kernelName:rh,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=t;return{x:()=>VQ(n,s,r,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zQ(n,e,t,s,r,o,i){const a=U(n,"dy","maxPoolGrad"),l=U(e,"input","maxPoolGrad"),u=U(t,"output","maxPoolGrad");B(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),B(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),B(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),As("maxPoolGrad",o,i);const d={dy:a,input:l,output:u},f={filterSize:s,strides:r,pad:o,dimRoundingMode:i};return Q.runKernel(Cy,d,f)}const UQ=Z({maxPoolGrad_:zQ});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WQ={kernelName:sh,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a}=t;return{x:()=>UQ(n,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GQ={kernelName:oh,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t,o=gt(r,s.shape),a=Hn(s.shape,o)[1],l=we(a);return{x:()=>{const d=s.shape.slice();o.forEach(y=>{d[y]=1});const f=se(n,d);return Be(j(f,Qs(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HQ={kernelName:ih,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(n,e,t)=>{const s=t,{axis:r}=s,[o,i]=e,a=gt(r,o.shape),l=bA(n,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qQ={kernelName:Sc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e;return{a:()=>j(n,Me(wa(t,s),"float32")),b:()=>j(n,Me(sr(t,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KQ={kernelName:ah,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,o=r.map(i=>i[0]);return{x:()=>it(n,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XQ={kernelName:bc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=dt(t.shape,s.shape);return{a:()=>{const a=En(t.shape,r);return a.length>0?se(Ge(n,a),t.shape):n},b:()=>{const a=j(n,Qt(Yc(Be(t,s)))),l=En(s.shape,r);return l.length>0?se(Ge(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JQ={kernelName:Ic,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=dt(t.shape,s.shape);return{a:()=>{const a=j(n,Me(s,"float32")),l=En(t.shape,r);return l.length>0?se(Ge(a,l),t.shape):a},b:()=>{const a=j(n,Me(t,"float32")),l=En(s.shape,r);return l.length>0?se(Ge(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YQ={kernelName:lh,gradFunc:n=>({x:()=>Qt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QQ={kernelName:dh,inputsToSave:["indices"],gradFunc:(n,e)=>{const t=e[0];return{indices:()=>kn(t.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZQ={kernelName:ch,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jQ={kernelName:fh,saveAllInputs:!0,gradFunc:(n,e,t)=>{const{axis:s}=t;return zr(n,s).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lN={kernelName:hh,inputsToSave:["x"],gradFunc:(n,e,t)=>{const s=e[0],{paddings:r}=t,o=r.map(i=>i[0]);return{x:()=>it(n,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eZ={kernelName:kc,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(n,e)=>{const[t,s,r]=e,o=t,i=s,a=dt(o.shape,i.shape);return{a:()=>{const d=Me(i,"float32");let f=j(n,j(d,mi(o,ze(d,tt(1)))));const p=En(o.shape,a);return p.length>0&&(f=Ge(f,p)),se(f,o.shape)},b:()=>{const d=sr(o,0),f=Ns(d,js(o),bt(o));let p=j(n,j(r,f));const y=En(i.shape,a);return y.length>0&&(p=Ge(p,y)),se(p,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tZ={kernelName:ph,inputsToSave:["x","alpha"],gradFunc:(n,e)=>{const[t,s]=e,r=sr(t,0);return{x:()=>Ns(r,n,j(n,s)),alpha:()=>{let o=Ns(r,bt(n),j(n,t));const i=En(s.shape,n.shape);return i.length>0&&(o=Ge(o,i)),se(o,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nZ(n,e,t){const s=n.shape.slice();s[t]=1;const r=se(e,s),o=mf(n,t,!0,!1),i=mf(n,t,!0,!0),a=j(o,i);return j(r,a)}function sZ(n,e,t){const s=n.shape.length,r=s-t.length,o=hn(t,s);let i=n;o!=null&&(i=xt(n,o));const a=i.shape.slice(),u=a.splice(s-t.length,t.length).reduce((p,y)=>p*y,1);a.push(u);const d=i.reshape(a);let f=nZ(d,e,r);if(f=f.reshape(i.shape),o!=null){const p=xa(o);f=xt(f,p)}return f}const rZ={kernelName:mh,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{axis:r}=t;let o=[];return r==null?o=s.shape.map((i,a)=>a):typeof r=="number"?o=[r]:o=r,{x:()=>sZ(s,n,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oZ={kernelName:lc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=dt(t.shape,s.shape);return{a:()=>{const a=Be(n,Me(s,"float32")),l=En(t.shape,r);return l.length>0?se(Ge(a,l),t.shape):a},b:()=>{let a=j(n,Me(t,"float32"));const l=En(s.shape,r);l.length>0&&(a=se(Ge(a,l),s.shape));const u=Ut(s);return Qt(Be(a,Me(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iZ={kernelName:Nc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Be(n,Qt(Ut(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aZ={kernelName:$c,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e,s=j(wa(t,6),_l(t));return{x:()=>j(n,Me(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lZ={kernelName:Ec,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,Me(_l(t),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uZ={kernelName:gh,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>se(n,t.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cZ={kernelName:xh,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>Q.runKernel(Dy,r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dZ={kernelName:yh,inputsToSave:["images"],gradFunc:(n,e,t)=>{const[s]=e,r={dy:n,images:s};return{images:()=>Q.runKernel(Ry,r,t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fZ={kernelName:vh,gradFunc:(n,e,t)=>{const{dims:s}=t,r=gt(s,n.shape);return{x:()=>yr(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hZ={kernelName:Ac,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pZ={kernelName:_c,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Qt(Be(n,j(mi(t,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mZ={kernelName:wh,inputsToSave:["condition"],gradFunc:(n,e)=>{const[t]=e;return{condition:()=>Me(bt(t),"float32"),t:()=>j(n,Me(t,n.dtype)),e:()=>j(n,Me(Oh(t),n.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gZ={kernelName:Rc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>{const s=sr(t,tt(0)),r=tt(G1),o=tt(H1),i=j(n,o),a=j(j(n,r),Es(Me(t,"float32")));return Ns(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yZ={kernelName:Pc,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,j(t,ze(tt(1),t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xZ={kernelName:Mc,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vZ={kernelName:Dc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(Mh(Me(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wZ={kernelName:Fc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(o1(Me(t,"float32")),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CZ={kernelName:Ch,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{begin:r,size:o}=t,i=s.shape,[a,l]=e1(s,r,o),u=[];for(let d=0;d<n.rank;d++)u.push([a[d],i[d]-a[d]-l[d]]);return{x:()=>bi(n,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TZ={kernelName:Ih,outputsToSave:[!0],gradFunc:(n,e,t)=>{const[s]=e,{dim:r}=t,o=!0,i=j(n,s);return{logits:()=>ze(i,j(Ge(i,[r],o),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SZ={kernelName:Lc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,Or(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uN={kernelName:Sh,gradFunc:(n,e,t)=>{const{blockShape:s,paddings:r}=t;return{x:()=>Fh(n,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cN={kernelName:bh,gradFunc:(n,e,t)=>{const{axis:s}=t;return{x:()=>dn(n,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bZ={kernelName:Oc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Be(n,j(ts(Me(t,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IZ={kernelName:zy,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(n,j(Me(t,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kZ={kernelName:Vc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=tt(2);return{a:()=>j(n,j(r,ze(t,s))),b:()=>j(n,j(r,ze(s,t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NZ={kernelName:Gc,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EZ={kernelName:Bc,inputsToSave:["a","b"],gradFunc:(n,e)=>{const[t,s]=e,r=dt(t.shape,s.shape);return{a:()=>{let a=n;const l=En(t.shape,r);return l.length>0&&(a=Ge(a,l)),se(a,t.shape)},b:()=>{let a=n;const l=En(s.shape,r);return l.length>0&&(a=Ge(a,l)),se(Qt(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Z={kernelName:Th,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,r=s.shape.slice(),{axis:o}=t;gt(o,s.shape).forEach(u=>{r[u]=1});const a=se(n,r),l=j(a,Qs(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AZ={kernelName:zc,inputsToSave:["x"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>Be(n,Ut(Mh(t)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Z={kernelName:Uc,outputsToSave:[!0],gradFunc:(n,e)=>{const[t]=e;return{x:()=>j(ze(tt(1),Ut(t)),n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RZ={kernelName:Wc,inputsToSave:["x"],gradFunc:(n,e,t)=>{const[s]=e,{reps:r}=t;return{x:()=>{let i=bt(s);if(s.rank===1)for(let a=0;a<r[0];++a)i=ke(i,it(n,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)i=ke(i,it(n,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)i=ke(i,it(n,[a*s.shape[0],l*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let u=0;u<r[2];++u)for(let d=0;d<r[3];++d)i=ke(i,it(n,[a*s.shape[0],l*s.shape[1],u*s.shape[2],d*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DZ={kernelName:sl,gradFunc:(n,e,t)=>{const s=t,{perm:r}=s,o=xa(r);return{x:()=>xt(n,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FZ={kernelName:kh,gradFunc:(n,e,t)=>{const s=t,{axis:r}=s;return{value:()=>xr(n,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MZ={kernelName:Nh,inputsToSave:["segmentIds"],gradFunc:(n,e)=>{const[t]=e;return{x:()=>PZ(n,t)}}};function PZ(n,e){const t=Vo(e,bt(e)),s=Qc(n,t);let r=va(e,tt(0,"int32"));const o=s.rank-r.rank;for(let a=0;a<o;++a)r=Zn(r,a+1);r=ao(r,Qs(s.shape,"bool"));const i=bt(s);return Ns(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LZ={kernelName:Eh,gradFunc:n=>({x:()=>bt(n)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OZ=[SA,MY,PY,LY,OY,VY,BY,zY,UY,WY,GY,HY,XY,QY,ZY,jY,eQ,tQ,nQ,sQ,rQ,oQ,aQ,iQ,cQ,dQ,fQ,hQ,pQ,mQ,oZ,gQ,yQ,xQ,vQ,wQ,TQ,CQ,SQ,bQ,IQ,kQ,NQ,EQ,$Q,AQ,_Q,RQ,DQ,PQ,aN,aN,LQ,BQ,WQ,GQ,HQ,qQ,KQ,XQ,JQ,YQ,QQ,ZQ,jQ,lN,lN,eZ,tZ,rZ,iZ,aZ,lZ,uZ,cZ,dZ,fZ,hZ,pZ,mZ,gZ,yZ,xZ,vZ,wZ,CZ,TZ,SZ,uN,uN,cN,cN,bZ,kZ,IZ,NZ,EZ,$Z,AZ,_Z,RZ,DZ,FZ,MZ,LZ];for(const n of OZ)t3(n);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.abs=function(){return this.throwIfDisposed(),In(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.acos=function(){return this.throwIfDisposed(),mw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.acosh=function(){return this.throwIfDisposed(),gw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.add=function(n){return this.throwIfDisposed(),ke(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.all=function(n,e){return this.throwIfDisposed(),n1(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.any=function(n,e){return this.throwIfDisposed(),pf(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.argMax=function(n){return this.throwIfDisposed(),ml(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.argMin=function(n){return this.throwIfDisposed(),yw(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.asScalar=function(){return this.throwIfDisposed(),B(this.size===1,()=>"The array must have only 1 element."),se(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.asType=function(n){return this.throwIfDisposed(),Me(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.as1D=function(){return this.throwIfDisposed(),se(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.as2D=function(n,e){return this.throwIfDisposed(),se(this,[n,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.as3D=function(n,e,t){return this.throwIfDisposed(),se(this,[n,e,t])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.as4D=function(n,e,t,s){return this.throwIfDisposed(),se(this,[n,e,t,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.as5D=function(n,e,t,s,r){return this.throwIfDisposed(),se(this,[n,e,t,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.asin=function(){return this.throwIfDisposed(),xw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.asinh=function(){return this.throwIfDisposed(),vw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.atan=function(){return this.throwIfDisposed(),ww(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.atan2=function(n){return this.throwIfDisposed(),Cw(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.atanh=function(){return this.throwIfDisposed(),Tw(this)};Ce().prototype.avgPool=function(n,e,t,s){return this.throwIfDisposed(),Dh(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.batchToSpaceND=function(n,e){return this.throwIfDisposed(),Fh(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.batchNorm=function(n,e,t,s,r){return this.throwIfDisposed(),qc(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.broadcastTo=function(n){return this.throwIfDisposed(),ol(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.cast=function(n){return this.throwIfDisposed(),Me(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.ceil=function(){return this.throwIfDisposed(),$w(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.clipByValue=function(n,e){return this.throwIfDisposed(),ks(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.concat=function(n,e){return this.throwIfDisposed(),n instanceof St&&(n=[n]),dn([this,...n],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.conv1d=function(n,e,t,s,r,o){return this.throwIfDisposed(),s1(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.conv2dTranspose=function(n,e,t,s,r){return this.throwIfDisposed(),r1(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.conv2d=function(n,e,t,s,r,o){return this.throwIfDisposed(),pi(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.cos=function(){return this.throwIfDisposed(),Mh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.cosh=function(){return this.throwIfDisposed(),o1(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.cumprod=function(n,e,t){return this.throwIfDisposed(),mf(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.cumsum=function(n,e,t){return this.throwIfDisposed(),i1(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.depthToSpace=function(n,e){return this.throwIfDisposed(),Lw(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.depthwiseConv2d=function(n,e,t,s,r,o){return this.throwIfDisposed(),Kc(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.dilation2d=function(n,e,t,s,r){return this.throwIfDisposed(),Ow(this,n,e,t,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.divNoNan=function(n){return this.throwIfDisposed(),Vw(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.div=function(n){return this.throwIfDisposed(),Be(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.dot=function(n){return this.throwIfDisposed(),Bw(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.elu=function(){return this.throwIfDisposed(),Xc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.equal=function(n){return this.throwIfDisposed(),Br(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.erf=function(){return this.throwIfDisposed(),zw(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.euclideanNorm=function(n,e){return this.throwIfDisposed(),Ww(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.exp=function(){return this.throwIfDisposed(),Es(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.expandDims=function(n){return this.throwIfDisposed(),Zn(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.expm1=function(){return this.throwIfDisposed(),Gw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.fft=function(){return this.throwIfDisposed(),qh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.flatten=function(){return this.throwIfDisposed(),se(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.floor=function(){return this.throwIfDisposed(),Yc(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.floorDiv=function(n){return this.throwIfDisposed(),t1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.gather=function(n,e){return this.throwIfDisposed(),Qc(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.greaterEqual=function(n){return this.throwIfDisposed(),va(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.greater=function(n){return this.throwIfDisposed(),sr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.ifft=function(){return this.throwIfDisposed(),Lu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.irfft=function(){return this.throwIfDisposed(),b1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.isFinite=function(){return this.throwIfDisposed(),Hw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.isInf=function(){return this.throwIfDisposed(),qw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.isNaN=function(){return this.throwIfDisposed(),Kw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.leakyRelu=function(n){return this.throwIfDisposed(),Ph(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.lessEqual=function(n){return this.throwIfDisposed(),wa(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.less=function(n){return this.throwIfDisposed(),l1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.localResponseNormalization=function(n,e,t,s){return this.throwIfDisposed(),Xw(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.logSigmoid=function(){return this.throwIfDisposed(),Jw(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.logSoftmax=function(n){return this.throwIfDisposed(),c1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.logSumExp=function(n,e){return this.throwIfDisposed(),d1(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.log=function(){return this.throwIfDisposed(),js(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.log1p=function(){return this.throwIfDisposed(),Lh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.logicalAnd=function(n){return this.throwIfDisposed(),ao(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.logicalNot=function(){return this.throwIfDisposed(),Oh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.logicalOr=function(n){return this.throwIfDisposed(),f1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.logicalXor=function(n){return this.throwIfDisposed(),Yw(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.matMul=function(n,e,t){return this.throwIfDisposed(),mt(this,n,e,t)};Ce().prototype.maxPool=function(n,e,t,s){return this.throwIfDisposed(),Vh(this,n,e,t,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.max=function(n,e){return this.throwIfDisposed(),Vr(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.maximum=function(n){return this.throwIfDisposed(),Vo(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.mean=function(n,e){return this.throwIfDisposed(),un(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.min=function(n,e){return this.throwIfDisposed(),gf(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.minimum=function(n){return this.throwIfDisposed(),Zc(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.mirrorPad=function(n,e){return this.throwIfDisposed(),Zw(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.mod=function(n){return this.throwIfDisposed(),jw(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.mul=function(n){return this.throwIfDisposed(),j(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.neg=function(){return this.throwIfDisposed(),Qt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.norm=function(n,e,t){return this.throwIfDisposed(),Jc(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.notEqual=function(n){return this.throwIfDisposed(),yl(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.oneHot=function(n,e=1,t=0){return this.throwIfDisposed(),Du(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.onesLike=function(){return this.throwIfDisposed(),er(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.pad=function(n,e){return this.throwIfDisposed(),bi(this,n,e)};Ce().prototype.pool=function(n,e,t,s,r,o){return this.throwIfDisposed(),eC(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.pow=function(n){return this.throwIfDisposed(),mi(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.prelu=function(n){return this.throwIfDisposed(),Uh(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.prod=function(n,e){return this.throwIfDisposed(),tC(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.reciprocal=function(){return this.throwIfDisposed(),sC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.relu=function(){return this.throwIfDisposed(),fo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.relu6=function(){return this.throwIfDisposed(),g1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.reshapeAs=function(n){return this.throwIfDisposed(),se(this,n.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.reshape=function(n){return this.throwIfDisposed(),se(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.resizeBilinear=function(n,e,t){return this.throwIfDisposed(),F$(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.resizeNearestNeighbor=function(n,e,t){return this.throwIfDisposed(),M$(this,n,e,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.reverse=function(n){return this.throwIfDisposed(),yr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.rfft=function(){return this.throwIfDisposed(),Kh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.round=function(){return this.throwIfDisposed(),y1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.rsqrt=function(){return this.throwIfDisposed(),x1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.selu=function(){return this.throwIfDisposed(),v1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.separableConv2d=function(n,e,t,s,r,o){return this.throwIfDisposed(),w1(this,n,e,t,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.sigmoid=function(){return this.throwIfDisposed(),Or(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.sign=function(){return this.throwIfDisposed(),rC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.sin=function(){return this.throwIfDisposed(),C1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.sinh=function(){return this.throwIfDisposed(),T1(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.slice=function(n,e){return this.throwIfDisposed(),it(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.softmax=function(n){return this.throwIfDisposed(),Hh(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.softplus=function(){return this.throwIfDisposed(),Al(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.spaceToBatchND=function(n,e){return this.throwIfDisposed(),zh(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.split=function(n,e){return this.throwIfDisposed(),Ls(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.sqrt=function(){return this.throwIfDisposed(),ts(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.square=function(){return this.throwIfDisposed(),Ut(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.squaredDifference=function(n){return this.throwIfDisposed(),I1(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.squeeze=function(n){return this.throwIfDisposed(),an(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.stack=function(n,e){this.throwIfDisposed();const t=n instanceof St?[this,n]:[this,...n];return xr(t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.step=function(n){return this.throwIfDisposed(),_l(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.stridedSlice=function(n,e,t,s,r,o,i,a){return this.throwIfDisposed(),oC(this,n,e,t,s,r,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.sub=function(n){return this.throwIfDisposed(),ze(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.sum=function(n,e){return this.throwIfDisposed(),Ge(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.tan=function(){return this.throwIfDisposed(),iC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.tanh=function(){return this.throwIfDisposed(),gl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.tile=function(n){return this.throwIfDisposed(),pr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.toBool=function(){return this.throwIfDisposed(),Me(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.toFloat=function(){return this.throwIfDisposed(),Me(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.toInt=function(){return this.throwIfDisposed(),Me(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.topk=function(n,e){return this.throwIfDisposed(),aC(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.transpose=function(n){return this.throwIfDisposed(),xt(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.unique=function(n){return this.throwIfDisposed(),lC(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.unsortedSegmentSum=function(n,e){return this.throwIfDisposed(),N1(this,n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.unstack=function(n){return this.throwIfDisposed(),zr(this,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.where=function(n,e){return this.throwIfDisposed(),Ns(n,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Ce().prototype.zerosLike=function(){return this.throwIfDisposed(),bt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Io extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Io.prototype)}}class Mr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Mr.prototype)}}class le extends Error{constructor(e){super(e),Object.setPrototypeOf(this,le.prototype)}}class pt extends Error{constructor(e){super(e),Object.setPrototypeOf(this,pt.prototype)}}class BC extends Error{constructor(e){super(e),Object.setPrototypeOf(this,BC.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class IA{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let t;return this.cache.has(e)&&(t=this.cache.get(e),this.cache.delete(e),this.cache.set(e,t)),t}put(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,t)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let t=0;t<this.maxEntries-e;t++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wl(n,e){if(Array.isArray(n)){let t=[];for(let s=0;s<e;s++)t=t.concat(n);return t}else{const t=new Array(e);return t.fill(n),t}}function ko(n,e){if(!n)throw new BC(e)}function dN(n,e){let t=0;for(const s of n)s===e&&t++;return t}function Ps(n){return n.length===1?n[0]:n}function Yt(n){return Array.isArray(n)?n:[n]}function si(n){const t=n.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return t[0]!=="_"?t:"private"+t}function Za(n){return n.length<=1||n.indexOf("_")===-1?n:n.replace(/[_]+(\w|$)/g,(e,t)=>t.toUpperCase())}let $r={};function zC(n){if(n==null)return null;const e={};return e.className=n.getClassName(),e.config=n.getConfig(),e}function c2(n){if(!(n==null||typeof n!="object"))if(Array.isArray(n))n.forEach(e=>c2(e));else{const e=Object.keys(n);for(const t of e){const s=n[t];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?n[t]=s.value:c2(s))}}}function Zh(n,e={},t={},s="object",r=!1){if(typeof n=="string"){const o=n;let i;if(o in t)i=t[o];else if(o in $r)i=$r[o];else if(i=e[o],i==null)throw new le(`Unknown ${s}: ${n}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=n;if(o.className==null||o.config==null)throw new le(`${s}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in t?[a,l]=t[i]:i in $r?[a,l]=$r.className:i in e&&([a,l]=e[i]),a==null)throw new le(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const u={};for(const y of Object.keys($r))u[y]=$r[y];for(const y of Object.keys(t))u[y]=t[y];const d=o.config;d.customObjects=u;const f=Object.assign({},$r);for(const y of Object.keys(t))$r[y]=t[y];c2(o.config);const p=l(a,o.config,t,r);return $r=Object.assign({},f),p}else{const u=Object.assign({},$r);for(const f of Object.keys(t))$r[f]=t[f];const d=new a(o.config);return $r=Object.assign({},u),d}}}function VZ(n,e){return n<e?-1:n>e?1:0}function Fm(n,e){return-1*VZ(n,e)}function ra(n){if(n==null)return n;const e=[];for(const t of n)e.indexOf(t)===-1&&e.push(t);return e}function BZ(n){if(n==null)throw new le(`Invalid value in obj: ${JSON.stringify(n)}`);for(const e in n)if(n.hasOwnProperty(e))return!1;return!0}function Rl(n,e,t){if(t!=null&&n.indexOf(t)<0)throw new le(`${t} is not a valid ${e}.  Valid values are ${n} or null/undefined.`)}function UC(n,e,t=0,s=1/0){return ko(t>=0),ko(s>=t),Array.isArray(n)&&n.length>=t&&n.length<=s&&n.every(r=>typeof r===e)}function Wn(n,e){Array.isArray(n)?(B(n.length>0,()=>`${e} is unexpectedly an empty array.`),n.forEach((t,s)=>Wn(t,`element ${s+1} of ${e}`))):B(Number.isInteger(n)&&n>0,()=>`Expected ${e} to be a positive integer, but got ${kA(n)}.`)}function kA(n){return n===null?"null":Array.isArray(n)?"["+n.map(e=>kA(e)).join(",")+"]":typeof n=="string"?`"${n}"`:`${n}`}function zZ(n,e,t){let s=t!=null?t():vs(),r;return(...i)=>{const a=t!=null?t():vs();return a-s<e||(s=a,r=n(...i)),r}}function NA(n){return n==="relu"?"relu":n==="linear"?"linear":n==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let UZ=0;function EA(){return UZ++}const Mm={};function q1(n=""){return n in Mm||(Mm[n]=0),Mm[n]+=1,n+Mm[n].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const WZ=["channelsFirst","channelsLast"],GZ=["nearest","bilinear"],HZ=["valid","same","causal"],qZ=["max","avg"],KZ=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const yu=new Map;function Tn(n){Rl(WZ,"DataFormat",n)}function XZ(n){Rl(GZ,"InterpolationFormat",n)}function vr(n){Rl(HZ,"PaddingMode",n)}function $A(n){Rl(qZ,"PoolMode",n)}const af=[],fN="/";function il(n,e){af.push(n);try{const t=e();return af.pop(),t}catch(t){throw af.pop(),t}}function JZ(){return af.length===0?"":af.join(fN)+fN}function AA(n){if(!RA(n))throw new Error("Not a valid tensor name: '"+n+"'");return JZ()+n}function _A(n){if(!RA(n))throw new Error("Not a valid tensor name: '"+n+"'");yu.has(n)||yu.set(n,0);const e=yu.get(n);if(yu.set(n,yu.get(n)+1),e>0){const t=`${n}_${e}`;return yu.set(t,1),t}else return n}const YZ=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function RA(n){return!!n.match(YZ)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QZ(n){return n===parseInt(n.toString(),10)}function oa(n,e,t){e==null&&(e=0),t==null&&(t=n.length);let s=1;for(let r=e;r<t;++r)s*=n[r];return s}function Ou(n){if(n.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s<e&&(e=s)}return e}function ca(n){if(n.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let t=0;t<n.length;t++){const s=n[t];s>e&&(e=s)}return e}function lo(n,e){if(e<n)throw new le(`end (${e}) < begin (${n}) is forbidden.`);const t=[];for(let s=n;s<e;++s)t.push(s);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let lv;function Dn(){return lv==null&&(lv=E3().epsilon()),lv}function uo(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jh(n,e){return Me(n,e)}function ep(n,e=-1){const t=n.shape.slice();return e<0&&(e=t.length+e+1),t.splice(e,0,1),se(n,t)}function ZZ(n,e){return he(()=>{if(n.shape.length!==2)throw new le(`repeat() expects a rank-2 tensor, but received a rank-${n.shape.length} tensor.`);const t=ep(n,1);return d2(t,[1,e,1])})}function jZ(n){const e=[oa(n.shape)];return se(n,e)}function ej(n){if(n.rank<=1)throw new le(`batchFlatten requires a minimum rank of 2. Got rank: ${n.rank}.`);const e=[n.shape[0],oa(n.shape,1)];return se(n,e)}function al(n,e,t){return he(()=>{switch(n.rank){case 1:return Wh(n,e,t);case 2:return S1(n,[e,0],[t,n.shape[1]]);case 3:return Gh(n,[e,0,0],[t,n.shape[1],n.shape[2]]);case 4:return Pu(n,[e,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3]]);case 5:return it(n,[e,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4]]);case 6:return it(n,[e,0,0,0,0,0],[t,n.shape[1],n.shape[2],n.shape[3],n.shape[4],n.shape[5]]);default:throw new le(`sliceAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}})}function uv(n,e,t){return he(()=>{switch(n.rank){case 1:return Wh(n,e,t);case 2:return S1(n,[0,e],[n.shape[0],t]);case 3:return Gh(n,[0,0,e],[n.shape[0],n.shape[1],t]);case 4:return Pu(n,[0,0,0,e],[n.shape[0],n.shape[1],n.shape[2],t]);default:throw new le(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function Pm(n,e,t,s){return he(()=>{switch(n.rank){case 1:return Wh(n,e,t);case 2:switch(s){case 1:return al(n,e,t);case 2:return uv(n,e,t);default:throw new le(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return al(n,e,t);case 2:return Gh(n,[0,e,0],[n.shape[0],t,n.shape[2]]);case 3:return uv(n,e,t);default:throw new le(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return al(n,e,t);case 2:return Pu(n,[0,e,0,0],[n.shape[0],t,n.shape[2],n.shape[3]]);case 3:return Pu(n,[0,0,e,0],[n.shape[0],n.shape[1],t,n.shape[3]]);case 4:return uv(n,e,t);default:throw new le(`The axis is not within the rank of the tensor ${s}`)}default:throw new le(`sliceAlongLastAxis() received an unsupported tensor rank: ${n.rank}`)}})}function WC(n,e=-1){let t;return e<0&&(t=n[0].rank,t!==0?e=t:e=0),e===n[0].rank&&(e=-1),dn(n,e)}function hN(n,e){switch(n.rank){case 1:return Aw([n,e]);case 2:return _w([n,e],0);case 3:return Rw([n,e],0);case 4:return Dw([n,e],0);default:throw new le(`concatAlongFirstAxis() received an unsupported tensor rank: ${n.rank}`)}}function d2(n,e){if(Array.isArray(e)||(e=[e]),n.rank!==e.length)throw new le(`The length of input n (${e.length}) does not match the number of dimensions in input x (${n.rank})`);return pr(n,e)}function K1(n,e=0,t=1,s,r){return m1(n,e,t,s,r)}function Fo(n,e,t,s){if(n.rank<2||e.rank<2)throw new pt(`dot requires both inputs to be rank >= 2 but got x shape = ${n.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=n.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(r!==o)throw new pt(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${n.shape} and  y shape = ${e.shape}`)}if(n.rank===2&&e.rank===2)return Yv({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?f2(n.rank,s,uo()):null,activation:t});{const r=n.shape.slice(),o=r.pop();n=se(n,[-1,o]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),u=[...i,a],d=Array.from({length:e.rank},(v,w)=>w===0?e.rank-2:w<=e.rank-2?w-1:w);e=se(xt(e,d),[l,-1]);const f=[...r,...u];return se(Yv({a:n,b:e,transposeA:!1,transposeB:!1,bias:s?f2(n.rank,s,uo()):null,activation:t}),f)}}function DA(n,e,t){return he(()=>(Array.isArray(e)?e=Nn(e,"int32"):e=Me(e,"int32"),Qc(n,e,t)))}function tp(n){return j(n,n)}function f2(n,e,t){const s=e.shape;if(e.rank!==1&&e.rank!==n)throw new le(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${n}`);if(n===5){if(t==="channelsFirst")return s.length===1?se(e,[1,s[0],1,1,1]):se(e,[1,s[3],s[0],s[1],s[2]]);if(t==="channelsLast")return s.length===1?se(e,[1,1,1,1,s[0]]):se(e,[1].concat(s))}else if(n===4){if(t==="channelsFirst")return s.length===1?se(e,[1,s[0],1,1]):se(e,[1,s[2],s[0],s[1]]);if(t==="channelsLast")return s.length===1?se(e,[1,1,1,s[0]]):se(e,[1].concat(s))}else if(n===3){if(t==="channelsFirst")return s.length===1?se(e,[1,s[0],1]):se(e,[1,s[1],s[0]]);if(t==="channelsLast")return s.length===1?se(e,[1,1,s[0]]):se(e,[1].concat(s))}else if(n<3)return e;throw new le(`Unsupported input rank by biasAdd: ${e.rank}`)}function ho(n,e,t){return he(()=>(t==null&&(t=uo()),Tn(t),ke(n,f2(n.rank,e,t))))}function tj(n,e=1){if(e!==1)throw new pt(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Xc(n)}function nj(n){return he(()=>Be(n,ke(In(n),1)))}function FA(n,e,t,s){return he(()=>dC(n,e,t,s))}function sj(n){return he(()=>{const e=ke(.5,j(.2,n));return ks(e,0,1)})}function np(n,e,t=!1){return t?n():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const rj=["fanIn","fanOut","fanAvg"],oj=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ij(n){Rl(rj,"FanMode",n)}function aj(n){Rl(oj,"Distribution",n)}class Wr extends El{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class MA extends Wr{apply(e,t){return kn(e,t)}}MA.className="Zeros";Ne(MA);class GC extends Wr{apply(e,t){return Qs(e,t)}}GC.className="Ones";Ne(GC);class PA extends Wr{constructor(e){if(super(),typeof e!="object")throw new le(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new le(`config must have value set but got ${e}`);this.value=e.value}apply(e,t){return he(()=>j(tt(this.value),Qs(e,t)))}getConfig(){return{value:this.value}}}PA.className="Constant";Ne(PA);class LA extends Wr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,t){return jc(e,this.minval,this.maxval,t)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}LA.className="RandomUniform";Ne(LA);class OA extends Wr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new pt(`randomNormal does not support dType ${t}.`);return K1(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}OA.className="RandomNormal";Ne(OA);class VA extends Wr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,t){if(t=t||"float32",t!=="float32"&&t!=="int32")throw new pt(`truncatedNormal does not support dType ${t}.`);return k1(e,this.mean,this.stddev,t,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}VA.className="TruncatedNormal";Ne(VA);class BA extends Wr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,t){return he(()=>{if(e.length!==2||e[0]!==e[1])throw new le("Identity matrix initializer can only be used for 2D square matrices.");return j(this.gain,a1(e[0]))})}getConfig(){return{gain:this.gain}}}BA.className="Identity";Ne(BA);function lj(n,e="channelsLast"){let t,s;if(Tn(e),n.length===2)t=n[0],s=n[1];else if([3,4,5].indexOf(n.length)!==-1){if(e==="channelsFirst"){const r=oa(n,2);t=n[1]*r,s=n[0]*r}else if(e==="channelsLast"){const r=oa(n,0,n.length-2);t=n[n.length-2]*r,s=n[n.length-1]*r}}else{const r=oa(n);t=Math.sqrt(r),s=Math.sqrt(r)}return[t,s]}class tr extends Wr{constructor(e){if(super(),e.scale<0)throw new le(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,ij(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,aj(this.distribution),this.seed=e.seed}apply(e,t){const s=lj(e),r=s[0],o=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(r+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(t=t||"float32",t!=="float32"&&t!=="int32")throw new pt(`${this.getClassName()} does not support dType ${t}.`);return k1(e,0,a,t,this.seed)}else{const a=Math.sqrt(3*i);return jc(e,-a,a,t)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}tr.className="VarianceScaling";Ne(tr);class HC extends tr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return tr.className}}HC.className="GlorotUniform";Ne(HC);class qC extends tr{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return tr.className}}qC.className="GlorotNormal";Ne(qC);class KC extends tr{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return tr.className}}KC.className="HeNormal";Ne(KC);class XC extends tr{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return tr.className}}XC.className="HeUniform";Ne(XC);class JC extends tr{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return tr.className}}JC.className="LeCunNormal";Ne(JC);class YC extends tr{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return tr.className}}YC.className="LeCunNormal";Ne(YC);class zA extends Wr{constructor(e){if(super(),this.DEFAULT_GAIN=1,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed,this.seed!=null)throw new pt("Random seed is not implemented for Orthogonal Initializer yet.")}apply(e,t){return he(()=>{if(e.length<2)throw new pt("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn(`Orthogonal initializer is being called on a matrix with more than 2000 (${e[0]*e[1]}) elements: Slowness may result.`);const s=e[0]>e[1]?[e[1],e[0]]:e,r=K1(s,0,1,"float32");let o=mC.gramSchmidt(r);return e[0]>e[1]&&(o=xt(o)),j(this.gain,o)})}getConfig(){return{gain:this.gain,seed:this.seed}}}zA.className="Orthogonal";Ne(zA);const pN={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function mN(n,e={}){return Zh(n,hr.getMap().classNameMap,e,"initializer")}function cn(n){return zC(n)}function tn(n){if(typeof n=="string"){const e=n in pN?pN[n]:n;if(e==="GlorotNormal")return new qC;if(e==="GlorotUniform")return new HC;if(e==="HeNormal")return new KC;if(e==="HeUniform")return new XC;if(e==="LeCunNormal")return new JC;if(e==="LeCunUniform")return new YC;{const t={};return t.className=e,t.config={},mN(t)}}else return n instanceof Wr?n:mN(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function h2(n){return Array.isArray(n)&&Array.isArray(n[0])}function bg(n){return n.length===0?[]:Array.isArray(n[0])?n:[n]}function ft(n){let e;if(Array.isArray(n)){if(n.length!==1)throw new le(`Expected Tensor length to be 1; got ${n.length}`);e=n[0]}else e=n;return e}function Vt(n){if(Array.isArray(n)&&Array.isArray(n[0])){if(n.length===1)return n=n,n[0];throw new le(`Expected exactly 1 Shape; got ${n.length}`)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ig(n){let e=0;for(const t of n)t.shape.length===0?e+=1:e+=t.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const gN="Variable";class uj{constructor(e,t="float32",s=gN,r=!0,o=null){this.dtype=t??"float32",this.shape=e.shape,this.id=EA(),s=s??gN,this.originalName=AA(s),this.name=_A(this.originalName),this.trainable_=r,this.constraint=o,this.val=uC(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),cj(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function cj(n,e){if(n.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(n.shape)+" vs. "+JSON.stringify(e.shape))}function p2(n){return n.map(e=>e.read())}function QC(n){n.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Fn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class $o{constructor(e,t,s,r,o,i,a){this.dtype=e,this.shape=t,this.sourceLayer=s,this.inputs=r,this.callArgs=o,this.outputTensorIndex=a,this.id=EA(),i!=null&&(this.originalName=AA(i),this.name=_A(this.originalName)),this.rank=t.length}}let dj=0;class X1{constructor(e,t){this.callArgs=t,this.id=dj++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const t of this.inboundLayers)t!=null?e.push(t.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let fj=0;class kt extends El{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=fj++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let t=e.name;if(!t){const s=this.getClassName();t=si(s)+"_"+q1(s)}if(this.name=t,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),s=[o].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,t){return e.name+"_ib-"+t.toString()}getNodeAtIndex(e,t){if(this.inboundNodes.length===0)throw new Mr(`The layer has never been called and thus has no defined ${t}.`);if(this.inboundNodes.length<=e)throw new le(`Asked to get ${t} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Ps(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Ps(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new Io(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new Io(`Layer ${this.name} is not connected, no input to return.`);return Ps(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new Io(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new Io(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Ps(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(t=>t.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){if(e=Yt(e),this.inputSpec==null||this.inputSpec.length===0)return;const t=Yt(this.inputSpec);if(e.length!==t.length)throw new le(`Layer ${this.name} expects ${t.length} inputs, but it received ${e.length} input tensors. Input received: ${e}`);for(let s=0;s<e.length;s++){const r=e[s],o=t[s];if(o==null)continue;const i=r.rank;if(o.ndim!=null&&i!==o.ndim)throw new le(`Input ${s} is incompatible with layer ${this.name}: expected ndim=${o.ndim}, found ndim=${i}`);if(o.maxNDim!=null&&i>o.maxNDim)throw new le(`Input ${s} is incompatible with layer ${this.name}: expected max_ndim=${o.maxNDim}, found ndim=${i}`);if(o.minNDim!=null&&i<o.minNDim)throw new le(`Input ${s} is incompatible with layer ${this.name}: expected min_ndim=${o.minNDim}, found ndim=${i}.`);if(o.dtype!=null&&r.dtype!==o.dtype)throw new le(`Input ${s} is incompatible with layer ${this.name} : expected dtype=${o.dtype}, found dtype=${r.dtype}.`);if(o.axes){const a=r.shape;for(const l in o.axes){const u=Number(l),d=o.axes[l],f=u>=0?a[u]:a[a.length+u];if(d!=null&&[d,null].indexOf(f)===-1)throw new le(`Input ${s} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${a}.`)}}if(o.shape!=null)for(let a=0;a<o.shape.length;++a){const l=o.shape[a],u=r.shape[a];if(l!=null&&u!=null&&l!==u)throw new le(`Input ${s} is incompatible with layer ${this.name}: expected shape=${o.shape}, found shape=${r.shape}.`)}}}call(e,t){return e}invokeCallHook(e,t){this._callHook!=null&&this._callHook(e,t)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,t){t=t||{},this.assertNotDisposed();const s=Yt(e);let r=!0;for(const i of s)if(!(i instanceof $o)){r=!1;break}let o=!0;for(const i of s)if(i instanceof $o){o=!1;break}if(r===o)throw new le("Arguments to apply() must be all SymbolicTensors or all Tensors");return il(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of Yt(e))i.push(a.shape);this.build(Ps(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,t);const a=Yt(i),l=[];for(let u of a)s.indexOf(u)!==-1&&(u=u.clone()),l.push(u);if(i=Ps(l),this.activityRegularizer!=null)throw new pt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=hj(e),a=this.computeOutputShape(i);let l;const u=pj(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((d,f)=>new $o(u,d,this,Yt(e),t,this.name,f)):l=new $o(u,a,this,Yt(e),t,this.name),this.addInboundNode(e,l,null,null,i,a,t),this._refCount++,this.activityRegularizer!=null)throw new pt("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let t=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(t=!0)}),t&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new Io(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const t of this.inboundNodes){const s=JSON.stringify(t.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const t=this.inboundNodes[0].outputShapes;return Array.isArray(t)&&Array.isArray(t[0])&&t.length===1?t[0]:t}else throw new Io(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Mr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Ig(this.weights)}build(e){this.built=!0}getWeights(e=!1){return p2(e?this.trainableWeights:this.weights)}setWeights(e){he(()=>{const t=this.weights;if(t.length!==e.length)throw new le(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${t.length} weights. Provided weights: ${e}...`);if(t.length===0)return;const s=[],r=p2(t);for(let o=0;o<r.length;++o){const i=r[o],a=t[o],l=e[o];if(!Ct(i.shape,l.shape))throw new le(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}QC(s)})}addWeight(e,t,s,r,o,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new le(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():tn("zeros"));const u=r.apply(t,s),d=new uj(u,s,e,i,a);return u.dispose(),o!=null&&this.addLoss(()=>o.apply(d.read())),i==null&&(i=!0),i?this._trainableWeights.push(d):this._nonTrainableWeights.push(d),d}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Yt(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,t){if(!this.supportsMasking){if(t!=null)if(Array.isArray(t))t.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return t}addInboundNode(e,t,s,r,o,i,a=null){const l=Yt(e);t=Yt(t),s=Yt(s),r=Yt(r),o=bg(o),i=bg(i);const u=[],d=[],f=[];for(const p of l)u.push(p.sourceLayer),d.push(p.nodeIndex),f.push(p.tensorIndex);new X1({outboundLayer:this,inboundLayers:u,nodeIndices:d,tensorIndices:f,inputTensors:l,outputTensors:t,inputMasks:s,outputMasks:r,inputShapes:o,outputShapes:i},a);for(let p=0;p<t.length;p++)t[p].sourceLayer=this,t[p].nodeIndex=this.inboundNodes.length-1,t[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function hj(n){n=Yt(n);const e=[];for(const t of n)e.push(t.shape);return Ps(e)}function pj(n){return"float32"}function UA(n,e,t){if((e==null||t!=null&&t>0)&&(e=n.sourceLayer,t=n.nodeIndex),e.inboundNodes.length===0)return[n];{const s=e.inboundNodes[t];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let o=0;o<s.inboundLayers.length;o++){const i=s.inputTensors[o],a=s.inboundLayers[o],l=s.nodeIndices[o],u=UA(i,a,l);for(const d of u)r.indexOf(d)===-1&&r.push(d)}return r}}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sp extends kt{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:q1("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new le("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let t=e.batchInputShape;if(t==null){if(e.inputShape==null)throw new le("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");t=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new le("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=t,this.dtype=s,this.inputSpec=[{shape:t}];const r=new $o(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new X1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[t],outputShapes:[t]})}apply(e,t){throw new le(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}sp.className="InputLayer";Ne(sp);function mj(n){if(n.batchShape==null&&n.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(n.batchShape!=null&&n.shape!=null)throw new le("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=n.batchShape;n.shape!=null&&e==null&&(e=[null].concat(n.shape));let t=n.dtype;return t==null&&(t="float32"),new sp({batchInputShape:e,name:n.name,dtype:t,sparse:n.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gj(n,e){if(n.dtype==null||n.dtype===e.dtype)return e;try{return Me(e,n.dtype)}catch{throw new le(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${n.name}' (${n.dtype}).`)}}class na{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof na)for(const t in e.id2Value)this.id2Value[t]=e.id2Value[t],t in e.id2Mask&&(this.id2Mask[t]=e.id2Mask[t]);else{if(e==null)return;for(const t of e)this.add(t.key,t.value)}}add(e,t,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=gj(e,t),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new le(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof $o){if(this.id2Value[e.id]==null)throw new le(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const t=this.name2Id[e];if(t==null)throw new le(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[t]}}getMask(e){if(e instanceof $o){if(this.id2Value[e.id]==null)throw new le(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const t=this.name2Id[e];if(t==null)throw new le(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[t]}}disposeMasks(){this.id2Mask!=null&&lt(this.id2Mask)}}const kg=new IA,Ng=new IA;function yj(n){kg!=null&&kg.setMaxEntries(n),Ng!=null&&Ng.setMaxEntries(n)}function ef(n,e,t,s){const r=t==null?!1:t.training,o=Array.isArray(n),i=o?n:[n],a=i.map(v=>v.name),l=[],u=e.names();for(const v of a)u.indexOf(v)!==-1?l.push(e.getValue(v)):l.push(null);const d=a.join(",")+"|"+e.names().sort().join(",");let f=kg.get(d),p;if(f==null){const v=xj(i,e);f=v.sorted,p=v.recipientCounts,kg.put(d,f),Ng.put(d,p)}p={},r||Object.assign(p,Ng.get(d));const y=new na(e);for(let v=0;v<f.length;++v){const w=f[v],C=w.sourceLayer;if(C instanceof sp)continue;const S=[],b=[],E=[];let N=!1;for(const M of w.inputs){const P=y.getValue(M),F=y.getMask(M);S.push(P),b.push(F),F!=null&&(N=!0),r||(p[M.name]--,p[M.name]===0&&!e.hasKey(M)&&a.indexOf(M.name)===-1&&!P.isDisposed&&M.sourceLayer.stateful!==!0&&E.push(P))}N&&(t=t||{},t.mask=b[0]);const A=Yt(C.apply(S,t));let R=null;C.supportsMasking&&(R=C.computeMask(S,b));const L=wj(w),z=Array.isArray(L)?L:[L];for(let M=0;M<z.length;++M){y.hasKey(z[M])||y.add(z[M],A[M],Array.isArray(R)?R[0]:R);const P=a.indexOf(z[M].name);P!==-1&&(l[P]=A[M])}r||lt(E)}return y.disposeMasks(),o?l:l[0]}function xj(n,e){B(n!=null&&n.length>0,()=>"Expected at least one fetch, got none");let t=[],s={};if(n.length===1){const r=yN(n[0],e);t=r.sorted,s=r.recipientMap}else{const r=new Set;for(const o of n){const{sorted:i,recipientMap:a}=yN(o,e);for(const l of i)r.has(l.name)||(t.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(u=>s[l].add(u))}}return{sorted:t,recipientCounts:vj(s)}}function vj(n){const e={};for(const t in n)e[t]=n[t].size;return e}function yN(n,e){const t=new Set,s=[],r={};for(const a of e.names())t.add(a);const o=[],i=[];for(o.push(n);o.length>0;){const a=o[o.length-1];if(t.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),s.push(a),t.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const u of a.inputs)r[u.name]==null&&(r[u.name]=new Set),r[u.name].add(a.name),!t.has(u.name)&&o.push(u)}}return{sorted:s,recipientMap:r}}function wj(n){let e;if(n.sourceLayer.inboundNodes.length===1)e=n.sourceLayer.output;else{let t=null;for(let s=0;s<n.sourceLayer.inboundNodes.length;++s)for(const r of n.sourceLayer.inboundNodes[s].outputTensors)if(r.id===n.id){t=s;break}e=n.sourceLayer.getOutputAt(t)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cj=me();Cj.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,yj);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ZC(n,e){return he(()=>ts(Ge(j(n,n),e,!0)))}class rp extends El{getConfig(){return{}}}class WA extends rp{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return he(()=>{const t=ZC(e,this.axis),s=ks(t,0,this.maxValue);return j(e,Be(s,ke(Dn(),t)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}WA.className="MaxNorm";Ne(WA);class GA extends rp{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return he(()=>Be(e,ke(Dn(),ZC(e,this.axis))))}getConfig(){return{axis:this.axis}}}GA.className="UnitNorm";Ne(GA);class HA extends rp{apply(e){return fo(e)}}HA.className="NonNeg";Ne(HA);class qA extends rp{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return he(()=>{const t=ZC(e,this.axis),s=ke(j(this.rate,ks(t,this.minValue,this.maxValue)),j(1-this.rate,t));return j(e,Be(s,ke(Dn(),t)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}qA.className="MinMaxNorm";Ne(qA);const xN={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function Pn(n){return zC(n)}function vN(n,e={}){return Zh(n,hr.getMap().classNameMap,e,"constraint")}function Ln(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in xN?xN[n]:n,config:{}};return vN(t)}else return n instanceof rp?n:vN(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function Ka(n){if(n==null)return;const e=[],t=[],s=[];for(const r in n){const o=n[r];if(typeof o!="number"){const i=o;e.push(i.data()),t.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let o=0;o<r.length;++o)n[t[o]]=r[o][0];lt(s)}}function KA(n){if(n!=null)for(const e in n){const t=n[e];typeof t!="number"&&t.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var wN;(function(n){n[n.SILENT=0]="SILENT",n[n.VERBOSE=1]="VERBOSE"})(wN||(wN={}));const Tj=125;class yf{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,t){}async onEpochEnd(e,t){}async onBatchBegin(e,t){}async onBatchEnd(e,t){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Sj{constructor(e,t=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=t}append(e){this.callbacks.push(e)}setParams(e){for(const t of this.callbacks)t.setParams(e)}setModel(e){for(const t of this.callbacks)t.setModel(e)}async onEpochBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochBegin(e,t)}async onEpochEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onEpochEnd(e,t)}async onBatchBegin(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchBegin(e,t)}async onBatchEnd(e,t){t==null&&(t={});for(const s of this.callbacks)await s.onBatchEnd(e,t)}async onTrainBegin(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const t of this.callbacks)await t.onTrainEnd(e)}}class bj extends yf{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,t){t==null&&(t={});const s=t.size==null?0:t.size;this.seen+=s;for(const r in t){const o=t[r];if(typeof o=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+o*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const a=he(()=>ke(this.totals[r],j(o,s)));this.totals[r]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,t){if(t!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?t[s]=this.totals[s]/this.seen:he(()=>{const r=j(Be(1,this.seen),this.totals[s]);t[s]=r,this.totals[s].dispose(),Un(t[s])}))}}class Ij extends yf{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,t){t==null&&(t={}),this.epoch.push(e);for(const s in t)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(t[s])}async syncData(){const e=[],t=[],s=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),t.push(o),s.push(a)}}const r=await Promise.all(e);for(let o=0;o<r.length;++o)this.history[t[o]][s[o]].dispose(),this.history[t[o]][s[o]]=r[o][0]}}class kj extends yf{constructor(e,t){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||gC,this.yieldEvery=t||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=Tj),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");cg(this.yieldEvery)&&(this.maybeWait=zZ(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,t,s){const r=[];this.yield!=null&&(await Ka(s),r.push(this.yield(e,t,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,t){this.currentEpoch=e,this.epochBegin!=null&&(await Ka(t),await this.epochBegin(e,t))}async onEpochEnd(e,t){const s=[];this.epochEnd!=null&&(await Ka(t),s.push(this.epochEnd(e,t))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,t){this.batchBegin!=null&&(await Ka(t),await this.batchBegin(e,t))}async onBatchEnd(e,t){const s=[];this.batchEnd!=null&&(await Ka(t),s.push(this.batchEnd(e,t))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):cg(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,t)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await Ka(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await Ka(e),await this.trainEnd(e))}}function XA(n,e){return n==null&&(n={}),n instanceof yf?[n]:Array.isArray(n)&&n[0]instanceof yf?n:Yt(n).map(s=>new kj(s,e))}class Rr{constructor(){}static registerCallbackConstructor(e,t){B(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Rr.checkForDuplicate(t),Rr.constructors[e]==null&&(Rr.constructors[e]=[]),Rr.constructors[e].push(t)}static checkForDuplicate(e){for(const t in Rr.constructors)Rr.constructors[+t].forEach(r=>{if(r===e)throw new le("Duplicate callback constructor.")})}static clear(){Rr.constructors={}}static createCallbacks(e){const t=[];for(const s in Rr.constructors){const r=+s;e>=r&&t.push(...Rr.constructors[r])}return t.map(s=>new s)}}Rr.constructors={};function JA(n,e,t,s,r,o,i,a,l){const u=new Ij,d=[new bj,...Rr.createCallbacks(e)];n!=null&&d.push(...n),d.push(u);const f=new Sj(d);return f.setParams({epochs:t,initialEpoch:s,samples:r,steps:o,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:f,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ci(n,e={},t=!1){return Zh(n,hr.getMap().classNameMap,e,"layer",t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Eg(n,e){return he(()=>{n.dtype!=="float32"&&(n=Me(n,"float32"));const t=Ge(tp(n),e,!0),s=$l(t.shape,Dn()),r=ts(Vo(t,s));return Be(n,r)})}function J1(n,e){return he(()=>un(tp(ze(e,n)),-1))}function jC(n,e){return he(()=>un(In(ze(e,n)),-1))}function eT(n,e){return he(()=>{const t=ze(n,e),s=ks(In(n),Dn(),Number.MAX_VALUE),r=In(Be(t,s));return j(100,un(r,-1))})}function Nj(n,e){return he(()=>{const t=ks(e,Dn(),Number.MAX_VALUE),s=js(ke(1,t)),r=ks(n,Dn(),Number.MAX_VALUE),o=js(ke(1,r));return un(tp(ze(s,o)),-1)})}function Ej(n,e){return he(()=>{const t=Vo(0,ze(1,j(n,e)));return un(tp(t),-1)})}function $j(n,e){return he(()=>{const t=Vo(0,ze(1,j(n,e)));return un(t,-1)})}function Aj(n,e){return he(()=>{const t=Ge(j(n,e),-1),s=Vr(j(ze(1,n),e),-1);return Vo(0,ke(1,ze(s,t)))})}function _j(n,e){return he(()=>{const t=Math.log(2),s=ze(e,n),r=ze(ke(s,Al(j(-2,s))),t);return un(r,-1)})}function xf(n,e,t=!1){return he(()=>{if(t)e=Hh(e);else{const s=Ge(e,e.shape.length-1,!0);e=Be(e,s)}return e=ks(e,Dn(),1-Dn()),Qt(Ge(j(Me(n,"float32"),js(e)),e.shape.length-1))})}function $g(n,e,t=!1){return he(()=>{const s=Me(Yc(jZ(n)),"int32");e=ks(e,Dn(),1-Dn());const r=e.shape,o=se(Du(s,r[r.length-1]),r);return xf(o,e,t)})}function Rj(n,e){if(!Ct(n.shape,e.shape))throw new le(`logits and labels must have the same shape, but got shapes ${JSON.stringify(n.shape)} and ${JSON.stringify(e.shape)}`);return he(()=>{const t=fo(e),s=Qt(In(e));return ke(ze(t,j(e,n)),Lh(Es(s)))})}function Y1(n,e){return he(()=>{let t;return t=ks(e,Dn(),1-Dn()),t=js(Be(t,ze(1,t))),un(Rj(n,t),-1)})}function Dj(n,e){return he(()=>{const t=ks(n,Dn(),1),s=ks(e,Dn(),1);return Ge(j(n,js(Be(t,s))),-1)})}function Fj(n,e){return he(()=>{const t=js(ke(Dn(),e));return un(ze(e,j(n,t)),-1)})}function YA(n,e){return he(()=>{const t=Eg(n,-1),s=Eg(e,-1),r=j(t,s);return Qt(Ge(r,-1))})}const Ag={meanSquaredError:J1,meanAbsoluteError:jC,meanAbsolutePercentageError:eT,meanSquaredLogarithmicError:Nj,squaredHinge:Ej,hinge:$j,categoricalHinge:Aj,logcosh:_j,categoricalCrossentropy:xf,sparseCategoricalCrossentropy:$g,binaryCrossentropy:Y1,kullbackLeiblerDivergence:Dj,poisson:Fj,cosineProximity:YA};function cv(n){if(typeof n=="string"){if(n in Ag)return Ag[n];let e=`Unknown loss ${n}`;throw n.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${n}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new le(e)}else return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function QA(n,e){return he(()=>{const t=j(.5,er(e)),s=jh(sr(e,t),n.dtype);return un(Br(n,s),-1)})}function ZA(n,e){return he(()=>jh(Br(ml(n,-1),ml(e,-1)),"float32"))}function Mj(n,e){return he(()=>Me(Ge(ao(Br(n,1),Br(e,1))),"float32"))}function Pj(n,e){return he(()=>Me(Ge(ao(Br(n,0),Br(e,1))),"float32"))}function Lj(n,e){return he(()=>{const t=Mj(n,e),s=Pj(n,e),r=ke(t,s);return Me(Ns(sr(r,0),Be(t,r),0),"float32")})}function Oj(n,e){return Y1(n,e)}function Vj(n,e){return n.rank===e.rank&&(n=an(n,[n.rank-1])),e=ml(e,-1),e.dtype!==n.dtype&&(e=Me(e,n.dtype)),Me(Br(n,e),"float32")}const Bj=J1,zj=J1,Uj=jC,Wj=jC,Gj=eT,Hj=eT,jA=xf,qj=YA,e_=$g,_g={binaryAccuracy:QA,categoricalAccuracy:ZA,precision:Lj,categoricalCrossentropy:jA,sparseCategoricalCrossentropy:e_,mse:Bj,MSE:zj,mae:Uj,MAE:Wj,mape:Gj,MAPE:Hj,cosine:qj};function Kj(n){if(typeof n=="string"&&n in _g)return _g[n];if(typeof n!="string"&&n!=null)return n;throw new le(`Unknown metric ${n}`)}function Lm(n){if(ko(n!==null,`Unknown LossOrMetricFn ${n}`),typeof n=="string")return n;{let e;for(const t of Object.keys(Ag))if(Ag[t]===n){e=t;break}if(e!==void 0)return e;for(const t of Object.keys(_g))if(_g[t]===n){e=t;break}return e!==void 0?e:n.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xj(n){const e={Adagrad:()=>Ya.adagrad(.01),Adadelta:()=>Ya.adadelta(1,.95,Dn()),Adam:()=>Ya.adam(.001,.9,.999,Dn()),Adamax:()=>Ya.adamax(.002,.9,.999,Dn(),0),RMSProp:()=>Ya.rmsprop(.001,.9,0,Dn()),SGD:()=>Ya.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,n in e)return e[n]();throw new le(`Unknown Optimizer ${n}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const CN=1*1024*1024;function TN(n,e,t=!1){if(n==null||typeof n!="object"||Object.getPrototypeOf(n)!==Object.prototype||!m2(n))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(t){const s=JSON.stringify(n);s.length>CN&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${CN}.`)}}function m2(n){if(n===null)return!0;if(typeof n=="object")if(Object.getPrototypeOf(n)===Object.prototype){const e=Object.keys(n);for(const t of e)if(typeof t!="string"||!m2(n[t]))return!1;return!0}else if(Array.isArray(n)){for(const e of n)if(!m2(e))return!1;return!0}else return!1;else{const e=typeof n;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Jj(n,e,t,s=console.log){const r=Qj(n),o=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,t=t||[.32,.61,.89,1]):(e=e||115,t=t||[.24,.48,.7,.8,1]),t[t.length-1]<=1&&(t=t.map(d=>Math.floor(e*d)));let i;if(!r){o.push("Receives inputs"),i=[];for(const d in n.nodesByDepth)i.push(...n.nodesByDepth[d])}s("_".repeat(e)),Rg(o,t,s),s("=".repeat(e));const a=n.layers;for(let d=0;d<a.length;++d)r?Zj(a[d],t,s):jj(a[d],t,i,s),s((d===a.length-1?"=":"_").repeat(e));n.checkTrainableWeightsConsistency();const l=Yj(n),u=Ig(n.nonTrainableWeights);s(`Total params: ${l+u}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function Yj(n){let e;return n.collectedTrainableWeights!=null?e=Ig(n.collectedTrainableWeights):e=Ig(n.trainableWeights),e}function Qj(n){let e=!0;const t=[],s=[];for(const r in n.nodesByDepth)t.push(n.nodesByDepth[r]);for(const r of t){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of n.layers){let o=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Rg(n,e,t=console.log){let s="";for(let r=0;r<n.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=n[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);t(s)}function Zj(n,e,t){let s,r;try{r=n.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(n.outputShape)}catch{s="multiple"}const o=n.name,i=n.getClassName(),a=[`${o} (${i})`,r,s,n.countParams().toString()];Rg(a,e,t)}function jj(n,e,t,s){let r,o;try{o=n.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(n.outputShape)}catch{r="multiple"}const i=[];for(const f of n.inboundNodes)if(!(t!=null&&t.length>0&&t.indexOf(f)===-1))for(let p=0;p<f.inboundLayers.length;++p){const y=f.inboundLayers[p].name,v=f.nodeIndices[p],w=f.tensorIndices[p];i.push(`${y}[${v}][${w}]`)}const a=n.name,l=n.getClassName(),u=i.length===0?"":i[0],d=[`${a} (${l})`,o,r,n.countParams().toString(),u];Rg(d,e,s);for(let f=1;f<i.length;++f)Rg(["","","","",i[f]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t_(n,e,t){return(n==="inboundNodes"||n==="outputLayers"||n==="inputLayers")&&e===0&&typeof t=="string"}function g2(n,e){if(n===null)return null;if(typeof n=="string")return Za(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const o=n[r];t_(e,r,o)?t.push(o):t.push(g2(o,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s];if(s==="name"&&typeof r=="string")t[s]=r;else{const o=Za(s);t[o]=g2(r,o)}}return t}}function y2(n,e){if(n==null)return null;if(typeof n=="string")return si(n);if(typeof n=="number"||typeof n=="boolean")return n;if(n instanceof Array){const t=[],s=n.length;for(let r=0;r<s;++r){const o=n[r];t_(e,r,o)?t.push(o):t.push(y2(o,e))}return t}else{const t={};for(const s of Object.keys(n)){const r=n[s],o=si(s);(s==="name"||s==="className")&&typeof r=="string"?t[o]=r:t[o]=y2(r,s)}return t}}/** @license See the LICENSE file. */const n_="3.21.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zr extends kt{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const b=this.getClassName().toLowerCase();this.name=q1(b)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],ra(this.inputs).length!==this.inputs.length)throw new le(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(b=>b.name)}`);ra(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(b=>b.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const b of this.outputs){const E=b.sourceLayer,N=b.nodeIndex,A=b.tensorIndex;this.outputLayers.push(E),this.outputLayersNodeIndices.push(N),this.outputLayersTensorIndices.push(A)}for(const b of this.inputs){const E=b.sourceLayer,N=b.nodeIndex,A=b.tensorIndex;ko(N===0,"input layer has >1 nodes"),ko(A===0,"input layer has >1 tensors"),this.inputLayers.push(E),this.inputLayersNodeIndices.push(N),this.inputLayersTensorIndices.push(A)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let b=0;b<this.inputLayers.length;b++){const E=this.inputLayers[b];if(!(E instanceof sp))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${b} (0-based) originates from layer type ${E.getClassName()}.`);this.inputNames.push(E.name),this.feedInputShapes.push(E.batchInputShape),this.feedInputNames.push(E.name)}for(const b of this.outputLayers)this.outputNames.push(b.name);this.internalInputShapes=this.inputs.map(b=>b.shape),this.internalOutputShapes=this.outputs.map(b=>b.shape);const t={},s={},r={},o={},i={},a=[],l=(b,E,N,A,R,L)=>{(A==null||R==null||L==null)&&(A=b.sourceLayer,R=b.nodeIndex,L=b.tensorIndex);const z=A.inboundNodes[R];if(N.indexOf(z)!==-1)throw new Mr(`The tensor ${b.name} at layer "${A.name}" is part of a cycle.`);if(E.indexOf(z)!==-1)return;this.containerNodes.add(Zr.nodeKey(A,R)),A.id in i||(i[A.id]=Object.keys(i).length),N.indexOf(z)===-1&&N.push(z);const M=z.inboundLayers.length;for(let P=0;P<M;P++){const F=z.inputTensors[P],q=z.inboundLayers[P],ee=z.nodeIndices[P],ue=z.tensorIndices[P];l(F,E,N,q,ee,ue)}for(E.push(z);N.indexOf(z)>=0;)N.splice(N.indexOf(z),1);a.push(z)},u=[],d=[];for(const b of this.outputs)l(b,u,d);const f=a.slice().reverse();for(const b of f){s[b.id]=b,b.id in t||(t[b.id]=0);let E=t[b.id];const N=r[b.outboundLayer.id]==null?0:r[b.outboundLayer.id];E=Math.max(E,N),r[b.outboundLayer.id]=E,o[b.outboundLayer.id]=b.outboundLayer,t[b.id]=E;for(let A=0;A<b.inboundLayers.length;A++){const R=b.inboundLayers[A],L=b.nodeIndices[A],z=R.inboundNodes[L],M=t[z.id]==null?0:t[z.id];t[z.id]=Math.max(E+1,M),s[z.id]=z}}const p={};for(const b in t){const E=t[b];E in p||(p[E]=[]),p[E].push(s[b])}const y={};for(const b in r){const E=r[b];E in y||(y[E]=[]),y[E].push(o[b])}let v=Object.keys(y).map(b=>parseInt(b,10)).sort(Fm);this.layers=[];for(const b of v){const E=y[b];E.sort((N,A)=>{const R=i[N.id],L=i[A.id];return R<L?-1:R>L?1:0});for(const N of E)N instanceof Zr&&this.internalContainerRefs.push(N),this.layers.push(N)}this.layersByDepth=y,v=Object.keys(p).map(b=>parseInt(b,10)).sort(Fm);const w=this.inputs.slice(),C=[];for(const b of v)for(const E of p[b]){const N=E.outboundLayer;if(N!=null){for(const A of E.inputTensors)if(w.indexOf(A)===-1)throw new Mr(`Graph disconnected: cannot obtain value for tensor ${A} at layer "${N.name}". The following previous layers were accessed without issue: ${C}`);for(const A of E.outputTensors)w.push(A);C.push(N.name)}}this.nodesByDepth=p;const S=this.layers.map(b=>b.name);for(const b of S){const E=S.filter(N=>N===b).length;if(E!==1)throw new Mr(`The name "${b}" is used ${E} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(S))}this.outboundNodes=[],this.inboundNodes=[],new X1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(b=>null),outputMasks:this.outputs.map(b=>null),inputShapes:this.inputs.map(b=>b.shape),outputShapes:this.outputs.map(b=>b.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const t of this.layers)e.numDisposedVariables+=t.dispose().numDisposedVariables;for(const t of this.internalContainerRefs)e.numDisposedVariables+=t.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(t=>{t._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new le("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const t of this.layers)e=e.concat(t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.layers)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.layers)t.push(...s.trainableWeights);return t.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,t=!0){const s={};let r=0;for(const i of this.layers)for(const a of i.weights){if(s[a.originalName]!=null)throw new le(`Duplicate weight name: ${a.originalName}`);s[a.originalName]=a,r++}const o=[];for(const i in e){let a=i;if(s[i]==null){const l=i.split("/");a=l.slice(0,-2).concat([l[l.length-1]]).join("/")}if(s[a]!=null)o.push([s[a],e[i]]);else if(t)throw new le(`Provided weight data has no target variable: ${i}`);delete s[a]}if(t){const i=[];for(const a in s)i.push(a);if(i.length>0)throw new le(`${i.length} of ${r} weights are not set: ${i}`)}QC(o)}updatedConfig(){const e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion=`tfjs-layers ${n_}`,t.backend="TensorFlow.js",t}toJSON(e,t=!0){const s=y2(this.updatedConfig());return t?JSON.stringify(s):s}call(e,t){return he(()=>{e=Yt(e);const s=new na;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return ef(this.outputs,s,t)})}computeMask(e,t){return he(()=>{e=Yt(e);let s;return t==null?s=wl(null,e.length):s=Yt(t),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const t=bg(e);if(t.length!==this.inputLayers.length)throw new le(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<t.length;a++){const l=this.inputLayers[a],u=t[a],d=l.name+"_0_0";s[d]=u}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Fm);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const u of l){const d=u.outboundLayer;if(this.inputLayers.map(w=>w.id).indexOf(d.id)!==-1)continue;const f=[];for(let w=0;w<u.inboundLayers.length;w++){const C=u.inboundLayers[w],S=u.nodeIndices[w],b=u.tensorIndices[w],E=`${C.name}_${S}_${b}`,N=s[E];f.push(N)}const p=d.computeOutputShape(Ps(f)),y=bg(p),v=d.inboundNodes.indexOf(u);for(let w=0;w<y.length;w++){const C=`${d.name}_${v}_${w}`;s[C]=y[w]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],u=this.outputLayersNodeIndices[a],d=this.outputLayersTensorIndices[a],f=`${l.name}_${u}_${d}`;i.push(f)}for(let a=0;a<i.length;a++){const l=i[a];ko(l in s),o.push(s[l])}return Ps(o)}runInternalGraph(e,t){t==null&&(t=wl(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const u=this.inputs[l],d=e[l],f=t[l];s[u.id]=[d,f]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Fm);for(const l of r){const u=this.nodesByDepth[l];for(const d of u){const f=d.outboundLayer,p=d.inputTensors,y=d.outputTensors,v=new Array;for(const w of p)w.id in s&&v.push(s[w.id]);if(v.length===p.length){let w={},C,S,b,E;if(d.callArgs!=null&&(w=d.callArgs),v.length===1){const[N,A]=v[0];w.mask==null&&(w.mask=A),b=Yt(f.call(N,w)),E=Yt(f.computeMask(N,A)),C=[N],S=[A]}else C=v.map(N=>N[0]),S=v.map(N=>N[1]),w.mask==null&&(w.mask=S),b=Yt(f.call(C,w)),E=Yt(f.computeMask(C,S));if(f.activityRegularizer)throw new pt("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let N=0;N<y.length;++N){const A=y[N],R=b[N],L=E[N];s[A.id]=[R,L]}}}}const o=[],i=[],a=[];for(const l of this.outputs){ko(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[u,d]=s[l.id];a.push(u.shape),o.push(u),i.push(d)}return[o,i,a]}buildNodeConversionMap(e){const t={};let s;for(const r of this.layers){s=r instanceof Zr?1:0;for(let o=0;o<r.inboundNodes.length;o++){const i=Zr.nodeKey(r,o);this.containerNodes.has(i)&&(t[i]=s,s+=1)}}return t}getLayer(e,t){if(t!=null){if(this.layers.length<=t)throw new le(`Was asked to retrieve layer at index ${t}, but model only has ${this.layers.length} layer(s).`);return this.layers[t]}else if(e==null)throw new le("Provide either a layer name or layer index");for(const s of this.layers)if(s.name===e)return s;throw new le(`No such layer: ${e}`)}calculateLosses(){return he(()=>{const e=[];for(const t of this.layers)for(let s=0;s<t.inboundNodes.length;++s){const r=Zr.nodeKey(t,s);this.containerNodes.has(r)&&e.push(...t.calculateLosses())}return e})}getConfig(){const e={name:this.name},t=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),u=[];for(let f=0;f<i.inboundNodes.length;f++){const p=i.inboundNodes[f],y=Zr.nodeKey(i,f);let v={};if(this.containerNodes.has(y)){if(p.callArgs)try{JSON.stringify(p.callArgs),v=p.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),v={}}if(p.inboundLayers.length>0){const w=[];for(let C=0;C<p.inboundLayers.length;C++){const S=p.inboundLayers[C],b=p.nodeIndices[C],E=p.tensorIndices[C],N=Zr.nodeKey(S,b);let A=t[N];A==null&&(A=0),w.push([S.name,A,E,v])}u.push(w)}}}const d={};d.name=i.name,d.className=a,d.config=l,d.inboundNodes=u,s.push(d)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],u=Zr.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let d=t[u];d==null&&(d=0);const f=this.inputLayersTensorIndices[i];r.push([a.name,d,f])}e.inputLayers=r;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],u=Zr.nodeKey(a,l);if(!this.containerNodes.has(u))continue;let d=t[u];d==null&&(d=0);const f=this.outputLayersTensorIndices[i];o.push([a.name,d,f])}return e.outputLayers=o,e}static fromConfig(e,t,s={},r=!1){const o={},i={};function a(C,S){C.name in i?i[C.name].push(S):i[C.name]=[S]}function l(C,S){const b=[];let E;for(const N of S){const A=N[0],R=N[1],L=N[2];if(E=N[3]==null?{}:N[3],!(A in o)){a(C,S);return}const z=o[A];if(z.inboundNodes.length<=R){a(C,S);return}const M=z.inboundNodes[R];b.push(M.outputTensors[L])}b.length>0&&C.apply(Ps(b),E)}function u(C){const S=C.name,b=ci(C,t.customObjects!=null?t.customObjects:{});b.setFastWeightInitDuringBuild(r),o[S]=b,C.inboundNodes.forEach(N=>{if(!(N instanceof Array))throw new le(`Corrupted configuration, expected array for nodeData: ${N}`);a(b,N)})}const d=t.name,f=t.layers;for(const C of f)u(C);for(;!BZ(i);)for(const C of f){const S=o[C.name];if(S.name in i){const b=i[S.name];delete i[S.name];for(const E of b)l(S,E)}}const p=[],y=[],v=t.inputLayers;for(const C of v){const S=C[0],b=C[1],E=C[2];ko(S in o);const A=o[S].inboundNodes[b].outputTensors;p.push(A[E])}const w=t.outputLayers;for(const C of w){const S=C[0],b=C[1],E=C[2];ko(S in o);const A=o[S].inboundNodes[b].outputTensors;y.push(A[E])}return new e({inputs:p,outputs:y,name:d})}get stateful(){if(this._stateful)throw new le("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){he(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function eee(n,e,t){const s=e.length;if(n==null||Array.isArray(n)&&n.length===0)return e.map(r=>null);if(s===1)return Array.isArray(n)&&n.length===1?n:typeof n=="object"&&e[0]in n?[n[e[0]]]:[n];if(Array.isArray(n)){if(n.length!==s)throw new Error(`Provided ${t} is an array of ${n.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return n}else if(typeof n=="object"&&Object.keys(n).length>0&&typeof n[Object.keys(n)[0]]=="object"){const r=[];return e.forEach(o=>{o in n?r.push(n[o]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${t} must be either an array with ${s} elements or an object with ${e} keys. Provided ${t} not understood: ${JSON.stringify(n)}`)}function s_(n,e){return eee(n,e,"classWeight")}async function r_(n,e,t,s){if(t!=null){const r=he(()=>{if(n.shape.length===1)return Ro(n);if(n.shape.length===2){if(n.shape[1]>1)return ml(n,1);if(n.shape[1]===1)return se(n,[n.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${n.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${n.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await r.data());lt(r);const i=[];return o.forEach(a=>{if(t[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(t[a])}),Nn(i,"float32")}else return null}function tee(n,e){return j(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const nee=32;function o_(n,e){let t,s;const r=e;t=r.xs,s=r.ys,B(t!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=SN("input",n.inputNames,t),i=SN("output",n.outputNames,s),a=o[0].shape[0];B(o.length===n.inputs.length,()=>`LayersModel has ${n.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(n.inputNames)})`),B(i.length===n.outputs.length,()=>`LayersModel has ${n.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(n.outputNames)})`);for(let l=0;l<o.length;l++)B(o[l].shape[0]===a,()=>`Batch size mismatch: input ${n.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);for(let l=0;l<i.length;l++)B(i[l].shape[0]===a,()=>`Batch size mismatch: output ${n.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${n.inputNames[0]}.`);return{xs:o,ys:i}}function SN(n,e,t){if(t instanceof St)return[t];if(Array.isArray(t))return B(t.length===e.length,()=>`Received an array of ${t.length} Tensors, but expected ${e.length} to match the ${n} keys ${e}.`),t;{const s=[];for(const r of e){if(t[r]==null)throw new le(`The feature data generated by the dataset lacks the required ${n} key '${r}'.`);s.push(t[r])}return s}}function see(n){if(n.length===3)throw new pt("Validation with sample weights is not implemented yet.");return{xs:n[0],ys:n[1]}}async function ree(n,e,t){const s=t.batchesPerEpoch!=null;if(B(n.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),B(t!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),B(t.epochs!=null&&t.epochs>0&&Number.isInteger(t.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${t.epochs}`),B(!s||t.batchesPerEpoch>0&&Number.isInteger(t.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${t.batchesPerEpoch}`),B(t.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;try{const r=t.validationData!=null;let o,i;if(r)if(bN(t.validationData))B(t.validationBatches==null||t.validationBatches>0&&Number.isInteger(t.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${t.validationBatches}`);else{const C=see(t.validationData);o=C.xs,i=C.ys}const a=n.makeTrainFunction(),l=n.getDedupedMetricsNames();let u;r?u=l.slice().concat(l.map(C=>"val_"+C)):u=l.slice();const d=XA(t.callbacks,t.yieldEvery),f=t.verbose==null?1:t.verbose,{callbackList:p,history:y}=JA(d,f,t.epochs,null,null,oee(e,t),null,r,u);p.setModel(n),n.history=y,await p.onTrainBegin(),n.stopTraining_=!1;let v=t.initialEpoch==null?0:t.initialEpoch,w=await e.iterator();for(;v<t.epochs;){const C={};await p.onEpochBegin(v);let S=0,b=0;for(s||(w=await e.iterator());!s||S<t.batchesPerEpoch;){const E=await w.next();if(s&&E.done){console.warn(`You provided \`batchesPerEpoch\` as ${t.batchesPerEpoch}, but your dataset iterator ran out of data after ${S} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${t.batchesPerEpoch*t.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(E.value!=null){const{xs:N,ys:A}=o_(n,E.value),R={};R.batch=b,R.size=N[0].shape[0],await p.onBatchBegin(b,R);const L=[];if(t.classWeight!=null){const P=s_(t.classWeight,n.outputNames);for(let F=0;F<P.length;++F)L.push(await r_(A[F],null,P[F]))}const z=N.concat(A).concat(L),M=a(z);lt(z);for(let P=0;P<l.length;++P){const F=l[P],q=M[P];R[F]=q,Un(q)}await p.onBatchEnd(b,R),KA(R),b++,S++}if(s?S>=t.batchesPerEpoch:E.done){if(r){let N;bN(t.validationData)?N=Yt(await n.evaluateDataset(t.validationData,{batches:t.validationBatches})):N=Yt(n.evaluate(o,i,{batchSize:t.validationBatchSize==null?nee:t.validationBatchSize,verbose:0}));for(let A=0;A<n.metricsNames.length;++A)C[`val_${n.metricsNames[A]}`]=N[A]}break}if(n.stopTraining_)break}if(await p.onEpochEnd(v,C),v++,n.stopTraining_)break}return await p.onTrainEnd(),await n.history.syncData(),n.history}finally{n.isTraining=!1}}function oee(n,e){let t=null;return e.batchesPerEpoch!=null?t=e.batchesPerEpoch:Number.isFinite(n.size)&&(t=n.size),t}function bN(n){return typeof n.iterator=="function"}function iee(n){return typeof n.next=="function"}async function aee(n,e,t){t=t||{};const s=t.batches!=null,r=n.testFunction;let o=[];if(t.verbose>0)throw new pt("Verbose mode is not implemented yet.");B(!s||t.batches>0&&Number.isInteger(t.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(t.batches)}`);const i=iee(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<t.batches;){const u=await i.next();if(o=he(()=>{if(u.value){const{xs:d,ys:f}=o_(n,u.value),p=d.concat(f),y=he(()=>r(p));if(lt(p),l===0)for(let w=0;w<y.length;++w)o.push(tt(0));const v=p[0].shape[0];for(let w=0;w<y.length;++w){const C=y[w],S=o[w];o[w]=he(()=>ke(o[w],j(v,C))),l>0&&lt(S)}lt(y),a+=v,++l}return o}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${t.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<o.length;++u){const d=o[u];o[u]=Be(o[u],a),lt(d)}return Ps(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function x2(n){B(n>0&&Number.isInteger(n),()=>`batchSize is required to be a positive integer, but got ${n}`)}function tf(n,e,t){return n==null?[null]:Array.isArray(n)?n.map(s=>al(s,e,t-e)):al(n,e,t-e)}function tT(n,e){return he(()=>n==null?null:Array.isArray(n)?n.map(t=>tT(t,e)):DA(n,e.dtype==="int32"?e:Me(e,"int32")))}function v2(n,e){const t=[];let s=0,r=null;for(;s<n;)r=s+e,r>=n&&(r=n),t.push([s,r]),s=r;return t}async function lee(n,e,t,s,r,o,i,a,l,u,d,f,p,y,v){r==null&&(r=32),o==null&&(o=1),d==null&&(d=!0),p==null&&(p=0);let w=!1;l!=null&&u!=null&&(w=!0);const C=n.checkNumSamples(t,r,y,"steps_per_epoch");let S;C!=null&&(S=lo(0,C)),i==null&&(i=1);const{callbackList:b,history:E}=JA(a,i,o,p,C,y,r,w,f);b.setModel(n),n.history=E,await b.onTrainBegin(),n.stopTraining_=!1;for(let N=p;N<o;++N){await b.onEpochBegin(N);const A={};{if(d==="batch")throw new pt("batch shuffling is not implemneted yet");d&&P2(S);const R=Nn(S),L=v2(C,r);for(let z=0;z<L.length;++z){const M={};if(await b.onBatchBegin(z,M),he(()=>{const P=L[z][0],F=L[z][1],q=al(R,P,F-P);M.batch=z,M.size=F-P;const ee=tT(t,q),ue=e(ee);for(let ie=0;ie<s.length;++ie){const de=s[ie],ae=ue[ie];M[de]=ae,Un(ae)}if(z===L.length-1&&w){const ie=n.testLoop(l,u,r);for(let de=0;de<s.length;++de){const ae=s[de],J=ie[de];Un(J),A["val_"+ae]=J}}}),await b.onBatchEnd(z,M),KA(M),n.stopTraining_)break}R.dispose()}if(await b.onEpochEnd(N,A),n.stopTraining_)break}return await b.onTrainEnd(),await n.history.syncData(),n.history}async function uee(n,e,t,s={}){if(n.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");n.isTraining=!0;let r,o,i,a,l,u,d,f,p;try{const y=s.batchSize==null?32:s.batchSize;x2(y);const w=await n.standardizeUserData(e,t,s.sampleWeight,s.classWeight,!1,y);r=w[0],o=w[1],p=w[2];let C=!1,S;if(s.validationData!=null&&s.validationData.length>0){if(C=!0,s.validationData.length===2)l=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new pt("validationData including sample weights is not supported yet."):new le(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const P=await n.standardizeUserData(l,u,null,null,!0,y);d=P[0],f=P[1],S=d.concat(f)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){C=!0;const M=Math.floor(r[0].shape[0]*(1-s.validationSplit)),P=r[0].shape[0];d=tf(r,M,P),i=r,r=tf(r,0,M),f=tf(o,M,P),a=o,o=tf(o,0,M),S=d.concat(f)}else s.validationSteps!=null&&(C=!0);const b=r.concat(o).concat(p);n.checkTrainableWeightsConsistency();const E=n.makeTrainFunction(),N=n.getDedupedMetricsNames();let A,R;C?(n.makeTestFunction(),A=n.testFunction,R=N.slice().concat(N.map(M=>"val_"+M))):(A=null,S=[],R=N.slice());const L=XA(s.callbacks,s.yieldEvery);return await lee(n,E,b,N,y,s.epochs,s.verbose,L,A,S,s.shuffle,R,s.initialEpoch,null,null)}finally{n.isTraining=!1,to(r,e),to(o,t),to(i,e),to(a,t),to(d,l),to(f,u),p!=null&&lt(p)}}function i_(n){const e=[];n instanceof St&&(n=[n]);for(let t=0;t<n.length;++t){const s=n[t];if(s.rank===1)e.push(ep(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function to(n,e){if(n==null)return;const t=[];if(e instanceof St)t.push(e.id);else if(Array.isArray(e))e.forEach(r=>t.push(r.id));else if(e!=null)for(const r in e){const o=e[r];t.push(o.id)}const s=[];if(n instanceof St)t.indexOf(n.id)===-1&&s.push(n);else if(Array.isArray(n))n.forEach(r=>{t.indexOf(r.id)===-1&&s.push(r)});else if(n!=null)for(const r in n){const o=n[r];t.indexOf(o.id)===-1&&s.push(o)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function cee(n){return n instanceof St}function w2(n){return Array.isArray(n)}function IN(n){return!cee(n)&&!w2(n)}function kN(n,e,t,s=!0,r=""){if(e==null||e.length===0){if(n!=null){let i=!1;if(w2(n)&&n.length>0)i=!0;else if(IN(n)){for(const a in n)if(n.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new le(`Error when checking model ${r} expected no data, but got ${n}`)}return[]}if(n==null)return e.map(i=>null);let o;if(IN(n)){n=n,o=[];for(const i of e){if(n[i]==null)throw new le(`No data provided for "${i}". Need data for each key in: ${e}`);o.push(n[i])}}else if(w2(n)){if(n=n,n.length!==e.length)throw new le(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${n}`);o=n}else{if(n=n,e.length>1)throw new le(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${n.shape}`);o=[n]}if(o=i_(o),t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const a=o[i];if(a.shape.length!==t[i].length)throw new le(`Error when checking ${r}: expected ${e[i]} to have ${t[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<t[i].length;++l){if(l===0&&!s)continue;const u=a.shape[l],d=t[i][l];if(d!=null&&d>=0&&u!==d)throw new le(`${r} expected a batch of elements where each example has shape [${t[i].slice(1,t[i].length)}] (i.e.,tensor shape [*,${t[i].slice(1,t[i].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function dee(n,e,t){const s=ra(n.map(o=>o.shape[0]));s.sort();const r=ra(e.map(o=>o.shape[0]));if(r.sort(),s.length>1)throw new le(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(n.map(o=>o.shape))}`);if(r.length>1)throw new le(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(s.length>0&&r.length>0&&!Ct(s,r))throw new le(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function fee(n,e,t){const s=[J1,Y1,xf];for(let r=0;r<n.length;++r){const o=n[r],i=e[r],a=t[r];if(i!=null){if(i===xf&&o.shape[o.shape.length-1]===1)throw new le(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=o.shape.slice(1),u=a.slice(1);for(let d=0;d<l.length;++d){const f=l[d],p=u[d];if(p!=null&&f!==p)throw new le(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function NN(n,e,t,s=!0,r=""){let o;if(Array.isArray(n)){if(n.length!==e.length)throw new le(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${n.length} Tensors(s).`);o=n}else{if(e.length>1)throw new le(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(n.shape)}.`);o=[n]}if(t!=null)for(let i=0;i<e.length;++i){if(t[i]==null)continue;const a=o[i];if(a.shape.length!==t[i].length)throw new le(`Error when checking ${r}: expected ${e[i]} to have ${t[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<t[i].length;++l){if(l===0&&!s)continue;const u=a.shape[l],d=t[i][l];if(d!=null&&d!==u)throw new le(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(t[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function hee(n,e){if(n==null||Array.isArray(n)&&n.length===0)return e.map(s=>[]);let t;if(typeof n=="string"||typeof n=="function")t=[n];else if(Array.isArray(n)||typeof n=="object")t=n;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${n}`);if(Array.isArray(t))return e.map(s=>t);{const s=[];for(const r of e){let o=t.hasOwnProperty(r)?t[r]:[];Array.isArray(o)||(o=[o]),s.push(o)}return s}}const pee="layers-model";class $u extends Zr{constructor(e){super(e),this.isTraining=!1}summary(e,t,s=console.log){if(!this.built)throw new le("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");Jj(this,e,t,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Xj(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof ki))throw new le("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let t=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new le(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),t.push(cv(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new le(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);t=e.loss.map(a=>cv(a))}else{const i=cv(e.loss);this.outputs.forEach(a=>{t.push(i)})}this.lossFunctions=t,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],il("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=hee(e.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};il("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=r[i];(u=>{let f,p,y;for(const v of u){if(typeof v=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(v)!==-1){const C=this.internalOutputShapes[i];C[C.length-1]===1||this.lossFunctions[i]===Y1?["accuracy","acc"].indexOf(v)!==-1?p=QA:["crossentropy","ce"].indexOf(v)!==-1&&(p=Oj):this.lossFunctions[i]===$g?["accuracy","acc"].indexOf(v)!==-1?p=Vj:["crossentropy","ce"].indexOf(v)!==-1&&(p=e_):["accuracy","acc"].indexOf(v)!==-1?p=ZA:["crossentropy","ce"].indexOf(v)!==-1&&(p=jA);let S;["accuracy","acc"].indexOf(v)!==-1?S="acc":["crossentropy","ce"].indexOf(v)!==-1&&(S="ce"),y=p,f=""+S}else y=Kj(v),f=""+Lm(v);let w;il(f,()=>{w=y}),o(i,f,w)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,t,s={}){const r=s.batchSize==null?32:s.batchSize;x2(r);const i=this.standardizeUserDataXY(e,t,!0,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,u=this.testLoop(l,a,r,s.verbose,s.steps);return Ps(u)}finally{to(i[0],e),to(i[1],t)}}async evaluateDataset(e,t){return this.makeTestFunction(),aee(this,e,t)}checkNumSamples(e,t,s,r="steps"){let o;if(s!=null){if(o=null,t!=null)throw new le(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${t}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new le(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return o}execute(e,t){if(Array.isArray(t)&&t.length===0)throw new le("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(t),r=s?t:[t],o=this.retrieveSymbolicTensors(r),i=new na;if(e instanceof St&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new le(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const u=e[l.name];if(u==null)throw new le(`No value is provided for the model's input ${l.name}`);i.add(l,u)}const a=ef(o,i);return s?a:a[0]}retrieveSymbolicTensors(e){const t=wl(null,e.length);let s=e.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],i=o.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(t[a]=o[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw t.forEach((o,i)=>{o==null&&r.push(e[i])}),new le(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return t}predictLoop(e,t=32,s=!1){return he(()=>{const r=this.checkNumSamples(e);if(s)throw new pt("Verbose predictLoop() is not implemented yet.");const o=v2(r,t),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)he(()=>{const u=o[a][0],d=o[a][1],f=tf(e,u,d),p=[];if(Array.isArray(f))for(let v=0;v<f.length;++v)p.push({key:this.inputs[v],value:f[v]});else p.push({key:this.inputs[0],value:f});const y=new na(p);return ef(this.outputs,y)}).forEach((u,d)=>i[d].push(u));return Ps(i.map(a=>dn(a,0)))})}predict(e,t={}){const s=i_(e);NN(s,this.inputNames,this.feedInputShapes,!1);try{const r=t.batchSize==null?32:t.batchSize;return x2(r),this.predictLoop(s,r)}finally{to(s,e)}}predictOnBatch(e){NN(e,this.inputNames,this.feedInputShapes,!0);const t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}standardizeUserDataXY(e,t,s=!0,r){if(this.optimizer_==null)throw new Mr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===$g?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(e=kN(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=kN(t,this.feedOutputNames,o,!1,"target"),dee(e,t),fee(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new le(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,t]}async standardizeUserData(e,t,s,r,o=!0,i){const[a,l]=this.standardizeUserDataXY(e,t,o,i);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(r!=null){const d=s_(r,this.outputNames);u=[];for(let f=0;f<d.length;++f)u.push(await r_(l[f],null,d[f]))}return[a,l,u]}testLoop(e,t,s,r=0,o){return he(()=>{const i=this.checkNumSamples(t,s,o,"steps"),a=[];if(r>0)throw new pt("Verbose mode is not implemented yet.");if(o!=null)throw new pt("steps mode in testLoop() is not implemented yet");{const l=v2(i,s),u=Nn(lo(0,i));for(let d=0;d<l.length;++d){const f=l[d][0],p=l[d][1],y=al(u,f,p-f),v=tT(t,y),w=e(v);if(d===0)for(let C=0;C<w.length;++C)a.push(tt(0));for(let C=0;C<w.length;++C){const S=w[C];a[C]=ke(a[C],j(p-f,S))}}for(let d=0;d<a.length;++d)a[d]=Be(a[d],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,t=[];for(let s=0;s<e.length;++s){const r=e[s];let o=r;if(dN(e,r)>1){const i=dN(e.slice(0,s),r);o+=`_${i}`}t.push(o)}return t}makeTrainFunction(){return e=>{const t=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const f=[];for(let w=0;w<this.inputs.length;++w)f.push({key:this.inputs[w],value:s[w]});const p=new na(f),y=ef(this.outputs,p,{training:!0});let v;for(let w=0;w<this.lossFunctions.length;++w){const C=this.lossFunctions[w];let S=C(r[w],y[w]);o[w]!=null&&(S=tee(S,o[w]));const b=un(S);t.push(b),w===0?v=S:v=ke(v,S)}for(let w=0;w<this.metricsTensors.length;++w){let C;if(this.outputs.length>1&&w<this.outputs.length)C=t[w];else{const S=this.metricsTensors[w][0],b=this.metricsTensors[w][1];C=un(S(r[b],y[b]))}Un(C),i.push(C)}return v=un(v),this.calculateLosses().forEach(w=>{v=ke(v,w)}),v},l=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(a,!0,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>he(()=>{const t=[];let s;const r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let u=0;u<this.inputs.length;++u)i.push({key:this.inputs[u],value:r[u]});const a=new na(i),l=ef(this.outputs,a);for(let u=0;u<this.lossFunctions.length;++u){const d=this.lossFunctions[u],f=un(d(o[u],l[u]));u===0?s=f:s=ke(s,f),t.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const d=this.metricsTensors[u][0],f=this.metricsTensors[u][1],p=un(d(o[f],l[f]));t.push(p)}return t})}async fit(e,t,s={}){return uee(this,e,t,s)}async fitDataset(e,t){return ree(this,e,t)}async trainOnBatch(e,t){const s=await this.standardizeUserData(e,t),r=s[0],o=s[1],a=this.makeTrainFunction()(r.concat(o)),l=[];for(const u of a){const d=await u.data();l.push(d[0])}return lt(a),to(s[0],e),to(s[1],t),Ps(l)}getNamedWeights(e){const t=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,o=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||t.push({name:r[i].originalName,tensor:o[i]});return t}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const t=qv().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-qv().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=si(this.loss);else if(Array.isArray(this.loss)){for(const t of this.loss)if(typeof t!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(t=>si(t))}else{const t=Object.keys(this.loss);e={};const s=this.loss;for(const r of t)if(typeof s[r]=="string")e[r]=si(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[si(Lm(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>si(Lm(e)));{const e={};for(const t in this.metrics)e[t]=si(Lm(this.metrics[t]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const t=g2(e.optimizer_config),s=ci(t);let r;if(typeof e.loss=="string")r=Za(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>Za(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=Za(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>Za(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=Za(e.metrics[i])}this.compile({loss:r,metrics:o,optimizer:s})}async save(e,t){if(typeof e=="string"){const u=p3(e);if(u.length===0)throw new le(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new le(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new le("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await zv(this.getNamedWeights(t)),a={modelTopology:this.toJSON(null,!1),format:pee,generatedBy:`TensorFlow.js tfjs-layers v${n_}`,convertedBy:null};if((t==null?!1:t.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:d,specs:f}=await zv(await this.optimizer.getWeights(),u);s.specs.push(...f),s.data=Zy([s.data,d])}return this.userDefinedMetadata!=null&&(TN(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){TN(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}$u.className="Model";Ne($u);class a_ extends $u{}a_.className="Functional";Ne(a_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vf extends $u{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:q1("sequential_"),e.layers!=null)for(const t of e.layers)this.add(t)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new le(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const t=e instanceof vf||e instanceof $u;let s;if(t){if(s=e,s.outputs.length!==1)throw new le("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new le("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new le("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=mj({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(t)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new le(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new le("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=UA(this.outputs[0])}this.inboundNodes=[],new X1({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:wl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,t){return this.model==null&&this.build(),this.model.call(e,t)}build(e){if(Vt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new $u({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,t,s=console.log){this.built||this.build(),super.summary(e,t,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,t,s={}){if(!this.built)throw new Mr("The model needs to be compiled before being used.");return this.model.evaluate(e,t,s)}async evaluateDataset(e,t){if(!this.built)throw new Mr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,t)}predict(e,t={}){return this.model==null&&this.build(),this.model.predict(e,t)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,t,s={}){if(!this.built)throw new Mr("The model needs to be compiled before being used.");return this.model.fit(e,t,s)}async fitDataset(e,t){if(!this.built)throw new Mr("The model needs to be compiled before being used.");return this.model.fitDataset(e,t)}async trainOnBatch(e,t){return this.model.trainOnBatch(e,t)}static fromConfig(e,t,s={},r=!1){let o,i={};if(t instanceof Array){if(t[0].className==null||t[0].className==="Merge")throw new le("Legacy serialization format not supported yet.");o=t}else B(t.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=t.layers,delete t.layers,i=t;const a=new e(i);if(!(a instanceof vf))throw new pt(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const d=ci(l,void 0,r);r&&d.setFastWeightInitDuringBuild(!0),a.add(d)}return a}set stopTraining(e){if(this.model==null)throw new le("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new le("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const t of this.layers){const s={};s.className=t.getClassName(),s.config=t.getConfig(),e.push(s)}return{name:this.name,layers:e}}}vf.className="Sequential";Ne(vf);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Bs=class extends El{getConfig(){return{}}};class l_ extends Bs{apply(e,t=1){return tj(e,t)}}l_.className="elu";Ne(l_);class u_ extends Bs{apply(e){return v1(e)}}u_.className="selu";Ne(u_);class c_ extends Bs{apply(e){return fo(e)}}c_.className="relu";Ne(c_);class d_ extends Bs{apply(e){return he(()=>Zc(6,fo(e)))}}d_.className="relu6";Ne(d_);class f_ extends Bs{apply(e){return e}}f_.className="linear";Ne(f_);class h_ extends Bs{apply(e){return Or(e)}}h_.className="sigmoid";Ne(h_);class p_ extends Bs{apply(e){return sj(e)}}p_.className="hardSigmoid";Ne(p_);class m_ extends Bs{apply(e){return Al(e)}}m_.className="softplus";Ne(m_);class g_ extends Bs{apply(e){return nj(e)}}g_.className="softsign";Ne(g_);class y_ extends Bs{apply(e){return gl(e)}}y_.className="tanh";Ne(y_);let nT=class extends Bs{apply(e,t=-1){return Hh(e,t)}};nT.className="softmax";Ne(nT);class x_ extends Bs{apply(e,t=-1){return c1(e,t)}}x_.className="logSoftmax";Ne(x_);class v_ extends Bs{apply(e,t=1){return he(()=>j(Or(j(e,t)),e))}}v_.className="swish";Ne(v_);class w_ extends Bs{apply(e){return he(()=>j(e,gl(Al(e))))}}w_.className="mish";Ne(w_);function da(n){return n.getClassName()}function dv(n,e={}){return Zh(n,hr.getMap().classNameMap,e,"activation")}function fa(n){if(n==null){const e={};return e.className="linear",e.config={},dv(e)}if(typeof n=="string"){const e={};return e.className=n,e.config={},dv(e)}else return n instanceof Bs?n:dv(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mee(n){if(n!=null&&typeof n!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${n}`)}class C_ extends El{}class T_ extends C_{constructor(e){super(),mee(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return he(()=>{let t=kn([1]);return this.hasL1&&(t=ke(t,Ge(j(this.l1,In(e))))),this.hasL2&&(t=ke(t,Ge(j(this.l2,tp(e))))),se(t,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,t){return new e({l1:t.l1,l2:t.l2})}}T_.className="L1L2";Ne(T_);const EN={l1l2:"L1L2"};function Gt(n){return zC(n)}function $N(n,e={}){return Zh(n,hr.getMap().classNameMap,e,"regularizer")}function nn(n){if(n==null)return null;if(typeof n=="string"){const t={className:n in EN?EN[n]:n,config:{}};return $N(t)}else return n instanceof C_?n:$N(n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class S_ extends kt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,t){e=ft(e);let s=fo(e);return this.maxValue!=null&&(s=ks(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},t=super.getConfig();return Object.assign(e,t),e}}S_.className="ReLU";Ne(S_);class b_ extends kt{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=ft(e);return Ph(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}}b_.className="LeakyReLU";Ne(b_);class I_ extends kt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=tn(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=nn(e.alphaRegularizer),this.alphaConstraint=Ln(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new le(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Vt(e);const t=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)t[r-1]=1;this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new Fn({ndim:e.length,axes:s})],this.built=!0}call(e,t){return e=ft(e),Uh(e,this.alpha.read())}getConfig(){const e={alphaInitializer:cn(this.alphaInitializer),alphaRegularizer:Gt(this.alphaRegularizer),alphaConstraint:Pn(this.alphaConstraint),sharedAxes:this.sharedAxes},t=super.getConfig();return Object.assign(e,t),e}}I_.className="PReLU";Ne(I_);let k_=class extends kt{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new pt(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,t){const s=ft(e);return Xc(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},t=super.getConfig();return Object.assign(e,t),e}};k_.className="ELU";Ne(k_);class N_ extends kt{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,t){const s=ft(e);return j(s,Me(sr(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},t=super.getConfig();return Object.assign(e,t),e}}N_.className="ThresholdedReLU";Ne(N_);class E_ extends kt{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new nT().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,t){const s=ft(e);return this.softmax(s,this.axis)}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}E_.className="Softmax";Ne(E_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Au(n,e,t){if(typeof n=="number")return wl(n,e);if(n.length!==e)throw new le(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${n.length} elements.`);for(let s=0;s<e;++s){const r=n[s];if(!QZ(r))throw new le(`The ${t} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(n)} including a non-integer number ${r}`)}return n}function io(n,e,t,s,r=1){if(n==null)return n;const o=e+(e-1)*(r-1);let i;return t==="same"?i=n:i=n-o+1,Math.floor((i+s-1)/s)}function No(n,e,t,s){if(n==null)return null;if(s==="valid")n=n*e+ca([t-e,0]);else if(s==="same")n=n*e;else throw new le(`Unsupport padding mode: ${s}.`);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sT(n,e){return he(()=>(Tn(e),e==="channelsFirst"?xt(n,[0,2,3,1]):n))}function $_(n,e){return he(()=>(Tn(e),e==="channelsFirst"?xt(n,[0,2,3,4,1]):n))}function gee(n,e,t,s=1,r="valid",o,i=1){return he(()=>{if(o==null&&(o=uo()),Tn(o),n.shape.length!==3)throw new le(`The input of a conv1dWithBias operation should be 3, but is ${n.shape.length} instead.`);if(e.shape.length!==3)throw new le(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(t!=null&&t.shape.length!==1)throw new le(`The bias for a conv1dWithBias operation should be 1, but is ${e.shape.length} instead`);if(o==="channelsFirst"&&(n=xt(n,[0,2,1])),r==="causal")throw new pt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=s1(n,e,s,r==="same"?"same":"valid","NWC",i);return t!=null&&(a=ho(a,t)),a})}function AN(n,e,t,s=[1,1],r="valid",o,i,a=null){return he(()=>{if(o==null&&(o=uo()),Tn(o),n.rank!==3&&n.rank!==4)throw new le(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${n.rank}.`);if(e.rank!==3&&e.rank!==4)throw new le(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${n.rank}.`);let l=sT(n,o);if(r==="causal")throw new pt("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=E$({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:t,activation:a}),o==="channelsFirst"&&(l=xt(l,[0,3,1,2])),l})}function yee(n,e,t,s=[1,1,1],r="valid",o,i){return he(()=>{if(o==null&&(o=uo()),Tn(o),n.rank!==4&&n.rank!==5)throw new le(`conv3dWithBias expects input to be of rank 4 or 5, but received ${n.rank}.`);if(e.rank!==4&&e.rank!==5)throw new le(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${n.rank}.`);let a=$_(n,o);if(r==="causal")throw new pt("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=Mw(a,e,s,r==="same"?"same":"valid","NDHWC",i),t!=null&&(a=ho(a,t)),o==="channelsFirst"&&(a=xt(a,[0,4,1,2,3])),a})}class Q1 extends kt{constructor(e,t){if(super(t),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Q1.verifyArgs(t),this.rank=e,Wn(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new pt(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Au(t.kernelSize,e,"kernelSize"),this.strides=Au(t.strides==null?1:t.strides,e,"strides"),this.padding=t.padding==null?"valid":t.padding,vr(this.padding),this.dataFormat=t.dataFormat==null?"channelsLast":t.dataFormat,Tn(this.dataFormat),this.activation=fa(t.activation),this.useBias=t.useBias==null?!0:t.useBias,this.biasInitializer=tn(t.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Ln(t.biasConstraint),this.biasRegularizer=nn(t.biasRegularizer),this.activityRegularizer=nn(t.activityRegularizer),this.dilationRate=Au(t.dilationRate==null?1:t.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new le(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new le(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new le(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(ko("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!UC(e.kernelSize,"number",1,3))throw new le(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:da(this.activation),useBias:this.useBias,biasInitializer:cn(this.biasInitializer),biasRegularizer:Gt(this.biasRegularizer),activityRegularizer:Gt(this.activityRegularizer),biasConstraint:Pn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}class td extends Q1{constructor(e,t){super(e,t),this.kernel=null,td.verifyArgs(t),this.filters=t.filters,Wn(this.filters,"filters"),this.kernelInitializer=tn(t.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Ln(t.kernelConstraint),this.kernelRegularizer=nn(t.kernelRegularizer)}build(e){e=Vt(e);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new le(`The channel dimension of the input should be defined. Found ${e[t]}`);const s=e[t],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[t]:s}}],this.built=!0}call(e,t){return he(()=>{e=ft(e);let s;const r=this.bias==null?null:this.bias.read(),o=NA(this.activation.getClassName());if(o!=null&&this.rank===2)s=AN(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)s=gee(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=AN(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=yee(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new pt("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=Vt(e);const t=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<s.length;++o){const i=io(s[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);t.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(t),r.push(this.filters)):(r.push(this.filters),r=r.concat(t)),r}getConfig(){const e={filters:this.filters,kernelInitializer:cn(this.kernelInitializer),kernelRegularizer:Gt(this.kernelRegularizer),kernelConstraint:Pn(this.kernelConstraint)},t=super.getConfig();return Object.assign(e,t),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new le(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class op extends td{constructor(e){super(2,e),op.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!UC(e.kernelSize,"number",1,2))throw new le(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}op.className="Conv2D";Ne(op);class ip extends td{constructor(e){super(3,e),ip.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new le(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}ip.className="Conv3D";Ne(ip);class A_ extends op{constructor(e){if(super(e),this.inputSpec=[new Fn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new le(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Vt(e),e.length!==4)throw new le("Input should have rank 4; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new le("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fn({ndim:4,axes:{[t]:s}})],this.built=!0}call(e,t){return he(()=>{let s=ft(e);if(s.shape.length!==4)throw new le(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=r[i],u=r[a],d=this.kernelSize[0],f=this.kernelSize[1],p=this.strides[0],y=this.strides[1],v=No(l,p,d,this.padding),w=No(u,y,f,this.padding),C=[o,v,w,this.filters];this.dataFormat!=="channelsLast"&&(s=xt(s,[0,2,3,1]));let S=r1(s,this.kernel.read(),C,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(S=xt(S,[0,3,1,2])),this.bias!=null&&(S=ho(S,this.bias.read(),this.dataFormat)),this.activation!=null&&(S=this.activation.apply(S)),S})}computeOutputShape(e){e=Vt(e);const t=e.slice();let s,r,o;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3):(s=3,r=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],u=this.strides[1];return t[s]=this.filters,t[r]=No(t[r],l,i,this.padding),t[o]=No(t[o],u,a,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}A_.className="Conv2DTranspose";Ne(A_);class __ extends ip{constructor(e){if(super(e),this.inputSpec=[new Fn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new le(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Vt(e),e.length!==5)throw new le("Input should have rank 5; Received input shape: "+JSON.stringify(e));const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null)throw new le("The channel dimension of the inputs should be defined. Found `None`.");const s=e[t],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Fn({ndim:5,axes:{[t]:s}})],this.built=!0}call(e,t){return he(()=>{let s=ft(e);if(s.shape.length!==5)throw new le(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const u=r[l],d=r[i],f=r[a],p=this.kernelSize[0],y=this.kernelSize[1],v=this.kernelSize[2],w=this.strides[0],C=this.strides[1],S=this.strides[2],b=No(u,w,p,this.padding),E=No(d,C,y,this.padding),N=No(f,S,v,this.padding),A=[o,b,E,N,this.filters];this.dataFormat!=="channelsLast"&&(s=xt(s,[0,2,3,4,1]));let R=Pw(s,this.kernel.read(),A,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(R=xt(R,[0,4,1,2,3])),this.bias!==null&&(R=ho(R,this.bias.read(),this.dataFormat)),this.activation!==null&&(R=this.activation.apply(R)),R})}computeOutputShape(e){e=Vt(e);const t=e.slice();let s,r,o,i;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3,i=4):(s=4,r=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],u=this.kernelSize[2],d=this.strides[0],f=this.strides[1],p=this.strides[2];return t[s]=this.filters,t[r]=No(t[r],d,a,this.padding),t[o]=No(t[o],f,l,this.padding),t[i]=No(t[i],p,u,this.padding),t}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}__.className="Conv3DTranspose";Ne(__);class R_ extends td{constructor(e,t){if(super(e,t),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,t.filters==null)throw new le("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(t.kernelInitializer!=null||t.kernelRegularizer!=null||t.kernelConstraint!=null)throw new le("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(t.padding!=null&&t.padding!=="same"&&t.padding!=="valid")throw new le(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(t.padding)}`);this.depthMultiplier=t.depthMultiplier==null?1:t.depthMultiplier,this.depthwiseInitializer=tn(t.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=nn(t.depthwiseRegularizer),this.depthwiseConstraint=Ln(t.depthwiseConstraint),this.pointwiseInitializer=tn(t.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=nn(t.pointwiseRegularizer),this.pointwiseConstraint=Ln(t.pointwiseConstraint)}build(e){if(e=Vt(e),e.length<this.rank+2)throw new le(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const t=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[t]==null||e[t]<0)throw new le(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[t])}`);const s=e[t],r=this.kernelSize.concat([s,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new Fn({ndim:this.rank+2,axes:{[t]:s}})],this.built=!0}call(e,t){return he(()=>{e=ft(e);let s;if(this.rank===1)throw new pt("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=xt(e,[0,2,3,1])),s=w1(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=ho(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=xt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=cn(this.depthwiseInitializer),e.pointwiseInitializer=cn(this.pointwiseInitializer),e.depthwiseRegularizer=Gt(this.depthwiseRegularizer),e.pointwiseRegularizer=Gt(this.pointwiseRegularizer),e.depthwiseConstraint=Pn(this.depthwiseConstraint),e.pointwiseConstraint=Pn(this.pointwiseConstraint),e}}R_.className="SeparableConv";class D_ extends R_{constructor(e){super(2,e)}}D_.className="SeparableConv2D";Ne(D_);class Z1 extends td{constructor(e){super(1,e),Z1.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!UC(e.kernelSize,"number",1,1))throw new le(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Z1.className="Conv1D";Ne(Z1);class F_ extends kt{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,t){return he(()=>{if(e=ft(e),this.dataFormat==="channelsLast"){const s=Pm(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Pm(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Pm(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Pm(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}F_.className="Cropping2D";Ne(F_);class M_ extends kt{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Tn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,XZ(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const t=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],t,s]}else{const t=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],t,s,e[3]]}}call(e,t){return he(()=>{let s=ft(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=xt(s,[0,2,3,1]);const o=this.size[0]*r[2],i=this.size[1]*r[3],a=this.interpolation==="nearest"?no.resizeNearestNeighbor(s,[o,i]):no.resizeBilinear(s,[o,i]);return xt(a,[0,3,1,2])}else{const o=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?no.resizeNearestNeighbor(s,[o,i]):no.resizeBilinear(s,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},t=super.getConfig();return Object.assign(e,t),e}}M_.className="UpSampling2D";Ne(M_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xee(n,e,t=[1,1],s="valid",r,o){return he(()=>{r==null&&(r=uo()),Tn(r);let i=sT(n,r);if(n.rank!==4)throw new le(`Input for depthwiseConv2d is required to be 4-D, but is instead ${n.rank}-D`);if(e.rank!==4)throw new le(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=Kc(i,e,t,s==="same"?"same":"valid","NHWC",o),r==="channelsFirst"&&(i=xt(i,[0,3,1,2])),i})}class P_ extends Q1{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=tn(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Ln(e.depthwiseConstraint),this.depthwiseRegularizer=nn(e.depthwiseRegularizer)}build(e){if(e=Vt(e),e.length<4)throw new le(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const t=this.dataFormat==="channelsFirst"?1:3;if(e[t]==null||e[t]<0)throw new le(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[t]}).`);const s=e[t],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return he(()=>{e=ft(e);let s=xee(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=ho(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=Vt(e);const t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=io(t,this.kernelSize[0],this.padding,this.strides[0]),i=io(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,o,i]:[e[0],o,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=cn(this.depthwiseInitializer),e.depthwiseRegularizer=Gt(this.depthwiseRegularizer),e.depthwiseConstraint=Pn(this.depthwiseRegularizer),e}}P_.className="DepthwiseConv2D";Ne(P_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function L_(n,e,t,s){if(Array.isArray(n)){if(e!=null||t!=null)throw new le("When inputs is an array, neither initialState or constants should be provided");s!=null&&(t=n.slice(n.length-s,n.length),n=n.slice(0,n.length-s)),n.length>1&&(e=n.slice(1,n.length)),n=n[0]}function r(o){return o==null||Array.isArray(o)?o:[o]}return e=r(e),t=r(t),{inputs:n,initialState:e,constants:t}}function O_(n,e,t,s=!1,r,o,i=!1,a=!1){return he(()=>{const l=e.shape.length;if(l<3)throw new le(`Input should be at least 3D, but is ${l}D.`);const u=[1,0].concat(lo(2,l));e=xt(e,u),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=Me(Me(r,"bool"),"float32"),r.rank===l-1&&(r=Zn(r,-1)),r=xt(r,u)),s&&(e=yr(e,0),r!=null&&(r=yr(r,0)));const d=[];let f,p=t;const y=e.shape[0],v=zr(e);let w;r!=null&&(w=zr(r));for(let S=0;S<y;++S){const b=v[S],E=he(()=>n(b,p));if(r==null)f=E[0],p=E[1];else{const N=he(()=>{const A=w[S],R=ze(er(A),A),L=ke(j(E[0],A),j(p[0],R)),z=p.map((M,P)=>ke(j(E[1][P],A),j(M,R)));return{output:L,newStates:z}});f=N.output,p=N.newStates}a&&d.push(f)}let C;return a&&(C=xr(d,1)),[f,C,p]})}class Ca extends kt{constructor(e){super(e);let t;if(e.cell==null)throw new le("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?t=new iT({cells:e.cell}):t=e.cell,t.stateSize==null)throw new le("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=t,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Fn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return lo(0,e).map(t=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){h2(e)&&(e=e[0]),e=e;let t=this.cell.stateSize;Array.isArray(t)||(t=[t]);const s=t[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const o=[];for(const i of t)o.push([e[0],i]);return[r].concat(o)}else return r}computeMask(e,t){return he(()=>{Array.isArray(t)&&(t=t[0]);const s=this.returnSequences?t:null;if(this.returnState){const r=this.states.map(o=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[];for(let s=0;s<e;++s)t.push(null);return t}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new pt("Constants support is not implemented in RNN yet.");h2(e)&&(e=e[0]),e=e;const t=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new Fn({shape:[t,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!Ct(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new le(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new Fn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,t=!1){he(()=>{if(!this.stateful)throw new Io("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new le("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>kn([s,r])):this.states_=[kn([s,this.cell.stateSize])];else if(e==null)lt(this.states_),this.keptStates!=null&&(lt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>kn([s,r])):this.states_[0]=kn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new le(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t===!0?this.keptStates.push(this.states_.slice()):lt(this.states_);for(let r=0;r<this.states_.length;++r){const o=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,i];if(!Ct(o.shape,a))throw new le(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[r]=o}}this.states_=this.states_.map(r=>Un(r.clone()))})}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const o=L_(e,s,r,this.numConstants);e=o.inputs,s=o.initialState,r=o.constants;let i=[],a=[];if(s!=null){t.initialState=s,i=i.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new Fn({shape:u.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(t.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof $o){const u=[e].concat(i),d=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=d;const p=super.apply(u,t);return this.inputSpec=f,p}else return super.apply(e,t)}call(e,t){return he(()=>{const s=t==null?null:t.mask,r=t==null?null:t.training;let o=t==null?null:t.initialState;e=ft(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new le(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},u=O_((v,w)=>{const C=this.cell.call([v].concat(w),a);return[C[0],C.slice(1)]},e,o,this.goBackwards,s,null,this.unroll,this.returnSequences),d=u[0],f=u[1],p=u[2];this.stateful&&this.resetStates(p,r);const y=this.returnSequences?f:d;return this.returnState?[y].concat(p):y})}getInitialState(e){return he(()=>{let t=kn(e.shape);return t=Ge(t,[1,2]),t=ep(t),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?d2(t,[1,s]):t):this.cell.stateSize>1?[d2(t,[1,this.cell.stateSize])]:[t]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),t={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(t.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===Ca.className&&(t.cell={className:this.cell.getClassName(),config:s}),Object.assign({},s,e,t)}static fromConfig(e,t,s={}){const r=t.cell,o=ci(r,s);return new e(Object.assign(t,{cell:o}))}}Ca.className="RNN";Ne(Ca);class j1 extends kt{}class rT extends j1{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Wn(this.units,"units"),this.activation=fa(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=tn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=tn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=tn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=nn(e.kernelRegularizer),this.recurrentRegularizer=nn(e.recurrentRegularizer),this.biasRegularizer=nn(e.biasRegularizer),this.kernelConstraint=Ln(e.kernelConstraint),this.recurrentConstraint=Ln(e.recurrentConstraint),this.biasConstraint=Ln(e.biasConstraint),this.dropout=Ou([1,ca([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ou([1,ca([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Vt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return he(()=>{if(e=e,e.length!==2)throw new le(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=t.training==null?!1:t.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ha({ones:()=>er(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ha({ones:()=>er(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=Fo(j(e,i),this.kernel.read()):o=Fo(e,this.kernel.read()),this.bias!=null&&(o=ho(o,this.bias.read())),a!=null&&(s=j(s,a));let l=ke(o,Fo(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:da(this.activation),useBias:this.useBias,kernelInitializer:cn(this.kernelInitializer),recurrentInitializer:cn(this.recurrentInitializer),biasInitializer:cn(this.biasInitializer),kernelRegularizer:Gt(this.kernelRegularizer),recurrentRegularizer:Gt(this.recurrentRegularizer),biasRegularizer:Gt(this.biasRegularizer),activityRegularizer:Gt(this.activityRegularizer),kernelConstraint:Pn(this.kernelConstraint),recurrentConstraint:Pn(this.recurrentConstraint),biasConstraint:Pn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign({},e,t)}}rT.className="SimpleRNNCell";Ne(rT);class V_ extends Ca{constructor(e){e.cell=new rT(e),super(e)}call(e,t){return he(()=>{this.cell.dropoutMask!=null&&(lt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(lt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,t){return new e(t)}}V_.className="SimpleRNN";Ne(V_);class oT extends j1{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new le("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Wn(this.units,"units"),this.activation=fa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=fa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=tn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=tn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=tn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=nn(e.kernelRegularizer),this.recurrentRegularizer=nn(e.recurrentRegularizer),this.biasRegularizer=nn(e.biasRegularizer),this.kernelConstraint=Ln(e.kernelConstraint),this.recurrentConstraint=Ln(e.recurrentConstraint),this.biasConstraint=Ln(e.biasConstraint),this.dropout=Ou([1,ca([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ou([1,ca([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Vt(e);const t=e[e.length-1];this.kernel=this.addWeight("kernel",[t,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,t){return he(()=>{if(e=e,e.length!==2)throw new le(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training==null?!1:t.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ha({ones:()=>er(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ha({ones:()=>er(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,u;0<this.dropout&&this.dropout<1&&(e=j(e,o[0]));let d=Fo(e,this.kernel.read());this.useBias&&(d=ho(d,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=j(r,i[0]));const f=this.recurrentKernel.read(),[p,y]=Ls(f,[2*this.units,this.units],f.rank-1),v=Fo(r,p),[w,C,S]=Ls(d,3,d.rank-1),[b,E]=Ls(v,2,v.rank-1);a=this.recurrentActivation.apply(ke(w,b)),l=this.recurrentActivation.apply(ke(C,E));const N=Fo(j(l,r),y);u=this.activation.apply(ke(S,N));const A=ke(j(a,r),j(ke(1,Qt(a)),u));return[A,A]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:da(this.activation),recurrentActivation:da(this.recurrentActivation),useBias:this.useBias,kernelInitializer:cn(this.kernelInitializer),recurrentInitializer:cn(this.recurrentInitializer),biasInitializer:cn(this.biasInitializer),kernelRegularizer:Gt(this.kernelRegularizer),recurrentRegularizer:Gt(this.recurrentRegularizer),biasRegularizer:Gt(this.biasRegularizer),activityRegularizer:Gt(this.activityRegularizer),kernelConstraint:Pn(this.kernelConstraint),recurrentConstraint:Pn(this.recurrentConstraint),biasConstraint:Pn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign({},e,t)}}oT.className="GRUCell";Ne(oT);class B_ extends Ca{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new oT(e),super(e)}call(e,t){return he(()=>{this.cell.dropoutMask!=null&&(lt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(lt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}B_.className="GRU";Ne(B_);class e0 extends j1{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Wn(this.units,"units"),this.activation=fa(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=fa(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=tn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=tn(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=tn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=nn(e.kernelRegularizer),this.recurrentRegularizer=nn(e.recurrentRegularizer),this.biasRegularizer=nn(e.biasRegularizer),this.kernelConstraint=Ln(e.kernelConstraint),this.recurrentConstraint=Ln(e.recurrentConstraint),this.biasConstraint=Ln(e.biasConstraint),this.dropout=Ou([1,ca([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Ou([1,ca([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var t;e=Vt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;r=new(t=class extends Wr{apply(l,u){const d=o.apply([i]),f=new GC().apply([i]),p=o.apply([i*2]);return hN(hN(d,f),p)}},t.className="CustomInit",t)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,t){return he(()=>{const s=t.training==null?!1:t.training;if(e=e,e.length!==3)throw new le(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ha({ones:()=>er(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ha({ones:()=>er(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,u,d,f;0<this.dropout&&this.dropout<1&&(e=j(e,i[0]));let p=Fo(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=j(r,a[0])),p=ke(p,Fo(r,this.recurrentKernel.read())),this.useBias&&(p=ho(p,this.bias.read()));const[y,v,w,C]=Ls(p,4,p.rank-1);l=this.recurrentActivation.apply(y),u=this.recurrentActivation.apply(v),d=ke(j(u,o),j(l,this.activation.apply(w))),f=this.recurrentActivation.apply(C);const S=j(f,this.activation.apply(d));return[S,S,d]})}getConfig(){const e=super.getConfig(),t={units:this.units,activation:da(this.activation),recurrentActivation:da(this.recurrentActivation),useBias:this.useBias,kernelInitializer:cn(this.kernelInitializer),recurrentInitializer:cn(this.recurrentInitializer),biasInitializer:cn(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Gt(this.kernelRegularizer),recurrentRegularizer:Gt(this.recurrentRegularizer),biasRegularizer:Gt(this.biasRegularizer),activityRegularizer:Gt(this.activityRegularizer),kernelConstraint:Pn(this.kernelConstraint),recurrentConstraint:Pn(this.recurrentConstraint),biasConstraint:Pn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign({},e,t)}}e0.className="LSTMCell";Ne(e0);class z_ extends Ca{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new e0(e),super(e)}call(e,t){return he(()=>{this.cell.dropoutMask!=null&&(lt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(lt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=t==null?null:t.mask,r=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,t){return t.implmentation===0&&(t.implementation=1),new e(t)}}z_.className="LSTM";Ne(z_);class iT extends j1{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const t of this.cells.slice().reverse())Array.isArray(t.stateSize)?e.push(...t.stateSize):e.push(t.stateSize);return e}call(e,t){return he(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,t),o.push(i.slice(1))}s=[];for(const a of o.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(e){h2(e)&&(e=e[0]),e=e;let t;this.cells.forEach((s,r)=>{il(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?t=s.stateSize[0]:t=s.stateSize,e=[e[0],t]})}),this.built=!0}getConfig(){const e=super.getConfig(),t=o=>({className:o.getClassName(),config:o.getConfig()}),r={cells:this.cells.map(t)};return Object.assign({},e,r)}static fromConfig(e,t,s={}){const r=[];for(const o of t.cells)r.push(ci(o,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const t of this.cells)e.push(...t.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const t of this.cells)e.push(...t.nonTrainableWeights);if(!this.trainable){const t=[];for(const s of this.cells)t.push(...s.trainableWeights);return t.concat(e)}return e}getWeights(){const e=[];for(const t of this.cells)e.push(...t.weights);return p2(e)}setWeights(e){const t=[];for(const s of this.cells){const r=s.weights.length,o=e.splice(r);for(let i=0;i<s.weights.length;++i)t.push([s.weights[i],o[i]])}QC(t)}}iT.className="StackedRNNCells";Ne(iT);function ha(n){const{ones:e,rate:t,training:s=!1,count:r=1,dropoutFunc:o}=n,i=()=>o!=null?o(e(),t):FA(e(),t),a=()=>np(i,e,s);return!r||r<=1?Un(a().clone()):Array(r).fill(void 0).map(a).map(u=>Un(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var vee=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class U_ extends Ca{constructor(e){if(e.unroll)throw new pt("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new pt("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Fn({ndim:5})]}call(e,t){return he(()=>{if(this.cell.dropoutMask!=null&&(lt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(lt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),t&&t.constants)throw new le("ConvRNN2D cell does not support constants");const s=t==null?null:t.mask,r=t==null?null:t.training,o=t==null?null:t.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}computeOutputShape(e){let t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0],...t.slice(2)]),this.returnState&&(t=[t,...Array(2).fill([e[0],...t.slice(-3)])]),t}getInitialState(e){return he(()=>{const{stateSize:t}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)],i=kn(o);return Array.isArray(t)?Array(t.length).fill(i):[i]})}resetStates(e,t=!1){he(()=>{if(!this.stateful)throw new Io("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)];if(s[0]==null)throw new le("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>kn(o)):this.states_=[kn(o)];else if(e==null)lt(this.states_),this.keptStates!=null&&(lt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>kn(o)):this.states_[0]=kn(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new le(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);t?this.keptStates.push(this.states_.slice()):lt(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],u=o;if(!Ct(l.shape,u))throw new le(`State ${a} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>Un(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:t,filters:s,kernelSize:r,padding:o,strides:i,dilationRate:a}=this.cell,l=t==="channelsFirst",u=e[l?3:2],d=e[l?4:3],f=io(u,r[0],o,i[0],a[0]),p=io(d,r[1],o,i[1],a[1]);return[...e.slice(0,2),...l?[s,f,p]:[f,p,s]]}}U_.className="ConvRNN2D";class aT extends e0{constructor(e){const{filters:t,kernelSize:s,strides:r,padding:o,dataFormat:i,dilationRate:a}=e;super(Object.assign({},e,{units:t})),this.filters=t,Wn(this.filters,"filters"),this.kernelSize=Au(s,2,"kernelSize"),this.kernelSize.forEach(l=>Wn(l,"kernelSize")),this.strides=Au(r||1,2,"strides"),this.strides.forEach(l=>Wn(l,"strides")),this.padding=o||"valid",vr(this.padding),this.dataFormat=i||"channelsLast",Tn(this.dataFormat),this.dilationRate=Au(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>Wn(l,"dilationRate"))}build(e){var t;e=Vt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new le(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],o=4,i=this.kernelSize.concat([r,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const u=this.biasInitializer,d=this.filters;l=new(t=class extends Wr{apply(p,y){const v=u.apply([d]),w=Qs([d]),C=u.apply([d*2]);return WC([v,w,C])}},t.className="CustomInit",t)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,t){return he(()=>{if(e.length!==3)throw new le(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=t.training||!1,r=e[0],o=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ha({ones:()=>er(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,u=(oe,G,ne)=>!G||!G[ne]?oe:j(G[ne],oe);let d=u(r,l,0),f=u(r,l,1),p=u(r,l,2),y=u(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ha({ones:()=>er(o),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const v=this.recurrentDropoutMask;let w=u(o,v,0),C=u(o,v,1),S=u(o,v,2),b=u(o,v,3);const E=3,[N,A,R,L]=Ls(this.kernel.read(),a,E),[z,M,P,F]=this.useBias?Ls(this.bias.read(),a):[null,null,null,null];d=this.inputConv(d,N,z,this.padding),f=this.inputConv(f,A,M,this.padding),p=this.inputConv(p,R,P,this.padding),y=this.inputConv(y,L,F,this.padding);const[q,ee,ue,ie]=Ls(this.recurrentKernel.read(),a,E);w=this.recurrentConv(w,q),C=this.recurrentConv(C,ee),S=this.recurrentConv(S,ue),b=this.recurrentConv(b,ie);const de=this.recurrentActivation.apply(ke(d,w)),ae=this.recurrentActivation.apply(ke(f,C)),J=ke(j(ae,i),j(de,this.activation.apply(ke(p,S)))),te=j(this.recurrentActivation.apply(ke(y,b)),this.activation.apply(J));return[te,te,J]})}getConfig(){const e=super.getConfig(),{units:t}=e,s=vee(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign({},s,r)}inputConv(e,t,s,r){const o=pi(e,t,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?ho(o,s,this.dataFormat):o}recurrentConv(e,t){return pi(e,t,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}aT.className="ConvLSTM2DCell";Ne(aT);class W_ extends U_{constructor(e){const t=new aT(e);super(Object.assign({},e,{cell:t}))}static fromConfig(e,t){return new e(t)}}W_.className="ConvLSTM2D";Ne(W_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class lT extends kt{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const t=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?t[r]:this.noiseShape[r]);return s}call(e,t){return he(()=>{this.invokeCallHook(e,t);const s=ft(e);if(0<this.rate&&this.rate<1){const r=t.training==null?!1:t.training,o=this.getNoiseShape(s);return np(()=>FA(s,this.rate,o,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=super.getConfig();return Object.assign(e,t),e}dispose(){return super.dispose()}}lT.className="Dropout";Ne(lT);class G_ extends lT{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const t=e.shape;return[t[0],1,t[2]]}}G_.className="SpatialDropout1D";Ne(G_);class H_ extends kt{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let t=null;e.batchSize!=null&&(t=e.batchSize),this.batchInputShape=[t,e.inputDim]}this.units=e.units,Wn(this.units,"units"),this.activation=fa(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=tn(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=tn(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Ln(e.kernelConstraint),this.biasConstraint=Ln(e.biasConstraint),this.kernelRegularizer=nn(e.kernelRegularizer),this.biasRegularizer=nn(e.biasRegularizer),this.activityRegularizer=nn(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Vt(e);const t=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:t}}],this.built=!0}computeOutputShape(e){e=Vt(e);const t=e.slice();return t[t.length-1]=this.units,t}call(e,t){return he(()=>{this.invokeCallHook(e,t);const s=ft(e),r=NA(this.activation.getClassName());let o;return r!=null?o=Fo(s,this.kernel.read(),r,this.bias?this.bias.read():null):(o=Fo(s,this.kernel.read()),this.bias!=null&&(o=ho(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:da(this.activation),useBias:this.useBias,kernelInitializer:cn(this.kernelInitializer),biasInitializer:cn(this.biasInitializer),kernelRegularizer:Gt(this.kernelRegularizer),biasRegularizer:Gt(this.biasRegularizer),activityRegularizer:Gt(this.activityRegularizer),kernelConstraint:Pn(this.kernelConstraint),biasConstraint:Pn(this.biasConstraint)},t=super.getConfig();return Object.assign(e,t),e}}H_.className="Dense";Ne(H_);class q_ extends kt{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Vt(e);for(const t of e.slice(1))if(t==null)throw new le(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],oa(e,1)]}call(e,t){return he(()=>{this.invokeCallHook(e,t);let s=ft(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let o=2;o<s.rank;++o)r.push(o);r.push(1),s=xt(s,r)}return ej(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const t=super.getConfig();return Object.assign(e,t),e}}q_.className="Flatten";Ne(q_);class K_ extends kt{constructor(e){super(e),this.supportsMasking=!0,this.activation=fa(e.activation)}call(e,t){return he(()=>{this.invokeCallHook(e,t);const s=ft(e);return this.activation.apply(s)})}getConfig(){const e={activation:da(this.activation)},t=super.getConfig();return Object.assign(e,t),e}}K_.className="Activation";Ne(K_);class X_ extends kt{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,t){return he(()=>(e=ft(e),ZZ(e,this.n)))}getConfig(){const e={n:this.n},t=super.getConfig();return Object.assign(e,t),e}}X_.className="RepeatVector";Ne(X_);class J_ extends kt{constructor(e){super(e),this.targetShape=e.targetShape;for(let t=0;t<this.targetShape.length;++t)this.isUnknown(this.targetShape[t])&&(this.targetShape[t]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,t){const s="Total size of new array must be unchanged.",r=t.slice();let o=1,i=null;for(let l=0;l<r.length;++l){const u=r[l];if(this.isUnknown(u))if(i===null)i=l;else throw new le("Can only specifiy one unknown dimension.");else o*=u}const a=oa(e);if(i!==null){if(o===0||a%o!==0)throw new le(s);r[i]=a/o}else if(a!==o)throw new le(s);return r}computeOutputShape(e){let t=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,t){return he(()=>{this.invokeCallHook(e,t);const s=ft(e),r=s.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return se(s,o)})}getConfig(){const e={targetShape:this.targetShape},t=super.getConfig();return Object.assign(e,t),e}}J_.className="Reshape";Ne(J_);class Y_ extends kt{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const t=lo(1,e.dims.length+1);if(!Ct(e.dims.slice().sort(),t))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Fn({ndim:this.dims.length+1})]}computeOutputShape(e){e=Vt(e);const t=e.slice();return this.dims.forEach((s,r)=>{t[r+1]=e[s]}),t}call(e,t){return xt(ft(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},t=super.getConfig();return Object.assign(e,t),e}}Y_.className="Permute";Ne(Y_);class Q_ extends kt{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={maskValue:this.maskValue};return Object.assign(t,e),t}computeMask(e,t){const s=ft(e);return pf(yl(s,this.maskValue),-1)}call(e,t){return he(()=>{this.invokeCallHook(e,t);const s=ft(e),i=pf(yl(s,this.maskValue),-1,!0);return j(s,Me(i,s.dtype))})}}Q_.className="Masking";Ne(Q_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Z_ extends kt{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let t=null;e.batchSize!=null&&(t=e.batchSize),e.inputLength==null?this.batchInputShape=[t,null]:this.batchInputShape=[t].concat(Yt(e.inputLength))}this.inputDim=e.inputDim,Wn(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Wn(this.outputDim,"outputDim"),this.embeddingsInitializer=tn(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=nn(e.embeddingsRegularizer),this.activityRegularizer=nn(e.activityRegularizer),this.embeddingsConstraint=Ln(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,t){return he(()=>this.maskZero?(e=ft(e),yl(e,bt(e))):null)}computeOutputShape(e){if(e=Vt(e),this.inputLength==null)return[...e,this.outputDim];const t=Yt(this.inputLength);if(t.length!==e.length-1)throw new le(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<t.length;++r){const o=t[r],i=e[r+1];if(o!=null&&i!=null&&o!==i)throw new le(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(t[s]=i),s++}}return[e[0],...t,this.outputDim]}call(e,t){return he(()=>{this.invokeCallHook(e,t);let s=ft(e);s.dtype!=="int32"&&(s=jh(s,"int32"));const r=DA(this.embeddings.read(),se(s,[s.size]));return se(r,Vt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:cn(this.embeddingsInitializer),embeddingsRegularizer:Gt(this.embeddingsRegularizer),activityRegularizer:Gt(this.activityRegularizer),embeddingsConstraint:Pn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=super.getConfig();return Object.assign(e,t),e}}Z_.className="Embedding";Ne(Z_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Dl extends kt{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new pt}computeElementwiseOpOutputShape(e,t){if(e==null||t==null)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(t.length===0)return e;const s=e.slice(0,e.length-t.length);for(let r=0;r<t.length;++r){const o=e[e.length-t.length+r],i=t[r];if(o==null||i==null||o<0||i<0)s.push(null);else if(o===1)s.push(i);else if(i===1)s.push(o);else{if(o!==i)throw new le("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));s.push(o)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Vt(e)]),e=e,e.length<2)throw new le(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let t=[];for(const o of e)o!=null&&o[0]!==null&&t.push(o[0]);if(t=ra(t),t.length>1)throw new le(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(o=>o.length);e.indexOf(null)===-1&&ra(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,t){return he(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(o=>o.rank);if(r.indexOf(null)===-1){const o=ca(r);for(let i of e){const a=i.rank;for(let l=0;l<o-a;++l)i=ep(i,1);s.push(i)}return this.mergeFunction(s)}else{let o=!1;for(const l of e){const u=l.rank;if(u==null){const d=l.shape,f=d[0],p=d.slice(1).concat([f]);let y=se(l,[f].concat(oa(d.slice(1))));y=xt(y,[1,0]),y=se(y,p),s.push(y),o=!0}else if(u>1){const d=lo(1,u).concat([0]);s.push(xt(l,d)),o=!0}else s.push(l)}let i=this.mergeFunction(s);const a=i.rank;if(o){if(a==null){const l=i.shape,u=l.length,d=l[u-1],f=[d].concat(l.slice(0,l.length-1));i=se(xt(se(i,[-1,d]),[1,0]),f)}else if(a>1){const l=[a-1].concat(lo(0,a-1));i=xt(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let t;e[0]==null?t=null:t=e[0].slice(1);for(let r=1;r<e.length;++r){const o=e[r]==null?null:e[r].slice(1);t=this.computeElementwiseOpOutputShape(t,o)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=ra(s),s.length===1?t=s.concat(t):t=[null].concat(t),t}computeMask(e,t){return he(()=>{if(t==null)return null;if(!Array.isArray(t))throw new le("`mask` should be an Array");if(!Array.isArray(e))throw new le("`inputs` should be an Array");if(t.length!==e.length)throw new le(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${t.length})`);if(t.every(r=>r==null))return null;t=t.map(r=>r==null?r:Zn(r,0));let s=t[0];for(let r=1;r<t.length-1;++r)s=ao(s,t[r]);return s})}}class j_ extends Dl{constructor(e){super(e)}mergeFunction(e){return he(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ke(t,e[s]);return t})}}j_.className="Add";Ne(j_);class eR extends Dl{constructor(e){super(e)}mergeFunction(e){return he(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=j(t,e[s]);return t})}}eR.className="Multiply";Ne(eR);class tR extends Dl{constructor(e){super(e)}mergeFunction(e){return he(()=>{let t=e[0].clone();for(let s=1;s<e.length;++s)t=ke(t,e[s]);return j(1/e.length,t)})}}tR.className="Average";Ne(tR);class nR extends Dl{constructor(e){super(e)}mergeFunction(e){return he(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=Vo(t,e[s]);return t})}}nR.className="Maximum";Ne(nR);class sR extends Dl{constructor(e){super(e)}mergeFunction(e){return he(()=>{let t=e[0];for(let s=1;s<e.length;++s)t=Zc(t,e[s]);return t})}}sR.className="Minimum";Ne(sR);class rR extends Dl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new le("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let t=!0;for(const r of e)if(r!=null){t=!1;break}if(t)return;const s=[];for(let r=0;r<e.length;++r){const o=e[r].slice();o.splice(this.axis,1);let i=!1;for(const a of s)if(Ct(a,o)){i=!0;break}i||s.push(o)}if(s.length>1)throw new le("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return he(()=>WC(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new le("A `Concatenate` layer should be called on a list of inputs.");const t=e,s=t[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const o of t.slice(1)){if(s[r]==null||o[r]==null){s[r]=null;break}s[r]+=o[r]}return s}computeMask(e,t){if(t==null)return null;if(!Array.isArray(t))throw new le("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new le("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new le(`Mismatch in the length of mask (${t.length}) and the legnth of inputs (${e.length})`);return he(()=>{let s=!0;if(t.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)t[i]==null?r.push(Me(er(e[i]),"bool")):t[i].rank<e[i].rank?r.push(Zn(t[i],-1)):r.push(t[i]);const o=dn(r,this.axis);return n1(o,-1,!1)})}getConfig(){const e={axis:this.axis},t=super.getConfig();return Object.assign(e,t),e}}rR.className="Concatenate";Ne(rR);function Yd(n,e){for(;n<0;)n+=e;return n}function wee(n,e,t){if(n.shape.length>3||e.shape.length>3)throw new pt("batchDot is not implemented for tensors of 4D or higher rank yet");if(B(n.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${n.shape.length}`),B(n.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof t=="number"&&(t=[t,t]),n.dtype==="complex64"||e.dtype==="complex64")throw new pt("batchDot is not implemented for complex64-type Tensors yet.");const s=n.shape.length,r=e.shape.length;t==null&&(t=[s-1,r-2]);const o=t;return he(()=>{let i;if(s>r){i=s-r;const l=[];for(let u=0;u<i;++u)l.push(1);e=se(e,e.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let u=0;u<i;++u)l.push(1);n=se(n,n.shape.concat(l))}else i=0;let a;if(n.shape.length===2&&e.shape.length===2)o[0]===o[1]?a=Ge(j(n,e),o[0]):a=Ge(j(xt(n,[1,0]),e),o[1]);else{const l=o[0]!==n.shape.length-1,u=o[1]===e.shape.length-1;a=mt(n,e,l,u)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const u=[];for(let d=l;d<l+i;++d)u.push(d);a=an(a,u)}return a.shape.length===1&&(a=Zn(a,1)),a})}class oR extends Dl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){B(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0],s=e[1];if(t.length>3||s.length>3)throw new pt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);if(t[r[0]]!==s[r[1]])throw new le(`Dimension incompatibility: ${t[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new le(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let t=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((o,i)=>Yd(o,e[i].shape.length)):r=[Yd(this.axes,t.shape.length),Yd(this.axes,s.shape.length)],this.normalize&&(t=Eg(t,r[0]),s=Eg(s,r[1])),wee(t,s,r)}interpretAxes(e,t){let s;return Array.isArray(this.axes)?s=this.axes:s=[Yd(this.axes,e.length),Yd(this.axes,t.length)],s}computeOutputShape(e){B(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const t=e[0].slice(),s=e[1].slice();if(t.length>3||s.length>3)throw new pt("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(t,s);t.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const o=t.concat(s);return o.length===1&&o.push(1),o}computeMask(e,t){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},t=super.getConfig();return Object.assign(e,t),e}}oR.className="Dot";Ne(oR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class iR extends kt{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={stddev:this.stddev};return Object.assign(t,e),t}call(e,t){return he(()=>{this.invokeCallHook(e,t);const s=ft(e);return np(()=>ke(K1(s.shape,0,this.stddev),s),()=>s,t.training||!1)})}}iR.className="GaussianNoise";Ne(iR);class aR extends kt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return he(()=>{this.invokeCallHook(e,t);const s=ft(e);return this.rate>0&&this.rate<1?np(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return j(s,K1(s.shape,1,o))},()=>s,t.training||!1):s})}}aR.className="GaussianDropout";Ne(aR);class lR extends kt{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||ft(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),t={rate:this.rate};return Object.assign(t,e),t}call(e,t){return he(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return np(()=>{const o=ft(e),a=-1.6732632423543772*1.0507009873554805;let l=va(jc(s),this.rate);l=jh(l,"float32");const u=((1-this.rate)*(1+this.rate*a**2))**-.5,d=-u*a*this.rate,f=ke(j(o,l),j(ke(l,-1),a));return ke(j(f,u),d)},()=>ft(e),t.training||!1)}return e})}}lR.className="AlphaDropout";Ne(lR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wf(n,e,t,s,r,o=.001){let i;if(n.rank===2)i=Iw(n,e,t,s,r,o);else if(n.rank===3)i=kw(n,e,t,s,r,o);else if(n.rank===4)i=Nw(n,e,t,s,r,o);else throw new pt(`batchNormalization is not implemented for array of rank ${n.rank} yet`);return i}function Cee(n,e,t,s,r=.001){return he(()=>{const o=Bh(n,s),i=o.mean,a=o.variance;return[wf(n,i,a,t,e,r),i,a]})}function Tee(n,e,t,s,r=.001){return he(()=>{const o=Bh(n,s),i=o.mean,a=o.variance,l=[];for(const v of lo(0,n.rank))s.indexOf(v)!==-1?l.push(1):l.push(n.shape[v]);const u=se(i,l),d=se(a,l),f=e==null?null:se(e,l),p=t==null?null:se(t,l);return[wf(n,u,d,p,f,r),i,a]})}function See(n,e,t,s,r=.001){return Ct(s.slice().sort(),lo(0,n.rank-1))?Cee(n,e,t,s,r):Tee(n,e,t,s,r)}class uR extends kt{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=tn(e.betaInitializer||"zeros"),this.gammaInitializer=tn(e.gammaInitializer||"ones"),this.movingMeanInitializer=tn(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=tn(e.movingVarianceInitializer||"ones"),this.betaConstraint=Ln(e.betaConstraint),this.gammaConstraint=Ln(e.gammaConstraint),this.betaRegularizer=nn(e.betaRegularizer),this.gammaRegularizer=nn(e.gammaRegularizer)}build(e){e=Vt(e);const t=this.axis>=0?this.axis:this.axis+e.length,s=e[t];if(s==null)throw new le(`Axis ${t} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Fn({ndim:e.length,axes:{[t]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,t){return he(()=>{const s=t.training==null?!1:t.training,r=ft(e),o=r.shape,i=o.length,a=lo(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const u=wl(1,i);u[l]=o[l];const d=a.slice();d.sort();const f=!Ct(d,lo(0,i).slice(0,i-1)),p=()=>{if(f){const b=se(this.movingMean.read(),u),E=se(this.movingVariance.read(),u),N=this.center?se(this.beta.read(),u):null,A=this.scale?se(this.gamma.read(),u):null;return wf(r,b,E,N,A,this.epsilon)}else return wf(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return p();const[y,v,w]=See(r,this.gamma.read(),this.beta.read(),a,this.epsilon),C=(b,E,N)=>{he(()=>{const A=1-N,R=b.read(),L=j(ze(R,E),A);b.write(ze(R,L))})};return(()=>{C(this.movingMean,v,this.momentum),C(this.movingVariance,w,this.momentum)})(),y})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:cn(this.betaInitializer),gammaInitializer:cn(this.gammaInitializer),movingMeanInitializer:cn(this.movingMeanInitializer),movingVarianceInitializer:cn(this.movingVarianceInitializer),betaRegularizer:Gt(this.betaRegularizer),gammaRegularizer:Gt(this.gammaRegularizer),betaConstraint:Pn(this.betaConstraint),gammaConstraint:Pn(this.gammaConstraint)},t=super.getConfig();return Object.assign(e,t),e}}uR.className="BatchNormalization";Ne(uR);class cR extends kt{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const t of this.axis)if(!Number.isInteger(t))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=tn(e.betaInitializer||"zeros"),this.gammaInitializer=tn(e.gammaInitializer||"ones"),this.betaRegularizer=nn(e.betaRegularizer),this.gammaRegularizer=nn(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Vt(e);const t=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=t);for(const o of this.axis)if(o<0||o>=t)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==ra(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(o=>e[o]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,t){const s=ft(e),r=s.shape,o=r.length;return he(()=>{let{mean:a,variance:l}=Bh(s,this.axis,!0);const u=wl(1,o);for(const w of this.axis)u[w]=r[w];const d=w=>w!=null&&w.shape.length!==o?se(w,u):w;let f=this.scale?d(this.gamma.read()):null,p=this.center?d(this.beta.read()):null;const y=[],v=[];for(let w=0;w<o;++w)this.axis.indexOf(w)!==-1?(y.push(r[w]),v.push(1)):(y.push(1),v.push(r[w]));return a=pr(a,y),l=pr(l,y),f!=null&&(f=pr(f,v)),p!=null&&(p=pr(p,v)),wf(s,a,l,p,f,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:cn(this.betaInitializer),gammaInitializer:cn(this.gammaInitializer),betaRegularizer:Gt(this.betaRegularizer),gammaRegularizer:Gt(this.gammaRegularizer)},t=super.getConfig();return Object.assign(e,t),e}}cR.className="LayerNormalization";Ne(cR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bee(n,e,t){return he(()=>{if(n.rank!==4)throw new le(`temporalPadding expects input tensor to be 4-D, but received a ${n.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new le("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(t==null&&(t=uo()),t!=="channelsLast"&&t!=="channelsFirst")throw new le(`Unknown data format: ${t}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return t==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],bi(n,s)})}class dR extends kt{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?uo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new le(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let t,s;if(typeof e.padding[0]=="number")t=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new le(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(t=e.padding[0],e.padding[1].length!==2)throw new le(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[t,s]}this.inputSpec=[new Fn({ndim:4})]}computeOutputShape(e){e=Vt(e);let t,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?t=e[2]+this.padding[0][0]+this.padding[0][1]:t=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],t,s]):(e[1]!=null&&e[1]>=0?t=e[1]+this.padding[0][0]+this.padding[0][1]:t=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],t,s,e[3]])}call(e,t){return he(()=>bee(ft(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}dR.className="ZeroPadding2D";Ne(dR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t0(n,e,t,s,r,o){return he(()=>{Tn(r),$A(o),vr(s),t==null&&(t=[1,1]),s==null&&(s="valid"),r==null&&(r=uo()),o==null&&(o="max"),n=sT(n,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=Vh(n,e,t,a):i=Dh(n,e,t,a),r==="channelsFirst"&&(i=xt(i,[0,3,1,2])),i})}function fR(n,e,t,s,r,o){return he(()=>{Tn(r),$A(o),vr(s),t==null&&(t=[1,1,1]),s==null&&(s="valid"),r==null&&(r=uo()),o==null&&(o="max"),n=$_(n,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=Qw(n,e,t,a):i=bw(n,e,t,a),r==="channelsFirst"&&(i=xt(i,[0,4,1,2,3])),i})}class hR extends kt{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new le(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Wn(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new le(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,vr(this.padding),this.inputSpec=[new Fn({ndim:3})]}computeOutputShape(e){e=Vt(e);const t=io(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}call(e,t){return he(()=>{this.invokeCallHook(e,t),e=ep(ft(e),2);const s=this.poolingFunction(ft(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return an(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=super.getConfig();return Object.assign(e,t),e}}class pR extends hR{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return Tn(o),vr(r),t0(e,t,s,r,o,"max")}}pR.className="MaxPooling1D";Ne(pR);class mR extends hR{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return Tn(o),vr(r),t0(e,t,s,r,o,"avg")}}mR.className="AveragePooling1D";Ne(mR);class gR extends kt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new le(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Wn(this.poolSize,"poolSize"),Wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Tn(this.dataFormat),vr(this.padding),this.inputSpec=[new Fn({ndim:4})]}computeOutputShape(e){e=Vt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return t=io(t,this.poolSize[0],this.padding,this.strides[0]),s=io(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s]:[e[0],t,s,e[3]]}call(e,t){return he(()=>(this.invokeCallHook(e,t),this.poolingFunction(ft(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class yR extends gR{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return Tn(o),vr(r),t0(e,t,s,r,o,"max")}}yR.className="MaxPooling2D";Ne(yR);class xR extends gR{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return Tn(o),vr(r),t0(e,t,s,r,o,"avg")}}xR.className="AveragePooling2D";Ne(xR);class vR extends kt{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new le(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Wn(this.poolSize,"poolSize"),Wn(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Tn(this.dataFormat),vr(this.padding),this.inputSpec=[new Fn({ndim:5})]}computeOutputShape(e){e=Vt(e);let t=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return t=io(t,this.poolSize[0],this.padding,this.strides[0]),s=io(s,this.poolSize[1],this.padding,this.strides[1]),r=io(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],t,s,r]:[e[0],t,s,r,e[4]]}call(e,t){return he(()=>(this.invokeCallHook(e,t),this.poolingFunction(ft(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class wR extends vR{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return Tn(o),vr(r),fR(e,t,s,r,o,"max")}}wR.className="MaxPooling3D";Ne(wR);class CR extends vR{constructor(e){super(e)}poolingFunction(e,t,s,r,o){return Tn(o),vr(r),fR(e,t,s,r,o,"avg")}}CR.className="AveragePooling3D";Ne(CR);class TR extends kt{constructor(e){super(e),this.inputSpec=[new Fn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,t){throw new pt}}class SR extends TR{constructor(e){super(e||{})}call(e,t){return he(()=>{const s=ft(e);return un(s,1)})}}SR.className="GlobalAveragePooling1D";Ne(SR);class bR extends TR{constructor(e){super(e||{})}call(e,t){return he(()=>{const s=ft(e);return Vr(s,1)})}}bR.className="GlobalMaxPooling1D";Ne(bR);class IR extends kt{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Tn(this.dataFormat),this.inputSpec=[new Fn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,t){throw new pt}getConfig(){const e={dataFormat:this.dataFormat},t=super.getConfig();return Object.assign(e,t),e}}class kR extends IR{call(e,t){return he(()=>{const s=ft(e);return this.dataFormat==="channelsLast"?un(s,[1,2]):un(s,[2,3])})}}kR.className="GlobalAveragePooling2D";Ne(kR);class NR extends IR{call(e,t){return he(()=>{const s=ft(e);return this.dataFormat==="channelsLast"?Vr(s,[1,2]):Vr(s,[2,3])})}}NR.className="GlobalMaxPooling2D";Ne(NR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class ER extends kt{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=super.getConfig();return Object.assign(e,t),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,t,s={}){const r=t.layer,o=ci(r,s);delete t.layer;const i={layer:o};return Object.assign(i,t),new e(i)}}class $R extends ER{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Vt(e),e.length<3)throw new le(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Vt(e);const t=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(t),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,t){return he(()=>(e=ft(e),O_((i,a)=>[ft(this.layer.call(i,t)),[]],e,[],!1,null,null,!1,!0)[1]))}}$R.className="TimeDistributed";Ne($R);function Iee(n){Rl(KZ,"BidirectionalMergeMode",n)}const kee="concat";class AR extends ER{constructor(e){super(e);const t=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=t,this.forwardLayer=ci(s),t.goBackwards=t.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=t,this.backwardLayer=ci(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?kee:e.mergeMode,Iee(this.mergeMode),e.weights)throw new pt("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const t=e.length,s=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let t=this.forwardLayer.computeOutputShape(e);Array.isArray(t)&&Array.isArray(t[0])||(t=[t]),t=t;let s,r,o;return this.returnState&&(o=t.slice(1)),s=t[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(o).concat(o.slice()):[s].concat(o).concat(o.slice()):Ps(r)}apply(e,t){let s=t==null?null:t.initialState,r=t==null?null:t.constants;t==null&&(t={});const o=L_(e,s,r,this.numConstants);if(e=o.inputs,s=o.initialState,r=o.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,t);const i=[],a=[];if(s!=null){const u=s.length;if(u%2>0)throw new le("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=s,i.push(...s);const d=s.map(f=>new Fn({shape:f.shape}));this.forwardLayer.stateSpec=d.slice(0,u/2),this.backwardLayer.stateSpec=d.slice(u/2),a.push(...d)}if(r!=null)throw new pt("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof $o;for(const u of i)if(u instanceof $o!==l)throw new le("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const u=[e].concat(i),d=this.inputSpec.concat(a),f=this.inputSpec;this.inputSpec=d;const p=super.apply(u,t);return this.inputSpec=f,p}else return super.apply(e,t)}call(e,t){return he(()=>{const s=t.initialState;let r,o;if(s==null)r=this.forwardLayer.call(e,t),o=this.backwardLayer.call(e,t);else{const l=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(t,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(t,{initialState:u}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=yr(o,1));let a;return this.mergeMode==="concat"?a=WC([r,o]):this.mergeMode==="sum"?a=ke(r,o):this.mergeMode==="ave"?a=j(.5,ke(r,o)):this.mergeMode==="mul"?a=j(r,o):this.mergeMode==null&&(a=[r,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){il(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),il(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,t){Array.isArray(t)&&(t=t[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[t,t]:s=t:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(o).concat(o):[s].concat(o).concat(o)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},t=super.getConfig();return Object.assign(e,t),e}static fromConfig(e,t){const s=ci(t.layer);if(delete t.layer,t.numConstants!=null)throw new pt("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=t;return r.layer=s,new e(r)}}AR.className="Bidirectional";Ne(AR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _R extends kt{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},t=super.getConfig();return Object.assign(e,t),e}call(e,t){return he(()=>(e=ft(e),e.dtype!=="float32"&&(e=jh(e,"float32")),ke(j(e,this.scale),this.offset)))}}_R.className="Rescaling";Ne(_R);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var _N;(function(n){n[n.FAIL=0]="FAIL",n[n.SHORTEST=1]="SHORTEST",n[n.LONGEST=2]="LONGEST"})(_N||(_N={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function He(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&B(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nee=E1;class n0 extends Hg{constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new M2(this,ti())}nextDataId(){return n0.nextDataId++}write(e,t,s){this.firstUse&&(this.firstUse=!1,me().get("IS_NODE")&&fr(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&Eo(s[0])){const o=s.map(i=>_o(i));r=this.write(o,e,t)}else r=this.write(s,e,t);return{dataId:r,shape:e,dtype:t}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const t=this.data.get(e);t.refCount++}decRef(e){if(this.data.has(e)){const t=this.data.get(e);t.refCount--}}move(e,t,s,r,o){this.data.set(e,{values:t,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:t,complexTensorInfos:s}=this.data.get(e);if(t==="complex64"){const r=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return gi(r,o)}return this.data.get(e).values}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>fi(r));return ht(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ht(e.shape,e.dtype,t)}makeOutput(e,t,s){return ti().makeTensorFromTensorInfo(this.makeTensorInfo(t,s,e),this)}disposeData(e,t=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!t&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const t=vs();return e(),{kernelMs:vs()-t}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){He([e],"where");const t=this.readSync(e.dataId);return Nee(e.shape,t)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}n0.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RR(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}const Eee=n=>{const{x:e}=n.inputs,t=n.backend;He(e,"abs");let s=new Float32Array(we(e.shape));const r=t.data.get(e.dataId).values;return s=RR(r),t.makeOutput(s,e.shape,e.dtype)},$ee={kernelName:Ef,backendName:"cpu",kernelFunc:Eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $n(n){return(e,t,s,r,o)=>{const i=dt(e,t),a=i.length,l=et(i),u=we(i),d=On(o,u),f=e.length,p=t.length,y=et(e),v=et(t),w=pl(e,i),C=pl(t,i);if(w.length+C.length===0)for(let S=0;S<d.length;++S)d[S]=n(s[S%s.length],r[S%r.length]);else for(let S=0;S<d.length;++S){const b=kl(S,a,l),E=b.slice(-f);w.forEach(L=>E[L]=0);const N=so(E,f,y),A=b.slice(-p);C.forEach(L=>A[L]=0);const R=so(A,p,v);d[S]=n(s[N],r[R])}return[d,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ys(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,o=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,a=t.makeTensorInfo(s.shape,"complex64"),l=t.data.get(a.dataId);return l.complexTensorInfos={real:t.makeTensorInfo(s.shape,"float32",o),imag:t.makeTensorInfo(r.shape,"float32",i)},a}const Aee={kernelName:ey,backendName:"cpu",kernelFunc:Ys};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dg(n,e,t="float32"){if(t==="complex64"){const r=Dg(n,e,"float32"),o=Dg(n,e,"float32");return Ys({inputs:{real:r,imag:o},backend:n})}const s=es(we(e),t);return n.makeTensorInfo(e,t,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lo(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const _ee={kernelName:gc,backendName:"cpu",kernelFunc:Lo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cl(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.real,o=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,o)}const Ree={kernelName:_y,backendName:"cpu",kernelFunc:Cl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DR(n,e,t,s){if(s==="int32"){const r=Int32Array.from(n);return[e,"int32",r]}if(s==="bool"){const r=ma([0],t),[o,i]=$n((a,l)=>a!==l?1:0)(e,[],n,r,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${t} to ${s}`)}function pa(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return Lo({inputs:{x:r},backend:t});const d=Dg(t,r.shape,r.dtype),f=pa({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),p=Ys({inputs:{real:f,imag:d},backend:t});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),p}if(r.dtype==="complex64"){const d=Cl({inputs:{input:r},backend:t}),f=pa({inputs:{x:d},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(d),f}if(!O2(r.dtype,o)){const d=Lo({inputs:{x:r},backend:t});return{dataId:d.dataId,shape:d.shape,dtype:o}}const i=t.data.get(r.dataId).values,[a,l,u]=DR(i,r.shape,r.dtype,o);return t.makeTensorInfo(a,l,u)}const Dee={kernelName:sc,backendName:"cpu",kernelFunc:pa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qn(n,e,t,s){return t==null?({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;He([i,a],n);const u=l.data.get(i.dataId).values,d=l.data.get(a.dataId).values,f=i.dtype==="string"?xl(u):u,p=i.dtype==="string"?xl(d):d,y=s||i.dtype,[v,w]=e(i.shape,a.shape,f,p,y);return l.makeTensorInfo(w,y,v)}:({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const u=pa({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),d=l.data.get(u.dataId),f=d.complexTensorInfos.real,p=d.complexTensorInfos.imag,y=l.data.get(f.dataId).values,v=l.data.get(p.dataId).values,w=pa({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),C=l.data.get(w.dataId),S=C.complexTensorInfos.real,b=C.complexTensorInfos.imag,E=l.data.get(S.dataId).values,N=l.data.get(b.dataId).values,[A,R,L]=t(i.shape,a.shape,y,v,E,N),z=l.makeTensorInfo(L,"float32",A),M=l.makeTensorInfo(L,"float32",R),P=Ys({inputs:{real:z,imag:M},backend:l});return l.disposeIntermediateTensorInfo(u),l.disposeIntermediateTensorInfo(w),l.disposeIntermediateTensorInfo(z),l.disposeIntermediateTensorInfo(M),P}else{const u=l.data.get(i.dataId).values,d=l.data.get(a.dataId).values,f=s||i.dtype,[p,y]=e(i.shape,a.shape,u,d,f);return l.makeTensorInfo(y,f,p)}}}function uT(n){return(e,t,s,r,o,i)=>{const a=dt(e,t),l=we(a),u=a.length,d=et(a),f=On("float32",l),p=On("float32",l),y=pl(e,a),v=pl(t,a),w=gi(s,r),C=gi(o,i),S=e.length,b=et(e),E=t.length,N=et(t);if(y.length+v.length===0)for(let A=0;A<f.length;A++){const R=A%w.length,L=A%C.length,z=n(w[R*2],w[R*2+1],C[L*2],C[L*2+1]);f[A]=z.real,p[A]=z.imag}else for(let A=0;A<f.length;A++){const R=kl(A,u,d),L=R.slice(-S);y.forEach(q=>L[q]=0);const z=so(L,S,b),M=R.slice(-E);v.forEach(q=>M[q]=0);const P=so(M,E,N),F=n(w[z*2],w[z*2+1],C[P*2],C[P*2+1]);f[A]=F.real,p[A]=F.imag}return[f,p,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FR=$n(((n,e)=>n+e)),Fee=uT(((n,e,t,s)=>({real:n+t,imag:e+s}))),Vu=qn(Nl,FR,Fee),Mee={kernelName:Nl,backendName:"cpu",kernelFunc:Vu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cT(n,e,t,s,r){const o=we(s),i=es(r,t);for(let a=0;a<n.length;a++){const l=n[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function MR(n,e,t,s=!1){const r=n.shape[0],o=n.shape[1],i=ht([r,t],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<o;l++){const u=n.get(a,l);if(u<0)throw new Error("Input x must be non-negative!");u>=t||(s?i.set(1,a,u):e.size>0?i.set(i.get(a,u)+e.get(a,l),a,u):i.set(i.get(a,u)+1,a,u))}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ta(n){return(e,t,s)=>{const r=On(t,e.length);for(let o=0;o<e.length;++o)r[o]=n(e[o],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bt(n,e,t){return({inputs:s,attrs:r,backend:o})=>{const{x:i}=s;if(He(i,n),i.dtype==="string"||t==="string")throw new Error("unaryKernelFunc does not support string input/output");const a=o,l=a.data.get(i.dataId).values,u=we(i.shape),d=t||i.dtype,f=Rn(d,u);for(let p=0;p<u;++p)f[p]=e(l[p],r);return a.makeTensorInfo(i.shape,d,f)}}function nd(n,e,t){return({inputs:s,attrs:r,backend:o})=>{const{x:i}=s;if(He(i,n),i.dtype==="string"||t==="string")throw new Error("unaryKernelFunc does not support string input/output");const a=o,l=a.data.get(i.dataId).values,u=t||i.dtype,d=e(l,u,r);return a.makeTensorInfo(i.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PR=Ta(n=>Math.ceil(n)),Pee=nd(rc,PR),Lee={kernelName:rc,backendName:"cpu",kernelFunc:Pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LR(n,e,t,s){const r=Rn(t,we(e));if(s&&t!=="string"){let o=0;n.forEach(i=>{const a=we(i.shape);r.set(i.vals,o),o+=a})}else{let o=0;n.forEach(i=>{const a=t==="string"?xl(i.vals):i.vals;let l=0;for(let u=0;u<i.shape[0];++u){const d=u*e[1]+o;for(let f=0;f<i.shape[1];++f)r[d+f]=a[l++]}o+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OR=$n((n,e)=>n===e?1:0),VR=qn(Gf,OR,null,"bool"),Oee={kernelName:Gf,backendName:"cpu",kernelFunc:VR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BR=Ta(n=>Math.exp(n)),zR=nd(dc,BR,"float32"),Vee={kernelName:dc,backendName:"cpu",kernelFunc:zR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UR=Ta(n=>Math.expm1(n)),Bee=nd(fc,UR),zee={kernelName:fc,backendName:"cpu",kernelFunc:Bee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WR=Ta(n=>Math.floor(n)),Uee=nd(hc,WR),Wee={kernelName:hc,backendName:"cpu",kernelFunc:Uee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GR(n,e,t,s,r,o,i,a,l){const u=ht([s,o],t);for(let d=0;d<s;d++){const f=[];let p=0;for(let y=0;y<r;y++){const v=n[d*r+y];p+=v*i[y],f.push(v)}if(p<0||p>=l/o)throw new Error(`Invalid indices: ${f} does not index into ${a}`);for(let y=0;y<o;y++)u.values[d*o+y]=e.get(...e.indexToLoc(p*o+y))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HR(n,e,t){const s=ht(t,n.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),a=i[0],l=i[2],u=e.locToIndex([a,l]);i[2]=e.values[u];const d=n.locToIndex(i);0<=d&&d<n.values.length&&(s.values[r]=n.values[d])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qR=$n((n,e)=>n>e?1:0),Gee=qn(Xf,qR,null,"bool"),Hee={kernelName:Xf,backendName:"cpu",kernelFunc:Gee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KR=$n((n,e)=>n>=e?1:0),qee=qn(mc,KR,null,"bool"),Kee={kernelName:mc,backendName:"cpu",kernelFunc:qee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XR=$n((n,e)=>n<e?1:0),Xee=qn(Yf,XR,null,"bool"),Jee={kernelName:Yf,backendName:"cpu",kernelFunc:Xee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JR=$n((n,e)=>n<=e?1:0),Yee=qn(Qf,JR,null,"bool"),Qee={kernelName:Qf,backendName:"cpu",kernelFunc:Yee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YR(n,e,t){const s=(e-n)/(t-1),r=es(t,"float32");r[0]=n;for(let o=1;o<r.length;o++)r[o]=r[o-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QR=Ta(n=>Math.log(n)),Zee=nd(wc,QR),jee={kernelName:wc,backendName:"cpu",kernelFunc:Zee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZR(n,e,t,s){const r=On(s,we(t));for(let o=0;o<r.length;++o){const i=o*e;let a=n[i];for(let l=0;l<e;++l){const u=n[i+l];(Number.isNaN(u)||u>a)&&(a=u)}r[o]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jR=$n(((n,e)=>Math.max(n,e))),ete=qn(Tc,jR),tte={kernelName:Tc,backendName:"cpu",kernelFunc:ete};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e4=$n(((n,e)=>Math.min(n,e))),nte=qn(Sc,e4),ste={kernelName:Sc,backendName:"cpu",kernelFunc:nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dT=$n(((n,e)=>n*e)),rte=uT(((n,e,t,s)=>({real:n*t-e*s,imag:n*s+e*t}))),s0=qn(Ic,dT,rte),ote={kernelName:Ic,backendName:"cpu",kernelFunc:s0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t4(n,e,t){const s=Ci(-1,t);return dT([],e,s,n,t)}function ite(n){const{inputs:e,backend:t}=n,{x:s}=e;He(s,"neg");const r=t.data.get(s.dataId).values,[o,i]=t4(r,s.shape,s.dtype);return t.makeTensorInfo(i,s.dtype,o)}const ate={kernelName:lh,backendName:"cpu",kernelFunc:ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n4=$n(((n,e)=>n!==e?1:0)),lte=qn(uh,n4,null,"bool"),ute={kernelName:uh,backendName:"cpu",kernelFunc:lte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fT(n,e,t,s,r){const o=e.length,i=we(e),a=et(e),l=et(r),u=On(t,we(r));for(let d=0;d<i;++d){const f=kl(d,o,a),p=new Array(f.length);for(let v=0;v<p.length;v++)p[v]=f[s[v]];const y=so(p,o,l);u[y]=n[d]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vs(n){const{inputs:e,attrs:t,backend:s}=n,{x:r}=e,{perm:o}=t;He(r,"transpose");const i=r.shape.length,a=new Array(i);for(let f=0;f<a.length;f++)a[f]=r.shape[o[f]];const l=s.data.get(r.dataId).values,u=fT(l,r.shape,r.dtype,o,a);return{dataId:s.write(u,a,r.dtype),shape:a,dtype:r.dtype}}const cte={kernelName:sl,backendName:"cpu",kernelFunc:Vs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4(n,e,t,s){const[r,o]=Hn(n,s),i=Os(e,"int32"),a=es(we(r),i),l=we(o);for(let u=0;u<a.length;++u){const d=u*l;let f=1;for(let p=0;p<l;++p)f*=t[d+p];a[u]=f}return{outVals:a,outShape:r,outDtype:i}}function dte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;He(r,"prod");const a=r.shape.length,l=gt(o,r.shape),u=hn(l,a);let d=l,f=r;const p=[];u!=null&&(f=Vs({inputs:{x:r},backend:t,attrs:{perm:u}}),p.push(f),d=Cn(d.length,a));const y=t.data.get(f.dataId).values,{outVals:v,outShape:w,outDtype:C}=s4(f.shape,f.dtype,y,d);let S=w;return i&&(S=wn(w,l)),p.forEach(b=>t.disposeIntermediateTensorInfo(b)),t.makeTensorInfo(S,C,v)}const fte={kernelName:mh,backendName:"cpu",kernelFunc:dte};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hte(n,e,t){n.forEach((s,r)=>{if(s<0||s>=t){const o=kl(r,e.length,et(e)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${t})`)}})}function pte(n,e){for(let t=0;t<n.length;++t){const s=n[t],r=t===n.length-1?e:n[t+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function mte(n,e,t,s){const r=[];let o=0;const i=e.length-1+t.length,a=new Array(i).fill(null).map(()=>[0]);pte(t,s);let l=1;for(let u=0;u<e.length-1;++u){l*=e[u];const d=e[u+1];for(let f=1;f<l+1;++f)a[u].push(f*d)}for(let u=0;u<n.length;++u){let d=n[u],f=n[u]+1;for(let p=0;p<t.length;++p){const y=t[p],v=p+e.length-1;if(v>=0){const w=a[v],C=w[w.length-1]-y[d];for(let S=d;S<f;++S)a[v].push(y[S+1]+C)}d=y[d],f=y[f]}f!==d&&(r.push([d,f]),o+=f-d)}return{outSplits:a,valueSlices:r,numValues:o}}function gte(n){const e=[];for(let t=0;t<n.length;++t){const s=n[t].length,r=Rn("int32",s);e.push(r),n[t].forEach((o,i)=>r[i]=o)}return e}function RN(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let s=e;s<n.length;s++)t[e-1]*=n[s];return t}function yte(n,e,t,s,r,o){const i=RN(e,2)[1],a=RN(o,2)[1];let l=0;for(const u of t)for(let d=u[0];d<u[1];++d){for(let f=0;f<s;++f)r[l*a+f]=n[d*i+f];++l}}function xte(n,e,t,s,r){const o=e.slice();o[0]=r;const i=Rn(t,we(o)),a=n.length,l=a===0?0:a/e[0];return yte(n,e,s,l,i,o),[i,o]}function r4(n,e,t,s,r,o,i,a){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(hte(o,i,l),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:d,valueSlices:f,numValues:p}=mte(o,i,n,u),y=gte(d),v=xte(t,s,r,f,p);return[y,v[0],v[1]]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ar=eo;class Fg{constructor(e,t,s,r,o,i,a,l,u,d){this.shape=e,this.shapeShape=t,this.values=s,this.valuesShape=r,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=U$(d),this.raggedRank=W$(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===Ar.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===Ar.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case Ar.VALUE_ROWIDS:return Fg.getMaxWidthValueRowID(t);case Ar.ROW_SPLITS:return Fg.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${Ar[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let s=0;for(let r=0;r<t-1;++r){const o=e[r+1]-e[r];o>s&&(s=o)}return s}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let s=0,r=e[0],o=0;for(let i=1;i<t;++i){const a=e[i];a!==r&&(r=a,o=Math.max(i-s,o),s=i)}return Math.max(t-s,o)}tensorShapeFromTensor(e,t,s=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return FN(e,s)}calculateOutputSize(e){const t=this.valuesShape,s=this.defaultValueShape;G$(s,t);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=z$(this.raggedRank,r,t);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,t,s){const r=Math.min(e,s),o=[];let i=0;for(let a=0;a<r;++a,i+=t)o.push(i);for(let a=r;a<e;++a)o.push(-1);return B(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,t,s,r){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let u=Math.min(r,l),d=t[a];d===-1&&(u=0);for(let f=0;f<u;++f)i.push(d),d+=s;for(let f=0;f<l-u;++f)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,s,r){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=t.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${t.length}`);let u=t[l];i.push(u);for(let d=1;d<o;++d){const f=e[d];if(f===l)u>=0&&(++a,a<r?u+=s:u=-1);else{if(a=0,l=f,f>=t.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${t.length}`);u=t[f]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,s,r){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case Ar.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,t,s,r);case Ar.ROW_SPLITS:if(o.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(o,t,s,r);default:throw new Error(`Unsupported partition type: ${Ar[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case Ar.FIRST_DIM_SIZE:return e[0];case Ar.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case Ar.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${Ar[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),s=this.calculateOutputSize(t),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const o=FN(s,!1),i=Rn(this.valuesDType,we(o));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(t,r[0],s[0]);for(let u=1;u<=this.raggedRank;++u)l=this.calculateOutputIndex(u-1,l,r[u],s[u]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,t,s,r){if(s.length===0)return;const o=this.values,i=s;let a=r.slice();a=a.slice(e+1);const l=we(a),u=t.length;let d=this.defaultValue;if(d.length!==l&&d.length!==1){const v=this.defaultValueShape;he(()=>{const w=se(d,v);d=ol(w,a).dataSync()})}let f=0,p=0,y=0;for(let v=0;v<=u;++v){let w=v<u?t[v]:-1;if(w===y){++y;continue}if(p<y){const C=o.subarray(f*l),S=i.subarray(p*l),b=(y-p)*l;DN(S,C,b)}if(v>=u){const C=s.length;w=Math.floor(C/l)}if(w>y)if(this.defaultValue.length===1)i.subarray(y*l,w*l).fill(this.defaultValue[0]),y=w;else for(;w>y;){const C=i.slice(y*l);DN(C,d,l),++y}w<0?(f=v+1,p=y):(f=v,p=y,y=p+1)}}}function DN(n,e,t){for(let s=0;s<t;s++)n[s]=e[s]}function FN(n,e){const t=[];for(let s of n){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}t.push(s)}return t}function o4(n,e,t,s,r,o,i,a,l,u){return new Fg(n,e,t,s,r,o,i,a,l,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i4(n,e,t,s){const r=n===e,o=n<e&&t<0,i=e<n&&t>1;if(r||o||i)return es(0,s);const a=Math.abs(Math.ceil((e-n)/t)),l=es(a,s);e<n&&t===1&&(t=-1),l[0]=n;for(let u=1;u<l.length;u++)l[u]=l[u-1]+t;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a4=Ta(n=>1/Math.sqrt(n)),vte=nd(_c,a4),wte={kernelName:_c,backendName:"cpu",kernelFunc:vte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Su(n,e,t,s,r,o,i,a,l,u){const d=[s/r,r],f=n.values,p=e.values;if(s===0)return ht(t,e.dtype);const y=ht(d,e.dtype);typeof l=="string"||typeof l=="number"?y.values.fill(l):typeof l=="boolean"&&y.values.fill(+l);for(let v=0;v<o;v++){const w=[];let C=0;for(let S=0;S<i;S++){const b=f[v*i+S];w.push(b),C+=b*a[S]}if(C<0||C>=s/r)throw new Error(`Invalid indices: ${w} does not index into ${t}`);for(let S=0;S<r;S++)u?y.values[C*r+S]+=p[v*r+S]:y.values[C*r+S]=e.rank===0?p[0]:p[v*r+S]}return y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cte=Ta(n=>1/(1+Math.exp(-n))),l4=Bt(Pc,n=>1/(1+Math.exp(-n))),Tte={kernelName:Pc,backendName:"cpu",kernelFunc:l4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4(n,e,t,s,r){const o=cw(s,e,t),i=we(t),a=et(s);if(o){const f=dw(e,a);return r==="string"?n.slice(f,f+i):n.subarray(f,f+i)}const l=r==="string"?xl(n):n,u=ht(s,r,l),d=ht(t,r);for(let f=0;f<d.size;++f){const p=d.indexToLoc(f),y=p.map((v,w)=>v+e[w]);d.set(u.get(...y),...p)}return r==="string"?cA(d.values):d.values}function Tl(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:o,size:i}=s;He(r,"slice");const[a,l]=e1(r,o,i);lw(r,a,l);const u=t.data.get(r.dataId).values,d=u4(u,a,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,d)}const Ste={kernelName:Ch,backendName:"cpu",kernelFunc:Tl};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(n,e,t,s,r,o,i){const a=e[0],l=o[0],u=new Array(l),d=new Array(a),f=e[1];if(l===0){if(a!==0)throw new Error(Q$(a));const C=Rn(t,0),S=Rn(r,0);return[C,[0,f],S,u,d]}let p=!0,y=0;const v=new Array(l).fill(0);for(let C=0;C<a;++C){const S=n[C*f];if(S<0)throw new Error(Z$(C,S));if(S>=l)throw new Error(j$(C,S,l));++v[S],p=p&&S>=y,y=S}let w=!0;for(let C=0;C<l;++C){const S=v[C]===0;u[C]=S,w=w&&!S,v[C]=Math.max(v[C],1),C>0&&(v[C]+=v[C-1])}if(w&&p){const C=n,S=s;for(let b=0;b<a;++b)d[b]=b;return[C,[a,f],S,u,d]}else{const C=v[l-1],S=Rn(t,C*f),b=Rn(r,C),E=new Array(l).fill(0);for(let N=0;N<a;++N){const A=n[N*f],R=E[A],L=(A===0?0:v[A-1])+R;E[A]++;for(let z=0;z<f;++z)S[L*f+z]=n[N*f+z];b[L]=s[N],d[N]=L}for(let N=0;N<l;++N)if(E[N]===0){const R=N===0?0:v[N-1];S[R*f+0]=N;for(let L=1;L<f;++L)S[R*f+L]=0;b[R]=i}return[S,[C,f],b,u,d]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4(n,e,t,s,r){const o=we(s),i=e[0],a=r.length,l=[];let u=1,d=-1;for(let C=0;C<a;++C){const S=r[C];if(S===-1){if(d!==-1)throw new Error(eA(d,C));d=C,l.push(1)}else{if(S<0)throw new Error(tA(C,S));u*=S,l.push(S)}}if(d!==-1){if(u<=0)throw new Error(nA());const C=Math.trunc(o/u);if(u*C!==o)throw new Error(sA(s,l));l[d]=C}if(we(l)!==o)throw new Error(rA(s,l));const p=s.length,y=[];if(p>0){y[p-1]=1;for(let C=p-2;C>=0;--C)y[C]=y[C+1]*s[C+1]}const v=[];if(a>0){v[a-1]=1;for(let C=a-2;C>=0;--C)v[C]=v[C+1]*l[C+1]}const w=Rn(t,i*a);for(let C=0;C<i;++C){let S=0;for(let b=0;b<p;++b)S+=n[C*p+b]*y[b];for(let b=0;b<a;++b)w[C*a+b]=Math.trunc(S/v[b]),S%=v[b]}return[w,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hT(n,e,t,s,r,o=!1,i=0){const a=s.length,l=[e[0],n.length/e[0]],u=l[1],f=a>0?r[a-1]+1:0;if(f<0)throw new Error(Qv());const p=e.slice();p[0]=f;const y=p.reduce((E,N)=>E*N,1),v=Rn(t,y);if(a===0)return f>0&&v.fill(i),[v,p];if(f<=0)throw new Error(Qv());let w=0,C=1,S=0,b=r[w];for(;;){let E=0;if(C<a){if(E=r[C],b===E){++C;continue}if(b>=E)throw new Error(oA())}if(b<0||b>=f)throw new Error(iA(b,f));b>S&&v.fill(i,S*u,b*u);for(let N=w;N<C;++N){const A=s[N];if(A<0||A>=l[0])throw new Error(aA(N,s[N],l[0]));for(let R=0;R<u;R++)v[b*u+R]+=n[A*u+R]}if(o)for(let N=0;N<u;N++)v[b*u+N]/=C-w;if(w=C,++C,S=b+1,b=E,C>a)break}return S<f&&v.fill(i,S*u,f*u),[v,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bte=Ta(n=>Math.sqrt(n)),Ite=Bt(Oc,n=>Math.sqrt(n)),kte={kernelName:Oc,backendName:"cpu",kernelFunc:Ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f4=$n(((n,e)=>{const t=n-e;return t*t})),Nte=qn(Vc,f4),Ete={kernelName:Vc,backendName:"cpu",kernelFunc:Nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h4(n,e,t,s){const r=ht(n,e.dtype);for(let o=0;o<r.size;o++){const i=r.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*t[l]+s[l];r.set(e.get(...a),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $te{constructor(e,t,s,r,o,i){this.separator=_o(e),this.nGramWidths=t,this.leftPad=_o(s),this.rightPad=_o(r),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const s=this.getPadWidth(t);return Math.max(0,e+2*s-t+1)}createNGrams(e,t,s,r,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),u=Math.max(0,l-a),d=Math.max(0,l-(o-(a+1))),f=i-(u+d),p=t+(u>0?0:a-l);let y=0;y+=u*this.leftPad.length;for(let b=0;b<f;++b)y+=e[p+b].length;y+=d*this.rightPad.length;const v=u+d+f-1;y+=v*this.separator.length,s[r+a]=new Uint8Array(y);const w=s[r+a];let C=0;const S=b=>b.forEach(E=>w[C++]=E);for(let b=0;b<u;++b)S(this.leftPad),S(this.separator);for(let b=0;b<f-1;++b)S(e[p+b]),S(this.separator);if(f>0){S(e[p+f-1]);for(let b=0;b<d;++b)S(this.separator),S(this.rightPad)}else{for(let b=0;b<d-1;++b)S(this.rightPad),S(this.separator);S(this.rightPad)}}}compute(e,t){const s=e.length,r=t.length;if(r>0){let l=t[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let u=1;u<r;++u){let d=t[u]>=l;if(d=d&&t[u]<=s,!d)throw new Error(`Invalid split value ${t[u]}, must be in [${l}, ${s}]`);l=t[u]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const o=r-1,i=Rn("int32",r);if(s===0||r===0){const l=new Array(s);for(let u=0;u<=o;++u)i[u]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const u=t[l]-t[l-1];let d=0;this.nGramWidths.forEach(f=>{d+=this.getNumNGrams(u,f)}),this.preserveShort&&u>0&&d===0&&(d=1),i[l]=i[l-1]+d}const a=new Array(i[o]);for(let l=0;l<o;++l){const u=t[l];let d=i[l];if(this.nGramWidths.forEach(f=>{const p=t[l+1]-t[l],y=this.getNumNGrams(p,f);this.createNGrams(e,u,a,d,y,f),d+=y}),this.preserveShort&&d===i[l]){const f=t[l+1]-t[l];if(f===0)continue;const p=f+2*this.padWidth;this.createNGrams(e,u,a,d,1,p)}}return[a,i]}}function p4(n,e,t,s,r,o,i,a){return new $te(t,s,r,o,i,a).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ate(n,e,t,s){if(!n.length)return;if(e.length===0){for(let o=0;o<n.length;++o)s.push(n.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=n.indexOf(o);for(;i!==-1;){const a=n.subarray(0,i);(!t||a.length!==0)&&s.push(a),n=n.subarray(i+1),i=n.indexOf(o)}(!t||n.length!==0)&&s.push(n);return}let r=0;for(let o=0;o<n.length+1;o++)if(o===n.length||e.indexOf(n[o])!==-1){const i=n.subarray(r,o);(!t||i.length!==0)&&s.push(i),r=o+1}}function m4(n,e,t){const s=n.length,r=[];let o=0,i=0;const a=new Array(s);for(let p=0;p<s;++p){const y=r.length;Ate(n[p],e,t,r);const v=r.length-y;a[p]=v,o+=v,i=Math.max(i,v)}const l=Rn("int32",o*2),u=new Array(o),d=[s,i];let f=0;for(let p=0;p<s;++p)for(let y=0;y<a[p];++y)l[f*2]=p,l[f*2+1]=y,u[f]=r[f],++f;return[l,u,d]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g4(n,e){const t=Rn("int32",n.length);for(let s=0;s<n.length;++s)t[s]=i3(n[s]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y4=$n(((n,e)=>n-e)),_te=uT(((n,e,t,s)=>({real:n-t,imag:e-s}))),pT=qn(Bc,y4,_te),Rte={kernelName:Bc,backendName:"cpu",kernelFunc:pT};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4(n,e){const t=new Array(n.rank);for(let r=0;r<t.length;r++)t[r]=n.shape[r]*e[r];const s=ht(t,n.dtype);for(let r=0;r<s.values.length;++r){const o=s.indexToLoc(r),i=new Array(n.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%n.shape[l];const a=n.locToIndex(i);s.values[r]=n.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nf=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function v4(n,e,t=0,s=n.length-1){for(;s>t;){if(s-t>600){const a=s-t+1,l=e-t+1,u=Math.log(a),d=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*d*(a-d)/a)*Math.sign(l-a/2),p=Math.max(t,Math.floor(e-l*d/a+f)),y=Math.min(s,Math.floor(e+(a-l)*d/a+f));v4(n,e,p,y)}const r=n[e];let o=t,i=s;for(ri(n,t,e),nf(n[s],r)>0&&ri(n,t,s);o<i;){for(ri(n,o,i),o++,i--;nf(n[o],r)<0;)o=o+1;for(;nf(n[i],r)>0;)i=i-1}nf(n[t],r)===0?ri(n,t,i):(i=i+1,ri(n,i,s)),i<=e&&(t=i+1),e<=i&&(s=i-1)}}function w4(n,e,t,s,r){const o=e[e.length-1],[i,a]=[n.length/o,o],l=On(t,i*s),u=On("int32",i*s);for(let f=0;f<i;f++){const p=f*a,y=n.subarray(p,p+a);let v=new Array(y.length);y.forEach((b,E)=>v[E]={value:b,index:E}),s<v.length&&(v4(v,s),v=v.slice(0,s)),r&&v.sort(nf);const w=f*s,C=l.subarray(w,w+s),S=u.subarray(w,w+s);for(let b=0;b<s;b++)C[b]=v[b].value,S[b]=v[b].index}const d=e.slice();return d[d.length-1]=s,[ht(d,t,l),ht(d,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4(n,e,t,s){const r=gt(e,t)[0],o=[1,t[0],1];for(let v=0;v<r;v++)o[0]*=t[v];o[1]=t[r];for(let v=r+1;v<t.length;v++)o[2]*=t[v];const i={},a=new Int32Array(t[r]),l=new Mn(o,s,n),u=[],d=o[0]===1&&o[2]===1;for(let v=0;v<t[r];v++){let w;if(d)w=n[v].toString();else{const C=[];for(let S=0;S<o[0];S++)for(let b=0;b<o[2];b++)C.push(l.get(S,v,b));w=C.join(",")}if(i[w]!==void 0)a[v]=i[w];else{const C=Object.keys(i).length;i[w]=C,a[v]=C,u.push(v)}}const f=o.slice();f[1]=Object.keys(i).length;const p=new Mn(f,s);u.forEach((v,w)=>{for(let C=0;C<o[0];C++)for(let S=0;S<o[2];S++)p.set(l.get(C,v,S),C,w,S)});const y=t.slice();return y[r]=f[1],{outputValues:p.values,outputShape:y,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dte=Object.freeze(Object.defineProperty({__proto__:null,addImpl:FR,bincountImpl:cT,bincountReduceImpl:MR,castImpl:DR,ceilImpl:PR,concatImpl:LR,equalImpl:OR,expImpl:BR,expm1Impl:UR,floorImpl:WR,gatherNdImpl:GR,gatherV2Impl:HR,greaterEqualImpl:KR,greaterImpl:qR,lessEqualImpl:JR,lessImpl:XR,linSpaceImpl:YR,logImpl:QR,maxImpl:ZR,maximumImpl:jR,minimumImpl:e4,multiplyImpl:dT,negImpl:t4,notEqualImpl:n4,prodImpl:s4,raggedGatherImpl:r4,raggedTensorToTensorImpl:o4,rangeImpl:i4,rsqrtImpl:a4,scatterImpl:Su,sigmoidImpl:Cte,simpleAbsImpl:RR,sliceImpl:u4,sparseFillEmptyRowsImpl:c4,sparseReshapeImpl:d4,sparseSegmentReductionImpl:hT,sqrtImpl:bte,squaredDifferenceImpl:f4,stridedSliceImpl:h4,stringNGramsImpl:p4,stringSplitImpl:m4,stringToHashBucketFastImpl:g4,subImpl:y4,tileImpl:x4,topKImpl:w4,transposeImpl:fT,uniqueImpl:C4},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */nw("cpu",()=>new n0,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T4=Bt(uc,n=>n>=0?n:Math.exp(n)-1),Fte={kernelName:uc,backendName:"cpu",kernelFunc:T4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S4(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:o}=s;He([r],"leakyRelu");const i=we(r.shape),a=t.data.get(r.dataId).values,l=On("float32",i);for(let u=0;u<a.length;u++)l[u]=a[u]<0?o*a[u]:a[u];return t.makeTensorInfo(r.shape,"float32",l)}const Mte={kernelName:Jf,backendName:"cpu",kernelFunc:S4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pte=$n((n,e)=>n<0?e*n:n);function b4(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e;He([s,r],"prelu");const o=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,[a,l]=Pte(s.shape,r.shape,o,i,"float32");return t.makeTensorInfo(l,"float32",a)}const Lte={kernelName:ph,backendName:"cpu",kernelFunc:b4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I4=Bt(Ec,n=>Math.max(0,n)),Ote={kernelName:Ec,backendName:"cpu",kernelFunc:I4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k4=Bt($c,n=>Math.min(Math.max(0,n),6)),Vte={kernelName:$c,backendName:"cpu",kernelFunc:k4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mg(n,e,t,s,r){if(t==="linear")return Lo({inputs:{x:e},backend:n});if(t==="relu")return I4({inputs:{x:e},backend:n});if(t==="elu")return T4({inputs:{x:e},backend:n});if(t==="relu6")return k4({inputs:{x:e},backend:n});if(t==="prelu")return b4({inputs:{x:e,alpha:s},backend:n});if(t==="leakyrelu")return S4({inputs:{x:e},backend:n,attrs:{alpha:r}});if(t==="sigmoid")return l4({inputs:{x:e},backend:n});throw new Error(`Activation ${t} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qt(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:o}=s,i=we(r.shape),a=L2(o,i),l=we(a);B(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),t.incRef(r.dataId);const u=t.data.get(r.dataId);if(u.complexTensorInfos!=null){const d=u.complexTensorInfos.real,f=u.complexTensorInfos.imag;d.shape=a,f.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const Bte={kernelName:gh,backendName:"cpu",kernelFunc:qt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;He([r,o],"matMul");const l=r.shape.length,u=o.shape.length,d=i?r.shape[l-2]:r.shape[l-1],f=a?o.shape[u-1]:o.shape[u-2],p=i?r.shape[l-1]:r.shape[l-2],y=a?o.shape[u-2]:o.shape[u-1],v=r.shape.slice(0,-2),w=o.shape.slice(0,-2),C=we(v),S=we(w),E=dt(r.shape.slice(0,-2),o.shape.slice(0,-2)).concat([p,y]);B(d===f,()=>`Error in matMul: inner shapes (${d}) and (${f}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const N=i?[C,d,p]:[C,p,d],A=a?[S,y,f]:[S,f,y],R=qt({inputs:{x:r},backend:t,attrs:{shape:N}}),L=qt({inputs:{x:o},backend:t,attrs:{shape:A}}),z=i?R.shape[1]:R.shape[2],M=i?R.shape[2]:R.shape[1],P=a?L.shape[1]:L.shape[2],F=Math.max(C,S),q=t.data.get(R.dataId).values,ee=t.data.get(L.dataId).values,ue=et(R.shape),ie=et(L.shape),[de,ae,J]=i?[ue[0],1,ue[1]]:[ue[0],ue[1],1],[te,oe,G]=a?[1,ie[1],ie[0]]:[ie[1],1,ie[0]],ne=M*P,ye=ht([F,M,P],R.dtype),Te=ye.values,Se=t.blockSize;for(let Ie=0;Ie<F;Ie++)for(let Re=0;Re<M;Re+=Se)for(let Fe=0;Fe<P;Fe+=Se)for(let Pe=0;Pe<z;Pe+=Se){const Qe=Math.min(Re+Se,M),je=Math.min(Fe+Se,P),yt=Math.min(Pe+Se,z);for(let Nt=Re;Nt<Qe;Nt++)for(let At=Fe;At<je;At++){let It=0;for(let Et=Pe;Et<yt;Et++){const Lt=Math.min(Ie,C-1)*de,Ot=Math.min(Ie,S-1)*G,Kn=q[Lt+Nt*ae+Et*J],Xt=ee[Et*te+At*oe+Ot];It+=Kn*Xt}Te[Ie*ne+(Nt*P+At)]+=It}}return t.disposeIntermediateTensorInfo(R),t.disposeIntermediateTensorInfo(L),t.makeTensorInfo(E,ye.dtype,ye.values)}const zte={kernelName:Ff,backendName:"cpu",kernelFunc:N4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ute(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:d,leakyreluAlpha:f}=s;let p,y,v;const w=[];p=N4({inputs:{a:r,b:o},attrs:{transposeA:l,transposeB:u},backend:t}),i&&(y=Vu({inputs:{a:p,b:i},backend:t}),w.push(p),p=y),d&&(v=Mg(t,p,d,a,f),w.push(p),p=v);for(const S of w)t.disposeIntermediateTensorInfo(S);return p}const Wte={kernelName:lf,backendName:"cpu",kernelFunc:Ute};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gte=Bt(Yu,n=>Math.acos(n)),Hte={kernelName:Yu,backendName:"cpu",kernelFunc:Gte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qte=Bt(Qu,n=>Math.acosh(n)),Kte={kernelName:Qu,backendName:"cpu",kernelFunc:qte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xte(n){const{inputs:e,backend:t}=n,s=e;He(e,"addN");const r=s.map(a=>t.data.get(a.dataId).values),o=ht(s[0].shape,s[0].dtype),i=o.values;for(let a=0;a<s.length;a++){const l=r[a];for(let u=0;u<i.length;u++)i[u]+=l[u]}return t.makeTensorInfo(o.shape,o.dtype,o.values)}const Jte={kernelName:$f,backendName:"cpu",kernelFunc:Xte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;He(r,"all");const a=gt(o,r.shape);let l=a;const u=hn(l,r.shape.length);let d=r;u!=null&&(d=Vs({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Cn(l.length,r.shape.length)),rs("all",l,d.shape.length);const[f,p]=Hn(d.shape,l),y=we(p),v=es(we(f),d.dtype),w=t.data.get(d.dataId).values;for(let S=0;S<v.length;++S){const b=S*y;let E=w[b];for(let N=0;N<y;++N){const A=w[b+N];E=E&&A}v[S]=E}u!=null&&t.disposeIntermediateTensorInfo(d);const C=t.makeTensorInfo(f,d.dtype,v);if(i){const S=wn(f,a),b=qt({inputs:{x:C},backend:t,attrs:{shape:S}});return t.disposeIntermediateTensorInfo(C),b}return C}const Qte={kernelName:Xg,backendName:"cpu",kernelFunc:Yte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zte(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;He(r,"any");const a=gt(o,r.shape);let l=a;const u=hn(l,r.shape.length);let d=r;u!=null&&(d=Vs({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Cn(l.length,r.shape.length)),rs("any",l,d.shape.length);const[f,p]=Hn(d.shape,l),y=we(p),v=es(we(f),d.dtype),w=t.data.get(d.dataId).values;for(let S=0;S<v.length;++S){const b=S*y;let E=w[b];for(let N=0;N<y;++N){const A=w[b+N];E=E||A}v[S]=E}u!=null&&t.disposeIntermediateTensorInfo(d);const C=t.makeTensorInfo(f,d.dtype,v);if(i){const S=wn(f,a),b=qt({inputs:{x:C},backend:t,attrs:{shape:S}});return t.disposeIntermediateTensorInfo(C),b}return C}const jte={kernelName:Jg,backendName:"cpu",kernelFunc:Zte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ene(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o}=s;He(r,"argMax");let i=gt(o,r.shape);const a=hn(i,r.shape.length);let l=r;const u=[];a!=null&&(l=Vs({inputs:{x:r},backend:t,attrs:{perm:a}}),u.push(l),i=Cn(i.length,l.shape.length)),i=[i[0]],rs("argMax",i,l.shape.length);const[d,f]=Hn(l.shape,i),p=we(d),y=es(p,"int32"),v=we(f),w=t.data.get(l.dataId).values;for(let C=0;C<y.length;++C){const S=C*v;let b=w[S],E=0;for(let N=0;N<v;++N){const A=w[S+N];A>b&&(b=A,E=N)}y[C]=E}return u.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.makeTensorInfo(d,"int32",y)}const tne={kernelName:Af,backendName:"cpu",kernelFunc:ene};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o}=s;He(r,"argMin");let i=gt(o,r.shape);const a=hn(i,r.shape.length);let l=r;const u=[];a!=null&&(l=Vs({inputs:{x:r},backend:t,attrs:{perm:a}}),u.push(l),i=Cn(i.length,l.shape.length)),i=[i[0]],rs("argMin",i,l.shape.length);const[d,f]=Hn(l.shape,i),p=we(d),y=es(p,"int32"),v=we(f),w=t.data.get(l.dataId).values;for(let C=0;C<y.length;++C){const S=C*v;let b=w[S],E=0;for(let N=0;N<v;++N){const A=w[S+N];A<b&&(b=A,E=N)}y[C]=E}return u.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.makeTensorInfo(d,"int32",y)}const sne={kernelName:_f,backendName:"cpu",kernelFunc:nne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rne=Bt(Zu,n=>Math.asin(n)),one={kernelName:Zu,backendName:"cpu",kernelFunc:rne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ine=Bt(ju,n=>Math.asinh(n)),ane={kernelName:ju,backendName:"cpu",kernelFunc:ine};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lne=Bt(ec,n=>Math.atan(n)),une={kernelName:ec,backendName:"cpu",kernelFunc:lne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cne=$n((n,e)=>Math.atan2(n,e)),dne=qn(nc,cne),fne={kernelName:nc,backendName:"cpu",kernelFunc:dne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hne=Bt(tc,n=>Math.atanh(n)),pne={kernelName:tc,backendName:"cpu",kernelFunc:hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mT(n,e,t,s,r,o){const i=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=r.padInfo.top,y=r.padInfo.left,v=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,w=ht(r.outShape,t),C=w.values,S=r.outShape[1]*r.outShape[2]*r.outShape[3],b=r.outShape[2]*r.outShape[3],E=r.outShape[3];for(let N=0;N<r.batchSize;++N){const A=N*S,R=N*s[0];for(let L=0;L<r.inChannels;++L)for(let z=0;z<r.outHeight;++z){const M=z*i-p,P=Math.max(0,M),F=Math.min(r.inHeight,d+M),q=A+z*b;for(let ee=0;ee<r.outWidth;++ee){const ue=ee*a-y,ie=Math.max(0,ue),de=Math.min(r.inWidth,f+ue);let ae=v,J=0,te=0;for(let G=P;G<F;G+=l){const ne=R+G*s[1];for(let ye=ie;ye<de;ye+=u){const Te=ne+ye*s[2],Se=n[Te+L];o==="max"&&Se>ae?ae=Se:o==="avg"&&(J+=Se,te++)}if(isNaN(ae))break}const oe=q+ee*E+L;C[oe]=o==="avg"?J/te:ae}}}return w}function E4(n,e,t,s,r=!1,o=!1){const i=ht(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,u=s.dilationHeight,d=s.dilationWidth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,y=s.padInfo.top,v=s.padInfo.left,w=ht(e,t,n);for(let C=0;C<s.batchSize;++C)for(let S=0;S<s.inChannels;++S)for(let b=0;b<s.outHeight;++b){const E=b*a-y;let N=E;for(;N<0;)N+=u;const A=Math.min(s.inHeight,f+E);for(let R=0;R<s.outWidth;++R){const L=R*l-v;let z=L;for(;z<0;)z+=d;const M=Math.min(s.inWidth,p+L);let P=Number.NEGATIVE_INFINITY,F=-1;for(let q=N;q<A;q+=u){const ee=q-E;for(let ue=z;ue<M;ue+=d){const ie=ue-L,de=w.get(C,q,ue,S);de>P&&(P=de,r?F=o?((C*s.inHeight+q)*s.inWidth+ue)*s.inChannels+S:(q*s.inWidth+ue)*s.inChannels+S:F=ee*p+ie)}}i.set(F,C,b,R,S)}}return i}function $4(n,e,t,s,r,o){const i=r.strideDepth,a=r.strideHeight,l=r.strideWidth,u=r.dilationDepth,d=r.dilationHeight,f=r.dilationWidth,p=r.effectiveFilterDepth,y=r.effectiveFilterHeight,v=r.effectiveFilterWidth,w=r.padInfo.front,C=r.padInfo.top,S=r.padInfo.left,b=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,E=ht(r.outShape,t),N=E.values,A=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],R=r.outShape[2]*r.outShape[3]*r.outShape[4],L=r.outShape[3]*r.outShape[4],z=r.outShape[4];for(let M=0;M<r.batchSize;++M){const P=M*A,F=M*s[0];for(let q=0;q<r.inChannels;++q)for(let ee=0;ee<r.outDepth;++ee){const ue=ee*i-w;let ie=ue;for(;ie<0;)ie+=u;const de=Math.min(r.inDepth,p+ue),ae=P+ee*R;for(let J=0;J<r.outHeight;++J){const te=J*a-C;let oe=te;for(;oe<0;)oe+=d;const G=Math.min(r.inHeight,y+te),ne=ae+J*L;for(let ye=0;ye<r.outWidth;++ye){const Te=ye*l-S;let Se=Te;for(;Se<0;)Se+=f;const Ie=Math.min(r.inWidth,v+Te),Re=ne+ye*z;let Fe=b,Pe=0,Qe=0;for(let yt=ie;yt<de;yt+=u){const Nt=F+yt*s[1];for(let At=oe;At<G;At+=d){const It=Nt+At*s[2];for(let Et=Se;Et<Ie;Et+=f){const Lt=It+Et*s[3],Ot=n[Lt+q];if(o==="max"&&Ot>Fe?Fe=Ot:o==="avg"&&(Pe+=Ot,Qe++),isNaN(Fe))break}if(isNaN(Fe))break}if(isNaN(Fe))break}const je=Re+q;N[je]=o==="avg"?Pe/Qe:Fe}}}}return E}function mne(n,e){const t=ht(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,u=e.effectiveFilterDepth,d=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=e.padInfo.front,y=e.padInfo.top,v=e.padInfo.left;for(let w=0;w<e.batchSize;++w)for(let C=0;C<e.inChannels;++C)for(let S=0;S<e.outDepth;++S){const b=S*s-p;let E=b;for(;E<0;)E+=i;const N=Math.min(e.inDepth,u+b);for(let A=0;A<e.outHeight;++A){const R=A*r-y;let L=R;for(;L<0;)L+=a;const z=Math.min(e.inHeight,d+R);for(let M=0;M<e.outWidth;++M){const P=M*o-v;let F=P;for(;F<0;)F+=l;const q=Math.min(e.inWidth,f+P);let ee=Number.NEGATIVE_INFINITY,ue=-1;for(let ie=E;ie<N;ie+=i){const de=ie-b;for(let ae=L;ae<z;ae+=a){const J=ae-R;for(let te=F;te<q;te+=l){const oe=te-P,G=n.get(w,ie,ae,te,C);G>=ee&&(ee=G,ue=de*d*f+J*d+oe)}}}t.set(ue,w,S,A,M,C)}}}return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;He(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;B(ss(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=Ur(r.shape,o,i,u,a,l);let f;if(d.filterWidth===1&&d.filterHeight===1&&Ct(d.inShape,d.outShape))f=Lo({inputs:{x:r},backend:t});else{const p=t.data.get(r.dataId).values,y=et(r.shape),v=mT(p,r.shape,r.dtype,y,d,"avg");f=t.makeTensorInfo(d.outShape,r.dtype,v.values)}return f}const yne={kernelName:Rf,backendName:"cpu",kernelFunc:gne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s;He(r,"avgPool3d");const d=Ti(r.shape,o,i,1,a,l,u),f=t.data.get(r.dataId).values,p=$4(f,r.shape,r.dtype,et(r.shape),d,"avg");return t.makeTensorInfo(p.shape,"float32",p.values)}const vne={kernelName:Df,backendName:"cpu",kernelFunc:xne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wne(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=s;He([r,o],"avgPool3DGrad");const d=Ti(o.shape,i,a,1,l,u),f=d.strideDepth,p=d.strideHeight,y=d.strideWidth,v=d.filterDepth,w=d.filterHeight,C=d.filterWidth,S=d.dilationDepth,b=d.dilationHeight,E=d.dilationWidth,N=d.effectiveFilterDepth,A=d.effectiveFilterHeight,R=d.effectiveFilterWidth,L=N-1-d.padInfo.front,z=R-1-d.padInfo.left,M=A-1-d.padInfo.top,P=ht(o.shape,"float32"),F=1/(v*w*C),q=t.bufferSync(r);for(let ee=0;ee<d.batchSize;++ee)for(let ue=0;ue<d.inChannels;++ue)for(let ie=0;ie<d.inDepth;++ie)for(let de=0;de<d.inHeight;++de)for(let ae=0;ae<d.inWidth;++ae){const J=ie-L,te=de-M,oe=ae-z;let G=0;for(let ne=0;ne<N;ne+=S){const ye=(J+ne)/f;if(!(ye<0||ye>=d.outDepth||Math.floor(ye)!==ye))for(let Te=0;Te<A;Te+=b){const Se=(te+Te)/p;if(!(Se<0||Se>=d.outHeight||Math.floor(Se)!==Se))for(let Ie=0;Ie<R;Ie+=E){const Re=(oe+Ie)/y;if(Re<0||Re>=d.outWidth||Math.floor(Re)!==Re)continue;const Fe=q.get(ee,ye,Se,Re,ue);G+=Fe}}}P.set(G*F,ee,ie,de,ae,ue)}return t.makeTensorInfo(P.shape,P.dtype,P.values)}const Cne={kernelName:Qg,backendName:"cpu",kernelFunc:wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,i=o;He([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=s,d=Ur(i.shape,a,l,1,u),f=d.strideHeight,p=d.strideWidth,y=d.filterHeight,v=d.filterWidth,w=d.dilationHeight,C=d.dilationWidth,S=d.effectiveFilterHeight,b=d.effectiveFilterWidth,E=b-1-d.padInfo.left,N=S-1-d.padInfo.top,A=ht(i.shape,"float32"),R=1/(y*v),L=t.data.get(r.dataId).values,z=ht(r.shape,"float32",L);for(let M=0;M<d.batchSize;++M)for(let P=0;P<d.inChannels;++P)for(let F=0;F<d.inHeight;++F)for(let q=0;q<d.inWidth;++q){const ee=F-N,ue=q-E;let ie=0;for(let de=0;de<S;de+=w){const ae=(ee+de)/f;if(!(ae<0||ae>=d.outHeight||Math.floor(ae)!==ae))for(let J=0;J<b;J+=C){const te=(ue+J)/p;if(te<0||te>=d.outWidth||Math.floor(te)!==te)continue;const oe=z.get(M,ae,te,P);ie+=oe}}A.set(ie*R,M,F,q,P)}return t.makeTensorInfo(A.shape,A.dtype,A.values)}const Sne={kernelName:Yg,backendName:"cpu",kernelFunc:Tne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,scale:o,offset:i,mean:a,variance:l}=e;B(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),He([r,a,l,o,i],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const d=t.data.get(r.dataId).values,f=t.data.get(a.dataId).values,p=t.data.get(l.dataId).values,y=o?t.data.get(o.dataId).values:new Float32Array([1]),v=i?t.data.get(i.dataId).values:new Float32Array([0]),w=new Float32Array(d.length),C=v.length,S=y.length,b=p.length,E=f.length;let N=0,A=0,R=0,L=0;for(let z=0;z<d.length;++z)w[z]=v[N++]+(d[z]-f[A++])*y[R++]/Math.sqrt(p[L++]+u),N>=C&&(N=0),A>=E&&(A=0),R>=S&&(R=0),L>=b&&(L=0);return t.makeTensorInfo(r.shape,r.dtype,w)}const Ine={kernelName:qf,backendName:"cpu",kernelFunc:bne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:o,crops:i}=s;He([r],"batchToSpaceND");const a=o.reduce((S,b)=>S*b),l=Jh(r.shape,o,a),u=Yh(l.length,o.length),d=Qh(r.shape,o,a),f=wC(i,o.length),p=CC(d,i,o.length),y=qt({inputs:{x:r},backend:t,attrs:{shape:l}}),v=Vs({inputs:{x:y},backend:t,attrs:{perm:u}}),w=qt({inputs:{x:v},backend:t,attrs:{shape:d}}),C=Tl({inputs:{x:w},backend:t,attrs:{begin:f,size:p}});return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),C}const Nne={kernelName:Mf,backendName:"cpu",kernelFunc:kne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ene(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:o}=e,{size:i}=s,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,u=cT(a,l,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,u)}const $ne={kernelName:Zg,backendName:"cpu",kernelFunc:Ene};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ane(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,o=t.data.get(s.dataId).values,i=t.data.get(r.dataId).values,a=dt(Array.from(o),Array.from(i));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const _ne={kernelName:jg,backendName:"cpu",kernelFunc:Ane};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rne=Bt(oc,(n,e)=>{const t=e;return n>t.clipValueMax?t.clipValueMax:n<t.clipValueMin?t.clipValueMin:n}),Dne={kernelName:oc,backendName:"cpu",kernelFunc:Rne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fne=n=>{const{x:e}=n.inputs,t=n.backend,s=new Float32Array(we(e.shape)),r=t.data.get(e.dataId),o=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,a=t.data.get(o.dataId).values,l=t.data.get(i.dataId).values;for(let u=0;u<a.length;u++){const d=a[u],f=l[u];s[u]=Math.hypot(d,f)}return t.makeOutput(s,e.shape,"float32")},Mne={kernelName:Pf,backendName:"cpu",kernelFunc:Fne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bu(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.data.get(s.dataId).complexTensorInfos.imag,o=t.data.get(r.dataId).values;return t.makeTensorInfo(r.shape,r.dtype,o)}const Pne={kernelName:xy,backendName:"cpu",kernelFunc:Bu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zu(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,o=gt(r,e[0].shape)[0],i=e.map(w=>w.shape);yC(i,o);let a=Do(e.map(w=>w.shape),o);if(we(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(w=>we(w.shape)>0);if(l.length===1)return Lo({inputs:{x:l[0]},backend:t});if(l[0].dtype==="complex64"){const w=l.map(N=>Cl({inputs:{input:N},backend:t})),C=l.map(N=>Bu({inputs:{input:N},backend:t})),S=zu({inputs:w,backend:t,attrs:{axis:o}}),b=zu({inputs:C,backend:t,attrs:{axis:o}}),E=Ys({inputs:{real:S,imag:b},backend:t});return w.forEach(N=>t.disposeIntermediateTensorInfo(N)),C.forEach(N=>t.disposeIntermediateTensorInfo(N)),t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(b),E}const u=l.map(w=>{const S=[-1,we(w.shape.slice(o))];return qt({inputs:{x:w},backend:t,attrs:{shape:S}})}),d=u.map(w=>({vals:t.data.get(w.dataId).values,shape:w.shape}));a=Do(u.map(w=>w.shape),1);const f=u[0].shape[0]===1,p=LR(d,a,e[0].dtype,f),y=Do(l.map(w=>w.shape),o),v=t.makeTensorInfo(y,e[0].dtype,p);return u.forEach(w=>t.disposeIntermediateTensorInfo(w)),v}const Lne={kernelName:Lf,backendName:"cpu",kernelFunc:zu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:d}=s;He([r,o],"conv2d");const f=Si(l),p=Gn(r.shape,o.shape,i,u,a,d,!1,f),y=p.filterHeight,v=p.filterWidth,w=p.dilationHeight,C=p.dilationWidth,S=p.padInfo.left,b=p.padInfo.top,E=p.dataFormat==="channelsLast",N=new Mn(p.outShape,r.dtype),A=et(r.shape),R=et(o.shape),L=A[0],z=E?A[1]:A[2],M=E?A[2]:1,P=E?1:A[1],F=N.strides[0],q=E?N.strides[1]:N.strides[2],ee=E?N.strides[2]:1,ue=E?1:N.strides[1],ie=t.data.get(r.dataId).values,de=t.data.get(o.dataId).values,ae=N.values;for(let J=0;J<p.batchSize;++J){const te=J*L,oe=J*F;for(let G=0;G<p.outHeight;++G){const ne=oe+G*q,ye=G*p.strideHeight-b;for(let Te=0;Te<y;++Te){const Se=ye+Te*w;if(Se<0||Se>=p.inHeight)continue;const Ie=Te*R[0],Re=te+Se*z;for(let Fe=0;Fe<p.outWidth;++Fe){const Pe=ne+Fe*ee,Qe=Fe*p.strideWidth-S;for(let je=0;je<v;++je){const yt=Qe+je*C;if(yt<0||yt>=p.inWidth)continue;const Nt=Ie+je*R[1],At=Re+yt*M;let It=Nt;for(let Et=0;Et<p.inChannels;++Et){const Lt=ie[At+Et*P];for(let Ot=0;Ot<p.outChannels;++Ot)ae[Pe+Ot*ue]+=Lt*de[It+Ot];It+=p.outChannels}}}}}}return t.makeTensorInfo(N.shape,N.dtype,ae)}const One={kernelName:Of,backendName:"cpu",kernelFunc:A4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:d}=s;He([r,o],"conv2dBackpropFilter");const f=Si(l),p=Gn(r.shape,d,i,1,a,u,!1,f),{strideHeight:y,strideWidth:v,filterHeight:w,filterWidth:C}=p,S=p.dataFormat==="channelsLast",b=new Mn(p.filterShape,"float32"),E=p.padInfo.left,N=p.padInfo.top,A=t.data.get(r.dataId).values,R=t.data.get(o.dataId).values,L=new Mn(r.shape,r.dtype,A),z=new Mn(o.shape,o.dtype,R);for(let M=0;M<w;++M){const P=Math.max(0,Math.ceil((N-M)/y)),F=Math.min(p.outHeight,(p.inHeight+N-M)/y);for(let q=0;q<C;++q){const ee=Math.max(0,Math.ceil((E-q)/v)),ue=Math.min(p.outWidth,(p.inWidth+E-q)/v);for(let ie=0;ie<p.inChannels;++ie)for(let de=0;de<p.outChannels;++de){let ae=0;for(let J=0;J<p.batchSize;++J)for(let te=P;te<F;++te){const oe=M+te*y-N;for(let G=ee;G<ue;++G){const ne=q+G*v-E;S?ae+=L.get(J,oe,ne,ie)*z.get(J,te,G,de):ae+=L.get(J,ie,oe,ne)*z.get(J,de,te,G)}}b.set(ae,M,q,ie,de)}}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const Bne={kernelName:ty,backendName:"cpu",kernelFunc:Vne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zne(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:d}=s;He([r,o],"conv2dBackpropInput");const f=et(o.shape),p=et(r.shape);let y=Si(u);const v=Gn(i,o.shape,a,1,l,d,!1,y),w=new Mn(v.inShape,"float32"),C=w.values,S=t.data.get(r.dataId).values,b=t.data.get(o.dataId).values,[E,N,A]=f,{batchSize:R,filterHeight:L,filterWidth:z,inChannels:M,inHeight:P,inWidth:F,outChannels:q,outHeight:ee,outWidth:ue,strideHeight:ie,strideWidth:de}=v;y=v.dataFormat;const ae=L-1-v.padInfo.top,J=z-1-v.padInfo.left,te=y==="channelsLast",oe=w.strides[0],G=te?w.strides[1]:w.strides[2],ne=te?w.strides[2]:1,ye=te?1:w.strides[1],Te=p[0],Se=te?p[1]:p[2],Ie=te?p[2]:1,Re=te?1:p[1];for(let Fe=0;Fe<R;++Fe)for(let Pe=0;Pe<M;++Pe)for(let Qe=0;Qe<P;++Qe){const je=Qe-ae,yt=Math.max(0,Math.ceil(je/ie)),Nt=Math.min(ee,(L+je)/ie);for(let At=0;At<F;++At){const It=At-J,Et=Math.max(0,Math.ceil(It/de)),Lt=Math.min(ue,(z+It)/de);let Ot=0;for(let Xt=yt;Xt<Nt;++Xt){const yn=Xt*ie-je;for(let xn=Et;xn<Lt;++xn){const rr=xn*de-It,is=Te*Fe+Se*Xt+Ie*xn,Xn=E*(L-1-yn)+N*(z-1-rr)+A*Pe;for(let as=0;as<q;++as){const fs=S[is+Re*as],hs=b[Xn+as];Ot+=fs*hs}}}const Kn=oe*Fe+G*Qe+ne*At+ye*Pe;C[Kn]=Ot}}return t.makeTensorInfo(w.shape,w.dtype,w.values)}const Une={kernelName:Vf,backendName:"cpu",kernelFunc:zne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s;He([r,o],"conv3d");const u=ya(r.shape,o.shape,i,l,a),{filterDepth:d,filterHeight:f,filterWidth:p,dilationDepth:y,dilationHeight:v,dilationWidth:w,padInfo:C}=u,S=C.front,b=C.left,E=C.top,N=new Mn(u.outShape,r.dtype),A=t.data.get(r.dataId).values,R=t.data.get(o.dataId).values,L=N.values,z=et(r.shape),M=et(o.shape);for(let P=0;P<u.batchSize;++P){const F=P*z[0],q=P*N.strides[0];for(let ee=0;ee<u.outDepth;++ee){const ue=q+ee*N.strides[1],ie=ee*u.strideDepth-S;for(let de=0;de<d;++de){const ae=ie+de*y;if(ae<0||ae>=u.inDepth)continue;const J=de*M[0],te=F+ae*z[1];for(let oe=0;oe<u.outHeight;++oe){const G=ue+oe*N.strides[2],ne=oe*u.strideHeight-E;for(let ye=0;ye<f;++ye){const Te=ne+ye*v;if(Te<0||Te>=u.inHeight)continue;const Se=J+ye*M[1],Ie=te+Te*z[2];for(let Re=0;Re<u.outWidth;++Re){const Fe=G+Re*u.outChannels,Pe=Re*u.strideWidth-b;for(let Qe=0;Qe<p;++Qe){const je=Pe+Qe*w;if(je<0||je>=u.inWidth)continue;const yt=Se+Qe*M[2],Nt=Ie+je*u.inChannels;let At=yt;for(let It=0;It<u.inChannels;++It){const Et=A[Nt+It];for(let Lt=0;Lt<u.outChannels;++Lt)L[Fe+Lt]+=Et*R[At+Lt];At+=u.outChannels}}}}}}}}return t.makeTensorInfo(N.shape,N.dtype,N.values)}const Gne={kernelName:Bf,backendName:"cpu",kernelFunc:Wne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hne(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s;He([r,o],"conv3dBackpropFilterV2");const u=et(r.shape),d=et(o.shape),f=ya(r.shape,l,i,1,a),p=f.strideDepth,y=f.strideHeight,v=f.strideWidth,w=f.filterDepth,C=f.filterHeight,S=f.filterWidth,b=new Mn(f.filterShape,"float32"),E=b.values,[N,A,R,L]=b.strides,z=t.data.get(o.dataId).values,[M,P,F,q]=d,ee=t.data.get(r.dataId).values,[ue,ie,de,ae]=u,J=f.padInfo.front,te=f.padInfo.left,oe=f.padInfo.top;for(let G=0;G<w;++G){const ne=Math.max(0,Math.ceil((J-G)/p)),ye=Math.min(f.outDepth,(f.inDepth+J-G)/p),Te=G*N;for(let Se=0;Se<C;++Se){const Ie=Math.max(0,Math.ceil((oe-Se)/y)),Re=Math.min(f.outHeight,(f.inHeight+oe-Se)/y),Fe=Se*A+Te;for(let Pe=0;Pe<S;++Pe){const Qe=Math.max(0,Math.ceil((te-Pe)/v)),je=Math.min(f.outWidth,(f.inWidth+te-Pe)/v),yt=Pe*R+Fe;for(let Nt=0;Nt<f.inChannels;++Nt){const At=Nt*L+yt;for(let It=0;It<f.outChannels;++It){let Et=0;for(let Lt=0;Lt<f.batchSize;++Lt){const Ot=Lt*ue,Kn=Lt*M;for(let Xt=ne;Xt<ye;++Xt){const xn=(G+Xt*p-J)*ie+Ot,rr=Xt*P+Kn;for(let is=Ie;is<Re;++is){const as=(Se+is*y-oe)*de+xn,fs=is*F+rr;for(let hs=Qe;hs<je;++hs){const wr=(Pe+hs*v-te)*ae+as,Cr=hs*q+fs;Et+=ee[wr+Nt]*z[Cr+It]}}}}E[At+It]=Et}}}}}return t.makeTensorInfo(b.shape,b.dtype,b.values)}const qne={kernelName:ny,backendName:"cpu",kernelFunc:Hne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kne(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s;He([r],"conv3dBackpropInputV2");const u=et(r.shape),d=et(o.shape),f=ya(l,o.shape,a,1,i),p=new Mn(f.inShape,"float32"),y=p.values,[v,w,C,S]=p.strides,b=t.data.get(r.dataId).values,[E,N,A,R]=u,L=t.data.get(o.dataId).values,[z,M,P,F]=d,{batchSize:q,filterDepth:ee,filterHeight:ue,filterWidth:ie,inChannels:de,inDepth:ae,inHeight:J,inWidth:te,outChannels:oe,outDepth:G,outHeight:ne,outWidth:ye,strideDepth:Te,strideHeight:Se,strideWidth:Ie}=f,Re=ee-1-f.padInfo.front,Fe=ue-1-f.padInfo.top,Pe=ie-1-f.padInfo.left;for(let Qe=0;Qe<q;++Qe)for(let je=0;je<de;++je)for(let yt=0;yt<ae;++yt){const Nt=yt-Re,At=Math.max(0,Math.ceil(Nt/Te)),It=Math.min(G,(ee+Nt)/Te);for(let Et=0;Et<J;++Et){const Lt=Et-Fe,Ot=Math.max(0,Math.ceil(Lt/Se)),Kn=Math.min(ne,(ue+Lt)/Se);for(let Xt=0;Xt<te;++Xt){const yn=Xt-Pe,xn=Math.max(0,Math.ceil(yn/Ie)),rr=Math.min(ye,(ie+yn)/Ie);let is=0;for(let Xn=At;Xn<It;++Xn){const as=Xn*Te-Nt;for(let fs=Ot;fs<Kn;++fs){const hs=fs*Se-Lt;for(let or=xn;or<rr;++or){const wr=or*Ie-yn,Cr=E*Qe+N*Xn+A*fs+R*or,Ll=z*(ee-1-as)+M*(ue-1-hs)+P*(ie-1-wr)+F*je;for(let po=0;po<oe;++po){const ps=b[Cr+po],pn=L[Ll+po];is+=ps*pn}}}}y[v*Qe+w*yt+C*Et+S*Xt+je]=is}}}return t.makeTensorInfo(p.shape,p.dtype,p.values)}const Xne={kernelName:sy,backendName:"cpu",kernelFunc:Kne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jne=Bt(ic,n=>Math.cos(n)),Yne={kernelName:ic,backendName:"cpu",kernelFunc:Jne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qne=Bt(ac,n=>Math.cosh(n)),Zne={kernelName:ac,backendName:"cpu",kernelFunc:Qne};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jne(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=s,[d,f,p,y]=r.shape,v=o.shape[0],[w,C]=a,S=ht([v,w,C,y],"float32"),b=t.data.get(o.dataId).values,E=t.data.get(i.dataId).values,N=t.data.get(r.dataId).values,A=et(r.shape),R=et(S.shape);for(let L=0;L<v;L++){const z=L*4,M=b[z],P=b[z+1],F=b[z+2],q=b[z+3],ee=E[L];if(ee>=d)continue;const ue=w>1?(F-M)*(f-1)/(w-1):0,ie=C>1?(q-P)*(p-1)/(C-1):0;for(let de=0;de<w;de++){const ae=w>1?M*(f-1)+de*ue:.5*(M+F)*(f-1);if(ae<0||ae>f-1){for(let J=0;J<C;J++)for(let te=0;te<y;te++){const oe=te+J*R[2]+de*R[1]+L*R[0];S.values[oe]=u}continue}if(l==="bilinear"){const J=Math.floor(ae),te=Math.ceil(ae),oe=ae-J;for(let G=0;G<C;G++){const ne=C>1?P*(p-1)+G*ie:.5*(P+q)*(p-1);if(ne<0||ne>p-1){for(let Ie=0;Ie<y;Ie++){const Re=Ie+G*R[2]+de*R[1]+L*R[0];S.values[Re]=u}continue}const ye=Math.floor(ne),Te=Math.ceil(ne),Se=ne-ye;for(let Ie=0;Ie<y;Ie++){let Re=Ie+ye*A[2]+J*A[1]+ee*A[0];const Fe=N[Re];Re=Ie+Te*A[2]+J*A[1]+ee*A[0];const Pe=N[Re];Re=Ie+ye*A[2]+te*A[1]+ee*A[0];const Qe=N[Re];Re=Ie+Te*A[2]+te*A[1]+ee*A[0];const je=N[Re],yt=Fe+(Pe-Fe)*Se,Nt=Qe+(je-Qe)*Se;Re=Ie+G*R[2]+de*R[1]+L*R[0],S.values[Re]=yt+(Nt-yt)*oe}}}else for(let J=0;J<C;++J){const te=C>1?P*(p-1)+J*ie:.5*(P+q)*(p-1);if(te<0||te>p-1){for(let ne=0;ne<y;ne++){const ye=ne+J*R[2]+de*R[1]+L*R[0];S.values[ye]=u}continue}const oe=Math.round(te),G=Math.round(ae);for(let ne=0;ne<y;ne++){const ye=ne+oe*A[2]+G*A[1]+ee*A[0],Te=ne+J*R[2]+de*R[1]+L*R[0];S.values[Te]=N[ye]}}}}return t.makeTensorInfo(S.shape,S.dtype,S.values)}const ese={kernelName:oy,backendName:"cpu",kernelFunc:jne};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;He(r,"cumprod");const l=hn([o],r.shape.length);let u=r;l!=null&&(u=Vs({inputs:{x:r},backend:t,attrs:{perm:l}}));const d=Cn(1,r.shape.length)[0];if(d!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${d}`);const f=Os(u.dtype,"int32"),p=Kg(we(u.shape),f),y=t.data.get(u.dataId).values,v=u.shape[u.shape.length-1],w=a?(S,b)=>S+v-b-1:(S,b)=>S+b;for(let S=0;S<y.length;S+=v)for(let b=0;b<v;b++){const E=w(S,b);if(b===0)p[E]=i?1:y[E];else{const N=w(S,b-1);p[E]=i?y[N]*p[N]:y[E]*p[N]}}const C=t.makeTensorInfo(u.shape,f,p);if(l!=null){const S=xa(l),b=Vs({inputs:{x:C},backend:t,attrs:{perm:S}});return t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo(u),b}return C}const nse={kernelName:ry,backendName:"cpu",kernelFunc:tse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;He(r,"cumsum");const l=hn([o],r.shape.length);let u=r;l!=null&&(u=Vs({inputs:{x:r},backend:t,attrs:{perm:l}}));const d=Cn(1,r.shape.length)[0];if(d!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${d}`);const f=Os(u.dtype,"int32"),p=es(we(u.shape),f),y=t.data.get(u.dataId).values,v=u.shape[u.shape.length-1],w=a?(S,b)=>S+v-b-1:(S,b)=>S+b;for(let S=0;S<y.length;S+=v)for(let b=0;b<v;b++){const E=w(S,b);if(b===0)p[E]=i?0:y[E];else{const N=w(S,b-1);p[E]=i?y[N]+p[N]:y[E]+p[N]}}const C=t.makeTensorInfo(u.shape,f,p);if(l!=null){const S=xa(l),b=Vs({inputs:{x:C},backend:t,attrs:{perm:S}});return t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo(u),b}return C}const rse={kernelName:zf,backendName:"cpu",kernelFunc:sse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ose(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=t.data.get(r.dataId).values,u=t.data.get(o.dataId).values,d=cT(l,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,d)}else if(r.shape.length===2){const l=t.bufferSync(r),u=t.bufferSync(o),d=MR(l,u,i,a);return t.makeTensorInfo(d.shape,o.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const ise={kernelName:iy,backendName:"cpu",kernelFunc:ose};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ase(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:o,dataFormat:i}=s;B(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=r.shape[0],l=r.shape[1],u=r.shape[2],d=r.shape[3],f=l*o,p=u*o,y=d/(o*o),v=t.data.get(r.dataId).values,w=new Float32Array(a*f*p*y);let C=0;for(let S=0;S<a;++S)for(let b=0;b<f;++b){const E=Math.floor(b/o),N=b%o;for(let A=0;A<p;++A){const R=Math.floor(A/o),L=A%o,z=(N*o+L)*y;for(let M=0;M<y;++M){const F=M+z+d*(R+u*(E+l*S));w[C++]=v[F]}}}return t.makeTensorInfo([a,f,p,y],r.dtype,w)}const lse={kernelName:ay,backendName:"cpu",kernelFunc:ase};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=s;He([r,o],"depthwiseConv2DNative");const d=et(r.shape),f=et(o.shape);let p=l;p==null&&(p=[1,1]),B(ss(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);const y=Gn(r.shape,o.shape,i,p,a,u,!0),{filterHeight:v,filterWidth:w,dilationHeight:C,dilationWidth:S,padInfo:b}=y,E=b.left,N=b.top,A=y.outChannels/y.inChannels,R=new Mn(y.outShape,r.dtype),L=t.data.get(r.dataId).values,z=t.data.get(o.dataId).values,M=R.values;for(let P=0;P<y.batchSize;++P){const F=P*d[0],q=P*R.strides[0];for(let ee=0;ee<y.outHeight;++ee){const ue=q+ee*R.strides[1],ie=ee*y.strideHeight-N;for(let de=0;de<v;++de){const ae=ie+de*C;if(ae<0||ae>=y.inHeight)continue;const J=de*f[0],te=F+ae*d[1];for(let oe=0;oe<y.outWidth;++oe){const G=ue+oe*R.strides[2],ne=oe*y.strideWidth-E;for(let ye=0;ye<w;++ye){const Te=ne+ye*S;if(Te<0||Te>=y.inWidth)continue;const Se=J+ye*f[1],Ie=te+Te*y.inChannels;let Re=G,Fe=Se;for(let Pe=0;Pe<y.inChannels;++Pe){const Qe=L[Ie+Pe];for(let je=0;je<A;++je)M[Re+je]+=Qe*z[Fe+je];Re+=A,Fe+=A}}}}}}return t.makeTensorInfo(R.shape,R.dtype,R.values)}const use={kernelName:Uf,backendName:"cpu",kernelFunc:_4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:d}=s;He([r,o],"depthwiseConv2dNativeBackpropFilter");const f=Gn(r.shape,d,i,a,l,u,!0),{strideHeight:p,strideWidth:y,filterHeight:v,filterWidth:w}=f,C=new Mn(f.filterShape,"float32"),S=f.padInfo.left,b=f.padInfo.top,E=f.outChannels/f.inChannels,N=t.data.get(r.dataId).values,A=new Mn(r.shape,r.dtype,N),R=t.data.get(o.dataId).values,L=new Mn(o.shape,o.dtype,R);for(let z=0;z<v;++z){const M=Math.max(0,Math.ceil((b-z)/p)),P=Math.min(f.outHeight,(f.inHeight+b-z)/p);for(let F=0;F<w;++F){const q=Math.max(0,Math.ceil((S-F)/y)),ee=Math.min(f.outWidth,(f.inWidth+S-F)/y);for(let ue=0;ue<f.outChannels;++ue){const ie=Math.trunc(ue/E),de=ue%E;let ae=0;for(let J=0;J<f.batchSize;++J)for(let te=M;te<P;++te){const oe=z+te*p-b;for(let G=q;G<ee;++G){const ne=F+G*y-S;ae+=A.get(J,oe,ne,ie)*L.get(J,te,G,ue)}}C.set(ae,z,F,ie,de)}}}return t.makeTensorInfo(C.shape,C.dtype,C.values)}const dse={kernelName:ly,backendName:"cpu",kernelFunc:cse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fse(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:d}=s;He([r,o],"depthwiseConv2DNativeBackpropInput");const f=et(r.shape),p=et(o.shape),y=Gn(d,o.shape,i,a,l,u,!0),v=new Mn(y.inShape,"float32"),w=v.values,[C,S,b]=v.strides,E=t.data.get(r.dataId).values,[N,A,R]=f,L=t.data.get(o.dataId).values,[z,M,P]=p,{batchSize:F,filterHeight:q,filterWidth:ee,inChannels:ue,inHeight:ie,inWidth:de,outChannels:ae,outHeight:J,outWidth:te,strideHeight:oe,strideWidth:G}=y,ne=q-1-y.padInfo.top,ye=ee-1-y.padInfo.left,Te=ae/ue;for(let Se=0;Se<F;++Se)for(let Ie=0;Ie<ue;++Ie)for(let Re=0;Re<ie;++Re){const Fe=Re-ne,Pe=Math.max(0,Math.ceil(Fe/oe)),Qe=Math.min(J,(q+Fe)/oe);for(let je=0;je<de;++je){const yt=je-ye,Nt=Math.max(0,Math.ceil(yt/G)),At=Math.min(te,(ee+yt)/G);let It=0;for(let Et=Pe;Et<Qe;++Et){const Lt=Et*oe-Fe;for(let Ot=Nt;Ot<At;++Ot){const Kn=Ot*G-yt,Xt=N*Se+A*Et+R*Ot,yn=z*(q-1-Lt)+M*(ee-1-Kn)+P*Ie;for(let xn=0;xn<Te;++xn){const rr=Ie*Te+xn,is=E[Xt+rr],Xn=L[yn+xn];It+=is*Xn}}}w[C*Se+S*Re+b*je+Ie]=It}}return t.makeTensorInfo(v.shape,v.dtype,v.values)}const hse={kernelName:uy,backendName:"cpu",kernelFunc:fse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pse(n){const{inputs:e,backend:t}=n,{x:s}=e,r=we(s.shape),o=t.data.get(s.dataId).values,i=ht([r,r],s.dtype),a=i.values;for(let u=0;u<o.length;u++)a[u*r+u]=o[u];const l=[...s.shape,...s.shape];return t.makeTensorInfo(l,i.dtype,i.values)}const mse={kernelName:cy,backendName:"cpu",kernelFunc:pse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gse={kernelName:Wf,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r}=n,{strides:o,pad:i,dilations:a}=t,l=e,u=l.data.get(s.dataId).values,d=s.shape.length,f=l.data.get(r.dataId).values,p=r.shape.length,{batchSize:y,inHeight:v,inWidth:w,inChannels:C,outHeight:S,outWidth:b,padInfo:E,strideHeight:N,strideWidth:A,filterHeight:R,filterWidth:L,dilationHeight:z,dilationWidth:M,outShape:P}=Rh(s.shape,r.shape,o,i,"NHWC",a),F=we(P),q=P.length,ee=Rn(s.dtype,F);for(let ie=0;ie<y;++ie)for(let de=0;de<S;++de){const ae=de*N-E.top;for(let J=0;J<b;++J){const te=J*A-E.left;for(let oe=0;oe<C;++oe){let G=Number.MIN_SAFE_INTEGER;for(let ye=0;ye<R;++ye){const Te=ae+ye*z;if(Te>=0&&Te<v)for(let Se=0;Se<L;++Se){const Ie=te+Se*M;if(Ie>=0&&Ie<w){const Re=so([ie,Te,Ie,oe],d,et(s.shape)),Fe=so([ye,Se,oe],p,et(r.shape)),Pe=u[Re]+f[Fe];Pe>G&&(G=Pe)}}}const ne=so([ie,de,J,oe],q,et(P));ee[ne]=G}}}return{dataId:l.write(ma(ee,s.dtype),P,s.dtype),shape:P,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yse={kernelName:hg,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:o}=n,{strides:i,pad:a,dilations:l}=t,u=e,d=gr(s.shape,u.data.get(s.dataId).values),f=gr(r.shape,u.data.get(r.dataId).values),{batchSize:p,inHeight:y,inWidth:v,inChannels:w,outHeight:C,outWidth:S,padInfo:b,strideHeight:E,strideWidth:N,filterHeight:A,filterWidth:R,dilationHeight:L,dilationWidth:z,outShape:M}=Rh(s.shape,r.shape,i,a,"NHWC",l);B(o.rank===M.length,()=>`Error in ${hg}, dy must have the same rank as output ${M.length}, but got ${o.rank}`);const P=gr(M,u.data.get(o.dataId).values),F=V2(r.shape,r.dtype);for(let ee=0;ee<p;++ee)for(let ue=0;ue<C;++ue){const ie=ue*E-b.top;for(let de=0;de<S;++de){const ae=de*N-b.left;for(let J=0;J<w;++J){let te=Number.MIN_SAFE_INTEGER,oe=0,G=0;for(let ne=0;ne<A;++ne){const ye=ie+ne*L;if(ye>=0&&ye<y)for(let Te=0;Te<R;++Te){const Se=ae+Te*z;if(Se>=0&&Se<v){const Ie=d[ee][ye][Se][J]+f[ne][Te][J];Ie>te&&(te=Ie,oe=ne,G=Te)}}}F[oe][G][J]+=P[ee][ue][de][J]}}}return{dataId:u.write(ma(F,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xse={kernelName:fg,backendName:"cpu",kernelFunc:({inputs:n,backend:e,attrs:t})=>{const{x:s,filter:r,dy:o}=n,{strides:i,pad:a,dilations:l}=t,u=e,d=gr(s.shape,u.data.get(s.dataId).values),f=gr(r.shape,u.data.get(r.dataId).values),{batchSize:p,inHeight:y,inWidth:v,inChannels:w,outHeight:C,outWidth:S,padInfo:b,strideHeight:E,strideWidth:N,filterHeight:A,filterWidth:R,dilationHeight:L,dilationWidth:z,outShape:M}=Rh(s.shape,r.shape,i,a,"NHWC",l);B(o.rank===M.length,()=>`Error in ${fg}, dy must have the same rank as output ${M.length}, but got ${o.rank}`);const P=gr(M,u.data.get(o.dataId).values),F=V2(s.shape,s.dtype);for(let ee=0;ee<p;++ee)for(let ue=0;ue<C;++ue){const ie=ue*E-b.top;for(let de=0;de<S;++de){const ae=de*N-b.left;for(let J=0;J<w;++J){let te=Number.MIN_SAFE_INTEGER,oe=ie<0?0:ie,G=ae<0?0:ae;for(let ne=0;ne<A;++ne){const ye=ie+ne*L;if(ye>=0&&ye<y)for(let Te=0;Te<R;++Te){const Se=ae+Te*z;if(Se>=0&&Se<v){const Ie=d[ee][ye][Se][J]+f[ne][Te][J];Ie>te&&(te=Ie,oe=ye,G=Se)}}}F[ee][oe][G][J]+=P[ee][ue][de][J]}}}return{dataId:u.write(ma(F,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ap(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;He(r,"sum");let a;r.dtype==="bool"?a=pa({inputs:{x:r},backend:t,attrs:{dtype:"int32"}}):a=Lo({inputs:{x:r},backend:t});const l=a.shape.length,u=gt(o,a.shape),d=hn(u,l);let f=u,p=a;d!=null&&(p=Vs({inputs:{x:a},backend:t,attrs:{perm:d}}),f=Cn(f.length,l)),rs("sum",f,p.shape.length);const[y,v]=Hn(p.shape,f),w=Os(p.dtype,"int32");let C=Dg(t,y,w);const S=we(v),b=t.data.get(C.dataId).values,E=t.data.get(p.dataId).values;for(let N=0;N<b.length;++N){const A=N*S;let R=0;for(let L=0;L<S;++L)R+=E[A+L];b[N]=R}if(i){const N=wn(C.shape,u),A=C;C=qt({inputs:{x:C},backend:t,attrs:{shape:N}}),t.disposeIntermediateTensorInfo(A)}return t.disposeIntermediateTensorInfo(a),d!=null&&t.disposeIntermediateTensorInfo(p),C}const vse={kernelName:Th,backendName:"cpu",kernelFunc:ap};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wse(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=$C(r,o.length);_C(i.length,l,o);const{path:u,steps:d}=RC(a,l),f=d.length;let p=null,y=i.length;const v=[];for(let w=0;w<f;++w){for(const C of d[w]){const{permutationIndices:S,expandDims:b}=AC(y,l[C]);let E;DC(S)?E=o[C]:(E=Vs({inputs:{x:o[C]},backend:t,attrs:{perm:S}}),v.push(E));const N=E.shape.slice();for(let A=0;A<b.length;++A)N.splice(b[A],0,1);Ct(E.shape,N)||(E=qt({inputs:{x:E},backend:t,attrs:{shape:N}}),v.push(E)),p===null?p=E:(p=s0({inputs:{a:E,b:p},backend:t}),v.push(p))}w<f-1&&(u[w]>=0&&(p=ap({inputs:{x:p},backend:t,attrs:{axis:u[w]-(i.length-y),keepDims:!1}}),v.push(p)),y--)}for(const w of v)w!==p&&t.disposeIntermediateTensorInfo(w);return p}const Cse={kernelName:dy,backendName:"cpu",kernelFunc:wse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tse(n){const{inputs:e,backend:t}=n,{dy:s,y:r}=e;He([s,r],"eluGrad");const o=new Float32Array(we(r.shape)),i=t.data.get(r.dataId).values,a=t.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const u=i[l];u>=1?o[l]=a[l]:o[l]=a[l]*(u+1)}return t.makeTensorInfo(r.shape,"float32",o)}const Sse={kernelName:fy,backendName:"cpu",kernelFunc:Tse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bse=TC,Ise=SC,kse=bC,Nse=IC,Ese=kC,$se=NC,Ase=Bt(cc,n=>{const e=Math.sign(n),t=Math.abs(n),s=1/(1+bse*t);return e*(1-(((($se*s+Ese)*s+Nse)*s+kse)*s+Ise)*s*Math.exp(-t*t))}),_se={kernelName:cc,backendName:"cpu",kernelFunc:Ase};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pg(n){const{inputs:e,backend:t,attrs:s}=n,{input:r}=e,{dim:o}=s,i=r.shape.length,a=r.shape.slice();let l=o;return o<0&&(B(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),qt({inputs:{x:r},backend:t,attrs:{shape:a}})}const Rse={kernelName:Hf,backendName:"cpu",kernelFunc:Pg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dse=$n((n,e)=>n/e),gT=qn(lc,Dse),C2={kernelName:lc,backendName:"cpu",kernelFunc:gT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R4(n,e,t){const s=n.shape,r=s[0],o=s[1],i=t.data.get(n.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,u=[r,o],d=we(u),f=On("float32",d),p=On("float32",d);for(let C=0;C<r;C++){const S=Tl({inputs:{x:a},backend:t,attrs:{begin:[C,0],size:[1,o]}}),b=Tl({inputs:{x:l},backend:t,attrs:{begin:[C,0],size:[1,o]}}),E=Ys({inputs:{real:S,imag:b},backend:t}),{real:N,imag:A}=Fse(E,e,t),R=gi(N,A);for(let L=0;L<o;L++){const z=EC(R,L);f[C*o+L]=z.real,p[C*o+L]=z.imag}t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(b),t.disposeIntermediateTensorInfo(E)}const y=t.makeTensorInfo(u,"float32",f),v=t.makeTensorInfo(u,"float32",p),w=Ys({inputs:{real:y,imag:v},backend:t});return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),w}function Fse(n,e,t){const s=we(n.shape),r=t.data.get(n.dataId),o=t.data.get(r.complexTensorInfos.real.dataId).values,i=t.data.get(r.complexTensorInfos.imag.dataId).values;if(Mse(s)){const a=T2(o,i,s,e,t),l=[n.shape[0],n.shape[1]];if(e){const u=t.makeTensorInfo(l,"float32",a.real),d=t.makeTensorInfo(l,"float32",a.imag),f=t.makeTensorInfo([],"float32",Ci(s,"float32")),p=Lo({inputs:{x:f},backend:t}),y=C2.kernelFunc({inputs:{a:u,b:f},backend:t}),v=C2.kernelFunc({inputs:{a:d,b:p},backend:t}),w=t.data.get(y.dataId).values,C=t.data.get(v.dataId).values;return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),{real:w,imag:C}}return a}else{const a=gi(o,i),l=Pse(a,s,e);return H$(l)}}function Mse(n){return(n&n-1)===0}function T2(n,e,t,s,r){if(t===1)return{real:n,imag:e};const o=gi(n,e),i=t/2,a=q$(o),l=a.real,u=a.imag,d=[l.length],f=r.makeTensorInfo(d,"float32",l),p=r.makeTensorInfo(d,"float32",u),y=Ys({inputs:{real:f,imag:p},backend:r}),v=K$(o),w=v.real,C=v.imag,S=[w.length],b=r.makeTensorInfo(S,"float32",w),E=r.makeTensorInfo(S,"float32",C),N=Ys({inputs:{real:b,imag:E},backend:r}),A=T2(l,u,i,s,r),R=A.real,L=A.imag,z=[R.length],M=r.makeTensorInfo(z,"float32",R),P=r.makeTensorInfo(z,"float32",L),F=Ys({inputs:{real:M,imag:P},backend:r}),q=T2(w,C,i,s,r),ee=q.real,ue=q.imag,ie=[ee.length],de=r.makeTensorInfo(ie,"float32",ee),ae=r.makeTensorInfo(ie,"float32",ue),J=Ys({inputs:{real:de,imag:ae},backend:r}),te=J$(t,s),oe=[te.real.length],G=r.makeTensorInfo(oe,"float32",te.real),ne=r.makeTensorInfo(oe,"float32",te.imag),ye=Ys({inputs:{real:G,imag:ne},backend:r}),Te=s0({inputs:{a:ye,b:J},backend:r}),Se=Vu({inputs:{a:F,b:Te},backend:r}),Ie=pT({inputs:{a:F,b:Te},backend:r}),Re=Cl({inputs:{input:Se},backend:r}),Fe=Cl({inputs:{input:Ie},backend:r}),Pe=Bu({inputs:{input:Se},backend:r}),Qe=Bu({inputs:{input:Ie},backend:r}),je=zu({inputs:[Re,Fe],backend:r,attrs:{axis:0}}),yt=zu({inputs:[Pe,Qe],backend:r,attrs:{axis:0}}),Nt=r.data.get(je.dataId).values,At=r.data.get(yt.dataId).values;return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(F),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(ae),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(G),r.disposeIntermediateTensorInfo(ne),r.disposeIntermediateTensorInfo(ye),r.disposeIntermediateTensorInfo(Te),r.disposeIntermediateTensorInfo(Se),r.disposeIntermediateTensorInfo(Ie),r.disposeIntermediateTensorInfo(Re),r.disposeIntermediateTensorInfo(Pe),r.disposeIntermediateTensorInfo(Fe),r.disposeIntermediateTensorInfo(Qe),r.disposeIntermediateTensorInfo(je),r.disposeIntermediateTensorInfo(yt),{real:Nt,imag:At}}function Pse(n,e,t){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let o=0,i=0;for(let a=0;a<e;a++){const l=Y$(r*a,e,t),u=EC(n,a);o+=u.real*l.real-u.imag*l.imag,i+=u.real*l.imag+u.imag*l.real}t&&(o/=e,i/=e),X$(s,o,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lse(n){const{inputs:e,backend:t}=n,{input:s}=e,r=we(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=qt({inputs:{x:s},backend:t,attrs:{shape:[i,o]}}),l=R4(a,!1,t),u=qt({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const Ose={kernelName:hy,backendName:"cpu",kernelFunc:Lse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yT(n){const{backend:e,attrs:t}=n,{shape:s,value:r,dtype:o}=t,i=o||Ju(r),a=Rn(i,we(s));return Bse(a,r,i),e.makeTensorInfo(s,i,a)}const Vse={kernelName:py,backendName:"cpu",kernelFunc:yT};function Bse(n,e,t){n.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zse={kernelName:my,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,r=t,o=On(s.dtype,we(s.shape)),[i,a,l,u]=s.shape,d=r.data.get(s.dataId).values;for(let p=0;p<i;p++){const y=p*l*a*u;for(let v=0;v<a;v++){const w=v*(l*u);for(let C=0;C<l;C++){const S=C*u;for(let b=0;b<u;b++){const E=Math.round(l-C-1),N=y+w+S+b;let A=d[N];if(E>=0&&E<l){const R=E*u,L=y+w+R+b;A=d[L]}o[N]=A}}}}return{dataId:r.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Use=$n((n,e)=>Math.floor(n/e)),Wse=qn(pc,Use,null,"int32"),Gse={kernelName:pc,backendName:"cpu",kernelFunc:Wse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:p,activation:y,leakyreluAlpha:v}=s;let w=A4({inputs:{x:r,filter:o},backend:t,attrs:{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:p}});if(i){const C=w;if(d==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const S=qt({inputs:{x:i},backend:t,attrs:{shape:[i.shape[0],1,1]}});w=Vu({inputs:{a:w,b:S},backend:t}),t.disposeIntermediateTensorInfo(S)}else w=Vu({inputs:{a:w,b:i},backend:t});t.disposeIntermediateTensorInfo(C)}if(y){const C=w;if(d==="NCHW"&&y==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const S=qt({inputs:{x:a},backend:t,attrs:{shape:[a.shape[0],1,1]}});w=Mg(t,w,y,S,v),t.disposeIntermediateTensorInfo(S)}else w=Mg(t,w,y,a,v);t.disposeIntermediateTensorInfo(C)}return w}const qse={kernelName:uf,backendName:"cpu",kernelFunc:Hse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:p,activation:y,leakyreluAlpha:v}=s;let w=_4({inputs:{x:r,filter:o},backend:t,attrs:{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:p}});if(i){const C=w;w=Vu({inputs:{a:w,b:i},backend:t}),t.disposeIntermediateTensorInfo(C)}if(y){const C=w;w=Mg(t,w,y,a,v),t.disposeIntermediateTensorInfo(C)}return w}const Xse={kernelName:cf,backendName:"cpu",kernelFunc:Kse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jse(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,o=we(s.shape),i=r.shape,a=i[i.length-1],[l,u,d,f]=jy(s,r);if(u===0)return t.makeTensorInfo(l,s.dtype,[]);const p=t.data.get(r.dataId).values,y=t.bufferSync(s),v=GR(p,y,s.dtype,u,a,d,f,s.shape,o);return t.makeTensorInfo(l,s.dtype,v.values)}const Yse={kernelName:gy,backendName:"cpu",kernelFunc:Jse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qse(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:o}=e,{axis:i,batchDims:a}=s;He([r,o],"gatherV2");const l=gt(i,r.shape)[0],u=t.data.get(o.dataId).values,d=r.shape[l];for(let N=0;N<u.length;++N){const A=u[N];B(A<=d-1&&A>=0,()=>`GatherV2: the index value ${A} is not in [0, ${d-1}]`)}let f=a;a==null&&(f=0);const p=we(o.shape),y=MC(r,o,l,f),v=qt({inputs:{x:r},backend:t,attrs:{shape:[y.batchSize,y.outerSize,y.dimSize,y.sliceSize]}}),w=qt({inputs:{x:o},backend:t,attrs:{shape:[y.batchSize,p/y.batchSize]}}),C=[y.batchSize,y.outerSize,p/y.batchSize,y.sliceSize],S=t.bufferSync(w),b=t.bufferSync(v),E=HR(b,S,C);return t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),t.makeTensorInfo(y.outputShape,E.dtype,E.values)}const Zse={kernelName:Kf,backendName:"cpu",kernelFunc:Qse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jse(n){const{inputs:e,backend:t}=n,{input:s}=e,r=we(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=qt({inputs:{x:s},backend:t,attrs:{shape:[i,o]}}),l=R4(a,!0,t),u=qt({inputs:{x:l},backend:t,attrs:{shape:s.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(l),u}const ere={kernelName:yy,backendName:"cpu",kernelFunc:jse};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tre=Bt(yc,n=>Number.isFinite(n)?1:0,"bool"),nre={kernelName:yc,backendName:"cpu",kernelFunc:tre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sre=Bt(xc,n=>Math.abs(n)===1/0?1:0,"bool"),rre={kernelName:xc,backendName:"cpu",kernelFunc:sre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ore=Bt(vc,n=>Number.isNaN(n)?1:0,"bool"),ire={kernelName:vc,backendName:"cpu",kernelFunc:ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function are(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:o}=t,i=YR(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const lre={kernelName:vy,backendName:"cpu",kernelFunc:are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ure=Bt(Cc,n=>Math.log1p(n)),cre={kernelName:Cc,backendName:"cpu",kernelFunc:ure};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dre=$n((n,e)=>n&&e),fre=qn(Zf,dre,null,"bool"),hre={kernelName:Zf,backendName:"cpu",kernelFunc:fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pre=Bt(jf,n=>n?0:1,"bool"),mre={kernelName:jf,backendName:"cpu",kernelFunc:pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gre=$n((n,e)=>n||e),yre=qn(eh,gre,null,"bool"),xre={kernelName:eh,backendName:"cpu",kernelFunc:yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s;He(r,"LRN");const u=r.shape[3],d=u-1,f=t.data.get(r.dataId).values,p=we(r.shape),y=new Float32Array(p);function v(w){const C=w%u;let S=w-C+Math.max(0,C-o);const b=w-C+Math.min(C+o,d);let E=0;for(;S<=b;S++){const N=f[S];E+=N*N}return E}for(let w=0;w<p;w++){const C=v(w),S=f[w]*Math.pow(i+a*C,-l);y[w]=S}return t.makeTensorInfo(r.shape,r.dtype,y)}const wre={kernelName:th,backendName:"cpu",kernelFunc:vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:d}=s;He(i,"LRNGrad");const f=we(i.shape),p=i.shape[3],y=t.data.get(i.dataId).values,v=t.data.get(r.dataId).values,w=t.data.get(o.dataId).values,C=new Float32Array(f),S=f;for(let b=0;b<S;b++){const E=b%p,N=b-E+Math.max(0,E-a),A=b-E+Math.min(p,E+a+1);let R=0;for(let L=N;L<A;L++)R+=Math.pow(v[L],2);R=u*R+l;for(let L=N;L<A;L++){let z=-2*u*d*v[L]*w[b]/R;b===L&&(z+=Math.pow(R,-d)),z*=y[b],C[L]+=z}}return t.makeTensorInfo(i.shape,r.dtype,C)}const Tre={kernelName:wy,backendName:"cpu",kernelFunc:Cre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D4(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=t;let l=r.shape;const u=l.length,d=gt(o,l);let f=d;const p=hn(f,u);let y=a.data.get(r.dataId).values;if(p!=null){const N=new Array(u);for(let A=0;A<N.length;A++)N[A]=l[p[A]];y=fT(y,l,r.dtype,p,N),f=Cn(f.length,u),l=N}He(r,"max"),rs("max",f,u);const[v,w]=Hn(l,f),C=we(w),S=ZR(y,C,v,r.dtype),b=a.write(S,v,r.dtype);let E=v;return i&&(E=wn(v,d)),{dataId:b,shape:E,dtype:r.dtype}}const Sre={kernelName:nh,backendName:"cpu",kernelFunc:D4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;He(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;B(ss(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=Ur(r.shape,o,i,u,a,l);let f;if(d.filterWidth===1&&d.filterHeight===1&&Ct(d.inShape,d.outShape))f=Lo({inputs:{x:r},backend:t});else{const p=t.data.get(r.dataId).values,y=et(r.shape),v=mT(p,r.shape,r.dtype,y,d,"max");f=t.makeTensorInfo(d.outShape,r.dtype,v.values)}return f}const Ire={kernelName:sh,backendName:"cpu",kernelFunc:bre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s;He(r,"maxPool3d");const d=Ti(r.shape,o,i,1,a,l,u),f=t.data.get(r.dataId).values,p=$4(f,r.shape,r.dtype,et(r.shape),d,"max");return t.makeTensorInfo(p.shape,"float32",p.values)}const Nre={kernelName:rh,backendName:"cpu",kernelFunc:kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ere(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:u}=s;He([r,o],"maxPool3DGrad");const d=Ti(o.shape,i,a,1,l,u),f=t.bufferSync(o),p=mne(f,d),y=d.strideDepth,v=d.strideHeight,w=d.strideWidth,C=d.dilationDepth,S=d.dilationHeight,b=d.dilationWidth,E=d.effectiveFilterDepth,N=d.effectiveFilterHeight,A=d.effectiveFilterWidth,R=E-1-d.padInfo.front,L=A-1-d.padInfo.left,z=N-1-d.padInfo.top,M=ht(o.shape,"float32"),P=t.bufferSync(r);for(let F=0;F<d.batchSize;++F)for(let q=0;q<d.inChannels;++q)for(let ee=0;ee<d.inDepth;++ee)for(let ue=0;ue<d.inHeight;++ue)for(let ie=0;ie<d.inWidth;++ie){const de=ee-R,ae=ue-z,J=ie-L;let te=0;for(let oe=0;oe<E;oe+=C){const G=(de+oe)/y;if(!(G<0||G>=d.outDepth||Math.floor(G)!==G))for(let ne=0;ne<N;ne+=S){const ye=(ae+ne)/v;if(!(ye<0||ye>=d.outHeight||Math.floor(ye)!==ye))for(let Te=0;Te<A;Te+=b){const Se=(J+Te)/w;if(Se<0||Se>=d.outWidth||Math.floor(Se)!==Se)continue;const Ie=E*N*A-1-p.get(F,G,ye,Se,q),Re=oe*N*A+ne*A+Te,Fe=Ie===Re?1:0;if(Fe===0)continue;const Pe=P.get(F,G,ye,Se,q);te+=Pe*Fe}}}M.set(te,F,ee,ue,ie,q)}return t.makeTensorInfo(M.shape,M.dtype,M.values)}const $re={kernelName:Ty,backendName:"cpu",kernelFunc:Ere};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Are(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o,output:i}=e,a=o;He([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:d,dimRoundingMode:f}=s,p=Ur(a.shape,l,u,1,d,f),y=t.data.get(a.dataId).values,v=ht(p.outShape,a.dtype,E4(y,a.shape,a.dtype,p).values),w=p.strideHeight,C=p.strideWidth,S=p.dilationHeight,b=p.dilationWidth,E=p.effectiveFilterHeight,N=p.effectiveFilterWidth,A=N-1-p.padInfo.left,R=E-1-p.padInfo.top,L=ht(a.shape,"float32"),z=t.data.get(r.dataId).values,M=ht(r.shape,"float32",z);for(let P=0;P<p.batchSize;++P)for(let F=0;F<p.inChannels;++F)for(let q=0;q<p.inHeight;++q)for(let ee=0;ee<p.inWidth;++ee){const ue=q-R,ie=ee-A;let de=0;for(let ae=0;ae<E;ae+=S){const J=(ue+ae)/w;if(!(J<0||J>=p.outHeight||Math.floor(J)!==J))for(let te=0;te<N;te+=b){const oe=(ie+te)/C;if(oe<0||oe>=p.outWidth||Math.floor(oe)!==oe)continue;const G=E*N-1-v.get(P,J,oe,F),ne=ae*N+te,ye=G===ne?1:0;if(ye===0)continue;const Te=M.get(P,J,oe,F);de+=Te*ye}}L.set(de,P,q,ee,F)}return t.makeTensorInfo(L.shape,L.dtype,L.values)}const _re={kernelName:Cy,backendName:"cpu",kernelFunc:Are};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rre(n,e,t,s,r){const o=et(e),i=mT(n,e,t,o,r,"max"),a=E4(n,e,t,r,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dre={kernelName:Sy,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=t;He(s,"MaxPoolWithArgmax");const u=l.data.get(s.dataId).values,d=Ur(s.shape,r,o,[1,1],i),[f,p]=Rre(u,s.shape,s.dtype,a,d),y=l.write(f,d.outShape,s.dtype),v=l.write(p,d.outShape,s.dtype);return[{dataId:y,shape:d.outShape,dtype:s.dtype},{dataId:v,shape:d.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=gt(o,r.shape),u=Hn(r.shape,a)[1],d=we(u),f=[],p=t.makeTensorInfo([],"float32",new Float32Array([d]));f.push(p);const y=pa({inputs:{x:r},backend:t,attrs:{dtype:"float32"}});f.push(y);const v=gT({inputs:{a:y,b:p},backend:t});f.push(v);const w=ap({inputs:{x:v},backend:t,attrs:{axis:o,keepDims:i}});return f.forEach(C=>t.disposeIntermediateTensorInfo(C)),w}const Mre={kernelName:oh,backendName:"cpu",kernelFunc:Fre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pre(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;He(r,"min");const a=gt(o,r.shape);let l=a;const u=hn(l,r.shape.length);let d=r;u!=null&&(d=Vs({inputs:{x:r},backend:t,attrs:{perm:u}}),l=Cn(l.length,r.shape.length)),rs("min",l,d.shape.length);const[f,p]=Hn(d.shape,l),y=we(p),v=es(we(f),d.dtype),w=t.data.get(d.dataId).values;for(let S=0;S<v.length;++S){const b=S*y;let E=w[b];for(let N=0;N<y;++N){const A=w[b+N];(Number.isNaN(A)||A<E)&&(E=A)}v[S]=E}u!=null&&t.disposeIntermediateTensorInfo(d);const C=t.makeTensorInfo(f,d.dtype,v);if(i){const S=wn(f,a),b=qt({inputs:{x:C},backend:t,attrs:{shape:S}});return t.disposeIntermediateTensorInfo(C),b}return C}const Lre={kernelName:ih,backendName:"cpu",kernelFunc:Pre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ore(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:o,mode:i}=s;He(r,"mirrorPad");const a=o.map((E,N)=>E[0]+r.shape[N]+E[1]),l=o.map(E=>E[0]),u=o.map((E,N)=>E[0]+r.shape[N]),d=i==="reflect"?0:1,f=t.data.get(r.dataId).values,p=r.shape.length,y=et(r.shape),v=we(a),w=a.length,C=et(a),S=On(r.dtype,v);for(let E=0;E<v;E++){let N=kl(E,w,C);for(let R=0;R<w;R++)N[R]<l[R]?N[R]=l[R]*2-N[R]-d:N[R]>=u[R]&&(N[R]=(u[R]-1)*2-N[R]+d);N=N.map((R,L)=>R-l[L]);const A=so(N,p,y);S[E]=f[A]}return{dataId:t.write(S,a,r.dtype),shape:a,dtype:r.dtype}}const Vre={kernelName:ah,backendName:"cpu",kernelFunc:Ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bre=$n(((n,e)=>{const t=n%e;return n<0&&e<0||n>=0&&e>=0?t:(t+e)%e})),zre=qn(bc,Bre),Ure={kernelName:bc,backendName:"cpu",kernelFunc:zre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F4(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:o}=s,i=r.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=gt([a],r.shape),u=D4({inputs:{x:r},backend:t,attrs:{reductionIndices:l,keepDims:!1}}),d=wn(u.shape,l),f=qt({inputs:{x:u},backend:t,attrs:{shape:d}}),p=pT({inputs:{a:r,b:f},backend:t}),y=zR({inputs:{x:p},backend:t}),v=ap({inputs:{x:y},backend:t,attrs:{axis:l,keepDims:!1}}),w=qt({inputs:{x:v},backend:t,attrs:{shape:d}}),C=gT({inputs:{a:y,b:w},backend:t});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(w),C}const Wre={kernelName:Ih,backendName:"cpu",kernelFunc:F4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gre(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s;He(r,"multinomial");const l=a?r:F4({inputs:{logits:r},backend:t,attrs:{dim:-1}}),u=l.shape[0],d=l.shape[1],f=t.data.get(l.dataId).values,p=[u,o],y=es(we(p),"int32");for(let v=0;v<u;++v){const w=v*d,C=new Float32Array(d-1);C[0]=f[w];for(let E=1;E<C.length;++E)C[E]=C[E-1]+f[w+E];const S=p1.alea(i.toString()),b=v*o;for(let E=0;E<o;++E){const N=S();y[b+E]=C.length;for(let A=0;A<C.length;A++)if(N<C[A]){y[b+E]=A;break}}}return a||t.disposeIntermediateTensorInfo(l),t.makeTensorInfo(p,"int32",y)}const Hre={kernelName:by,backendName:"cpu",kernelFunc:Gre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qre=F1;function Kre(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s;He(r,"NonMaxSuppression");const u=t.data.get(r.dataId).values,d=t.data.get(o.dataId).values,{selectedIndices:f}=qre(u,d,i,a,l);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const Xre={kernelName:Iy,backendName:"cpu",kernelFunc:Kre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jre=M1;function Yre(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=s;He(r,"NonMaxSuppressionPadded");const d=t.data.get(r.dataId).values,f=t.data.get(o.dataId).values,{selectedIndices:p,validOutputs:y}=Jre(d,f,i,a,l,u);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([y]))]}const Qre={kernelName:ky,backendName:"cpu",kernelFunc:Yre};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zre=P1;function jre(n){const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=s;He(r,"NonMaxSuppressionWithScore");const d=t.data.get(r.dataId).values,f=t.data.get(o.dataId).values,p=i,y=a,v=l,w=u,{selectedIndices:C,selectedScores:S}=Zre(d,f,p,y,v,w);return[t.makeTensorInfo([C.length],"int32",new Int32Array(C)),t.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const eoe={kernelName:Ny,backendName:"cpu",kernelFunc:jre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function toe(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s;He(r,"oneHot");const u=we(r.shape),d=new Float32Array(u*i);d.fill(l);const f=t.data.get(r.dataId).values;for(let p=0;p<u;++p)f[p]>=0&&f[p]<i&&(d[p*i+f[p]]=a);return t.makeTensorInfo([...r.shape,i],o,d)}const noe={kernelName:dh,backendName:"cpu",kernelFunc:toe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lg(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Cl({inputs:{input:s},backend:t}),o=Lg({inputs:{x:r},backend:t}),i=Bu({inputs:{input:s},backend:t}),a=Lg({inputs:{x:i},backend:t}),l=Ys({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),l}else return yT({backend:t,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const soe={kernelName:Eh,backendName:"cpu",kernelFunc:Lg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M4(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Cl({inputs:{input:s},backend:t}),o=M4({inputs:{x:r},backend:t}),i=Bu({inputs:{input:s},backend:t}),a=Lg({inputs:{x:i},backend:t}),l=Ys({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),l}else return yT({backend:t,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const roe={kernelName:ch,backendName:"cpu",kernelFunc:M4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return Pg({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(d=>{ns(o,d.shape,"All tensors passed to stack must have matching shapes"),B(i===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(d=>{const f=Pg({inputs:{input:d},backend:t,attrs:{dim:r}});return a.push(f),f}),u=zu({inputs:l,backend:t,attrs:{axis:r}});return a.forEach(d=>t.disposeIntermediateTensorInfo(d)),u}const ooe={kernelName:fh,backendName:"cpu",kernelFunc:P4};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ioe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:o,constantValue:i}=s;He(r,"pad");const a=o.map((b,E)=>b[0]+r.shape[E]+b[1]),l=o.map(b=>b[0]),u=t.data.get(r.dataId).values,d=we(r.shape),f=r.shape.length,p=et(r.shape),y=we(a),v=a.length,w=et(a),C=On(r.dtype,y);i!==0&&C.fill(i);for(let b=0;b<d;b++){const N=kl(b,f,p).map((R,L)=>R+l[L]),A=so(N,v,w);C[A]=u[b]}return{dataId:t.write(C,a,r.dtype),shape:a,dtype:r.dtype}}const L4={kernelName:hh,backendName:"cpu",kernelFunc:ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aoe=$n((n,e)=>Math.pow(n,e)),loe=qn(kc,aoe),uoe={kernelName:kc,backendName:"cpu",kernelFunc:loe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function coe(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(S=>t.data.get(S.dataId).values),u=r.map(S=>S.shape),d=t.data.get(o.dataId).values,f=t.data.get(i.dataId).values,[p,y,v]=r4(l,u,d,o.shape,o.dtype,f,i.shape),w=p.map(S=>t.makeTensorInfo([S.length],"int32",S)),C=t.makeTensorInfo(v,o.dtype,y);return w.concat([C])}const doe={kernelName:Ey,backendName:"cpu",kernelFunc:coe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function foe(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,u=t.data.get(r.dataId).values,d=t.data.get(o.dataId).values,f=t.data.get(i.dataId).values,p=a.map(C=>t.data.get(C.dataId).values),y=a.map(C=>C.shape),[v,w]=o4(u,r.shape,d,o.shape,o.dtype,f,i.shape,p,y,l);return t.makeTensorInfo(v,o.dtype,w)}const hoe={kernelName:$y,backendName:"cpu",kernelFunc:foe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function poe(n){const{backend:e,attrs:t}=n,{start:s,stop:r,dtype:o,step:i}=t,a=i4(s,r,i,o);return e.makeTensorInfo([a.length],o,a)}const moe={kernelName:Ay,backendName:"cpu",kernelFunc:poe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const goe=Bt(Nc,n=>1/n),yoe={kernelName:Nc,backendName:"cpu",kernelFunc:goe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xoe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;He(r,"resizeBilinear");const l=et(r.shape),[u,d]=a,[f,p,y,v]=r.shape,w=t.data.get(r.dataId).values,C=new Float32Array(we([f,u,d,v])),S=[o&&u>1?p-1:p,o&&d>1?y-1:y],b=[o&&u>1?u-1:u,o&&d>1?d-1:d];let E=0;const N=S[0]/b[0],A=S[1]/b[1];for(let R=0;R<f;R++)for(let L=0;L<u;L++){let z;i?z=N*(L+.5)-.5:z=N*L;const M=Math.max(0,Math.floor(z)),P=z-M,F=Math.min(p-1,Math.ceil(z)),q=R*l[0]+M*l[1],ee=R*l[0]+F*l[1];for(let ue=0;ue<d;ue++){let ie;i?ie=A*(ue+.5)-.5:ie=A*ue;const de=Math.max(0,Math.floor(ie)),ae=ie-de,J=Math.min(y-1,Math.ceil(ie)),te=q+de*l[2],oe=ee+de*l[2],G=q+J*l[2],ne=ee+J*l[2];for(let ye=0;ye<v;ye++){const Te=w[te+ye],Se=w[oe+ye],Ie=w[G+ye],Re=w[ne+ye],Fe=Te+(Ie-Te)*ae,Pe=Se+(Re-Se)*ae,Qe=Fe+(Pe-Fe)*P;C[E++]=Qe}}}return t.makeTensorInfo([f,u,d,v],"float32",C)}const voe={kernelName:xh,backendName:"cpu",kernelFunc:xoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function woe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:o}=e,{alignCorners:i}=s;He([o,r],"resizeBilinearGrad");const a=et(r.shape),[l,u,d,f]=r.shape,[,p,y]=o.shape,v=new Float32Array(l*u*d*f),w=[i&&p>1?u-1:u,i&&y>1?d-1:d],C=[i&&p>1?p-1:p,i&&y>1?y-1:y],S=w[0]/C[0],b=w[1]/C[1],E=t.data.get(o.dataId).values;let N=0;for(let A=0;A<l;A++){const R=A*a[0];for(let L=0;L<p;L++){const z=L*S,M=Math.floor(z),P=Math.min(Math.ceil(z),u-1),F=R+M*a[1],q=R+P*a[1],ee=z-M,ue=1-ee;for(let ie=0;ie<y;ie++){const de=ie*b,ae=Math.floor(de),J=Math.min(Math.ceil(de),d-1),te=de-ae,oe=1-te,G=F+ae*a[2],ne=F+J*a[2],ye=q+ae*a[2],Te=q+J*a[2],Se=ue*oe,Ie=ue*te,Re=ee*oe,Fe=ee*te;for(let Pe=0;Pe<f;Pe++){const Qe=E[N++];v[G+Pe]+=Qe*Se,v[ne+Pe]+=Qe*Ie,v[ye+Pe]+=Qe*Re,v[Te+Pe]+=Qe*Fe}}}}return t.makeTensorInfo([l,d,u,f],"float32",v)}const Coe={kernelName:Dy,backendName:"cpu",kernelFunc:woe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Toe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;He(r,"resizeNearestNeighbor");const l=et(r.shape),[u,d]=a,[f,p,y,v]=r.shape,w=t.data.get(r.dataId).values,C=new Float32Array(f*u*d*v),S=[o&&u>1?p-1:p,o&&d>1?y-1:y],b=[o&&u>1?u-1:u,o&&d>1?d-1:d],E=S[0]/b[0],N=S[1]/b[1];let A=0;for(let R=0;R<f;R++){const L=R*l[0];for(let z=0;z<u;z++){const M=i?E*(z+.5):E*z;let P=Math.min(p-1,o?Math.round(M):Math.floor(M));i&&(P=Math.max(0,P));const F=L+P*l[1];for(let q=0;q<d;q++){const ee=i?N*(q+.5):N*q;let ue=Math.min(y-1,o?Math.round(ee):Math.floor(ee));i&&(ue=Math.max(0,ue));const ie=F+ue*l[2];for(let de=0;de<v;de++){const ae=w[ie+de];C[A++]=ae}}}}return t.makeTensorInfo([f,u,d,v],r.dtype,C)}const Soe={kernelName:yh,backendName:"cpu",kernelFunc:Toe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function boe(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:o}=e,{alignCorners:i}=s;He([o,r],"resizeNearestNeighborGrad");const a=et(r.shape),l=et(o.shape),[u,d,f,p]=r.shape,[,y,v]=o.shape,w=new Float32Array(u*d*f*p),C=t.data.get(o.dataId).values,S=[i&&y>1?d-1:d,i&&v>1?f-1:f],b=[i&&y>1?y-1:y,i&&v>1?v-1:v],E=S[0]/b[0],N=S[1]/b[1],A=1/E,R=1/N,L=Math.ceil(A)*2+2,z=Math.ceil(R)*2+2;for(let M=0;M<u;M++){const P=M*a[0];for(let F=0;F<d;F++){const q=P+F*a[1],ee=Math.floor(F*A),ue=Math.floor(ee-L/2);for(let ie=0;ie<f;ie++){const de=q+ie*a[2],ae=Math.floor(ie*R),J=Math.floor(ae-z/2);for(let te=0;te<p;te++){let oe=0;for(let G=0;G<L;G++){const ne=G+ue;if(ne<0||ne>=y)continue;const ye=P+ne*l[1],Te=ne*E,Se=Math.min(d-1,i?Math.round(Te):Math.floor(Te));if(F===Se)for(let Ie=0;Ie<z;Ie++){const Re=Ie+J;if(Re<0||Re>=v)continue;const Fe=ye+Re*l[2],Pe=Re*N,Qe=Math.min(f-1,i?Math.round(Pe):Math.floor(Pe));ie===Qe&&(oe+=C[Fe+te])}}w[de+te]=oe}}}}return t.makeTensorInfo(r.shape,r.dtype,w)}const Ioe={kernelName:Ry,backendName:"cpu",kernelFunc:boe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:o}=s;He(r,"reverse");const i=r.shape.length,a=gt(o,r.shape);if(i===0)return Lo({inputs:{x:r},backend:t});const l=new Mn(r.shape,r.dtype),u=t.bufferSync(r);for(let d=0;d<l.size;d++){const f=l.indexToLoc(d),p=f.slice();a.forEach(y=>p[y]=r.shape[y]-1-p[y]),l.set(u.get(...p),...f)}return t.makeTensorInfo(l.shape,l.dtype,l.values)}const Noe={kernelName:vh,backendName:"cpu",kernelFunc:koe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eoe={kernelName:Jy,backendName:"cpu",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:o,center:i}=e,a=t,l=On(s.dtype,we(s.shape)),[u,d,f,p]=s.shape,[y,v]=vC(i,d,f),w=255,C=Math.sin(r),S=Math.cos(r),b=a.data.get(s.dataId).values;for(let N=0;N<u;N++){const A=N*f*d*p;for(let R=0;R<d;R++){const L=R*(f*p);for(let z=0;z<f;z++){const M=z*p;for(let P=0;P<p;P++){const F=[u,R,z,P],q=F[2],ee=F[1];let ue=(q-y)*S-(ee-v)*C,ie=(q-y)*C+(ee-v)*S;ue=Math.round(ue+y),ie=Math.round(ie+v);let de=o;if(typeof o!="number"&&(P===3?de=w:de=o[P]),ue>=0&&ue<f&&ie>=0&&ie<d){const J=ie*(f*p),te=ue*p,oe=A+J+te+P;de=b[oe]}const ae=A+L+M+P;l[ae]=de}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $oe=Bt(Ac,n=>{const e=Math.floor(n);return n-e<.5?Math.floor(n):n-e>.5?Math.ceil(n):e%2===0?e:e+1}),Aoe={kernelName:Ac,backendName:"cpu",kernelFunc:$oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _oe(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:u,strides:d,outputSize:f}=Hc(o,r,i),p=!0,y=t.bufferSync(r),v=t.bufferSync(o),w=Su(y,v,i,f,u,l,a,d,0,p);return t.makeTensorInfo(i,w.dtype,w.values)}const Roe={kernelName:Fy,backendName:"cpu",kernelFunc:_oe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Doe(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<e?t=r+1:s=r;return s}function Foe(n,e){let t=0,s=n.length,r=0;for(;t<s;)r=Math.floor((t+s)/2),n[r]<=e?t=r+1:s=r;return s}function Moe(n,e,t,s,r,o){const i=Rn("int32",t*r);for(let a=0;a<t;++a){const l=n.slice(a*s,(a+1)*s),u=a*r;for(let d=0;d<r;++d)i[u+d]=o==="left"?Doe(l,e[d+u]):Foe(l,e[d+u])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Poe(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:o}=e,{side:i}=s,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,u=Moe(a,l,r.shape[0],r.shape[1],o.shape[1],i);return t.makeTensorInfo(o.shape,"int32",u)}const Loe={kernelName:My,backendName:"cpu",kernelFunc:Poe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ooe(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:o}=e;He([s,r,o],"select");const i=s.shape.length,a=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,u=t.data.get(o.dataId).values,d=Os(r.dtype,o.dtype),f=es(we(r.shape),d);let p=0;const y=i===0||i>1||r.shape.length===1?1:we(r.shape.slice(1));for(let v=0;v<a.length;v++)for(let w=0;w<y;w++)a[v]===1?f[p++]=l[v]:f[p++]=u[v];return t.makeTensorInfo(r.shape,d,f)}const Voe={kernelName:wh,backendName:"cpu",kernelFunc:Ooe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Boe=G1,zoe=H1,Uoe=Bt(Rc,n=>n>=0?zoe*n:Boe*(Math.exp(n)-1)),Woe={kernelName:Rc,backendName:"cpu",kernelFunc:Uoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Goe=Bt(Mc,n=>n<0?-1:n>0?1:0),Hoe={kernelName:Mc,backendName:"cpu",kernelFunc:Goe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qoe=Bt(Dc,n=>Math.sin(n)),Koe={kernelName:Dc,backendName:"cpu",kernelFunc:qoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xoe=Bt(Fc,n=>Math.sinh(n)),Joe={kernelName:Fc,backendName:"cpu",kernelFunc:Xoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yoe=11920928955078125e-23,MN=Math.log(Yoe)+2,Qoe=Bt(Lc,n=>{const e=n>-MN,t=n<MN,s=Math.exp(n);let r;return t?r=s:e?r=n:r=Math.log(1+s),r}),Zoe={kernelName:Lc,backendName:"cpu",kernelFunc:Qoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function joe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:o,paddings:i}=s;He([r],"spaceToBatchND");const a=we(o),l=[[0,0]];l.push(...i);for(let R=1+o.length;R<r.shape.length;++R)l.push([0,0]);const u=L4.kernelFunc({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),d=Jh(u.shape,o,a,!1),f=Yh(d.length,o.length,!1),p=Qh(u.shape,o,a,!1),w=qt({inputs:{x:u},backend:t,attrs:{shape:d}}),b=Vs({inputs:{x:w},backend:t,attrs:{perm:f}}),A=qt({inputs:{x:b},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(b),A}const eie={kernelName:Sh,backendName:"cpu",kernelFunc:joe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tie(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=t.data.get(s.dataId).values,l=t.data.get(r.dataId).values,u=t.data.get(o.dataId).values,d=t.data.get(i.dataId).values[0],[f,p,y,v,w]=c4(a,s.shape,s.dtype,l,r.dtype,u,d);return[t.makeTensorInfo(p,s.dtype,f),t.makeTensorInfo([p[0]],r.dtype,y),t.makeTensorInfo([v.length],"bool",new Uint8Array(v.map(C=>Number(C)))),t.makeTensorInfo([w.length],s.dtype,new Int32Array(w))]}const nie={kernelName:Py,backendName:"cpu",kernelFunc:tie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sie(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(t.data.get(r.dataId).values),a=t.data.get(s.dataId).values,l=Array.from(t.data.get(o.dataId).values),[u,d,f]=d4(a,s.shape,s.dtype,i,l);return[t.makeTensorInfo(d,s.dtype,u),t.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}const rie={kernelName:Ly,backendName:"cpu",kernelFunc:sie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oie(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,[u,d]=hT(i,s.shape,s.dtype,a,l,!0);return t.makeTensorInfo(d,s.dtype,u)}const iie={kernelName:Oy,backendName:"cpu",kernelFunc:oie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aie(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=t.data.get(s.dataId).values,a=t.data.get(r.dataId).values,l=t.data.get(o.dataId).values,[u,d]=hT(i,s.shape,s.dtype,a,l);return t.makeTensorInfo(d,s.dtype,u)}const lie={kernelName:Vy,backendName:"cpu",kernelFunc:aie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uie(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:u,sliceSize:d,strides:f,outputSize:p}=Hc(o,r,a),y=!1,v=t.bufferSync(r);let w;switch(o.dtype){case"bool":{const C=t.bufferSync(o),S=!!t.data.get(i.dataId).values[0];w=Su(v,C,a,p,d,u,l,f,S,y);break}case"float32":{const C=t.bufferSync(o),S=t.data.get(i.dataId).values[0];w=Su(v,C,a,p,d,u,l,f,S,y);break}case"int32":{const C=t.bufferSync(o),S=t.data.get(i.dataId).values[0];w=Su(v,C,a,p,d,u,l,f,S,y);break}case"string":{const C=t.bufferSync(o),S=fi(t.data.get(i.dataId).values[0]);w=Su(v,C,a,p,d,u,l,f,S,y);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return t.makeTensorInfo(a,w.dtype,w.values)}const cie={kernelName:By,backendName:"cpu",kernelFunc:uie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function die(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=gt(i,r.shape)[0],l=FC(r,o,a),u=new Array(r.shape.length).fill(0),d=r.shape.slice();return l.map(f=>{const p=[...d];p[a]=f;const y=Tl({inputs:{x:r},backend:t,attrs:{begin:u,size:p}});return u[a]+=f,y})}const fie={kernelName:bh,backendName:"cpu",kernelFunc:die};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hie={kernelName:zy,backendName:"cpu",kernelFunc:({inputs:n,backend:e})=>{const{x:t}=n,s=e;He(t,"square");const r=s.data.get(t.dataId).values,o=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];o[a]=l*l}return{dataId:s.write(o,t.shape,t.dtype),shape:t.shape,dtype:t.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pie=Bt(Gc,(n,e)=>{const t=e;return isNaN(n)?NaN:n>0?1:t.alpha}),mie={kernelName:Gc,backendName:"cpu",kernelFunc:pie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:d,newAxisMask:f,shrinkAxisMask:p}=s;He(r,"stridedSlice");const{finalShapeSparse:y,finalShape:v,isIdentity:w,sliceDim0:C,isSimpleSlice:S,begin:b,end:E,strides:N}=fw(r.shape,o,i,a,l,u,d,f,p);let A;if(w)A=qt({inputs:{x:r},backend:t,attrs:{shape:v}});else if(C||S){B(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const R=uw(b,E,N),L=Tl({inputs:{x:r},backend:t,attrs:{begin:b,size:R}});A=qt({inputs:{x:L},backend:t,attrs:{shape:v}}),t.disposeIntermediateTensorInfo(L)}else{const R=t.bufferSync(r),L=h4(y,R,N,b);A=t.makeTensorInfo(v,L.dtype,L.values)}return A}const yie={kernelName:Uy,backendName:"cpu",kernelFunc:gie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xie(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=s,{data:d,dataSplits:f}=e,p=t.data.get(d.dataId).values,y=t.data.get(f.dataId).values,[v,w]=p4(p,y,r,o,i,a,l,u);return[t.makeTensorInfo([v.length],"string",v),t.makeTensorInfo(f.shape,"int32",w)]}const vie={kernelName:Wy,backendName:"cpu",kernelFunc:xie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wie(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=t.data.get(o.dataId).values,l=t.data.get(i.dataId).values[0],[u,d,f]=m4(a,l,r),p=d.length;return[t.makeTensorInfo([p,2],"int32",u),t.makeTensorInfo([p],"string",d),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const Cie={kernelName:Gy,backendName:"cpu",kernelFunc:wie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tie(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=t.data.get(o.dataId).values,a=g4(i,r);return t.makeTensorInfo(o.shape,"int32",a)}const Sie={kernelName:Hy,backendName:"cpu",kernelFunc:Tie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bie=Bt(zc,n=>Math.tan(n)),Iie={kernelName:zc,backendName:"cpu",kernelFunc:bie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kie=Bt(Uc,n=>Math.tanh(n)),Nie={kernelName:Uc,backendName:"cpu",kernelFunc:kie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:o}=s;He(r,"tile");const i=x4(t.bufferSync(r),o);return t.makeTensorInfo(i.shape,i.dtype,i.values)}const $ie={kernelName:Wc,backendName:"cpu",kernelFunc:Eie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:o,sorted:i}=s;He(r,"topk");const a=t.data.get(r.dataId).values,[l,u]=w4(a,r.shape,r.dtype,o,i);return[t.makeTensorInfo(l.shape,l.dtype,l.values),t.makeTensorInfo(u.shape,u.dtype,u.values)]}const _ie={kernelName:qy,backendName:"cpu",kernelFunc:Aie};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rie(n){const{inputs:e,attrs:t,backend:s}=n,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=t,[d,f,p,y]=r.shape,[v,w]=u??[f,p],C=[d,v,w,y],S=et(r.shape),b=S[0],E=S[1],N=S[2],A=et(C),R=A[0],L=A[1],z=A[2],M=On(r.dtype,we(C));M.fill(l);const P=s.data.get(r.dataId).values,F=s.data.get(o.dataId).values;for(let ee=0;ee<d;++ee){const ue=o.shape[0]===1?F:F.subarray(ee*8,ee*8+8);for(let ie=0;ie<v;++ie)for(let de=0;de<w;++de)for(let ae=0;ae<y;++ae){let J;const te=ue[6]*de+ue[7]*ie+1;if(te===0)continue;const oe=(ue[0]*de+ue[1]*ie+ue[2])/te,G=(ue[3]*de+ue[4]*ie+ue[5])/te,ne=PN(oe,p,a),ye=PN(G,f,a);switch(i){case"nearest":J=Oie(P,f,p,b,E,N,ee,ye,ne,ae,l);break;case"bilinear":J=Vie(P,f,p,b,E,N,ee,ye,ne,ae,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const Te=ee*R+ie*L+de*z+ae;M[Te]=J}return s.makeTensorInfo(C,r.dtype,M)}return{dataId:s.write(M,C,r.dtype),shape:r.shape,dtype:r.dtype}}const Die={kernelName:Ky,backendName:"cpu",kernelFunc:Rie};function PN(n,e,t){switch(t){case"reflect":return Fie(n,e);case"wrap":return Mie(n,e);case"nearest":return Lie(n,e);case"constant":default:return Pie(n)}}function Fie(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=2*e;t<s&&(t=s*Math.trunc(-t/s)+t),t=t<-e?t+s:-t-1}else if(t>e-1)if(e<=1)t=0;else{const s=2*e;t-=s*Math.trunc(t/s),t>=e&&(t=s-t-1)}return ia(0,t,e-1)}function Mie(n,e){let t=n;if(t<0)if(e<=1)t=0;else{const s=e-1;t+=e*(Math.trunc(-t/s)+1)}else if(t>e-1)if(e<=1)t=0;else{const s=e-1;t-=e*Math.trunc(t/s)}return ia(0,t,e-1)}function Pie(n,e){return n}function Lie(n,e){return ia(0,n,e-1)}function sf(n,e,t,s,r,o,i,a,l,u,d){const f=i*s+a*r+l*o+u;return 0<=a&&a<e&&0<=l&&l<t?n[f]:d}function Oie(n,e,t,s,r,o,i,a,l,u,d){const f=Math.round(a),p=Math.round(l);return sf(n,e,t,s,r,o,i,f,p,u,d)}function Vie(n,e,t,s,r,o,i,a,l,u,d){const f=Math.floor(a),p=Math.floor(l),y=f+1,v=p+1,w=(v-l)*sf(n,e,t,s,r,o,i,f,p,u,d)+(l-p)*sf(n,e,t,s,r,o,i,f,v,u,d),C=(v-l)*sf(n,e,t,s,r,o,i,y,p,u,d)+(l-p)*sf(n,e,t,s,r,o,i,y,v,u,d);return(y-a)*w+(a-f)*C}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bie(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:o}=e;He(o,"unique");const i=s.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:u}=C4(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([u.length],"int32",u)]}const zie={kernelName:Xy,backendName:"cpu",kernelFunc:Bie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uie(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r.shape.length,a=r.shape[o],l=new Array(i-1);let u=0;for(let y=0;y<i;y++)y!==o&&(l[u++]=r.shape[y]);const d=new Array(i).fill(0),f=r.shape.slice();f[o]=1;const p=new Array(a);for(let y=0;y<p.length;y++){d[o]=y;const v=Tl({inputs:{x:r},backend:t,attrs:{begin:d,size:f}});p[y]=qt({inputs:{x:v},backend:t,attrs:{shape:l}}),t.disposeIntermediateTensorInfo(v)}return p}const Wie={kernelName:kh,backendName:"cpu",kernelFunc:Uie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gie(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:o}=e,{numSegments:i}=s;He(r,"unsortedSegmentSum");const a=r.shape.length,l=o.shape.length,u=[],d=[],f=a-l;let p=o;for(let v=0;v<f;++v){const w=Pg({inputs:{input:p},backend:t,attrs:{dim:v+1}});p=w,d.push(w)}for(let v=0;v<i;++v){const w=Ci(v,"int32"),C=t.makeTensorInfo([],"int32",w),S=VR({inputs:{a:C,b:p},backend:t}),b=pa({inputs:{x:S},backend:t,attrs:{dtype:"float32"}}),E=s0({inputs:{a:b,b:r},backend:t}),N=ap({inputs:{x:E},backend:t,attrs:{axis:0,keepDims:!1}});u.push(N),d.push(C),d.push(S),d.push(b),d.push(E),d.push(N)}const y=P4({inputs:u,backend:t,attrs:{axis:0}});return d.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}const Hie={kernelName:Nh,backendName:"cpu",kernelFunc:Gie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qie=[Wte,$ee,Hte,Kte,Mee,Jte,Qte,jte,tne,sne,one,ane,une,fne,pne,yne,vne,Cne,Sne,zte,Ine,Nne,$ne,_ne,Dee,Lee,Dne,Aee,Mne,Lne,One,Bne,Une,Gne,qne,Xne,Yne,Zne,ese,nse,rse,ise,lse,use,dse,hse,mse,gse,yse,xse,Cse,Fte,Sse,Oee,_se,Vee,Rse,zee,Ose,Vse,zse,Wee,Gse,qse,Xse,Yse,Zse,Hee,Kee,_ee,ere,Pne,nre,rre,ire,Mte,Jee,Qee,lre,jee,cre,hre,mre,xre,wre,Tre,Sre,tte,Ire,Nre,$re,_re,Dre,Mre,Lre,ste,Vre,Ure,Hre,ote,ate,Xre,Qre,eoe,ute,noe,roe,ooe,L4,uoe,Lte,fte,doe,hoe,moe,Ree,C2,yoe,Ote,Vte,Bte,voe,Coe,Soe,Ioe,Noe,Eoe,Aoe,wte,Roe,Loe,Voe,Woe,Tte,Hoe,Koe,Joe,Ste,Wre,Zoe,eie,nie,rie,iie,lie,cie,fie,kte,hie,Ete,mie,yie,vie,Cie,Sie,Rte,vse,Iie,Nie,$ie,_ie,Die,cte,zie,Wie,Hie,soe];for(const n of qie)Yy(n);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ja={},Om={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function Kie(n,e){ja[n]=e}function co(n,e){if(!(n in ja)||e!=null){const s=Jie(n,e);if(s!==null)ja[n]=s;else return console.log("Could not get context for WebGL version",n),null}const t=ja[n];return t==null||t.isContextLost()?(delete ja[n],co(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),ja[n])}function Xie(n){if(typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function Jie(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e??Xie(n);return t.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete ja[n]},!1),me().getBool("SOFTWARE_WEBGL_ENABLED")&&(Om.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Om)||t.getContext("experimental-webgl",Om):t.getContext("webgl2",Om)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Cf;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Cf||(Cf={}));var mr;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(mr||(mr={}));var jn;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(jn||(jn={}));function lp(n,e){return[e,n]}function Yie(n,e){return n*e}function Vm(n){const e=we(n),t=Math.ceil(e/4);return lg(t)}function sd(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function Qie(n,e){const[t,s]=sd(n,e);return t*s*4}function xT(n,e){const t=n;let s,r,o,i,a,l,u,d,f,p;return me().getNumber("WEBGL_VERSION")===2?(s=t.R32F,r=t.R16F,o=t.RGBA16F,i=t.RGBA32F,a=t.RED,u=4,d=1,f=t.HALF_FLOAT,p=t.FLOAT,l=t.RGBA8):(s=n.RGBA,r=n.RGBA,o=n.RGBA,i=t.RGBA,a=n.RGBA,u=4,d=4,f=e!=null?e.HALF_FLOAT_OES:null,p=n.FLOAT,l=n.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:u,defaultNumChannels:d,textureTypeHalfFloat:f,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qe(n,e){const t=e();return me().getBool("DEBUG")&&Zie(n),t}function Zie(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+nae(n,e))}const jie=596e-10,eae=65504;function tae(n){return!!(me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||jie<Math.abs(n)&&Math.abs(n)<eae)}function nae(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Bm(n,e){return Ni(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function sae(n,e){const t=Ni(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(qe(n,()=>n.shaderSource(t,e)),qe(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function rae(n,e){const t=Ni(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(qe(n,()=>n.shaderSource(t,e)),qe(n,()=>n.compileShader(t)),me().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw O4(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const oae=/ERROR: [0-9]+:([0-9]+):/g;function O4(n,e){const t=oae.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const s=+t[1],r=n.split(`
`),o=r.length.toString().length+2,i=r.map((f,p)=>nl((p+1).toString(),o)+f);let a=0;for(let f=0;f<i.length;f++)a=Math.max(i[f].length,a);const l=i.slice(0,s-1),u=i.slice(s-1,s),d=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${nl(u[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(d.join(`
`))}function iae(n){return Ni(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function aae(n,e){if(qe(n,()=>n.linkProgram(e)),!me().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function fv(n,e){if(qe(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function lae(n,e){const t=Ni(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return qe(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),qe(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function uae(n,e){const t=Ni(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return qe(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),qe(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function cae(n){return Ni(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function dae(n,e){const t=me().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const s=`[${n}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(n>t||e>t){const s=`[${n}x${e}]`,r=`[${t}x${t}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function fae(n){return Ni(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function LN(n,e,t,s,r,o,i){const a=n.getAttribLocation(e,t);return a===-1?!1:(qe(n,()=>n.bindBuffer(n.ARRAY_BUFFER,s)),qe(n,()=>n.vertexAttribPointer(a,r,n.FLOAT,!1,o,i)),qe(n,()=>n.enableVertexAttribArray(a)),!0)}function hae(n,e,t){xae(n,t),qe(n,()=>n.activeTexture(n.TEXTURE0+t)),qe(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function pae(n,e,t){return Ni(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function mae(n,e,t){return n.getUniformLocation(e,t)}function gae(n,e,t,s){qe(n,()=>hae(n,e,s)),qe(n,()=>n.uniform1i(t,s))}function hv(n,e,t){qe(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),qe(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function ON(n,e){qe(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),qe(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function zm(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+yae(n,e))}function yae(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Ni(n,e,t){const s=qe(n,()=>e());if(s==null)throw new Error(t);return s}function xae(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+n.TEXTURE0;if(s<n.TEXTURE0||s>t){const r=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Uu(n,e=2){return we(n.slice(0,n.length-e))}function Wu(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function pv(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[Uu(n),...Wu(n)]),e}function vae(n,e=!1){let t=me().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=me().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&me().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=t/2),e&&(t=t*2,s=s*2,n=n.map((a,l)=>l>=n.length-2?qg(n[l]):n[l]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=wi(n).newShape);let r=we(n),o=null;n.length<=1&&r<=t?o=[1,r]:n.length===2&&n[0]<=t&&n[1]<=t?o=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?o=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?o=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?o=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(o=[n[0],n[1]*n[2]*n[3]]);const i=o!=null&&Math.max(...o)>s&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=Uu(n);let l=2,u=2;n.length&&([l,u]=Wu(n)),r=a*(l/2)*(u/2),o=lg(r).map(d=>d*2)}else o=lg(r);return o}function Um(n){return n%2===0}function Og(n,e){if(n=n.slice(-2),e=e.slice(-2),Ct(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n.slice(-1)[0],s=e.slice(-1)[0];if(t===s||Um(t)&&Um(s)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&Um(n[0])&&Um(e[0])}let mv,gv;function wae(n){if(mv==null){const e=co(n);mv=e.getParameter(e.MAX_TEXTURE_SIZE)}return mv}function Cae(n){if(gv==null){const e=co(n);gv=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,gv)}function Tae(n){if(n===0)return 0;let e;const t=co(n);return Pr(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:Pr(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function Pr(n,e){return n.getExtension(e)!=null}function VN(n){try{if(co(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function Sae(n){if(n===0)return!1;const e=co(n);if(n===1){if(!Pr(e,"OES_texture_float"))return!1}else if(!Pr(e,"EXT_color_buffer_float"))return!1;return S2(e)}function bae(n){if(n===0)return!1;const e=co(n);if(n===1){if(!Pr(e,"OES_texture_float")||!Pr(e,"WEBGL_color_buffer_float"))return!1}else{if(Pr(e,"EXT_color_buffer_float"))return S2(e);const s="EXT_color_buffer_half_float";if(Pr(e,s)){const r=e.getExtension(s);return Iae(e,r)}return!1}return S2(e)}function S2(n){const e=xT(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t),n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(o),i}function Iae(n,e){const t=xT(n,e),s=n.createTexture();n.bindTexture(n.TEXTURE_2D,s),n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,1,1,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,s,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(s),n.deleteFramebuffer(i),a}function kae(n){return n!==2?!1:co(n).fenceSync!=null}function up(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&B(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ye=me();Ye.registerFlag("HAS_WEBGL",()=>Ye.getNumber("WEBGL_VERSION")>0);Ye.registerFlag("WEBGL_VERSION",()=>VN(2)?2:VN(1)?1:0);Ye.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ye.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ye.get("WEBGL_VERSION")===2);Ye.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ye.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ye.registerFlag("WEBGL_PACK",()=>Ye.getBool("HAS_WEBGL"));Ye.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_CLIP",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_PACK_REDUCE",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_CONV_IM2COL",()=>Ye.getBool("WEBGL_PACK"));Ye.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>wae(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Cae(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Ye.getNumber("WEBGL_VERSION");return n===0?0:Tae(n)});Ye.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ye.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!H2());Ye.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>Sae(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ye.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ye.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ye.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>bae(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_FENCE_API_ENABLED",()=>kae(Ye.getNumber("WEBGL_VERSION")));Ye.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ye.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ye.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Ye.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>H2()?1:-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Ye.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ye.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ye.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ye.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ye.registerFlag("WEBGL_EXP_CONV",()=>!1);Ye.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ye.getBool("IS_TEST"));Ye.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ye.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ye.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _s(){let n,e,t,s,r,o,i,a,l,u;return me().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",s="in",r="texture",o="outputColor",i="out vec4 outputColor;",a=me().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",s="varying",r="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:s,texture2D:r,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fl(n,e,t="index"){const s=et(e);return s.map((r,o)=>{const i=`int ${n[o]} = ${t} / ${r}`,a=o===s.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * ${r}`:`index -= ${n[o]} * ${r}`;return`${i}; ${a};`}).join("")}function r0(n,e,t="index"){const s=et(e);return s.map((r,o)=>{const i=`int ${n[o]} = ${t} / outShapeStrides[${o}]`,a=o===s.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * outShapeStrides[${o}]`:`index -= ${n[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function Nae(n,e){const t=n.length,s=n.map(o=>`${e}[${o}]`),r=new Array(t-1);r[t-2]=s[t-1];for(let o=t-3;o>=0;--o)r[o]=`(${r[o+1]} * ${s[o+1]})`;return r}function Eae(n,e,t="index"){const s=n.map((o,i)=>i),r=Nae(s,e);return r.map((o,i)=>{const a=`int ${n[i]} = ${t} / ${r[i]}`,l=i===r.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${r[i]}`:`index -= ${n[i]} * ${r[i]}`;return`${a}; ${l};`}).join("")}function vT(n){const e=et(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function wT(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const V4=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:B4}=dA;function $ae(n,e,t){const s=[];if(n.forEach(y=>{const v=we(y.shapeInfo.logicalShape);if(y.shapeInfo.isUniform?s.push(`uniform float ${y.name}${v>1?`[${v}]`:""};`):(s.push(`uniform sampler2D ${y.name};`),s.push(`uniform int offset${y.name};`)),t.enableShapeUniforms){const{uniformShape:w}=CT(t.packedInputs,y.shapeInfo.logicalShape,y.shapeInfo.texShape);switch(w.length){case 1:s.push(`uniform int ${y.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${y.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${y.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${y.name}Shape;`);break}s.push(`uniform ivec2 ${y.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(y=>{s.push(`uniform ${y.type} ${y.name}${y.arrayIndex?`[${y.arrayIndex}]`:""};`)});const r=s.join(`
`),o=n.map(y=>Aae(y,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),i=e.texShape,a=_s(),l=Dae(a);let u,d,f=Pae(a);return e.isPacked?(u=_ae(e.logicalShape,i,t.enableShapeUniforms),d=Mae(a)):(u=Rae(e.logicalShape,i,t.enableShapeUniforms),d=Fae(a)),t.packedInputs&&(f+=Bae),[f,l,d,r,u,o,t.userCode].join(`
`)}function rd(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return Zae(n,e);case 1:return ele(n,e);case 2:return nle(n,e);case 3:return rle(n,e);case 4:return ile(n,e);case 5:return ale(n);case 6:return lle(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function z4(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return Qae(n);case 1:return jae(n,e);case 2:return tle(n,e);case 3:return sle(n,e);default:return ole(n,e)}}function Aae(n,e,t=!1,s){let r="";t?r+=z4(n,s):r+=rd(n,s);const o=n.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(t?r+=ule(n,e):r+=cle(n,e)),r}function _ae(n,e,t){switch(n.length){case 0:return U4();case 1:return zae(n,e,t);case 2:return Jae(n,e,t);case 3:return Wae(n,e,t);default:return Hae(n,e,t)}}function Rae(n,e,t){switch(n.length){case 0:return U4();case 1:return Uae(n,e,t);case 2:return Yae(n,e,t);case 3:return Gae(n,e,t);case 4:return qae(n,e,t);case 5:return Kae(n,e);case 6:return Xae(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function Dae(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function Fae(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function Mae(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function Pae(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Lae}
    ${Oae}
    ${Vae}
  `}const Lae=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Oae=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Vae=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,Bae=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function U4(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function zae(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function Uae(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function Wae(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[2]/2),o=r*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function Gae(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${r0(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const s=Fl(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function Hae(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(n[n.length-1]/2),o=r*Math.ceil(n[n.length-2]/2);let i=o,a="",l="b, r, c";for(let u=2;u<n.length-1;u++)i*=n[n.length-u-1],a=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+a,l=`b${u}, `+l;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${n.length}(${l});
    }
  `}function qae(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${r0(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Fl(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function Kae(n,e){const t=Fl(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function Xae(n,e){const t=Fl(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function Jae(n,e,t){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Ct(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function Yae(n,e,t){return Ct(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Ml(n){return`offset${n}`}function Qae(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),s=_s();return`
    vec4 ${t}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function Zae(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${s}() {return ${t};}`;const[r,o]=n.shapeInfo.texShape;if(r===1&&o===1)return`
      float ${s}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const i=Ml(t);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${i});
      return sampleTexture(${t}, uv);
    }
  `;const[a,l]=n.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${t}, uv);
    }
  `}function jae(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=n.shapeInfo.texShape,o=_s();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${t}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${t}, uv);
    }
  `}function ele(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${od(n)}
      }
    `;const r=n.shapeInfo.texShape,o=r[0],i=r[1];if(i===1&&o===1)return`
      float ${s}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=Ml(t);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${t}, uv);
      }
    `:o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${a});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${t}, uv);
    }
  `}function tle(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n.shapeInfo.texShape,i=o[0],a=o[1],l=_s();if(o!=null&&Ct(t,o))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],d=Math.ceil(t[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${d}, ${u[0]}, ${u[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function nle(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n.shapeInfo.texShape;if(o!=null&&Ct(t,o)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const p=o[0],y=o[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${y}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=wi(t),l=i;if(l.length<t.length){const p=id(n,l),y=["row","col"];return`
      ${rd(p,e)}
      float ${r}(int row, int col) {
        return ${r}(${ad(y,a)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${od(n)}
      }
    `;const u=o[0],d=o[1],f=Ml(s);return d===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${d}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${f};
    vec2 uv = uvFromFlat(${u}, ${d}, index);
    return sampleTexture(${s}, uv);
  }
`}function sle(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(t[0]===1){const p=t.slice(1),y=[1,2],v=id(n,p),w=["b","row","col"];return`
        ${z4(v,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${ad(w,y)});
        }
      `}const a=_s();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=i[0],u=i[1],d=Math.ceil(t[2]/2),f=d*Math.ceil(t[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${u}, ${f}, ${d}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function rle(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t[1]*t[2],i=t[2],{newShape:a,keptDims:l}=wi(t),u=a;if(u.length<t.length){const w=id(n,u),C=["row","col","depth"];return`
        ${rd(w,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${ad(C,l)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${od(n)}
      }
    `;const d=n.shapeInfo.texShape,f=d[0],p=d[1],y=n.shapeInfo.flatOffset;if(p===o&&y==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${f}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(p===i&&y==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `;const v=Ml(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${v};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${v};
        vec2 uv = uvFromFlat(${f}, ${p}, index);
        return sampleTexture(${s}, uv);
      }
  `}function ole(n,e){const t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=_s();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${t}, uv);
    }
  `;const o=n.shapeInfo.logicalShape,i=o.length,a=n.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],u=l[0],d=l[1],f=Math.ceil(o[i-1]/2);let p=f*Math.ceil(o[i-2]/2),y="int b, int row, int col",v=`b * ${p} + (row / 2) * ${f} + (col / 2)`;for(let w=2;w<i-1;w++)y=`int b${w}, `+y,p*=o[i-w-1],v=`b${w} * ${p} + `+v;return`
    vec4 ${s}(${y}) {
      int index = ${v};
      int texR = index / ${d};
      int texC = index - texR * ${d};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}, ${u});
      return ${r.texture2D}(${t}, uv);
    }
  `}function ile(n,e){const t=n.shapeInfo.logicalShape,s=n.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t[3],i=t[2]*o,a=t[1]*i,{newShape:l,keptDims:u}=wi(t);if(l.length<t.length){const b=id(n,l),E=["row","col","depth","depth2"];return`
      ${rd(b,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${ad(E,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${od(n)}
      }
    `;const d=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,p=f[0],y=f[1],v=`int stride2 = ${s}Shape[3];`,w=`int stride1 = ${s}Shape[2] * stride2;`,C=`int stride0 = ${s}Shape[1] * stride1;`;if(y===a&&d==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${v}
        ${w}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(y===o&&d==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;const S=Ml(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${v}
      ${w}
      ${C}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${S});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${p}, ${y}, index + ${S});
      return sampleTexture(${s}, uv);
    }
  `}function ale(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e[4],o=e[3]*r,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:u}=wi(e);if(l.length<e.length){const w=id(n,l),C=["row","col","depth","depth2","depth3"];return`
      ${rd(w)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${ad(C,u)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${r})) +
          depth3;
        ${od(n)}
      }
    `;const d=n.shapeInfo.flatOffset,f=n.shapeInfo.texShape,p=f[0],y=f[1];if(y===a&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(y===r&&d==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${p}.0);
        return sampleTexture(${t}, uv);
      }
    `;const v=Ml(t);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${r} + depth3 + ${v};
      vec2 uv = uvFromFlat(${p}, ${y}, index);
      return sampleTexture(${t}, uv);
    }
  `}function lle(n){const e=n.shapeInfo.logicalShape,t=n.name,s="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:r,keptDims:o}=wi(e);if(r.length<e.length){const C=id(n,r),S=["row","col","depth","depth2","depth3","depth4"];return`
      ${rd(C)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${ad(S,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,u=e[2]*l,d=e[1]*u;if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${d}, ${u}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${od(n)}
      }
    `;const f=n.shapeInfo.flatOffset,p=n.shapeInfo.texShape,y=p[0],v=p[1];if(v===d&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${v}.0, ${y}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(v===i&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${v}.0, ${y}.0);
        return sampleTexture(${t}, uv);
      }
    `;const w=Ml(t);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${d} + col * ${u} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${w};
      vec2 uv = uvFromFlat(${y}, ${v}, index);
      return sampleTexture(${t}, uv);
    }
  `}function od(n){const e=n.name,t=we(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function ule(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",o=n.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=B4(n.shapeInfo.logicalShape,e.logicalShape),l=Kt(i),u=i-o;let d;const f=["x","y","z","w","u","v"];o===0?d="":i<2&&a.length>=1?d="coords = 0;":d=a.map(b=>`coords.${f[b+u]} = 0;`).join(`
`);let p="";i<2&&o>0?p="coords":p=n.shapeInfo.logicalShape.map((b,E)=>`coords.${f[E+u]}`).join(", ");let y="return outputValue;";const w=we(n.shapeInfo.logicalShape)===1,S=we(e.logicalShape)===1;if(o===1&&!w&&!S)y=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(w&&!S)i===1?y=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:y=`
        return vec4(outputValue.x);
      `;else if(a.length){const b=o-2,E=o-1;a.indexOf(b)>-1&&a.indexOf(E)>-1?y="return vec4(outputValue.x);":a.indexOf(b)>-1?y="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(E)>-1&&(y="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${d}
      vec4 outputValue = get${s}(${p});
      ${y}
    }
  `}function cle(n,e){const t=n.name,s=t.charAt(0).toUpperCase()+t.slice(1),r="get"+s+"AtOutCoords",o=e.texShape,i=n.shapeInfo.texShape,a=n.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!n.shapeInfo.isUniform&&a===l&&n.shapeInfo.flatOffset==null&&Ct(i,o))return`
      float ${r}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const u=Kt(l),d=B4(n.shapeInfo.logicalShape,e.logicalShape),f=l-a;let p;const y=["x","y","z","w","u","v"];a===0?p="":l<2&&d.length>=1?p="coords = 0;":p=d.map(w=>`coords.${y[w+f]} = 0;`).join(`
`);let v="";return l<2&&a>0?v="coords":v=n.shapeInfo.logicalShape.map((w,C)=>`coords.${y[C+f]}`).join(", "),`
    float ${r}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${s}(${v});
    }
  `}function Kt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function CT(n,e,t){const{newShape:s,keptDims:r}=wi(e),o=e.length,i=n&&o===3&&e[0]===1,a=i?e.slice(1):s,l=!n&&o>1&&!Ct(e,t)&&s.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function id(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function ad(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dle(n,e,t,s){const r=t.map((d,f)=>{const p={logicalShape:d.shape,texShape:d.isUniform?null:d.texData.texShape,isUniform:d.isUniform,isPacked:d.isUniform?!1:d.texData.isPacked,flatOffset:null};return d.texData!=null&&d.texData.slice!=null&&d.texData.slice.flatOffset>0&&(p.flatOffset=d.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:p}}),o=r.map(d=>d.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=$ae(r,i,e),l=rae(n.gl,a),u=n.createProgram(l);return me().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:u,inShapeInfos:o,outShapeInfo:i},W4(n,e,u))}function W4(n,e,t){const s={},r={},o={},i=[];let a,l,u,d=null,f=null;f=n.getUniformLocation(t,"NAN",!1),me().getNumber("WEBGL_VERSION")===1&&(d=n.getUniformLocation(t,"INFINITY",!1));const p=!1;for(let y=0;y<e.variableNames.length;y++){const v=e.variableNames[y];s[v]=n.getUniformLocation(t,v,p),s[`offset${v}`]=n.getUniformLocation(t,`offset${v}`,p),e.enableShapeUniforms&&(r[`${v}Shape`]=n.getUniformLocation(t,`${v}Shape`,p),o[`${v}TexShape`]=n.getUniformLocation(t,`${v}TexShape`,p))}return e.enableShapeUniforms&&(a=n.getUniformLocation(t,"outShape",p),u=n.getUniformLocation(t,"outShapeStrides",p),l=n.getUniformLocation(t,"outTexShape",p)),e.customUniforms&&e.customUniforms.forEach((y,v)=>{i[v]=n.getUniformLocation(t,y.name,p)}),{uniformLocations:s,customUniformLocations:i,infLoc:d,nanLoc:f,inShapesLocations:r,inTexShapesLocations:o,outShapeLocation:a,outShapeStridesLocation:u,outTexShapeLocation:l}}function BN(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,s)=>{const r=t.logicalShape,o=e[s],i=o.shape;if(!Ct(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(t.isUniform&&o.isUniform)return;const a=t.texShape,l=o.isUniform?null:o.texData.texShape;if(!Ct(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function fle(n,e,t,s,r){e.program.enableShapeUniforms||(BN(e.inShapeInfos,t),BN([e.outShapeInfo],[s]));const o=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?n.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):n.setOutputMatrixTexture(o.texture,i[0],i[1]),n.setProgram(e.webGLProgram),me().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN),t.forEach((l,u)=>{const d=e.program.variableNames[u],f=e.uniformLocations[d],p=e.uniformLocations[`offset${d}`],y=e.inShapesLocations[`${d}Shape`],v=e.inTexShapesLocations[`${d}TexShape`];if(y){const{uniformShape:w}=CT(e.program.packedInputs,l.shape,l.texData.texShape);switch(w.length){case 1:n.gl.uniform1iv(y,new Int32Array(w));break;case 2:n.gl.uniform2iv(y,new Int32Array(w));break;case 3:n.gl.uniform3iv(y,new Int32Array(w));break;case 4:n.gl.uniform4iv(y,new Int32Array(w));break}}if(v&&n.gl.uniform2i(v,l.texData.texShape[0],l.texData.texShape[1]),f!=null){if(l.isUniform){if(we(l.shape)<2)n.gl.uniform1f(f,l.uniformValues[0]);else{let w=l.uniformValues;w instanceof Float32Array||(w=new Float32Array(w)),n.gl.uniform1fv(f,w)}return}l.texData.slice!=null&&p!=null&&n.gl.uniform1i(p,l.texData.slice.flatOffset),n.setInputMatrixTexture(l.texData.texture.texture,f,u)}});const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=et(s.shape);switch(s.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r&&e.program.customUniforms.forEach((l,u)=>{const d=e.customUniformLocations[u],f=r[u];if(l.type==="float")n.gl.uniform1fv(d,f);else if(l.type==="vec2")n.gl.uniform2fv(d,f);else if(l.type==="vec3")n.gl.uniform3fv(d,f);else if(l.type==="vec4")n.gl.uniform4fv(d,f);else if(l.type==="int")n.gl.uniform1iv(d,f);else if(l.type==="ivec2")n.gl.uniform2iv(d,f);else if(l.type==="ivec3")n.gl.uniform3iv(d,f);else if(l.type==="ivec4")n.gl.uniform4iv(d,f);else throw Error(`uniform type ${l.type} is not supported yet.`)}),n.executeProgram()}function hle(n,e,t){let s="";e.concat(t).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:u,uniformShape:d,keptDims:f}=CT(n.packedInputs,i.shape,l);let p="",y="",v="";if(d.length===1&&n.packedInputs){const A=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];p=`${A[0]>1}_${A[1]>1}`}else if(d.length===2&&!n.packedInputs)y=`${d[0]>1}_${d[1]>1}`;else if(d.length>2&&!n.packedInputs){const A=et(d);v=`${A[0]===l[1]}_${A[A.length-1]===l[1]}`}const w=i.shape.length,C=d.length===2&&Ct(i.shape,l),S=we(i.shape)===1,b=pl(i.shape,t.shape),E=!n.packedInputs&&w===t.shape.length&&Ct(l,t.texData.texShape),N=n.packedInputs||d.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${w}_${E}_${u?f:""}_${d.length}_${S}_${b}_${C}_${p}_${y}_${v}_${N}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${a}`}});const r=n.userCode;let o=n.constructor.name;return o+="_"+s+"_"+r+`${me().getNumber("WEBGL_VERSION")}`,o}function Rs(n){return me().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ple{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Cf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=_s();this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?r0(["r","c","d"],e):Fl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mle{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Cf.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=_s();this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?r0(["r","c","d"],e):Fl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gle{constructor(e){this.variableNames=["A"],this.outTexUsage=mr.DOWNLOAD;const t=_s();this.outputShape=e,this.userCode=`
      ${V4}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yle{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=mr.DOWNLOAD;const t=_s();this.outputShape=e,this.userCode=`
      ${V4}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xle{constructor(e,t=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=_s();this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length);let r="result";t&&(r="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?wT():vT(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${s.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${s.output} = vec4(${r}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vle{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=_s();this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length);let r="",o="result";t&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?wT():vT(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wle(n){const e=_s(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return sae(n,t)}function Cle(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return lae(n,e)}function Tle(n){const e=new Uint16Array([0,1,2,2,1,3]);return uae(n,e)}function cp(n,e,t,s,r,o){dae(e,t);const i=cae(n),a=n.TEXTURE_2D;return qe(n,()=>n.bindTexture(a,i)),qe(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),qe(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),qe(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),qe(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),me().getNumber("WEBGL_VERSION")===1?qe(n,()=>n.texImage2D(a,0,s,e,t,0,r,o,null)):qe(n,()=>n.texStorage2D(a,1,s,e,t)),qe(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:i,texShape:[t,e]}}function G4(n){return n.internalFormatFloat}function Sle(n,e,t,s){const[r,o]=lp(e,t);return cp(n,r,o,G4(s),s.textureFormatFloat,n.FLOAT)}function H4(n){return n.internalFormatHalfFloat}function ble(n,e,t,s){const[r,o]=lp(e,t);return cp(n,r,o,H4(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function q4(n){return n.downloadTextureFormat}function Ile(n,e,t,s){const[r,o]=lp(e,t);return cp(n,r,o,q4(s),n.RGBA,n.UNSIGNED_BYTE)}function K4(n){return n.internalFormatPackedFloat}function kle(n,e,t,s){const[r,o]=sd(e,t);return cp(n,r,o,K4(s),n.RGBA,n.FLOAT)}function X4(n){return n.internalFormatPackedHalfFloat}function Nle(n,e,t,s){const[r,o]=sd(e,t);return cp(n,r,o,X4(s),n.RGBA,s.textureTypeHalfFloat)}function Ele(n,e,t){return qe(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),LN(n,e,"clipSpacePos",t,3,20,0)&&LN(n,e,"uv",t,2,20,12)}function $le(n,e,t,s,r,o){qe(n,()=>n.bindTexture(n.TEXTURE_2D,e));let i,a,l;r instanceof Uint8Array?(i=new Uint8Array(t*s*4),a=n.UNSIGNED_BYTE,l=n.RGBA):(i=new Float32Array(t*s*4),a=n.FLOAT,l=o.internalFormatPackedFloat),i.set(r),me().getNumber("WEBGL_VERSION")===2?qe(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,s,n.RGBA,a,i)):qe(n,()=>n.texImage2D(n.TEXTURE_2D,0,l,t,s,0,n.RGBA,a,i)),qe(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function Ale(n,e,t){qe(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?me().getNumber("WEBGL_VERSION")===2?qe(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):qe(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):me().getNumber("WEBGL_VERSION")===2?qe(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):qe(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),qe(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function _le(n,e,t,s){const r=n.createBuffer();qe(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,r));const a=4*4*e*t;return qe(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),qe(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),qe(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),r}function Rle(n,e,t){const s=n,r=new Float32Array(t);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function Dle(n,e,t,s){const[r,o]=lp(e,t),i=4,a=new Uint8Array(Yie(e*t,i));return qe(n,()=>n.readPixels(0,0,r,o,s.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Fle(n,e,t,s,r,o,i,a){const l=n,u=new Float32Array(Qie(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,u),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),u}function Mle(n,e,t){const s=new Float32Array(e*t*4);return qe(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yv{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const t=me().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,Kie(t,e)):this.gl=co(t);let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),me().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Bm(this.gl,o),Pr(this.gl,i))this.textureHalfFloatExtension=Bm(this.gl,i);else if(me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Pr(this.gl,r))this.colorBufferHalfFloatExtension=Bm(this.gl,r);else if(me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Pr(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Pr(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Cle(this.gl),this.indexBuffer=Tle(this.gl),this.framebuffer=fae(this.gl),this.textureConfig=xT(this.gl,this.textureHalfFloatExtension)}get debug(){return me().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;qe(e,()=>e.finish()),qe(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),qe(e,()=>e.deleteFramebuffer(this.framebuffer)),qe(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),qe(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),qe(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),Sle(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),ble(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),Ile(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),Ale(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,s,r){this.throwIfDisposed(),$le(this.gl,e,t,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),Nle(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),kle(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(ON(this.gl,this.framebuffer),this.outputTexture=null),qe(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,s){return this.downloadMatrixDriver(e,()=>Dle(this.gl,t,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,s,r,o,i){return Fle(this.gl,e,t,s,r,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return Rle(this.gl,e,t)}createBufferFromTexture(e,t,s){this.bindTextureToFrameBuffer(e);const r=_le(this.gl,t,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,s;if(me().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(o,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},t=o}else me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(t,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:t,isFencePassed:s}}downloadMatrixFromPackedTexture(e,t,s){return this.downloadMatrixDriver(e,()=>Mle(this.gl,t,s))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=wle(t));const s=iae(t);return qe(t,()=>t.attachShader(s,this.vertexShader)),qe(t,()=>t.attachShader(s,e)),aae(t,s),this.debug&&fv(t,s),this.vertexAttrsAreBound||(this.setProgram(s),this.vertexAttrsAreBound=Ele(t,this.program,this.vertexBuffer)),s}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&qe(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&fv(this.gl,this.program),qe(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,s=!0){return this.throwIfDisposed(),s?pae(this.gl,e,t):mae(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),qe(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,s){this.throwIfDisposed(),this.throwIfNoProgram(),gae(this.gl,e,t,s)}setOutputMatrixTexture(e,t,s){this.setOutputMatrixTextureDriver(e,s,t)}setOutputPackedMatrixTexture(e,t,s){this.throwIfDisposed();const[r,o]=sd(t,s);this.setOutputMatrixTextureDriver(e,r,o)}setOutputMatrixWriteRegion(e,t,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,t)}setOutputPackedMatrixWriteRegion(e,t,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&fv(this.gl,this.program),zm(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),qe(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),qe(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Bm(this.gl,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,s=this.getQueryTimerExtensionWebGL2();t.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await _v(()=>this.disposed||this.isQueryAvailable(e,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=Ple(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:s}=this.itemsToPoll[t];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in me().platform&&(s=me().platform.setTimeoutCustom.bind(me().platform)),_v(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),hv(this.gl,e,this.framebuffer),this.debug&&zm(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(hv(this.gl,this.outputTexture,this.framebuffer),this.debug&&zm(this.gl)):ON(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const s=t();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,t,s){this.throwIfDisposed();const r=this.gl;hv(r,e,this.framebuffer),this.debug&&zm(r),this.outputTexture=e,qe(r,()=>r.viewport(0,0,t,s)),qe(r,()=>r.scissor(0,0,t,s))}setOutputMatrixWriteRegionDriver(e,t,s,r){this.throwIfDisposed(),qe(this.gl,()=>this.gl.scissor(e,t,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Ple(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Lle,bincountImpl:J4,bincountReduceImpl:Ole,castImpl:Vle,ceilImpl:Ble,concatImpl:zle,equalImpl:Ule,expImpl:Wle,expm1Impl:Gle,floorImpl:Hle,gatherNdImpl:qle,gatherV2Impl:Kle,greaterImpl:Xle,greaterEqualImpl:Jle,lessImpl:Yle,lessEqualImpl:Qle,linSpaceImpl:Zle,logImpl:jle,maxImpl:eue,maximumImpl:tue,minimumImpl:nue,multiplyImpl:sue,negImpl:rue,notEqualImpl:oue,prodImpl:iue,raggedGatherImpl:aue,raggedTensorToTensorImpl:lue,rangeImpl:uue,rsqrtImpl:cue,scatterImpl:due,sigmoidImpl:fue,simpleAbsImpl:Y4,sliceImpl:hue,sparseFillEmptyRowsImpl:pue,sparseReshapeImpl:mue,sparseSegmentReductionImpl:Q4,sqrtImpl:gue,stridedSliceImpl:yue,stringNGramsImpl:xue,stringSplitImpl:vue,stringToHashBucketFastImpl:wue,subImpl:Cue,tileImpl:Tue,topKImpl:Sue,transposeImpl:TT,uniqueImpl:bue}=Dte;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function bs(n,e){return e===1?[n]:Z4(n,e)}function Iue(n,e){if(n===1)return"rc";let t="";for(let s=0;s<n;s++)t+=e[s],s<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kue{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Rs(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=bs("rc",this.rank),s=Kt(this.rank),r=this.getOutOfBoundsCondition(t),o=this.getSetup(t),i=this.getOutput(t);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let o=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;t.push(o)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let s=this.rank-2;s<this.rank;s++)t+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j4{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length);let s="";for(let r=0;r<4;r++){let o="thisRC = rc;";r%2===1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),s+=`
        ${o}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${Nue(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?wT():vT(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function Nue(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Eae(["r","c","d"],"inputShape"):Fl(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eue{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,t,s){const r=UN(t,s),o=WN(e,r,s);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=zN(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].shift();return this.usedTextures[o].push(l),l}let a;return r===jn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===jn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===jn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===jn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===jn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,t,s,r){if(this.freeTextures==null)return;const o=UN(s,r),i=WN(t,o,r);i in this.freeTextures||(this.freeTextures[i]=[]);const a=zN(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=me().get("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const u=this.usedTextures[i],d=u.indexOf(e);if(d<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(d,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function $ue(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function zN(n,e,t,s,r){const o=Aue(e,s);let i;if(r){const[l,u]=sd(n[0],n[1]);i=l*u}else{const[l,u]=lp(n[0],n[1]);i=l*u}const a=$ue(t,o);return i*a}function Aue(n,e){switch(n){case jn.PACKED_2X2_FLOAT32:return K4(e);case jn.PACKED_2X2_FLOAT16:return X4(e);case jn.UNPACKED_FLOAT32:return G4(e);case jn.UNPACKED_FLOAT16:return H4(e);case jn.PACKED_4X1_UNSIGNED_BYTE:return q4(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function _ue(n){return me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?jn.PACKED_2X2_FLOAT32:jn.UNPACKED_FLOAT32:n?jn.PACKED_2X2_FLOAT16:jn.UNPACKED_FLOAT16}function UN(n,e){if(n===mr.UPLOAD)return jn.PACKED_2X2_FLOAT32;if(n===mr.RENDER||n==null)return _ue(e);if(n===mr.DOWNLOAD||n===mr.PIXELS)return jn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function WN(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class li{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Gr="if (isnan(x)) return x;",Rue="return x;",GN="return abs(x);",Due="return (x >= 0.0) ? x : (exp(x) - 1.0);",Fue=Gr+`
  return (x < 0.0) ? 0.0 : x;
`,Mue=Gr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,xu="return x;",Pue="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lue="return x;",Oue=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Vue=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Bue=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zue="return 1.0 / (1.0 + exp(-1.0 * x));";class tl{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uue{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length);const t=e.length,s=bs("rc",t),r=Kt(t),o=Iue(t,s),i=s.slice(-2),a=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wue=E1,Gue=1e-7,Hue=1e-4,Wm={};function que(n){return n in Wm||(Wm[n]={}),Wm[n]}const Kue=me().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),Xue=600;function Jue(){return me().global.screen==null?1024:me().global.screen.height*me().global.screen.width*window.devicePixelRatio*Xue/1024/1024}class o0 extends Hg{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!me().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof yv)t=e;else{const s=co(me().getNumber("WEBGL_VERSION"),e);t=new yv(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=co(me().getNumber("WEBGL_VERSION"));t=new yv(s),this.binaryCache=que(me().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Eue(this.gpgpu),this.numMBBeforeWarning=Jue(),this.texData=new M2(this,ti())}nextDataId(){return o0.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,t,s){if((me().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||me().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:s,values:e,usage:mr.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,s,r,o){if(me().getBool("DEBUG")&&this.checkNumericalProblems(t),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:t,usage:mr.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=t;if(i!=null){let p;l?p=new tl(a,xu):p=new li(a,xu);const y=this.runWebGLProgram(p,[{dataId:e,shape:a,dtype:r}],r),v=this.readSync(y.dataId);return this.disposeIntermediateTensorInfo(y),v}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const u=this.activeTimers!=null;let d;u&&(d=vs());let f;if(r==="complex64"){const p=this.readSync(o.real.dataId),y=this.readSync(o.imag.dataId);f=gi(p,y)}else f=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=vs()-d),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const v=this.pendingRead.get(e);return new Promise(w=>v.push(w))}const t=this.texData.get(e),{values:s,shape:r,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=t;if(o!=null){let v;l?v=new tl(r,xu):v=new li(r,xu);const w=this.runWebGLProgram(v,[{dataId:e,shape:r,dtype:i}],i),C=this.read(w.dataId);return this.disposeIntermediateTensorInfo(w),C}if(s!=null)return this.convertAndCacheOnCPU(e);if(me().getBool("DEBUG")&&!me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&me().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,d;if(i!=="complex64"&&me().get("WEBGL_BUFFER_SUPPORTED")){d=this.decode(e);const v=this.texData.get(d.dataId);u=this.gpgpu.createBufferFromTexture(v.texture.texture,...Vm(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(i==="complex64"){const v=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),w=v[0],C=v[1];f=gi(w,C)}else if(u==null)f=this.getValuesFromTexture(e);else{const v=we(r);f=this.gpgpu.downloadFloat32MatrixFromBuffer(u,v)}if(d!=null&&this.disposeIntermediateTensorInfo(d),u!=null){const v=this.gpgpu.gl;qe(v,()=>v.deleteBuffer(u))}const p=this.convertAndCacheOnCPU(e,f),y=this.pendingRead.get(e);return this.pendingRead.delete(e),y.forEach(v=>v(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&ti().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,t={}){const s=this.texData.get(e),{values:r,shape:o,slice:i,dtype:a,isPacked:l,texture:u}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let y;l?y=new tl(o,xu):y=new li(o,xu);const v=this.runWebGLProgram(y,[{dataId:e,shape:o,dtype:a}],a),w=this.readToGPU(v,t);return this.disposeIntermediateTensorInfo(v),w}if(u==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const d=this.decode(e,t.customTexShape),f=ti().makeTensorFromTensorInfo(d),p=this.texData.get(d.dataId);return Object.assign({tensorRef:f},p.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const s=t.map(r=>fi(r));return ht(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return ht(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const s=e[t];if(!tae(s))throw me().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:s,isPacked:r}=this.texData.get(e),o=we(t);if(me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),y=this.texData.get(p.dataId),v=this.gpgpu.downloadMatrixFromPackedTexture(y.texture.texture,...Vm(t)).subarray(0,o);return this.disposeIntermediateTensorInfo(p),v}const i=me().getBool("WEBGL_PACK")&&r===!0,a=i?pv(t):t,l=i?new yle(a):new gle(a),u=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),d=this.texData.get(u.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture.texture,d.texShape[0],d.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(u),f}timerAvailable(){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const o=di(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=di(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=t,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=HE(l),a.getExtraProfileInfo=()=>l.map((u,d)=>({name:i[d],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:vs(),endMs:null}}endTimer(e){return me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=vs(),e)}async getQueryTime(e){if(me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,t),this.disposeData(s.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:s,texShape:r,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,u=this.dataRefCount.get(l);u>1?this.dataRefCount.set(l,u-1):(this.dataRefCount.delete(l),t!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(t,r,o,i)));const d=this.texData.get(e);d.texture=null,d.texShape=null,d.isPacked=!1,d.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=Kue){return me().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&we(s.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){fr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return Wue(e.shape,t)}packedUnaryOp(e,t,s){const r=new tl(e.shape,t),o=this.compileAndRun(r,[e],s);return ti().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=Y4(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(me().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,GN,e.dtype);const t=new li(e.shape,GN),s=this.compileAndRun(t,[e]);return ti().makeTensorFromTensorInfo(s)}makeTensorInfo(e,t,s){let r;if(t==="string"&&s!=null&&s.length>0&&Eo(s[0])){const o=s.map(i=>_o(i));r=this.write(o,e,t)}else r=this.write(s,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}makeOutput(e,t,s){return ti().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,s),this)}unpackTensor(e){const t=new Uue(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new kue(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}packedReshape(e,t){const s=[Uu(e.shape),...Wu(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},o=[Uu(t),...Wu(t)],i=new j4(o,s),a=!0,l=[s],u=this.runWebGLProgram(i,[r],e.dtype,l,a);return{dataId:u.dataId,shape:t,dtype:u.dtype}}decode(e,t){const s=this.texData.get(e),{isPacked:r,shape:o,dtype:i}=s;if(t!=null){const p=we(o),y=t[0]*t[1]*4;B(p<=y,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=pv(o);let l;r?l=new mle(a):l=new ple(a);const u=!0,d=[t??Vm(a)],f=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,d,u,t);return{dtype:i,shape:o,dataId:f.dataId}}runWebGLProgram(e,t,s,r,o=!1,i){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===Cf.DENSE){const S=i??Vm(e.outputShape);l.texShape=S.map(b=>b*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),we(a.shape)===0)return l.values=On(a.dtype,0),a;const u=[],d=t.map(S=>{if(S.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let b=this.texData.get(S.dataId);if(b.texture==null){if(!e.packedInputs&&we(S.shape)<=me().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:S.shape,texData:null,isUniform:!0,uniformValues:b.values};e.packedInputs&&(b.isPacked=!0,b.shape=S.shape)}if(this.uploadToGPU(S.dataId),!!b.isPacked!=!!e.packedInputs)S=b.isPacked?this.unpackTensor(S):this.packTensor(S),u.push(S),b=this.texData.get(S.dataId);else if(b.isPacked&&!Og(b.shape,S.shape)){const E=S,N=S.shape;S.shape=b.shape,S=this.packedReshape(S,N),u.push(S),b=this.texData.get(S.dataId),E.shape=N}return{shape:S.shape,texData:b,isUniform:!1}});this.uploadToGPU(a.dataId);const f={shape:a.shape,texData:l,isUniform:!1},p=hle(e,d,f),y=this.getAndSaveBinary(p,()=>dle(this.gpgpu,e,d,f)),v=this.activeTimers!=null;let w;v&&(w=this.startTimer()),me().get("ENGINE_COMPILE_ONLY")||fle(this.gpgpu,y,d,f,r),u.forEach(S=>this.disposeIntermediateTensorInfo(S)),v&&(w=this.endTimer(w),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(w)}));const C=me().get("WEBGL_FLUSH_THRESHOLD");if(C>0){const S=vs();S-this.lastGlFlushTime>C&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=S)}if(!me().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const S=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),S}return a}compileAndRun(e,t,s,r,o=!1){return s=s||t[0].dtype,this.runWebGLProgram(e,t,s,r,o)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(me().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=he(()=>{if(!me().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=me().getBool("DEBUG");me().set("DEBUG",!1);const t=this.abs(tt(1e-8)).dataSync()[0];if(me().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Gue:Hue}uploadToGPU(e){const t=this.texData.get(e),{shape:s,dtype:r,values:o,texture:i,usage:a,isPacked:l}=t;if(i!=null)return;const u=this.activeTimers!=null;let d;u&&(d=vs());let f=t.texShape;if(f==null&&(f=vae(s,l),t.texShape=f),o!=null){const p=pv(s);let y,v=f[1],w=f[0];const C=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!C)&&([v,w]=sd(f[0],f[1])),l?y=new vle(p,C):y=new xle(p,C);const S=C?[w,v]:f,b=this.makeTensorInfo(S,r),E=this.texData.get(b.dataId);C?E.usage=mr.PIXELS:E.usage=mr.UPLOAD,E.texShape=S,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(b.dataId),v,w,o);const N=[[w,v]],R=this.runWebGLProgram(y,[b],r,N,!0),L=this.texData.get(R.dataId);t.texShape=L.texShape,t.isPacked=L.isPacked,t.usage=L.usage,me().get("ENGINE_COMPILE_ONLY")?this.disposeData(R.dataId):(t.texture=L.texture,t.values=null,this.texData.delete(R.dataId)),this.disposeIntermediateTensorInfo(b),u&&(this.uploadWaitMs+=vs()-d)}else{const p=this.acquireTexture(f,a,r,l);t.texture=p}}convertAndCacheOnCPU(e,t){const s=this.texData.get(e),{dtype:r}=s;return this.releaseGPUData(e),t!=null&&(s.values=Yue(t,r)),s.values}acquireTexture(e,t,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,r)}computeBytes(e,t){return e[0]*e[1]*ug(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(t),r(!0)}catch(o){throw o}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await gC(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(O4(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:t,customUniformLocations:s,infLoc:r,nanLoc:o,inShapesLocations:i,inTexShapesLocations:a,outShapeLocation:l,outShapeStridesLocation:u,outTexShapeLocation:d}=W4(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=t,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=o,e.inShapesLocations=i,e.inTexShapesLocations=a,e.outShapeLocation=l,e.outShapeStridesLocation=u,e.outTexShapeLocation=d}}}o0.nextDataId=0;function Yue(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let s=0;s<t.length;++s)t[s]=Math.round(n[s]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */q2()&&nw("webgl",()=>new o0,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ST=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Gu{constructor(e,t,s){this.variableNames=["A","B"],this.outputShape=dt(t,s),this.enableShapeUniforms=Rs(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dp=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class fp{constructor(e,t,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=dt(t,s);const o=this.outputShape.length;this.enableShapeUniforms=Rs(o);let i="";if(r)if(o===0||we(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${Kt(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=bs("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nr(n){const{inputs:e,backend:t}=n,{x:s}=e;return t.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const Que={kernelName:gc,backendName:"webgl",kernelFunc:nr};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sa(n){const{inputs:e,backend:t}=n,{real:s,imag:r}=e,o=t.makeTensorInfo(s.shape,"complex64"),i=t.texData.get(o.dataId),a=nr({inputs:{x:s},backend:t}),l=nr({inputs:{x:r},backend:t});return i.complexTensorInfos={real:a,imag:l},o}const Zue={kernelName:ey,backendName:"webgl",kernelFunc:Sa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eD="return (a < 0.) ? b * a : a;",tD=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function jue(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{alpha:o}=s,i=t.makeTensorInfo([],"float32",Ci(o,"float32")),a=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fp(tD,r.shape,i.shape):new Gu(eD,r.shape,i.shape),l=t.runWebGLProgram(a,[r,i],"float32");return t.disposeIntermediateTensorInfo(i),l}const ece={kernelName:Jf,backendName:"webgl",kernelFunc:jue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nD="return (a < 0.) ? b * a : a;",sD=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function tce(n){const{inputs:e,backend:t}=n,{x:s,alpha:r}=e,o=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fp(sD,s.shape,r.shape):new Gu(nD,s.shape,r.shape);return t.runWebGLProgram(o,[s,r],"float32")}const nce={kernelName:ph,backendName:"webgl",kernelFunc:tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ld="if (isnan(x)) return x;";function $t({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:s}){return({inputs:r,backend:o})=>{const{x:i}=r,a=o,l=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&t!=null){const f=a.texData.get(i.dataId),p=t(f.values,l);return a.makeTensorInfo(i.shape,l,p)}const u=me().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let d;return u?d=new tl(i.shape,e):d=new li(i.shape,n),a.runWebGLProgram(d,[i],l)}}function os({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:u}=i,d=a;if(s&&l.dtype==="complex64"){const v=d.texData.get(l.dataId),w=d.texData.get(u.dataId),[C,S]=[[v.complexTensorInfos.real,w.complexTensorInfos.real],[v.complexTensorInfos.imag,w.complexTensorInfos.imag]].map(E=>{const[N,A]=E,R={dataId:N.dataId,dtype:N.dtype,shape:l.shape},L={dataId:A.dataId,dtype:A.dtype,shape:u.shape},z=new Gu(n,l.shape,u.shape);return d.runWebGLProgram(z,[R,L],Os(N.dtype,A.dtype))}),b=Sa({inputs:{real:C,imag:S},backend:d});return d.disposeIntermediateTensorInfo(C),d.disposeIntermediateTensorInfo(S),b}const f=o||Os(l.dtype,u.dtype);if((l.dtype==="string"||u.dtype==="string"||d.shouldExecuteOnCPU([l,u]))&&r!=null){const v=d.texData.get(l.dataId).values,w=d.texData.get(u.dataId).values,C=l.dtype==="string"?xl(v):v,S=l.dtype==="string"?xl(w):w,[b,E]=r(l.shape,u.shape,C,S,f),N=d.makeTensorInfo(E,f),A=d.texData.get(N.dataId);return A.values=b,N}const p=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let y;return p?y=new fp(e,l.shape,u.shape,t):y=new Gu(n,l.shape,u.shape),d.runWebGLProgram(y,[l,u],f)}}function Tf(n,e=!1){if(n==="linear")return e?Lue:Rue;if(n==="relu")return e?Vue:Fue;if(n==="elu")return e?Oue:Due;if(n==="relu6")return e?Bue:Mue;if(n==="prelu")return e?sD:nD;if(n==="leakyrelu")return e?tD:eD;if(n==="sigmoid")return e?zue:Pue;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rD{constructor(e,t,s,r=!1,o=!1,i=!1,a=null,l=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Rs(this.outputShape.length);const d=r?e[1]:e[2],f=Math.ceil(d/2),p=r?"i * 2, rc.y":"rc.y, i * 2",y=o?"rc.z, i * 2":"i * 2, rc.z",v=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],w=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let C="",S="";a&&(l?C=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:u?C=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:C=`vec4 activation(vec4 x) {
          ${a}
        }`,S="result = activation(result);");const b=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let E="rc.x",N="rc.x";e[0]<t[0]?E=`int(min(float(rc.x), ${e[0]-1}.))`:t[0]<e[0]&&(N=`int(min(float(rc.x), ${t[0]-1}.))`),this.userCode=`
      ${C}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${f}; i++) {
          int batchA = ${E};
          int batchB = ${N};
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${y});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${v[0]} * ${w[0]});
          result += (${v[1]} * ${w[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${b}

        ${S}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HN={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class qN{constructor(e,t,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=dt(t,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KN="return a * b;";function bT(n){const{inputs:e,backend:t}=n,{a:s,b:r}=e,o=Os(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=t.texData.get(s.dataId),l=t.texData.get(r.dataId),u=new qN(HN.REAL,s.shape,r.shape),d=new qN(HN.IMAG,s.shape,r.shape),f=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],p=t.runWebGLProgram(u,f,"float32"),y=t.runWebGLProgram(d,f,"float32"),v=Sa({inputs:{real:p,imag:y},backend:t});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(y),v}if(t.shouldExecuteOnCPU([s,r])){const a=t.texData.get(s.dataId),l=t.texData.get(r.dataId),[u,d]=sue(s.shape,r.shape,a.values,l.values,o),f=t.makeTensorInfo(d,o),p=t.texData.get(f.dataId);return p.values=u,f}let i;return me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new fp(KN,s.shape,r.shape):i=new Gu(KN,s.shape,r.shape),t.runWebGLProgram(i,[s,r],o)}const sce={kernelName:Ic,backendName:"webgl",kernelFunc:bT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rce(n,e,t){const s=[Uu(n.shape),...Wu(n.shape)],r={dtype:n.dtype,shape:s,dataId:n.dataId},o=[Uu(e),...Wu(e)],i=new j4(o,s),a=!0,l=[s],u=t.runWebGLProgram(i,[r],n.dtype,l,a);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ve(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{shape:o}=s,i=t,a=we(r.shape),l=L2(o,a),u=we(l);B(a===u,()=>`The new shape (${l}) has ${u} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const d=i.texData.get(r.dataId);return d.isPacked&&!Og(r.shape,l)&&!(d.texture!==null&&Og(d.shape,l))?rce(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const oce={kernelName:gh,backendName:"webgl",kernelFunc:Ve};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XN{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];const a=Math.floor(s/4)*4,l=s%4;let u="sumValue += dot(values, ones);";if(t!=null){const f=1/t;u=`sumValue += dot(values * ${ul(f)?f.toPrecision(2):f}, ones);`}let d="";o%s>0&&(d=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${d}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ice{constructor(e,t){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];let a="0.0",l="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",l="min"):t==="max"&&(a="-1.0 / 1e-20",l="max");let u=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?u="sumValue":t==="prod"?u="prodValue":t==="all"?u="allValue":t==="any"&&(u="anyValue");const d=Math.floor(s/4)*4,f=s%4;let p=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,y="vec4";t==="all"?(a="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,y="bvec4"):t==="any"&&(a="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,y="bvec4");let v="";o%s>0&&(v=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${v}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${d};
        if (${f===1}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${f===2}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${f===3}) {
          ${y} values = ${y}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ace(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],s=W1(t);e.push({inSize:t,windowSize:s,outSize:Math.ceil(t/s)})}return e}function Pl(n,e,t,s){const r=ace(n.shape);let o=n;for(let i=0;i<r.length;i++){const{inSize:a,windowSize:l,outSize:u}=r[i];let d,f;t==="mean"?d=i===0?new XN({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u},a):new XN({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u}):d=new ice({windowSize:l,inSize:a,batchSize:n.shape[0],outSize:u},t),f=o,o=s.runWebGLProgram(d,[o],e),f.dataId!==n.dataId&&s.disposeIntermediateTensorInfo(f)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lce{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[t[i]];this.outputShape=s,this.rank=s.length;const r=Kt(this.rank),o=uce(t);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function uce(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<n.length;r++)s[n[r]]=t[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cce{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let d=0;d<s.length;d++)s[d]=e[t[d]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=Kt(this.rank),o=Z4("rc",this.rank),i=new Array(this.rank);for(let d=0;d<t.length;d++)i[t[d]]=o[d];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${l}) {
        result[1] = ${u};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${l}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i0(n,e,t){const s=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new cce(n.shape,e):new lce(n.shape,e);return t.runWebGLProgram(s,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dce(n,e,t,s){const r=e,o=n.shape.length,i=gt(r,n.shape);let a=i;const l=hn(a,o),u=l!=null;let d=n;u&&(d=i0(n,l,s),a=Cn(a.length,o)),rs("sum",a,o);const[f,p]=Hn(d.shape,a);let y=f;t&&(y=wn(f,i));const v=we(p),C=we(n.shape)/v,S=Ve({inputs:{x:d},attrs:{shape:[C,v]},backend:s}),b=Qy(n.dtype),E=Pl(S,b,"sum",s),N=Ve({inputs:{x:E},attrs:{shape:y},backend:s});return s.disposeIntermediateTensorInfo(S),s.disposeIntermediateTensorInfo(E),u&&s.disposeIntermediateTensorInfo(d),N}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a0(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s;return dce(r,o,i,t)}const fce={kernelName:Th,backendName:"webgl",kernelFunc:a0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $s(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{perm:o}=s,i=t,a=r.shape.length,l=new Array(a);for(let d=0;d<l.length;d++)l[d]=r.shape[o[d]];let u;if(i.shouldExecuteOnCPU([r])){const f=i.texData.get(r.dataId).values,p=TT(f,r.shape,r.dtype,o,l);u=i.makeTensorInfo(l,r.dtype);const y=i.texData.get(u.dataId);y.values=p}else u=i0(r,o,i);return u}const hce={kernelName:sl,backendName:"webgl",kernelFunc:$s};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oD=1e3;function Vg({a:n,b:e,transposeA:t,transposeB:s,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const u=n.shape.length,d=e.shape.length,f=t?n.shape[u-2]:n.shape[u-1],p=s?e.shape[d-1]:e.shape[d-2],y=t?n.shape[u-1]:n.shape[u-2],v=s?e.shape[d-2]:e.shape[d-1],w=n.shape.slice(0,-2),C=e.shape.slice(0,-2),S=we(w),b=we(C),N=dt(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([y,v]);B(f===p,()=>`Error in matMul: inner shapes (${f}) and (${p}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${s} must match.`);const A=t?[S,f,y]:[S,y,f],R=s?[b,v,p]:[b,p,v],L=Ve({inputs:{x:n},backend:r,attrs:{shape:A}}),z=Ve({inputs:{x:e},backend:r,attrs:{shape:R}}),M=[L,z],P=Math.max(S,b),F=t?L.shape[1]:L.shape[2],q=o!=null,ee=i!=null,ue=l==="leakyrelu",ie=l!=null?Tf(l,!0):null,de=q||ee||ue||ie!=null;let ae;if((y===1||v===1)&&F>oD&&de===!1){let te=L,oe=z;t&&(te=$s({inputs:{x:L},backend:r,attrs:{perm:[0,2,1]}}),M.push(te)),s&&(oe=$s({inputs:{x:z},backend:r,attrs:{perm:[0,2,1]}}),M.push(oe));const G=v!==1,ne=v===1;let ye=te;G&&(ye=Ve({inputs:{x:te},backend:r,attrs:{shape:[P,F,1]}}),M.push(ye));const Te=v===1?2:1;let Se=oe;ne&&(Se=Ve({inputs:{x:oe},backend:r,attrs:{shape:[P,1,F]}}),M.push(Se));const Ie=bT({inputs:{a:ye,b:Se},backend:r});ae=a0({inputs:{x:Ie},backend:r,attrs:{axis:Te,keepDims:!0}}),M.push(Ie)}else{const te=Os(n.dtype,e.dtype),oe=new rD(A,R,[P,y,v],t,s,q,ie,ee,ue),G=[L,z];if(o!=null&&G.push(o),ee&&G.push(i),ue){const ne=r.makeTensorInfo([],"float32",Ci(a,"float32"));G.push(ne),M.push(ne)}ae=r.runWebGLProgram(oe,G,te)}const J=Ve({inputs:{x:ae},backend:r,attrs:{shape:N}});M.push(ae);for(const te of M)r.disposeIntermediateTensorInfo(te);return J}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pce(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:u,activation:d,leakyreluAlpha:f}=s;return Vg({a:r,b:o,transposeA:l,transposeB:u,backend:t,bias:i,preluActivationWeights:a,leakyreluAlpha:f,activation:d})}const mce={kernelName:lf,backendName:"webgl",kernelFunc:pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JN="return abs(x);";function gce(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const o=t.texData.get(s.dataId),i=Y4(o.values);return t.makeTensorInfo(s.shape,s.dtype,i)}let r;return me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new tl(s.shape,JN):r=new li(s.shape,JN),t.runWebGLProgram(r,[s],s.dtype)}const yce={kernelName:Ef,backendName:"webgl",kernelFunc:gce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xce=Gr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,vce=$t({opSnippet:xce}),wce={kernelName:Yu,backendName:"webgl",kernelFunc:vce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cce=Gr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Tce=$t({opSnippet:Cce}),Sce={kernelName:Qu,backendName:"webgl",kernelFunc:Tce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YN="return a + b;",bce=os({opSnippet:YN,packedOpSnippet:YN,supportsComplex:!0,cpuKernelImpl:Lle}),Ice={kernelName:Nl,backendName:"webgl",kernelFunc:bce};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kce{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`float v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nce{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`vec4 v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rg(n){const{inputs:e,backend:t}=n,s=e;if(s.length===1)return nr({inputs:{x:s[0]},backend:t});if(s.length>me().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),u=rg({inputs:s.slice(0,l),backend:t}),d=rg({inputs:s.slice(l),backend:t});return rg({inputs:[u,d],backend:t})}const r=s.map(l=>l.dtype).reduce((l,u)=>Os(l,u)),o=s.map(l=>l.shape),a=me().getBool("WEBGL_PACK")?new Nce(s[0].shape,o):new kce(s[0].shape,o);return t.runWebGLProgram(a,s,r)}const Ece={kernelName:$f,backendName:"webgl",kernelFunc:rg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=gt(o,r.shape);let u=l;const d=hn(u,a);let f=r;d!=null&&(f=$s({inputs:{x:r},backend:t,attrs:{perm:d}}),u=Cn(u.length,a)),rs("all",u,a);const[p,y]=Hn(f.shape,u),v=we(y),w=Ve({inputs:{x:f},backend:t,attrs:{shape:[-1,v]}}),C=Pl(w,w.dtype,"all",t);let S;if(i){const b=wn(p,l);S=Ve({inputs:{x:C},backend:t,attrs:{shape:b}})}else S=Ve({inputs:{x:C},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(C),d!=null&&t.disposeIntermediateTensorInfo(f),S}const Ace={kernelName:Xg,backendName:"webgl",kernelFunc:$ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=gt(o,r.shape);let u=l;const d=hn(u,a);let f=r;d!=null&&(f=$s({inputs:{x:r},backend:t,attrs:{perm:d}}),u=Cn(u.length,a)),rs("any",u,a);const[p,y]=Hn(f.shape,u),v=we(y),w=Ve({inputs:{x:f},backend:t,attrs:{shape:[-1,v]}}),C=Pl(w,w.dtype,"any",t);let S;if(i){const b=wn(p,l);S=Ve({inputs:{x:C},backend:t,attrs:{shape:b}})}else S=Ve({inputs:{x:C},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(C),d!=null&&t.disposeIntermediateTensorInfo(f),S}const Rce={kernelName:Jg,backendName:"webgl",kernelFunc:_ce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dce{constructor(e,t,s){this.variableNames=["A"];const{windowSize:r,batchSize:o,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=t==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fce{constructor(e,t,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,B(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,u=Kt(l),d=bs("coords",l);let f,p;if(i===1){p=l+1;const z=Kt(p);f=`
        ${z} sourceLocR = ${z}(${d.join()}, 0);
        ++${d[l-1]};
        ${z} sourceLocG = ${z}(${d.join()}, 0);
        ++${d[l-2]};
        ${z} sourceLocA = ${z}(${d.join()}, 0);
        --${d[l-1]};
        ${z} sourceLocB = ${z}(${d.join()}, 0);
        --${d[l-2]};`}else p=l,f=`
        ${u} sourceLocR = coords;
        ++${d[l-1]};
        ${u} sourceLocG = coords;
        ++${d[l-2]};
        ${u} sourceLocA = coords;
        --${d[l-1]};
        ${u} sourceLocB = coords;
        --${d[l-2]};`;const y=["x","y","z","w","u","v"].slice(0,p),v="."+y[p-1],w=y.map(z=>"int "+z),C=bs("sourceLocR",p-1).concat("inIdx.r"),S=bs("sourceLocG",p-1).concat("inIdx.g"),b=bs("sourceLocB",p-1).concat("inIdx.b"),E=bs("sourceLocA",p-1).concat("inIdx.a"),N=s==="max"?"greaterThan":"lessThan",A=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${C.join()}),
                             getBestIndicesAChannel(${S.join()}),
                             getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${E.join()})));`,R=`vec4(
            getAChannel(${C.join()}),
            hasNextCol ? getAChannel(${S.join()}) : 0.,
            hasNextRow ? getAChannel(${b.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${E.join()}) : 0.)`,L=r?"":`
      float getBestIndicesAChannel(${w.join()}) {
        return getChannel(getBestIndicesA(${y.join()}),
                                          vec2(${y.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${w.join()}) {
        return getChannel(getA(${y.join()}),
                               vec2(${y.slice(-2).join()}));
      }
      ${L}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${d[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${d[l-2]} < ${a[l-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${v}, sourceLocG${v},
          sourceLocB${v}, sourceLocA${v}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${R};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${A}
          vec4 candidate = ${R};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${N}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iD(n,e,t,s=null){let r=e.shape[0],o=e.shape[1];s!=null&&(r=s.shape[0],o=s.shape[1]);const i=W1(o),a={windowSize:i,inSize:o,batchSize:r,outSize:Math.ceil(o/i)},l=new Dce(a,t,s==null),u=[e];s!=null&&u.push(s);const d=n.runWebGLProgram(l,u,"int32");if(d.shape[1]===1)return d;const f=iD(n,e,t,d);return n.disposeIntermediateTensorInfo(d),f}function aD(n,e,t,s=null){const r=s!=null?s.shape:e.shape,o=r[r.length-1],i=W1(o),a=new Fce(r,i,t,s==null),l=s==null?[e]:[e,s],u=n.runWebGLProgram(a,l,"int32");if(u.shape.length===e.shape.length){const d=aD(n,e,t,u);return n.disposeIntermediateTensorInfo(u),d}return u}function lD(n,e,t,s){const r=[t];if(rs("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!me().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=n.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=n.unpackTensor(e),o.push(l));const[u,d]=Hn(l.shape,r),f=we(d),p=Ve({inputs:{x:l},backend:n,attrs:{shape:[-1,f]}});o.push(p);const y=iD(n,p,s);o.push(y);const v=Ve({inputs:{x:y},backend:n,attrs:{shape:u}});return o.forEach(w=>n.disposeIntermediateTensorInfo(w)),v}return aD(n,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o}=s;let i=gt(o,r.shape);const a=hn(i,r.shape.length);let l=r;const u=[];a!=null&&(l=$s({inputs:{x:r},backend:t,attrs:{perm:a}}),u.push(l),i=Cn(i.length,l.shape.length)),rs("argMax",[i[0]],l.shape.length);const d=lD(t,l,i[0],"max");return u.forEach(f=>t.disposeIntermediateTensorInfo(f)),d}const Pce={kernelName:Af,backendName:"webgl",kernelFunc:Mce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lce(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o}=s;let i=gt(o,r.shape);const a=hn(i,r.shape.length);let l=r;const u=[];a!=null&&(l=$s({inputs:{x:r},backend:t,attrs:{perm:a}}),u.push(l),i=Cn(i.length,l.shape.length)),rs("argMin",[i[0]],l.shape.length);const d=lD(t,l,i[0],"min");return u.forEach(f=>t.disposeIntermediateTensorInfo(f)),d}const Oce={kernelName:_f,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vce=Gr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,Bce=$t({opSnippet:Vce}),zce={kernelName:Zu,backendName:"webgl",kernelFunc:Bce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uce=Gr+"return log(x + sqrt(x * x + 1.0));",Wce=$t({opSnippet:Uce}),Gce={kernelName:ju,backendName:"webgl",kernelFunc:Wce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hce=Gr+`
  return atan(x);
`,qce=$t({opSnippet:Hce}),Kce={kernelName:ec,backendName:"webgl",kernelFunc:qce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xce=ST+`
  return atan(a, b);
`,Jce=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+dp+`
  return result;
`,Yce=os({opSnippet:Xce,packedOpSnippet:Jce}),Qce={kernelName:nc,backendName:"webgl",kernelFunc:Yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zce=Gr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,jce=$t({opSnippet:Zce}),ede={kernelName:tc,backendName:"webgl",kernelFunc:jce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Sf{constructor(e,t,s,r=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterHeight,p=e.effectiveFilterWidth,y=e.padInfo.top,v=e.padInfo.left;this.outputShape=e.outShape;const w=t==="avg",C=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,S=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let b="0.0";if(w||(b="-1.0 / 1e-20"),s){this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${y}, ${v});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${d}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?o?C:S:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const E="max";let N=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(N="avgValue / count");const A=Math.floor(i/4)*4,R=i%4,L=`
      if (${w}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${E}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${y}, ${v});
      const float initializationValue = ${b};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${b});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${A}; wC += 4) {
            int xC = xCCorner + wC * ${d};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              getValue(batch, xR, xC + 3 * ${d}, d)
            );

            ${L}
          }

          int xC = xCCorner + ${A};
          if (${R===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${L}
          } else if (${R===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              initializationValue,
              initializationValue
            );

            ${L}
          } else if (${R===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${d}, d),
              getValue(batch, xR, xC + 2 * ${d}, d),
              initializationValue
            );

            ${L}
          }
        }
        setOutput(${N});
      }
    `}}class IT{constructor(e,t,s,r=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,u=e.strideWidth,d=e.dilationDepth,f=e.dilationHeight,p=e.dilationWidth,y=e.effectiveFilterDepth,v=e.effectiveFilterHeight,w=e.effectiveFilterWidth,C=e.padInfo.front,S=e.padInfo.top,b=e.padInfo.left;this.outputShape=e.outShape;const E=t==="avg";let N="0.0";if(E||(N="-1.0 / 1e-20"),s){this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${u});
        const ivec3 pads = ivec3(${C}, ${S}, ${b});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${y};
              wD += ${d}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${v};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${w};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${v} * ${w} +
                      wR * ${w} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const A="max";let R=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(R="avgValue / count");const L=Math.floor(i/4)*4,z=i%4,M=`
      if (${E}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${A}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${u});
      const ivec3 pads = ivec3(${C}, ${S}, ${b});
      const float initializationValue = ${N};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${N});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${y};
            wD += ${d}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${v};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${L}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${M}
            }

            int xC = xCCorner + ${L};
            if (${z===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${z===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${M}
            } else if (${z===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${M}
            }
          }
          setOutput(${R});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tde(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;up(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;B(ss(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=Ur(r.shape,o,i,u,a,l);if(d.filterWidth===1&&d.filterHeight===1&&Ct(d.inShape,d.outShape))return nr({inputs:{x:r},backend:t});const f=new Sf(d,"avg",!1);return t.runWebGLProgram(f,[r],"float32")}const nde={kernelName:Rf,backendName:"webgl",kernelFunc:tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sde(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:u}=s,d=[1,1,1],f=Ti(r.shape,o,i,d,a,l,u),p=new IT(f,"avg",!1);return t.runWebGLProgram(p,[r],"float32")}const rde={kernelName:Df,backendName:"webgl",kernelFunc:sde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ode{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.top,f=u-1-e.padInfo.left,p=1/(t*s);this.userCode=`
      const ivec2 pads = ivec2(${d}, ${f});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class ide{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,y=e.effectiveFilterWidth,v=f-1-e.padInfo.front,w=p-1-e.padInfo.top,C=y-1-e.padInfo.left,S=1/(t*s*r);this.userCode=`
      const ivec3 pads = ivec3(${v}, ${w}, ${C});
      const float avgMultiplier = float(${S});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${y};
                wC += ${d}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:d}=s,f=[1,1,1],p=Ti(i.shape,a,l,f,u,d),y=new ide(p);return t.runWebGLProgram(y,[r],i.dtype)}const lde={kernelName:Qg,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ude(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,i=o;up([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:u}=s,d=Ur(i.shape,a,l,1,u),f=new ode(d);return t.runWebGLProgram(f,[r],i.dtype)}const cde={kernelName:Yg,backendName:"webgl",kernelFunc:ude};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dde(n){const{inputs:e,backend:t,attrs:s}=n,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;return Vg({a:r,b:o,transposeA:i,transposeB:a,backend:t})}const fde={kernelName:Ff,backendName:"webgl",kernelFunc:dde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hde{constructor(e,t,s,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],dt(e,t),dt(e,s);let a="0.0";r!=null&&(dt(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(dt(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pde{constructor(e,t,s,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],dt(e,t),dt(e,s);let a="vec4(0.0)";r!=null&&(dt(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(dt(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mde=({inputs:n,backend:e,attrs:t})=>{const{x:s,mean:r,variance:o,offset:i,scale:a}=n;B(r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),B(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),B(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=t;l==null&&(l=.001);const u=[s,r,o];let d=null;i!=null&&(d=i.shape,u.push(i));let f=null;a!=null&&(f=a.shape,u.push(a));const p=me().getBool("WEBGL_PACK_NORMALIZATION")?new pde(s.shape,r.shape,o.shape,d,f,l):new hde(s.shape,r.shape,o.shape,d,f,l);return e.runWebGLProgram(p,u,u[0].dtype)},gde={kernelName:qf,backendName:"webgl",kernelFunc:mde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yde{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Kt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=xde(this.rank);let r;const o=e.map((i,a)=>`sourceLoc.${b2[a]} = start[${a}] + coords.${b2[a]};`);r=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const b2=["x","y","z","w","u","v"];function xde(n){if(n===1)return"sourceLoc";if(n<=6)return b2.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vde{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Kt(this.rank),s=bs("coords",this.rank),r=bs("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((d,f)=>`start[${f}]`).join()});`:e.map((d,f)=>`${r[f]} = ${s[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(n,e,t,s){const r=s.texData.get(n.dataId),o=s.makeTensorInfo(t,n.dtype),i=s.texData.get(o.dataId);Object.assign(i,r),i.refCount=1,i.shape=t,i.dtype=n.dtype;let a=dw(e,et(n.shape));r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||n.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),o}function ud(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:o,size:i}=s,[a,l]=e1(r,o,i);if(lw(r,a,l),we(l)===0)return t.makeTensorInfo(l,r.dtype,[]);if(t.shouldExecuteOnCPU([r])||r.dtype==="string"){const f=t.texData.get(r.dataId),p=hue(f.values,a,l,r.shape,r.dtype);return t.makeTensorInfo(l,r.dtype,p)}const{isPacked:u}=t.texData.get(r.dataId),d=cw(r.shape,a,l);if(u||!d){const f=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vde(l):new yde(l),p=[a];return t.runWebGLProgram(f,[r],r.dtype,p)}return t.uploadToGPU(r.dataId),wde(r,a,l,t)}const Cde={kernelName:Ch,backendName:"webgl",kernelFunc:ud};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tde=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:o,crops:i}=s;B(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((b,E)=>b*E),l=Jh(r.shape,o,a),u=Yh(l.length,o.length),d=Qh(r.shape,o,a),f=wC(i,o.length),p=CC(d,i,o.length),y=[],v=Ve({inputs:{x:r},backend:t,attrs:{shape:l}}),w=$s({inputs:{x:v},backend:t,attrs:{perm:u}}),C=Ve({inputs:{x:w},backend:t,attrs:{shape:d}}),S=ud({inputs:{x:C},backend:t,attrs:{begin:f,size:p}});return y.push(v),y.push(w),y.push(C),y.forEach(b=>t.disposeIntermediateTensorInfo(b)),S},Sde={kernelName:Mf,backendName:"webgl",kernelFunc:Tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bde(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:o}=e,{size:i}=s,a=t.readSync(r.dataId),l=t.readSync(o.dataId),u=J4(a,l,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,u)}const Ide={kernelName:Zg,backendName:"webgl",kernelFunc:bde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kde(n){const{inputs:e,backend:t}=n,{s0:s,s1:r}=e,o=t.readSync(s.dataId),i=t.readSync(r.dataId),a=dt(Array.from(o),Array.from(i));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Nde={kernelName:jg,backendName:"webgl",kernelFunc:kde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ede="return float(a != b);",uD=os({opSnippet:Ede,cpuKernelImpl:oue,dtype:"bool"}),$de={kernelName:uh,backendName:"webgl",kernelFunc:uD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hp(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return nr({inputs:{x:r.complexTensorInfos.real},backend:t})}const Ade={kernelName:_y,backendName:"webgl",kernelFunc:hp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _de="return float(int(x));";function Rde(n,e){const t=new li(n.shape,_de),s=e.runWebGLProgram(t,[n],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return nr({inputs:{x:r},backend:t});const i=kn(r.shape),a=I2({inputs:{x:r},backend:t,attrs:{dtype:"float32"}}),l=Sa({inputs:{real:a,imag:i},backend:t});return i.dispose(),t.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const i=hp({inputs:{input:r},backend:t}),a=I2({inputs:{x:i},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(i),a}if(!O2(r.dtype,o)){const i=nr({inputs:{x:r},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(t.shouldExecuteOnCPU([r])){const i=t.texData.get(r.dataId).values,[a,l,u]=Vle(i,r.shape,r.dtype,o);return t.makeTensorInfo(a,l,u)}if(o==="int32")return Rde(r,t);if(o==="bool"){const i=t.makeTensorInfo([],"bool",On("bool",1)),l=uD({inputs:{a:r,b:i},backend:t});return t.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}const Dde={kernelName:sc,backendName:"webgl",kernelFunc:I2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QN="return ceil(x);",Fde=$t({opSnippet:QN,packedOpSnippet:QN,cpuKernelImpl:Ble}),Mde={kernelName:rc,backendName:"webgl",kernelFunc:Fde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pde{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Lde{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ode(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{clipValueMin:o,clipValueMax:i}=s;let a;me().getBool("WEBGL_PACK_CLIP")?a=new Lde(r.shape):a=new Pde(r.shape);const l=[[o],[i]];return t.runWebGLProgram(a,[r],r.dtype,l)}const Vde={kernelName:oc,backendName:"webgl",kernelFunc:Ode};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bde{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZN(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function zde(n){const{inputs:e,backend:t}=n,{x:s}=e,r=t.texData.get(s.dataId),o=new Bde(s.shape),i=[ZN(s,r.complexTensorInfos.real),ZN(s,r.complexTensorInfos.imag)];return t.runWebGLProgram(o,i,i[0].dtype)}const Ude={kernelName:Pf,backendName:"webgl",kernelFunc:zde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wde{constructor(e){this.outputShape=[],this.outputShape=Do(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const s=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<t.length;i++){const a=t[i-1];s.push(`else if (yC < ${t[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const r=t.length,o=t[t.length-1];s.push(`else setOutput(getT${r}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gde{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Do(e,t);const s=this.outputShape,r=s.length,o=Kt(r),i=bs("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((w,C)=>`T${C}`);const l=new Array(e.length-1);l[0]=e[0][t];for(let w=1;w<l.length;w++)l[w]=l[w-1]+e[w][t];const u=a[t],d=a.slice(-2),f=a.join();let p=`if (${u} < ${l[0]}) {
        return getChannel(
            getT0(${f}), vec2(${d.join()}));
        }`;for(let w=1;w<l.length;w++){const C=l[w-1];p+=`
        if (${u} < ${l[w]}  && ${u} >= ${l[w-1]}) {
          return getChannel(
            getT${w}(${Gm(a,u,C)}),
            vec2(${Gm(d,u,C)}));
        }`}const y=l.length,v=l[l.length-1];p+=`
        return getChannel(
          getT${y}(${Gm(a,u,v)}),
          vec2(${Gm(d,u,v)}));`,this.userCode=`
      float getValue(${a.map(w=>"int "+w)}) {
        ${p}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function Gm(n,e,t){const s=n.indexOf(e);return n.map((o,i)=>i===s?`${o} - ${t}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l0(n){const{inputs:e,backend:t}=n,{input:s}=e,r=t.texData.get(s.dataId);return nr({inputs:{x:r.complexTensorInfos.imag},backend:t})}const Hde={kernelName:xy,backendName:"webgl",kernelFunc:l0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rf(n,e,t){const s=n[0].dtype;if(s==="complex64"){const f=n.map(C=>hp({inputs:{input:C},backend:t})),p=n.map(C=>l0({inputs:{input:C},backend:t})),y=rf(f,e,t),v=rf(p,e,t),w=Sa({inputs:{real:y,imag:v},backend:t});return f.forEach(C=>t.disposeIntermediateTensorInfo(C)),p.forEach(C=>t.disposeIntermediateTensorInfo(C)),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),w}let r=t.shouldExecuteOnCPU(n);if(s==="string"&&(r=!0),r){const f=n.map(b=>{const N=[-1,we(b.shape.slice(e))];return Ve({inputs:{x:b},backend:t,attrs:{shape:N}})}),p=f.map(b=>({vals:t.readSync(b.dataId),shape:b.shape})),y=Do(f.map(b=>b.shape),1),v=f[0].shape[0]===1,w=zle(p,y,s,v),C=Do(n.map(b=>b.shape),e),S=t.makeTensorInfo(C,s,w);return f.forEach(b=>t.disposeIntermediateTensorInfo(b)),S}const o=me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(n.length>o){const f=[];for(let y=0;y<n.length;y+=o){const v=n.slice(y,y+o);f.push(rf(v,e,t))}const p=rf(f,e,t);for(const y of f)t.disposeIntermediateTensorInfo(y);return p}if(me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].shape.length>1){const f=new Gde(n.map(p=>p.shape),e);return t.runWebGLProgram(f,n,s)}const{tensors2D:i,outShape:a}=qde(n,e,t),l=new Wde(i.map(f=>f.shape)),u=t.runWebGLProgram(l,i,s);i.forEach(f=>t.disposeIntermediateTensorInfo(f));const d=Ve({inputs:{x:u},attrs:{shape:a},backend:t});return t.disposeIntermediateTensorInfo(u),d}function qde(n,e,t){const s=Do(n.map(o=>o.shape),e);return{tensors2D:n.map(o=>Ve({inputs:{x:o},attrs:{shape:[-1,we(o.shape.slice(e))]},backend:t})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cD(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s,o=gt(r,e[0].shape)[0],i=e.map(u=>u.shape);yC(i,o);const a=Do(e.map(u=>u.shape),o);if(we(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(u=>we(u.shape)>0);return l.length===1?nr({inputs:{x:l[0]},backend:t}):rf(l,o,t)}const Kde={kernelName:Lf,backendName:"webgl",kernelFunc:cD};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dD{constructor(e,t=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,u=e.strideWidth,d=e.dilationHeight,f=e.dilationWidth,p=e.filterHeight,y=e.filterWidth,v=Math.floor(e.inChannels/4)*4,w=e.inChannels%4,C=e.dataFormat==="channelsLast",S=C?1:2,b=C?2:3,E=C?3:1;let N="",A="";s&&(r?N=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?N=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:N=`
          float activation(float x) {
            ${s}
          }
        `,A="result = activation(result);");const R=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${N}

      const ivec2 strides = ivec2(${l}, ${u});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${E}];

        ivec2 xRCCorner =
            ivec2(coords[${S}], coords[${b}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${d};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${y}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${v}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${C}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${w===1}) {

              if (${C}) {
                dotProd +=
                    getX(batch, xR, xC, ${v}) *
                    getW(wR, wC, ${v}, d2);
              } else {
                dotProd +=
                    getX(batch, ${v}, xR, xC) *
                    getW(wR, wC, ${v}, d2);
              }

            } else if (${w===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${v}, d2),
                getW(wR, wC, ${v} + 1, d2)
              );

              if (${C}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${v}),
                  getX(batch, xR, xC, ${v} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${v}, xR, xC),
                  getX(batch, ${v} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${w===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${v}, d2),
                getW(wR, wC, ${v} + 1, d2),
                getW(wR, wC, ${v} + 2, d2)
              );

              if (${C}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${v}),
                  getX(batch, xR, xC, ${v} + 1),
                  getX(batch, xR, xC, ${v} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${v}, xR, xC),
                  getX(batch, ${v} + 1, xR, xC),
                  getX(batch, ${v} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${R}
        ${A}
        setOutput(result);
      }
    `}}class Xde{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,u=e.dilationHeight,d=e.dilationWidth,f=e.filterDepth,p=e.filterHeight,y=e.filterWidth,v=Math.floor(e.inChannels/4)*4,w=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${t}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${y}; wC++) {
              int xC = xCCorner + wC * ${d};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${v}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${w===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${v}) *
                  getW(wF, wR, wC, ${v}, d2);
              } else if (${w===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${v}),
                  getX(batch, xF, xR, xC, ${v} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${v}, d2),
                  getW(wF, wR, wC, ${v} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${w===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${v}),
                  getX(batch, xF, xR, xC, ${v} + 1),
                  getX(batch, xF, xR, xC, ${v} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${v}, d2),
                  getW(wF, wR, wC, ${v} + 1, d2),
                  getW(wF, wR, wC, ${v} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fD{constructor(e,t=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Rs(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,f=d;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let C=0;C<d;C++)p+=`
           vec4 xTexelC${C*2};
           int xTexelC${C*2}Ready;
           vec4 xTexelC${C*2+1};
           int xTexelC${C*2+1}Ready;
           vec4 xC${C};`;p+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let C=0;C<d;C++)p+=`
           xTexelC${C*2} = vec4(0.0);
           xTexelC${C*2}Ready = 0;
           xTexelC${C*2+1} = vec4(0.0);
           xTexelC${C*2+1}Ready = 0;
           xC${C} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let C=0;C<(f+1)/2;C++){const S=C*2;if(p+=`
           xC = xCCorner + ${S*l};
           `,a===1){if(S<d&&(i%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }
               `,l===1&&S>0?p+=`
                 xC${S} = vec4(xTexelC${S-2}.zw, xTexelC${S}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${S} = vec4(previous.zw, xTexelC${S}.xy);
                   } else {
                     xC${S} = vec4(0.0, 0.0, xTexelC${S}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 xC${S} = xTexelC${S};
                 `,S+1<d)){const b=i%2===0?qg(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${b};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                     xTexelC${S+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${S+1}.zw = vec2(0.0);
                     }
                     xTexelC${S+1}Ready = 1;
                   }
                   `,l>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${S+1} = vec4(previous.zw, xTexelC${S+1}.xy);
                     } else {
                      xC${S+1} = vec4(0.0, 0.0, xTexelC${S+1}.xy);
                     }
                     `:p+=`
                     xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.xy);
                     `):b===1?p+=`
                     xC${S+1} = xTexelC${S};
                     `:p+=`
                     xCOffset = xC + ${b};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                       xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${S+1}.zw = vec2(0.0);
                       }
                       xTexelC${S+1}Ready = 1;
                     }

                     xC${S+1} = xTexelC${S+1};
                     `}}else S<d&&(i%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${S+1}Ready == 0) {
                   xTexelC${S+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${S+1}.zw = vec2(0.0);
                   }
                   xTexelC${S+1}Ready = 1;
                 }

                 xC${S} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
               `,S+1<d&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${S+1} = vec4(xTexelC${S+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                   xTexelC${S} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${S}.zw = vec2(0.0);
                   }
                   xTexelC${S}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                   xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${S+1}.zw = vec2(0.);
                   }
                   xTexelC${S+1}Ready = 1;
                 }

                 xC${S} = vec4(
                   xTexelC${S}.xy, xTexelC${S+1}.xy);
               `,S+1<d&&(p+=`
                   xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
                 `)));S<d&&(p+=`
             wTexel = getW(r, ${S}, d1, d2);
             dotProd += xC${S}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${S}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,S+1<d&&(p+=`
               wTexel = getW(r, ${S+1}, d1, d2);
               dotProd += xC${S+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${S+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let y="",v="";s&&(r?y=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:o?y=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:y=`vec4 activation(vec4 x) {
           ${s}
         }`,v="result = activation(result);");const w=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${y}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${w}
         ${v}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jde{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Rs(this.outputShape.length);const{dataFormat:s}=t,r=_s(),o=s==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let d=0;d<=1;d++)for(let f=0;f<=1;f++)u+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${d};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${d*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${d*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bg(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function hD({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=n.shape,u=s.texData.get(n.dataId),d=t.inChannels,f=l[0]*l[1]*l[2],p=t.outChannels,y=t.dataFormat==="channelsLast",v=!1,w=!1;let C;const S=[];if(o!=null){const N=Bg(o.shape,y);N!=null&&(o=Ve({inputs:{x:o},backend:s,attrs:{shape:N}}),S.push(o))}if(r!=null){const N=Bg(r.shape,y);N!=null&&(r=Ve({inputs:{x:r},backend:s,attrs:{shape:N}}),S.push(r))}if(!((f===1||p===1)&&d>oD)&&u.isPacked&&y&&u.texture!=null&&l[2]%2!==0&&Ct(u.shape.slice(-3),l.slice(-3))){const N=l[0]*l[1]*(l[2]+1),A={dataId:n.dataId,shape:[1,N,t.inChannels],dtype:n.dtype},R=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,B(Og(u.shape,A.shape),()=>`packed reshape ${u.shape} to ${A.shape} isn't free`);const L=Ve({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}});S.push(L);const z=Vg({a:A,b:L,backend:s,transposeA:v,transposeB:w,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),M=s.texData.get(z.dataId);B(M.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=R,M.shape=t.outShape,C=nr({inputs:{x:z},backend:s}),C.shape=t.outShape,S.push(z)}else{const N=t.outHeight*t.outWidth,A=Ve({inputs:{x:n},backend:s,attrs:{shape:y?[t.batchSize,N,t.inChannels]:[t.batchSize,t.inChannels,N]}}),R=Ve({inputs:{x:e},backend:s,attrs:{shape:[1,t.inChannels,t.outChannels]}}),L=Vg({a:y?A:R,b:y?R:A,transposeA:!y,transposeB:w,backend:s,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i});C=Ve({inputs:{x:L},backend:s,attrs:{shape:t.outShape}}),S.push(A),S.push(R),S.push(L)}for(const N of S)s.disposeIntermediateTensorInfo(N);return C}function pD({x:n,filter:e,convInfo:t,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:u,inChannels:d,outWidth:f,outHeight:p,dataFormat:y}=t,v=y==="channelsLast",w=l*u*d,C=p*f,S=[t.batchSize,w,C],b=!0,E=!1,N=[];if(o!=null){const J=Bg(o.shape,v);J!=null&&(o=Ve({inputs:{x:o},backend:s,attrs:{shape:J}}),N.push(o))}if(r!=null){const J=Bg(r.shape,v);J!=null&&(r=Ve({inputs:{x:r},backend:s,attrs:{shape:J}}),N.push(r))}const A=Ve({inputs:{x:e},backend:s,attrs:{shape:[1,w,we(e.shape)/w]}});N.push(A);const R=new Jde(S,t),L=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],z=s.runWebGLProgram(R,[n],"float32",L),M=Ve({inputs:{x:z},backend:s,attrs:{shape:S}});N.push(z),N.push(M);const P=r!=null,F=o!=null,q=a==="leakyrelu",ee=a?Tf(a,!0):null,ue=new rD(v?M.shape:A.shape,v?A.shape:M.shape,v?[t.batchSize,C,t.outChannels]:[t.batchSize,t.outChannels,C],b,E,P,ee,F,q),ie=v?[M,A]:[A,M];if(r&&ie.push(r),F&&ie.push(o),q){const J=s.makeTensorInfo([],"float32",Ci(i,"float32"));ie.push(J),N.push(J)}const de=s.runWebGLProgram(ue,ie,"float32"),ae=Ve({inputs:{x:de},backend:s,attrs:{shape:t.outShape}});N.push(de);for(const J of N)s.disposeIntermediateTensorInfo(J);return ae}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yde(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:u,dimRoundingMode:d}=s,f=Si(l),p=Gn(r.shape,o.shape,i,u,a,d,!1,f);let y;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))y=hD({x:r,filter:o,convInfo:p,backend:t});else if(p.strideWidth<=2&&f==="channelsLast"&&me().getBool("WEBGL_EXP_CONV")){const w=new fD(p),C=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];y=t.runWebGLProgram(w,[r,o],"float32",C)}else if(me().getBool("WEBGL_CONV_IM2COL"))y=pD({x:r,filter:o,convInfo:p,backend:t});else{const w=new dD(p);y=t.runWebGLProgram(w,[r,o],"float32")}const v=Ve({inputs:{x:y},backend:t,attrs:{shape:p.outShape}});return t.disposeIntermediateTensorInfo(y),v}const Qde={kernelName:Of,backendName:"webgl",kernelFunc:Yde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zde{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${i}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class jde{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,l=s-1-e.padInfo.left,u=i?1:2,d=i?2:3,f=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${d}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class efe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class tfe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=t-1-e.padInfo.front,u=s-1-e.padInfo.top,d=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${u}, ${d});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:u,filterShape:d}=s,f=Si(l),p=Gn(r.shape,d,i,1,a,u,!1,f),y=new Zde(p);return t.runWebGLProgram(y,[r,o],"float32")}const sfe={kernelName:ty,backendName:"webgl",kernelFunc:nfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rfe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:u,dimRoundingMode:d}=s,f=Si(u),p=Gn(i,o.shape,a,1,l,d,!1,f),y=new jde(p);return t.runWebGLProgram(y,[r,o],"float32")}const ofe={kernelName:Vf,backendName:"webgl",kernelFunc:rfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ife(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,u=ya(r.shape,o.shape,i,l,a),d=new Xde(u);return t.runWebGLProgram(d,[r,o],"float32")}const afe={kernelName:Bf,backendName:"webgl",kernelFunc:ife};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s,u=ya(r.shape,l,i,1,a),d=new efe(u);return t.runWebGLProgram(d,[r,o],"float32")}const ufe={kernelName:ny,backendName:"webgl",kernelFunc:lfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cfe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s,u=ya(l,o.shape,a,1,i),d=new tfe(u);return t.runWebGLProgram(d,[r,o],"float32")}const dfe={kernelName:sy,backendName:"webgl",kernelFunc:cfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ffe=ld+`
  return cos(x);
`,hfe=$t({opSnippet:ffe}),pfe={kernelName:ic,backendName:"webgl",kernelFunc:hfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mfe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,gfe=$t({opSnippet:mfe}),yfe={kernelName:ac,backendName:"webgl",kernelFunc:gfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xfe{constructor(e,t,s,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,u]=e,[d]=t,[f,p]=s;this.outputShape=[d,f,p,u];const y=r==="bilinear"?1:0,[v,w]=[`${a-1}.0`,`${l-1}.0`],[C,S,b]=f>1?[`${(a-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${v} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${v}`],[E,N,A]=p>1?[`${(l-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${w} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${w}`];this.userCode=`
      const float height_ratio = float(${C});
      const float width_ratio = float(${E});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${S};
        float width_scale = ${N};

        float in_y = ${b};
        if( in_y < 0.0 || in_y > ${v} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${A};
        if( in_x < 0.0 || in_x > ${w} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${y} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vfe=n=>{const{inputs:e,backend:t,attrs:s}=n,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:u}=s,d=new xfe(r.shape,o.shape,a,l,u);return t.runWebGLProgram(d,[r,o,i],"float32")},wfe={kernelName:oy,backendName:"webgl",kernelFunc:vfe};var bf;(function(n){n.Prod="*",n.Sum="+"})(bf||(bf={}));class jN{constructor(e,t,s,r){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===bf.Prod?"1.0":"0.0",a=s?i:`getX(${eE(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let u="",d="";s?(u=r?`end != ${l-1}`:"end != 0",d=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${l}`:"end >= pow2",d=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Kt(o)} coords = getOutputCoords();
        int end = ${tE(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${d};
          ${tE(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${eE(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function eE(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function tE(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mD(n,e,t,s,r,o){const i=e.shape.length,a=hn([s],i);let l=e;a!=null&&(l=$s({inputs:{x:e},backend:t,attrs:{perm:a}}));const u=Cn(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const d=l.shape[u];let f=nr({inputs:{x:l},backend:t});for(let p=0;p<=Math.ceil(Math.log2(d))-1;p++){const y=new jN(n,l.shape,!1,o),v=[[p]],w=f;f=t.runWebGLProgram(y,[f],f.dtype,v),t.disposeIntermediateTensorInfo(w)}if(r){const p=new jN(n,l.shape,r,o),y=f;f=t.runWebGLProgram(p,[f],f.dtype),t.disposeIntermediateTensorInfo(y)}if(a!=null){const p=xa(a),y=$s({inputs:{x:f},backend:t,attrs:{perm:p}});return t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(l),y}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return mD(bf.Prod,r,t,o,i,a)}const Tfe={kernelName:ry,backendName:"webgl",kernelFunc:Cfe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sfe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return mD(bf.Sum,r,t,o,i,a)}const bfe={kernelName:zf,backendName:"webgl",kernelFunc:Sfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ife(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=t.readSync(r.dataId),u=t.readSync(o.dataId),d=J4(l,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,d)}else if(r.shape.length===2){const l=t.bufferSync(r),u=t.bufferSync(o),d=Ole(l,u,i,a);return t.makeTensorInfo(d.shape,o.dtype,d.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const kfe={kernelName:iy,backendName:"webgl",kernelFunc:Ife};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nfe{constructor(e,t,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Efe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockSize:o,dataFormat:i}=s,a=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],u=i==="NHWC"?r.shape[2]:r.shape[3],d=i==="NHWC"?r.shape[3]:r.shape[1],f=l*o,p=u*o,y=d/(o*o),v=i==="NHWC"?[a,f,p,y]:[a,y,f,p],w=new Nfe(v,o,i);return t.runWebGLProgram(w,[r],r.dtype)}const $fe={kernelName:ay,backendName:"webgl",kernelFunc:Efe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gD{constructor(e,t=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Rs(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let u="",d="";s&&(r?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,d="result = activation(result);");const f=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${d}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yD{constructor(e,t=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Rs(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,u=e.dilationWidth,d=e.filterHeight,f=e.filterWidth,p=f;let y=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let S=0;S<f;S++)y+=`
          vec4 xTexelC${S*2};
          int xTexelC${S*2}Ready;
          vec4 xTexelC${S*2+1};
          int xTexelC${S*2+1}Ready;
          vec4 xC${S};`;y+=`
    for (int r = 0; r < ${d}; r++) {
      `;for(let S=0;S<f;S++)y+=`
          xTexelC${S*2} = vec4(0.0);
          xTexelC${S*2}Ready = 0;
          xTexelC${S*2+1} = vec4(0.0);
          xTexelC${S*2+1}Ready = 0;
          xC${S} = vec4(0.0);`;y+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let S=0;S<(p+1)/2;S++){const b=S*2;if(y+=`
          xC = xCCorner + ${b*u};
          `,l===1){if(b<f&&(a%2===1?(y+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }
              `,u===1&&b>0?y+=`
                xC${b} = vec4(xTexelC${b-2}.zw, xTexelC${b}.xy);
                `:y+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${b} = vec4(previous.zw, xTexelC${b}.xy);
                  } else {
                    xC${b} = vec4(0.0, 0.0, xTexelC${b}.xy);
                  }
                  `):y+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xC${b} = xTexelC${b};
                `,b+1<f)){const E=a%2===0?qg(u):u;u%2===0&&a%2===1||u%2!==0&&a%2!==1?(y+=`
                  xCOffset = xC + imod(pads[1], 2) + ${E};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                    xTexelC${b+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${b+1}.zw = vec2(0.0);
                    }
                    xTexelC${b+1}Ready = 1;
                  }
                  `,u>1?y+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${b+1} = vec4(previous.zw, xTexelC${b+1}.xy);
                    } else {
                     xC${b+1} = vec4(0.0, 0.0, xTexelC${b+1}.xy);
                    }
                    `:y+=`
                    xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.xy);
                    `):E===1?y+=`
                    xC${b+1} = xTexelC${b};
                    `:y+=`
                    xCOffset = xC + ${E};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                      xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${b+1}.zw = vec2(0.0);
                      }
                      xTexelC${b+1}Ready = 1;
                    }

                    xC${b+1} = xTexelC${b+1};
                    `}}else b<f&&(a%2===1?(y+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.0);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
              `,b+1<f&&(y+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${b+1} = vec4(xTexelC${b+1}.xy, final.xy);
                `)):(y+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${b}Ready == 0) {
                  xTexelC${b} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${b}.zw = vec2(0.0);
                  }
                  xTexelC${b}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${b+1}Ready == 0) {
                  xTexelC${b+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${b+1}.zw = vec2(0.);
                  }
                  xTexelC${b+1}Ready = 1;
                }

                xC${b} = vec4(
                  xTexelC${b}.xy, xTexelC${b+1}.xy);
              `,b+1<f&&(y+=`
                  xC${b+1} = vec4(xTexelC${b}.zw, xTexelC${b+1}.zw);
                `)));b<f&&(y+=`
            wTexel = getW(r, ${b}, d1, q);
            dotProd += xC${b} * vec4(wTexel.xz, wTexel.xz);
          `,b+1<f&&(y+=`
              wTexel = getW(r, ${b+1}, d1, q);
              dotProd += xC${b+1} * vec4(wTexel.xz, wTexel.xz);
            `))}y+=`
    }
  `,y+=`
      }
    `;let v="",w="";s&&(r?v=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?v=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:v=`vec4 activation(vec4 x) {
          ${s}
        }`,w="result = activation(result);");const C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${y}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${C}
        ${w}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Afe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:u}=s;let d=l;d==null&&(d=[1,1]),B(ss(i,d),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${d}'`);const f=Gn(r.shape,o.shape,i,d,a,u,!0);let p;me().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?p=new yD(f):p=new gD(f);const y=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return t.runWebGLProgram(p,[r,o],"float32",y)}const _fe={kernelName:Uf,backendName:"webgl",kernelFunc:Afe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rfe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Dfe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ffe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,filterShape:d}=s,f=Gn(r.shape,d,i,a,l,u,!0),p=new Rfe(f);return t.runWebGLProgram(p,[r,o],"float32")}const Mfe={kernelName:ly,backendName:"webgl",kernelFunc:Ffe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pfe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:u,inputShape:d}=s,f=Gn(d,o.shape,i,a,l,u,!0),p=new Dfe(f);return t.runWebGLProgram(p,[r,o],"float32")}const Lfe={kernelName:uy,backendName:"webgl",kernelFunc:Pfe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ofe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vfe(n){const{inputs:e,backend:t}=n,{x:s}=e,r=[...s.shape,...s.shape],o=we(s.shape),i=Ve({inputs:{x:s},backend:t,attrs:{shape:[o]}}),a=new Ofe(o),l=t.runWebGLProgram(a,[i],i.dtype),u=Ve({inputs:{x:l},backend:t,attrs:{shape:r}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(l),u}const Bfe={kernelName:cy,backendName:"webgl",kernelFunc:Vfe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zfe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:s,padInfo:r,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:u,dilationWidth:d}=e,{top:f,left:p}=r;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${f}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${d};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ufe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,u=Rh(r.shape,o.shape,i,a,"NHWC",l);let d;const f=new zfe(u);d=t.runWebGLProgram(f,[r,o],"float32");const p=Ve({inputs:{x:d},backend:t,attrs:{shape:u.outShape}});return t.disposeIntermediateTensorInfo(d),p}const Wfe={kernelName:Wf,backendName:"webgl",kernelFunc:Ufe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gfe(n){const{inputs:e,backend:t,attrs:s}=n,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=$C(r,o.length);_C(i.length,l,o);const{path:u,steps:d}=RC(a,l),f=d.length;let p=null,y=i.length;const v=[];for(let w=0;w<f;++w){for(const C of d[w]){const{permutationIndices:S,expandDims:b}=AC(y,l[C]);let E;DC(S)?E=o[C]:(E=$s({inputs:{x:o[C]},backend:t,attrs:{perm:S}}),v.push(E));const N=E.shape.slice();for(let A=0;A<b.length;++A)N.splice(b[A],0,1);Ct(E.shape,N)||(E=Ve({inputs:{x:E},backend:t,attrs:{shape:N}}),v.push(E)),p===null?p=E:(p=bT({inputs:{a:E,b:p},backend:t}),v.push(p))}w<f-1&&(u[w]>=0&&(p=a0({inputs:{x:p},backend:t,attrs:{axis:u[w]-(i.length-y),keepDims:!1}}),v.push(p)),y--)}for(const w of v)w!==p&&t.disposeIntermediateTensorInfo(w);return p}const Hfe={kernelName:dy,backendName:"webgl",kernelFunc:Gfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qfe="return (x >= 0.0) ? x : (exp(x) - 1.0);",Kfe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,Xfe=$t({opSnippet:qfe,packedOpSnippet:Kfe}),Jfe={kernelName:uc,backendName:"webgl",kernelFunc:Xfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yfe="return (b >= 1.0) ? a : a * (b + 1.0);",Qfe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Zfe=n=>{const{inputs:e,backend:t}=n,{dy:s,y:r}=e,o=me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new fp(Qfe,s.shape,r.shape):new Gu(Yfe,s.shape,r.shape);return t.runWebGLProgram(o,[s,r],s.dtype)},jfe={kernelName:fy,backendName:"webgl",kernelFunc:Zfe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ehe=`
  return vec4(equal(a, b));
`,the="return float(a == b);",nhe=os({opSnippet:the,packedOpSnippet:ehe,dtype:"bool",cpuKernelImpl:Ule}),she={kernelName:Gf,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rhe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${TC};
  float a1 = ${SC};
  float a2 = ${bC};
  float a3 = ${IC};
  float a4 = ${kC};
  float a5 = ${NC};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,ohe=$t({opSnippet:rhe}),ihe={kernelName:cc,backendName:"webgl",kernelFunc:ohe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ahe=ld+`
  return exp(x);
`,lhe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,xD=$t({opSnippet:ahe,packedOpSnippet:lhe,cpuKernelImpl:Wle,dtype:"float32"}),uhe={kernelName:dc,backendName:"webgl",kernelFunc:xD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k2(n){const{inputs:e,attrs:t,backend:s}=n,{dim:r}=t,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=r;return r<0&&(B(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),a.splice(l,0,1),Ve({inputs:{x:o},backend:s,attrs:{shape:a}})}const che={kernelName:Hf,backendName:"webgl",kernelFunc:k2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nE="return exp(x) - 1.0;",dhe=$t({opSnippet:nE,packedOpSnippet:nE,cpuKernelImpl:Gle}),fhe={kernelName:fc,backendName:"webgl",kernelFunc:dhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sE{constructor(e,t,s){this.variableNames=["real","imag"];const r=t[1];this.outputShape=t;const o=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vD(n,e,t){const s=t.texData.get(n.dataId),r=we(n.shape),o=n.shape[n.shape.length-1],i=r/o,a=Ve({inputs:{x:n},backend:t,attrs:{shape:[i,o]}}),l=a.shape,u=new sE("real",l,e),d=new sE("imag",l,e),f=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],p=t.runWebGLProgram(u,f,"float32"),y=t.runWebGLProgram(d,f,"float32"),v=Sa({inputs:{real:p,imag:y},backend:t});t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(y);const w=Ve({inputs:{x:v},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(v),w}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hhe(n){const{inputs:e,backend:t}=n,{input:s}=e;return vD(s,!1,t)}const phe={kernelName:hy,backendName:"webgl",kernelFunc:hhe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mhe{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pp(n){const{backend:e,attrs:t}=n,{shape:s,value:r}=t;let{dtype:o}=t;if(o=o||Ju(r),o==="string"){const i=Rn(o,we(s));return i.fill(r),e.makeTensorInfo(s,o,i)}else{const i=new mhe(s,r),a=[[r]];return e.runWebGLProgram(i,[],o,a)}}const ghe={kernelName:py,backendName:"webgl",kernelFunc:pp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yhe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xhe={kernelName:my,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,s=e,r=new yhe(t.shape);return s.runWebGLProgram(r,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rE="return floor(x);",vhe=$t({opSnippet:rE,packedOpSnippet:rE,cpuKernelImpl:Hle}),whe={kernelName:hc,backendName:"webgl",kernelFunc:vhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Che=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,The=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,She=os({opSnippet:Che,packedOpSnippet:The,dtype:"int32"}),bhe={kernelName:pc,backendName:"webgl",kernelFunc:She};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ihe{constructor(e){this.variableNames=["A"];const t=_s(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class khe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=_s(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe={kernelName:pg,backendName:"webgl",kernelFunc:Ehe};let vu,xv=me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Ehe(n){const{inputs:e,backend:t,attrs:s}=n;let{pixels:r}=e;const{numChannels:o}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,u]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],d=[u,l],f=[u,l,o];if(a||i){const w=me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(vu==null||w!==xv)&&(xv=w,vu=document.createElement("canvas").getContext("2d",{willReadFrequently:xv})),vu.canvas.width=l,vu.canvas.height=u,vu.drawImage(r,0,0,l,u),r=vu.canvas}const p=t.makeTensorInfo(d,"int32");t.texData.get(p.dataId).usage=mr.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(p.dataId),r);const y=me().getBool("WEBGL_PACK")?new khe(f):new Ihe(f),v=t.runWebGLProgram(y,[p],"int32");return t.disposeData(p.dataId),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $he(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dataFormat:d,dilations:f,dimRoundingMode:p,activation:y,leakyreluAlpha:v}=s,w=Si(d),C=Gn(r.shape,o.shape,l,f,u,p,!1,w);let S;const b=[],E=i!=null,N=a!=null,A=y==="leakyrelu",R=()=>{const z=[r,o],M=(P,F)=>{if(F==="NCHW"&&P.shape.length===1&&P.shape[0]!==1){const q=Ve({inputs:{x:P},backend:t,attrs:{shape:[P.shape[0],1,1]}});return b.push(q),q}return P};if(E&&z.push(M(i,d)),N&&z.push(M(a,d)),A){const P=t.makeTensorInfo([],"float32",Ci(v,"float32"));z.push(P),b.push(P)}return z};if(C.filterHeight===1&&C.filterWidth===1&&C.dilationHeight===1&&C.dilationWidth===1&&C.strideHeight===1&&C.strideWidth===1&&(C.padInfo.type==="SAME"||C.padInfo.type==="VALID"))S=hD({x:r,filter:o,convInfo:C,backend:t,bias:i,activation:y,preluActivationWeights:a,leakyreluAlpha:v});else if(C.strideWidth<=2&&w==="channelsLast"&&me().getBool("WEBGL_EXP_CONV")){const z=y?Tf(y,!0):null,M=new fD(C,E,z,N,A),P=[[C.padInfo.top,C.padInfo.left],[C.strideHeight,C.strideWidth],[C.dilationHeight,C.dilationWidth],[C.inHeight,C.inWidth]],F=R();S=t.runWebGLProgram(M,F,"float32",P)}else if(me().getBool("WEBGL_CONV_IM2COL"))S=pD({x:r,filter:o,convInfo:C,backend:t,bias:i,activation:y,preluActivationWeights:a,leakyreluAlpha:v});else{const z=y?Tf(y,!1):null,M=new dD(C,E,z,N,A),P=R();S=t.runWebGLProgram(M,P,"float32")}const L=Ve({inputs:{x:S},backend:t,attrs:{shape:C.outShape}});return b.push(S),b.forEach(z=>t.disposeIntermediateTensorInfo(z)),L}const Ahe={kernelName:uf,backendName:"webgl",kernelFunc:$he};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _he(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:u,dilations:d,dimRoundingMode:f,activation:p,leakyreluAlpha:y}=s,v=[];let w=d;w==null&&(w=[1,1]),B(ss(l,w),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${w}'`);const C=Gn(r.shape,o.shape,l,w,u,f,!0),S=me().getBool("WEBGL_PACK_DEPTHWISECONV")&&C.strideWidth<=2&&C.outChannels/C.inChannels===1,b=p?Tf(p,S):null,E=[r,o],N=i!=null,A=a!=null,R=p==="leakyrelu";if(N&&E.push(i),A&&E.push(a),R){const P=t.makeTensorInfo([],"float32",Ci(y,"float32"));E.push(P),v.push(P)}let L;S?L=new yD(C,N,b,A,R):L=new gD(C,N,b,A,R);const z=[[C.padInfo.top,C.padInfo.left],[C.strideHeight,C.strideWidth],[C.dilationHeight,C.dilationWidth],[C.inHeight,C.inWidth]],M=t.runWebGLProgram(L,E,"float32",z);return v.forEach(P=>t.disposeIntermediateTensorInfo(P)),M}const Rhe={kernelName:cf,backendName:"webgl",kernelFunc:_he};class Dhe{constructor(e,t,s,r){this.sliceDim=e,this.strides=t,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const o=Kt(s.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fhe(n){const{inputs:e,backend:t}=n,{params:s,indices:r}=e,o=r.shape,i=o[o.length-1],a=we(s.shape),[l,u,d,f]=jy(s,r),p=Ve({inputs:{x:r},backend:t,attrs:{shape:[u,i]}}),y=Ve({inputs:{x:s},backend:t,attrs:{shape:[we(s.shape)/d,d]}});if(t.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const S=t.readSync(r.dataId),b=t.bufferSync(s),E=qle(S,b,s.dtype,u,i,d,f,s.shape,a);return t.makeTensorInfo(l,s.dtype,E.values)}const v=new Dhe(i,f,[u,d],s.shape),w=t.runWebGLProgram(v,[y,p],y.dtype),C=Ve({inputs:{x:w},backend:t,attrs:{shape:l}});return t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(w),C}const Mhe={kernelName:gy,backendName:"webgl",kernelFunc:Fhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Phe{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const s=Kt(this.rank),r=Lhe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function Lhe(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<n.length;r++)r===2?s.push("index"):s.push(`${t[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wD(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,indices:o}=e,{axis:i,batchDims:a}=s,l=gt(i,r.shape)[0];if(me().get("DEBUG")){const b=t.readSync(o.dataId),E=r.shape[l];for(let N=0;N<b.length;++N){const A=b[N];B(A<=E-1&&A>=0,()=>`GatherV2: the index value ${A} is not in [0, ${E-1}]`)}}const u=MC(r,o,l,a),d=we(o.shape),f=[],p=Ve({inputs:{x:r},backend:t,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),y=Ve({inputs:{x:o},backend:t,attrs:{shape:[u.batchSize,d/u.batchSize]}});f.push(p),f.push(y);const v=[u.batchSize,u.outerSize,d/u.batchSize,u.sliceSize];if(t.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const b=t.bufferSync(y),E=t.bufferSync(p),N=Kle(E,b,v);return f.forEach(A=>t.disposeIntermediateTensorInfo(A)),t.makeTensorInfo(u.outputShape,N.dtype,N.values)}const w=new Phe(p.shape,v),C=t.runWebGLProgram(w,[p,y],p.dtype);f.push(C);const S=Ve({inputs:{x:C},backend:t,attrs:{shape:u.outputShape}});return f.forEach(b=>t.disposeIntermediateTensorInfo(b)),S}const Ohe={kernelName:Kf,backendName:"webgl",kernelFunc:wD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vhe="return float(a > b);",Bhe=`
  return vec4(greaterThan(a, b));
`,zhe=os({opSnippet:Vhe,packedOpSnippet:Bhe,cpuKernelImpl:Xle,dtype:"bool"}),Uhe={kernelName:Xf,backendName:"webgl",kernelFunc:zhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Whe="return float(a >= b);",Ghe=`
  return vec4(greaterThanEqual(a, b));
`,Hhe=os({opSnippet:Whe,packedOpSnippet:Ghe,dtype:"bool",cpuKernelImpl:Jle}),qhe={kernelName:mc,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Khe(n){const{inputs:e,backend:t}=n,{input:s}=e;return vD(s,!0,t)}const Xhe={kernelName:yy,backendName:"webgl",kernelFunc:Khe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jhe="return float(!isnan(x) && !isinf(x));",Yhe=$t({opSnippet:Jhe,dtype:"bool"}),Qhe={kernelName:yc,backendName:"webgl",kernelFunc:Yhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zhe="return float(isinf(x));",jhe=$t({opSnippet:Zhe,dtype:"bool"}),epe={kernelName:xc,backendName:"webgl",kernelFunc:jhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tpe="return float(isnan(x));",npe=$t({opSnippet:tpe,dtype:"bool"}),spe={kernelName:vc,backendName:"webgl",kernelFunc:npe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rpe="return float(a < b);",ope=`
  return vec4(lessThan(a, b));
`,ipe=os({opSnippet:rpe,packedOpSnippet:ope,cpuKernelImpl:Yle,dtype:"bool"}),ape={kernelName:Yf,backendName:"webgl",kernelFunc:ipe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lpe="return float(a <= b);",upe=`
  return vec4(lessThanEqual(a, b));
`,cpe=os({opSnippet:lpe,packedOpSnippet:upe,cpuKernelImpl:Qle,dtype:"bool"}),dpe={kernelName:Qf,backendName:"webgl",kernelFunc:cpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fpe(n){const{backend:e,attrs:t}=n,{start:s,stop:r,num:o}=t,i=Zle(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const hpe={kernelName:vy,backendName:"webgl",kernelFunc:fpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ppe=ld+`
  return x < 0.0 ? 0./0. : log(x);
`,mpe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,gpe=$t({opSnippet:ppe,packedOpSnippet:mpe,cpuKernelImpl:jle}),ype={kernelName:wc,backendName:"webgl",kernelFunc:gpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xpe=ld+`
  return log(1.0 + x);
`,vpe=$t({opSnippet:xpe}),wpe={kernelName:Cc,backendName:"webgl",kernelFunc:vpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cpe="return float(a >= 1.0 && b >= 1.0);",Tpe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Spe=os({opSnippet:Cpe,packedOpSnippet:Tpe,dtype:"bool"}),bpe={kernelName:Zf,backendName:"webgl",kernelFunc:Spe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ipe="return float(!(x >= 1.0));",kpe=$t({opSnippet:Ipe}),Npe={kernelName:jf,backendName:"webgl",kernelFunc:kpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Epe="return float(a >= 1.0 || b >= 1.0);",$pe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,Ape=os({opSnippet:Epe,packedOpSnippet:$pe,dtype:"bool"}),_pe={kernelName:eh,backendName:"webgl",kernelFunc:Ape};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rpe{constructor(e,t,s,r,o){this.variableNames=["x"],this.outputShape=[];const i=t,a=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dpe{constructor(e,t,s,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,a=e[3]-1;this.outputShape=e;let l;const u=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${u})`:o===1?l=`1.0/(${u})`:l=`exp(log(${u}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fpe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s,u=me().getBool("WEBGL_PACK_NORMALIZATION")?new Dpe(r.shape,o,i,a,l):new Rpe(r.shape,o,i,a,l);return t.runWebGLProgram(u,[r],r.dtype)},Mpe={kernelName:th,backendName:"webgl",kernelFunc:Fpe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ppe{constructor(e,t,s,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=s,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${o})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lpe=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:u,beta:d}=s,f=new Ppe(r.shape,a,l,u,d);return t.runWebGLProgram(f,[r,o,i],r.dtype)},Ope={kernelName:wy,backendName:"webgl",kernelFunc:Lpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vpe(n,e,t,s){const r=we(e),i=we(n.shape)/r,a=Ve({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),l=Pl(a,n.dtype,"max",s),u=Ve({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CD(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=r.shape.length,l=gt(o,r.shape);let u=l;const d=hn(u,a),f=d!=null,p=t.shouldExecuteOnCPU([r]);let y=r;if(f){if(p){const E=t.texData.get(y.dataId).values,N=new Array(a);for(let L=0;L<N.length;L++)N[L]=r.shape[d[L]];const A=TT(E,r.shape,r.dtype,d,N);y=t.makeTensorInfo(N,r.dtype);const R=t.texData.get(y.dataId);R.values=A}else y=i0(r,d,t);u=Cn(u.length,a)}rs("max",u,a);const[v,w]=Hn(y.shape,u);let C=v;i&&(C=wn(v,l));let S;if(p){const E=t.texData.get(y.dataId).values,N=eue(E,we(w),C,r.dtype);S=t.makeTensorInfo(C,r.dtype);const A=t.texData.get(S.dataId);A.values=N}else S=Vpe(y,w,C,t);return f&&t.disposeIntermediateTensorInfo(y),S}const Bpe={kernelName:nh,backendName:"webgl",kernelFunc:CD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zpe=ST+`
  return max(a, b);
`,Upe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+dp+`
  return result;
`,Wpe=os({opSnippet:zpe,packedOpSnippet:Upe,cpuKernelImpl:tue}),Gpe={kernelName:Tc,backendName:"webgl",kernelFunc:Wpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hpe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e;up(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,u=1;B(ss(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=Ur(r.shape,o,i,u,a,l);if(d.filterWidth===1&&d.filterHeight===1&&Ct(d.inShape,d.outShape))return nr({inputs:{x:r},backend:t});const f=new Sf(d,"max",!1);return t.runWebGLProgram(f,[r],r.dtype)}const qpe={kernelName:sh,backendName:"webgl",kernelFunc:Hpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kpe(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:u}=s,d=[1,1,1],f=Ti(r.shape,o,i,d,a,u,l),p=new IT(f,"max",!1);return t.runWebGLProgram(p,[r],r.dtype)}const Xpe={kernelName:rh,backendName:"webgl",kernelFunc:Kpe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jpe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,u=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class Ype{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,f=l-1-e.padInfo.front,p=u-1-e.padInfo.top,y=d-1-e.padInfo.left,v=l*u*d-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${p}, ${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${d};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${v} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${d} +
                  wR * ${d} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qpe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:u,dimRoundingMode:d}=s,f=[1,1,1],p=Ti(i.shape,a,l,f,u,d),y=new IT(p,"max",!0),v=t.runWebGLProgram(y,[i],i.dtype),w=new Ype(p),C=t.runWebGLProgram(w,[r,v],i.dtype);return t.disposeIntermediateTensorInfo(v),C}const Zpe={kernelName:Ty,backendName:"webgl",kernelFunc:Qpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jpe(n){const{inputs:e,backend:t,attrs:s}=n,{dy:r,input:o,output:i}=e,a=o;up([o,i],"maxPoolGrad");const{filterSize:l,strides:u,pad:d,dimRoundingMode:f}=s,p=Ur(a.shape,l,u,1,d,f),y=!0,v=new Sf(p,"max",y),w=t.runWebGLProgram(v,[a],a.dtype),C=new Jpe(p),S=t.runWebGLProgram(C,[r,w],a.dtype);return t.disposeIntermediateTensorInfo(w),S}const eme={kernelName:Cy,backendName:"webgl",kernelFunc:jpe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tme(n,e,t,s){let r=new Sf(t,"max",!1);const o=s.runWebGLProgram(r,[n],"float32");r=new Sf(t,"max",!0,!0,e);const i=s.runWebGLProgram(r,[n],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nme={kernelName:Sy,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=t;B(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];B(ss(o,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${u}'`);const d=Ur(s.shape,r,o,u,i),[f,p]=tme(s,a,d,l);return[f,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sme(n,e,t,s){const r=we(e),i=we(n.shape)/r,a=Ve({inputs:{x:n},attrs:{shape:[i,r]},backend:s}),l=Pl(a,"float32","mean",s),u=Ve({inputs:{x:l},attrs:{shape:t},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rme={kernelName:oh,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:s}=n,{keepDims:r,axis:o}=e,i=t,a=s.shape.length,l=gt(o,s.shape);let u=l;const d=hn(u,a),f=d!=null,p=i.shouldExecuteOnCPU([s]),y=[];let v=s;if(f){if(p){const N=i.texData.get(v.dataId).values,A=new Array(a);for(let z=0;z<A.length;z++)A[z]=s.shape[d[z]];const R=TT(N,s.shape,s.dtype,d,A);v=i.makeTensorInfo(A,s.dtype);const L=i.texData.get(v.dataId);L.values=R}else v=i0(s,d,i);y.push(v),u=Cn(u.length,a)}rs("sum",u,a);const[w,C]=Hn(v.shape,u);let S=w;r&&(S=wn(w,l));const b=sme(v,C,S,i);for(const E of y)i.disposeIntermediateTensorInfo(E);return b}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ome(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=gt(o,r.shape);let u=l;const d=hn(u,a);let f=r;d!=null&&(f=$s({inputs:{x:r},backend:t,attrs:{perm:d}}),u=Cn(u.length,r.shape.length)),rs("min",u,a);const[p,y]=Hn(f.shape,u),v=we(y),w=Ve({inputs:{x:f},backend:t,attrs:{shape:[-1,v]}}),C=Pl(w,w.dtype,"min",t);let S;if(i){const b=wn(p,l);S=Ve({inputs:{x:C},backend:t,attrs:{shape:b}})}else S=Ve({inputs:{x:C},backend:t,attrs:{shape:p}});return t.disposeIntermediateTensorInfo(w),t.disposeIntermediateTensorInfo(C),d!=null&&t.disposeIntermediateTensorInfo(f),S}const ime={kernelName:ih,backendName:"webgl",kernelFunc:ome};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ame=ST+`
  return min(a, b);
`,lme=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+dp+`
  return result;
`,ume=os({opSnippet:ame,packedOpSnippet:lme,cpuKernelImpl:nue}),cme={kernelName:Sc,backendName:"webgl",kernelFunc:ume};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dme{constructor(e,t,s){this.variableNames=["x"],this.outputShape=t.map((d,f)=>d[0]+e[f]+d[1]);const r=e.length,o=Kt(r),i=t.map(d=>d[0]).join(","),a=t.map((d,f)=>d[0]+e[f]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fme{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((v,w)=>v[0]+e[w]+v[1]);const r=e.length,o=Kt(r),i=t.map(v=>v[0]).join(","),a=t.map((v,w)=>v[0]+e[w]).join(","),l=bs("rc",r),u=bs("source",r),d=`${l[r-1]} < ${this.outputShape[r-1]}`,f=r===1?"source":`vec2(${u.slice(-2).join()})`,p=s==="reflect"?0:1;let y="";if(r===1){const v=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;y=`
        ${o} rc = outputLoc;
        ${v}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[r-1]} += 1;
        if(${d}) {
          ${v}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
      `}else{const v=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;y=`
        ${o} rc = outputLoc;
        ${v}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${l[r-1]} += 1;
        if(${d}) {
          ${v}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${v}
          result[2] = getChannel(getX(${u.join()}), ${f});
          ${l[r-1]} += 1;
          if(${d}) {
            ${v}
            result[3] = getChannel(getX(${u.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hme=({inputs:n,backend:e,attrs:t})=>{const{x:s}=n,{paddings:r,mode:o}=t,i=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new fme(s.shape,r,o):new dme(s.shape,r,o);return e.runWebGLProgram(i,[s],s.dtype)},pme={kernelName:ah,backendName:"webgl",kernelFunc:hme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mme=`if (b == 0.0) return NAN;
  return mod(a, b);`,gme=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+dp+`
  return result;
`,yme=os({opSnippet:mme,packedOpSnippet:gme}),xme={kernelName:bc,backendName:"webgl",kernelFunc:yme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vme{constructor(e,t,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wme=`
if (a == b) {
  return 1.0;
};
return a / b;`,Cme=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,TD=os({opSnippet:wme,packedOpSnippet:Cme,checkOutOfBounds:!0}),Tme={kernelName:lc,backendName:"webgl",kernelFunc:TD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oE="return a - b;",SD=os({opSnippet:oE,packedOpSnippet:oE,supportsComplex:!0,cpuKernelImpl:Cue}),Sme={kernelName:Bc,backendName:"webgl",kernelFunc:SD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bD(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{dim:o}=s,i=gt([o],r.shape),a=CD({inputs:{x:r},backend:t,attrs:{reductionIndices:i,keepDims:!1}}),l=wn(a.shape,i),u=Ve({inputs:{x:a},backend:t,attrs:{shape:l}}),d=SD({inputs:{a:r,b:u},backend:t}),f=xD({inputs:{x:d},backend:t}),p=a0({inputs:{x:f},backend:t,attrs:{axis:i,keepDims:!1}}),y=Ve({inputs:{x:p},backend:t,attrs:{shape:l}}),v=TD({inputs:{a:f,b:y},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(u),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(f),t.disposeIntermediateTensorInfo(p),t.disposeIntermediateTensorInfo(y),v}const bme={kernelName:Ih,backendName:"webgl",kernelFunc:bD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ime(n){const{inputs:e,backend:t,attrs:s}=n,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s,l=a?r:bD({inputs:{logits:r},backend:t,attrs:{dim:r.shape.length-1}}),u=l.shape[0],d=l.shape[1],f=new vme(u,d,o),p=[[i]],y=t.runWebGLProgram(f,[l],"int32",p);return a||t.disposeIntermediateTensorInfo(l),y}const kme={kernelName:by,backendName:"webgl",kernelFunc:Ime};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nme=Gr+`
  return -x;
`,Eme=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function $me(n){const{inputs:e,backend:t}=n,{x:s}=e;if(t.shouldExecuteOnCPU([s])){const o=t.texData.get(s.dataId),[i,a]=rue(o.values,s.shape,s.dtype);return t.makeTensorInfo(a,s.dtype,i)}let r;return me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new tl(s.shape,Eme):r=new li(s.shape,Nme),t.runWebGLProgram(r,[s],s.dtype)}const Ame={kernelName:lh,backendName:"webgl",kernelFunc:$me};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _me=F1;function Rme(n){fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s,u=t.readSync(r.dataId),d=t.readSync(o.dataId),{selectedIndices:f}=_me(u,d,i,a,l);return t.makeTensorInfo([f.length],"int32",new Int32Array(f))}const Dme={kernelName:Iy,backendName:"webgl",kernelFunc:Rme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fme=M1;function Mme(n){fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:u}=s,d=t.readSync(r.dataId),f=t.readSync(o.dataId),{selectedIndices:p,validOutputs:y}=Fme(d,f,i,a,l,u);return[t.makeTensorInfo([p.length],"int32",new Int32Array(p)),t.makeTensorInfo([],"int32",new Int32Array([y]))]}const Pme={kernelName:ky,backendName:"webgl",kernelFunc:Mme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lme=P1;function Ome(n){fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:s}=n,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:u}=s,d=t.readSync(r.dataId),f=t.readSync(o.dataId),p=i,y=a,v=l,w=u,{selectedIndices:C,selectedScores:S}=Lme(d,f,p,y,v,w);return[t.makeTensorInfo([C.length],"int32",new Int32Array(C)),t.makeTensorInfo([S.length],"float32",new Float32Array(S))]}const Vme={kernelName:Ny,backendName:"webgl",kernelFunc:Ome};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bme{constructor(e,t,s,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zme=n=>{const{inputs:e,backend:t,attrs:s}=n,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s,u=we(r.shape),d=new Bme(u,i,a,l),f=Ve({inputs:{x:r},backend:t,attrs:{shape:[u]}}),p=t.runWebGLProgram(d,[f],o);t.disposeIntermediateTensorInfo(f);const y=[...r.shape,i],v=Ve({inputs:{x:p},backend:t,attrs:{shape:y}});return t.disposeIntermediateTensorInfo(p),v},Ume={kernelName:dh,backendName:"webgl",kernelFunc:zme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zg(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="complex64"){const r=hp({inputs:{input:s},backend:t}),o=zg({inputs:{x:r},backend:t}),i=l0({inputs:{input:s},backend:t}),a=zg({inputs:{x:i},backend:t}),l=Sa({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),l}else return pp({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:t})}const Wme={kernelName:Eh,backendName:"webgl",kernelFunc:zg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ID(n){const{inputs:e,backend:t}=n,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=hp({inputs:{input:s},backend:t}),o=ID({inputs:{x:r},backend:t}),i=l0({inputs:{input:s},backend:t}),a=zg({inputs:{x:i},backend:t}),l=Sa({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(r),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),l}else return pp({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:t})}const Gme={kernelName:ch,backendName:"webgl",kernelFunc:ID};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hme(n){const{inputs:e,backend:t,attrs:s}=n,{axis:r}=s;if(e.length===1)return k2({inputs:{input:e[0]},backend:t,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(d=>{ns(o,d.shape,"All tensors passed to stack must have matching shapes"),B(i===d.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(d=>{const f=k2({inputs:{input:d},backend:t,attrs:{dim:r}});return a.push(f),f}),u=cD({inputs:l,backend:t,attrs:{axis:r}});return a.forEach(d=>t.disposeIntermediateTensorInfo(d)),u}const qme={kernelName:fh,backendName:"webgl",kernelFunc:Hme};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kme{constructor(e,t,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,o=Kt(r),i=t.map(u=>u[0]).join(","),a=t.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xme{constructor(e,t,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((w,C)=>w[0]+e[C]+w[1]);const r=e.length,o=Kt(r),i=t.map(w=>w[0]).join(","),a=t.map((w,C)=>w[0]+e[C]).join(","),l=bs("rc",r),u=bs("source",r),d=`${l[r-1]} < ${this.outputShape[r-1]}`,f=r===1?"source":`vec2(${u.slice(-2).join()})`,p=[`${o} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${d}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${d}) {`],y=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let v="";for(let w=0,C=r===1?2:4;w<C;w++)v+=`
        ${p[w]}
        if (${y}) {
          result[${w}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${w}] = getChannel(getX(${u.join()}), ${f});
        }
      `;v+=r===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kD=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{paddings:o,constantValue:i}=s;if(we(r.shape)===0){const u=o.map((d,f)=>d[0]+r.shape[f]+d[1]);return pp({backend:t,attrs:{shape:u,value:i,dtype:r.dtype}})}const a=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Xme(r.shape,o,i):new Kme(r.shape,o,i),l=[[i]];return t.runWebGLProgram(a,[r],r.dtype,l)},Jme={kernelName:hh,backendName:"webgl",kernelFunc:kD};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yme=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,Qme=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+dp+`
  return result;
`,Zme=os({opSnippet:Yme,packedOpSnippet:Qme}),jme={kernelName:kc,backendName:"webgl",kernelFunc:Zme};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ege(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=[],u=gt(o,r.shape);let d=u;const f=hn(d,a);let p=r;f!=null&&(p=$s({inputs:{x:r},backend:t,attrs:{perm:f}}),d=Cn(d.length,a),l.push(p)),rs("prod",d,a);let y;if(t.shouldExecuteOnCPU([p])){const v=t.texData.get(p.dataId).values,{outVals:w,outShape:C,outDtype:S}=iue(p.shape,p.dtype,v,d);y=t.makeTensorInfo(C,S,w)}else{const[v,w]=Hn(p.shape,d),C=we(w),S=Ve({inputs:{x:p},backend:t,attrs:{shape:[-1,C]}}),b=Qy(r.dtype),E=Pl(S,b,"prod",t);y=Ve({inputs:{x:E},backend:t,attrs:{shape:v}}),l.push(S),l.push(E)}if(i){l.push(y);const v=wn(y.shape,u);y=Ve({inputs:{x:y},backend:t,attrs:{shape:v}})}return l.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}const tge={kernelName:mh,backendName:"webgl",kernelFunc:ege};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nge(n){const{inputs:e,backend:t,attrs:s}=n,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(S=>t.readSync(S.dataId)),u=r.map(S=>S.shape),d=t.readSync(o.dataId),f=t.readSync(i.dataId),[p,y,v]=aue(l,u,d,o.shape,o.dtype,f,i.shape,a),w=p.map(S=>t.makeTensorInfo([S.length],"int32",S)),C=t.makeTensorInfo(v,o.dtype,y);return w.concat([C])}const sge={kernelName:Ey,backendName:"webgl",kernelFunc:nge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rge(n){const{inputs:e,backend:t,attrs:s}=n,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,u=t.readSync(r.dataId),d=t.readSync(o.dataId),f=t.readSync(i.dataId),p=a.map(C=>t.readSync(C.dataId)),y=a.map(C=>C.shape),[v,w]=lue(u,r.shape,d,o.shape,o.dtype,f,i.shape,p,y,l);return t.makeTensorInfo(v,o.dtype,w)}const oge={kernelName:$y,backendName:"webgl",kernelFunc:rge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ND=n=>{const{backend:e,attrs:t}=n,{start:s,stop:r,step:o,dtype:i}=t,a=uue(s,r,o,i);return e.makeTensorInfo([a.length],i,a)},ige={kernelName:Ay,backendName:"webgl",kernelFunc:ND};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const age="return 1.0 / x;",lge=$t({opSnippet:age}),uge={kernelName:Nc,backendName:"webgl",kernelFunc:lge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cge=Gr+`
  return (x < 0.0) ? 0.0 : x;
`,dge=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,fge=$t({opSnippet:cge,packedOpSnippet:dge}),hge={kernelName:Ec,backendName:"webgl",kernelFunc:fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pge=Gr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,mge=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,gge=$t({opSnippet:pge,packedOpSnippet:mge}),yge={kernelName:$c,backendName:"webgl",kernelFunc:gge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xge{constructor(e,t,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,t,s,u];const d=[r&&t>1?a-1:a,r&&s>1?l-1:l],f=[r&&t>1?t-1:t,r&&s>1?s-1:s];let p;o?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/f[0]},
          ${d[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vge{constructor(e,t,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,t,s,u];const d=[r&&t>1?a-1:a,r&&s>1?l-1:l],f=[r&&t>1?t-1:t,r&&s>1?s-1:s];let p;o?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/f[0]},
          ${d[1]/f[1]},
          ${d[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wge(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,u]=a,d=me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new vge(r.shape,l,u,o,i):new xge(r.shape,l,u,o,i);return t.runWebGLProgram(d,[r],"float32")}const Cge={kernelName:xh,backendName:"webgl",kernelFunc:wge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tge{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,o]=t,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],u=[s&&i>1?i-1:i,s&&a>1?a-1:a],d=l[0]/u[0],f=l[1]/u[1],p=1/d,y=1/f,v=Math.ceil(p)*2+2,w=Math.ceil(y)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${f});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${y});

        const int winHeight = int(${v});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sge(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:o}=e,{alignCorners:i}=s,a=new Tge(o.shape,r.shape,i);return t.runWebGLProgram(a,[o],o.dtype)}const bge={kernelName:Dy,backendName:"webgl",kernelFunc:Sge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ige{constructor(e,t,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,t,s,u];const d=[r&&t>1?a-1:a,r&&s>1?l-1:l],f=[r&&t>1?t-1:t,r&&s>1?s-1:s],p=r?"0.5":"0.0";let y;o?y="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":y="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${d[0]/f[0]},
          ${d[1]/f[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${y};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kge{constructor(e,t,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,u]=e;this.outputShape=[i,t,s,u];const d=[r&&t>1?a-1:a,r&&s>1?l-1:l],f=[r&&t>1?t-1:t,r&&s>1?s-1:s],p=r?"0.5":"0.0";let y;o?y="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":y="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${d[0]/f[0]},
          ${d[1]/f[1]},
          ${d[1]/f[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${y};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nge(n){const{inputs:e,backend:t,attrs:s}=n,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,u]=a,d=me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new kge(r.shape,l,u,o,i):new Ige(r.shape,l,u,o,i);return t.runWebGLProgram(d,[r],r.dtype)}const Ege={kernelName:yh,backendName:"webgl",kernelFunc:Nge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $ge{constructor(e,t,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,r,o]=t,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],u=[s&&i>1?i-1:i,s&&a>1?a-1:a],d=l[0]/u[0],f=l[1]/u[1],p=1/d,y=1/f,v=Math.ceil(p)*2+2,w=Math.ceil(y)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${d});
        const float widthScale = float(${f});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${y});

        const int winHeight = int(${v});
        const int winWidth = int(${w});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Age(n){const{inputs:e,backend:t,attrs:s}=n,{images:r,dy:o}=e,{alignCorners:i}=s,a=new $ge(o.shape,r.shape,i);return t.runWebGLProgram(a,[o],o.dtype)}const _ge={kernelName:Ry,backendName:"webgl",kernelFunc:Age};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rge{constructor(e,t){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>t.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>r(l)).join(","),i=Kt(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dge{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=bs("rc",s),o=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=Kt(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${o}){
            result.g = ${u(r.slice())};
          }
          if(${i}) {
            result.b = ${d(r.slice())};
            if(${o}) {
              result.a = ${f(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(v){return p(v)}function u(v){return v[s-1]="("+v[s-1]+" + 1)",p(v)}function d(v){return v[s-2]="("+v[s-2]+" + 1)",p(v)}function f(v){return v[s-1]="("+v[s-1]+" + 1)",v[s-2]="("+v[s-2]+" + 1)",p(v)}function p(v){const w=e.map((b,E)=>y(E,v)),C=w.join(","),S=w.slice(-2).join(",");return`getChannel(getX(${C}), vec2(${S}))`}function y(v,w){return t.indexOf(v)!==-1&&e[v]!==1?`${e[v]} - ${w[v]} - 1`:`${w[v]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fge(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{dims:o}=s,i=r.shape.length,a=gt(o,r.shape);if(i===0)return nr({inputs:{x:r},backend:t});const l=me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Dge(r.shape,a):new Rge(r.shape,a);return t.runWebGLProgram(l,[r],r.dtype)}const Mge={kernelName:vh,backendName:"webgl",kernelFunc:Fge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pge{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let o="";typeof t=="number"?o=`float outputValue = ${t.toFixed(2)};`:o=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lge={kernelName:Jy,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:s}=n,{radians:r,fillValue:o,center:i}=e,a=t,l=new Pge(s.shape,o),[u,d]=vC(i,s.shape[1],s.shape[2]),f=[[u,d,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oge=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,Vge=$t({opSnippet:Oge}),Bge={kernelName:Ac,backendName:"webgl",kernelFunc:Vge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zge="return inversesqrt(x);",Uge=$t({opSnippet:zge,cpuKernelImpl:cue}),Wge={kernelName:_c,backendName:"webgl",kernelFunc:Uge};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ED{constructor(e,t,s,r,o,i,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const l=Kt(o.length),u=Kt(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const f=`getIndices(${d})`;let p="";r===1?p="i":r===2&&(p="i, coords[1]");const y=`getUpdates(${p})`,v=t>1?"strides[j]":"strides";this.userCode=`
        ${l} strides = ${l}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${f});
              flattenedIndex += index * ${v};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${y};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gge(n){const{inputs:e,backend:t,attrs:s}=n,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:u,strides:d,outputSize:f}=Hc(o,r,i),p=[f/u,u];if(f===0)return t.makeTensorInfo(i,r.dtype);const y=Ve({inputs:{x:r},backend:t,attrs:{shape:[l,a]}}),v=Ve({inputs:{x:o},backend:t,attrs:{shape:[l,u]}}),w=t.makeTensorInfo([],"float32",new Float32Array([0])),C=new ED(l,a,y.shape.length,v.shape.length,d,p),S=t.runWebGLProgram(C,[v,y,w],v.dtype),b=Ve({inputs:{x:S},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(y),t.disposeIntermediateTensorInfo(v),t.disposeIntermediateTensorInfo(S),t.disposeIntermediateTensorInfo(w),b}const Hge={kernelName:Fy,backendName:"webgl",kernelFunc:Gge};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class qge{constructor(e,t,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=me().getNumber("WEBGL_VERSION")===2?o:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kge(n){const{inputs:e,backend:t,attrs:s}=n,{sortedSequence:r,values:o}=e,{side:i}=s,a=new qge(r.shape[0],r.shape[1],o.shape[1],i),l=[[r.shape[1]]];return t.runWebGLProgram(a,[r,o],"int32",l)}const Xge={kernelName:My,backendName:"webgl",kernelFunc:Kge};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jge{constructor(e,t,s){this.variableNames=["c","a","b"],this.outputShape=t;let r,o;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)o="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],u=[];for(let d=0;d<t.length;d++)u.push(`${a[d]}`),d<e&&l.push(`${a[d]}`);r=l.join(),o=u.join()}const i=Kt(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yge(n){const{inputs:e,backend:t}=n,{condition:s,t:r,e:o}=e,i=new Jge(s.shape.length,r.shape,r.shape.length);return t.runWebGLProgram(i,[s,r,o],Os(r.dtype,o.dtype))}const Qge={kernelName:wh,backendName:"webgl",kernelFunc:Yge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zge=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${G1};
  float scale = ${H1};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,jge=$t({opSnippet:Zge}),eye={kernelName:Rc,backendName:"webgl",kernelFunc:jge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tye=ld+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,nye=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sye=$t({opSnippet:tye,packedOpSnippet:nye,cpuKernelImpl:fue}),rye={kernelName:Pc,backendName:"webgl",kernelFunc:sye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oye=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,iye=$t({opSnippet:oye}),aye={kernelName:Mc,backendName:"webgl",kernelFunc:iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lye=ld+`
  return sin(x);
`,uye=$t({opSnippet:lye}),cye={kernelName:Dc,backendName:"webgl",kernelFunc:uye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dye=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,fye=$t({opSnippet:dye}),hye={kernelName:Fc,backendName:"webgl",kernelFunc:fye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pye=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,mye=$t({opSnippet:pye}),gye={kernelName:Lc,backendName:"webgl",kernelFunc:mye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yye=n=>{const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{blockShape:o,paddings:i}=s;B(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((S,b)=>S*b),l=[[0,0]];l.push(...i);for(let S=1+o.length;S<r.shape.length;++S)l.push([0,0]);const u=[],d=kD({inputs:{x:r},backend:t,attrs:{paddings:l,constantValue:0}}),f=Jh(d.shape,o,a,!1),p=Yh(f.length,o.length,!1),y=Qh(d.shape,o,a,!1),v=Ve({inputs:{x:d},backend:t,attrs:{shape:f}}),w=$s({inputs:{x:v},backend:t,attrs:{perm:p}}),C=Ve({inputs:{x:w},backend:t,attrs:{shape:y}});return u.push(d),u.push(v),u.push(w),u.forEach(S=>t.disposeIntermediateTensorInfo(S)),C},xye={kernelName:Sh,backendName:"webgl",kernelFunc:yye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vye(n){const{inputs:e,backend:t}=n,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=t.readSync(s.dataId),l=t.readSync(r.dataId),u=t.readSync(o.dataId),d=t.readSync(i.dataId)[0],[f,p,y,v,w]=pue(a,s.shape,s.dtype,l,r.dtype,u,d);return[t.makeTensorInfo(p,s.dtype,f),t.makeTensorInfo([p[0]],r.dtype,y),t.makeTensorInfo([v.length],"bool",new Uint8Array(v.map(C=>Number(C)))),t.makeTensorInfo([w.length],s.dtype,new Int32Array(w))]}const wye={kernelName:Py,backendName:"webgl",kernelFunc:vye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cye(n){const{inputs:e,backend:t}=n,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(t.readSync(r.dataId)),a=t.readSync(s.dataId),l=Array.from(t.readSync(o.dataId)),[u,d,f]=mue(a,s.shape,s.dtype,i,l);return[t.makeTensorInfo(d,s.dtype,u),t.makeTensorInfo([f.length],o.dtype,new Int32Array(f))]}const Tye={kernelName:Ly,backendName:"webgl",kernelFunc:Cye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sye(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=t.readSync(s.dataId),a=t.readSync(r.dataId),l=t.readSync(o.dataId),[u,d]=Q4(i,s.shape,s.dtype,a,l,!0);return t.makeTensorInfo(d,s.dtype,u)}const bye={kernelName:Oy,backendName:"webgl",kernelFunc:Sye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iye(n){const{inputs:e,backend:t}=n,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=t.readSync(s.dataId),a=t.readSync(r.dataId),l=t.readSync(o.dataId),[u,d]=Q4(i,s.shape,s.dtype,a,l);return t.makeTensorInfo(d,s.dtype,u)}const kye={kernelName:Vy,backendName:"webgl",kernelFunc:Iye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nye(n){const{inputs:e,backend:t,attrs:s}=n,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:u,sliceSize:d,strides:f,outputSize:p}=Hc(o,r,a),y=!1;if(o.dtype==="string"){const S=t.bufferSync(r),b=t.bufferSync(o),E=fi(t.readSync(i.dataId)[0]),N=due(S,b,a,p,d,u,l,f,E,y);return t.makeTensorInfo(a,N.dtype,N.values)}const v=new ED(u,l,r.shape.length,o.shape.length,f,[p,1],y),w=t.runWebGLProgram(v,[o,r,i],o.dtype),C=Ve({inputs:{x:w},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(w),C}const Eye={kernelName:By,backendName:"webgl",kernelFunc:Nye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ye(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=gt(i,r.shape)[0],l=FC(r,o,a),u=r.shape.length,d=new Array(u).fill(0),f=r.shape.slice();return l.map(p=>{const y=[...f];y[a]=p;const v=ud({inputs:{x:r},backend:t,attrs:{begin:d,size:y}});return d[a]+=p,v})}const Aye={kernelName:bh,backendName:"webgl",kernelFunc:$ye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iE="return sqrt(x);",_ye=$t({opSnippet:iE,packedOpSnippet:iE,cpuKernelImpl:gue}),Rye={kernelName:Oc,backendName:"webgl",kernelFunc:_ye};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dye="return x * x;",Fye=$t({opSnippet:Dye}),Mye={kernelName:zy,backendName:"webgl",kernelFunc:Fye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aE="return (a - b) * (a - b);",Pye=os({opSnippet:aE,packedOpSnippet:aE}),Lye={kernelName:Vc,backendName:"webgl",kernelFunc:Pye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oye({inputs:n,attrs:e,backend:t}){const{x:s}=n,r=Gr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new li(s.shape,r);return t.runWebGLProgram(o,[s],s.dtype)}const Vye={kernelName:Gc,backendName:"webgl",kernelFunc:Oye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bye{constructor(e,t,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,o=Kt(s.length),i=Kt(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((u,d)=>(l++,s.length===1?`coords * strides[${d}] + begin[${d}]`:`coords[${l-1}] * strides[${d}] + begin[${d}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${t});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zye(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:u,ellipsisMask:d,newAxisMask:f,shrinkAxisMask:p}=s,{finalShapeSparse:y,finalShape:v,isIdentity:w,sliceDim0:C,isSimpleSlice:S,begin:b,end:E,strides:N}=fw(r.shape,o,i,a,l,u,d,f,p);let A;if(w)A=Ve({inputs:{x:r},backend:t,attrs:{shape:v}});else if(C||S){B(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const L=uw(b,E,N),z=ud({inputs:{x:r},backend:t,attrs:{begin:b,size:L}});A=Ve({inputs:{x:z},backend:t,attrs:{shape:v}}),t.disposeIntermediateTensorInfo(z)}else if(t.shouldExecuteOnCPU([r])){const z=t.readSync(r.dataId),M=ht(r.shape,r.dtype,z),P=yue(y,M,N,b);A=t.makeTensorInfo(v,r.dtype,P.values)}else{const z=new Bye(b,N,y);A=t.runWebGLProgram(z,[r],r.dtype)}const R=Ve({inputs:{x:A},backend:t,attrs:{shape:v}});return t.disposeIntermediateTensorInfo(A),R}const Uye={kernelName:Uy,backendName:"webgl",kernelFunc:zye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wye(n){const{inputs:e,backend:t,attrs:s}=n,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:u}=s,{data:d,dataSplits:f}=e,p=t.readSync(d.dataId),y=t.readSync(f.dataId),[v,w]=xue(p,y,r,o,i,a,l,u);return[t.makeTensorInfo([v.length],"string",v),t.makeTensorInfo(f.shape,"int32",w)]}const Gye={kernelName:Wy,backendName:"webgl",kernelFunc:Wye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hye(n){const{inputs:e,backend:t,attrs:s}=n,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=t.readSync(o.dataId),l=t.readSync(i.dataId)[0],[u,d,f]=vue(a,l,r),p=d.length;return[t.makeTensorInfo([p,2],"int32",u),t.makeTensorInfo([p],"string",d),t.makeTensorInfo([2],"int32",new Int32Array(f))]}const qye={kernelName:Gy,backendName:"webgl",kernelFunc:Hye};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kye(n){const{inputs:e,backend:t,attrs:s}=n,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=t.readSync(o.dataId),a=wue(i,r);return t.makeTensorInfo(o.shape,"int32",a)}const Xye={kernelName:Hy,backendName:"webgl",kernelFunc:Kye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jye="return tan(x);",Yye=$t({opSnippet:Jye}),Qye={kernelName:zc,backendName:"webgl",kernelFunc:Yye};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zye=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,jye=$t({opSnippet:Zye}),e1e={kernelName:Uc,backendName:"webgl",kernelFunc:jye};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class t1e{constructor(e,t){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*t[i];this.outputShape=s,this.rank=s.length;const r=Kt(this.rank),o=n1e(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function n1e(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<n.length;r++)s.push(`imod(${t[r]}, ${n[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $D(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{reps:o}=s;if(r.dtype==="string"||r.shape.length>5){const l=t.readSync(r.dataId),u=r.dtype==="string"?l.map(p=>fi(p)):l,d=ht(r.shape,r.dtype,u),f=Tue(d,o);return t.makeTensorInfo(f.shape,f.dtype,f.values)}const i=new t1e(r.shape,o);return t.runWebGLProgram(i,[r],r.dtype)}const s1e={kernelName:Wc,backendName:"webgl",kernelFunc:$D};class r1e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class o1e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function lE(n){let e=1;for(;e<n;)e*=2;return e}function i1e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r}=e,{k:o,sorted:i}=s,a=me().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=me().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,d=u[u.length-1];if(t.shouldExecuteOnCPU([r])||d<a||o>l){const P=t.readSync(r.dataId),[F,q]=Sue(P,u,r.dtype,o,i);return[t.makeTensorInfo(F.shape,F.dtype,F.values),t.makeTensorInfo(q.shape,q.dtype,q.values)]}if(o===0)return u[u.length-1]=0,[t.makeTensorInfo(u,r.dtype,[]),t.makeTensorInfo(u,"int32",[])];if(d===1)return[r,pp({attrs:{shape:u,dtype:"int32",value:0},backend:t})];const f=t.texData.get(r.dataId),p=f!==null&&f.isPacked,y=p?t.unpackTensor(r):r,w=we(u)/d,C=Ve({inputs:{x:y},attrs:{shape:[w,d]},backend:t});p&&Xa(t,y);const S=lE(o),b=lE(d);let E=null;const N=()=>E===null?[C,C]:[C,E],A=(P,F,q)=>{const ee=N(),ue=new r1e(q),de=[[d],[E===null?1:0],[Number.NEGATIVE_INFINITY],[P],[F]],ae=E;E=t.runWebGLProgram(ue,ee,"int32",de),Xa(t,ae)};for(let P=1;P<S;P*=2){const F=P*2;for(let q=P;q>=1;q/=2)A(F,q,[w,b])}for(let P=b;P>S;P/=2){const F=N(),q=new o1e([w,P/2]),ue=[[d],[E===null?1:0],[S]],ie=E;E=t.runWebGLProgram(q,F,"int32",ue),Xa(t,ie);const de=S/2,ae=de*2;for(let J=de;J>=1;J/=2)A(ae,J,E.shape)}let R=E;E=ud({inputs:{x:E},backend:t,attrs:{begin:0,size:[w,o]}}),Xa(t,R);let L=wD({inputs:{x:C,indices:E},backend:t,attrs:{axis:1,batchDims:1}});Xa(t,C);const z=u.slice(0,-1);z.push(o),R=E,E=Ve({inputs:{x:E},attrs:{shape:z},backend:t}),Xa(t,R);const M=L;return L=Ve({inputs:{x:L},attrs:{shape:z},backend:t}),Xa(t,M),[L,E]}const a1e={kernelName:qy,backendName:"webgl",kernelFunc:i1e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l1e{constructor(e,t,s,r,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u1e(n){const{inputs:e,backend:t,attrs:s}=n,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:u}=s,[d,f,p,y]=r.shape,[v,w]=u??[f,p],C=[d,v,w,y],S=new l1e(f,p,i,a,l,C);return t.runWebGLProgram(S,[r,o],"float32")}const c1e={kernelName:Ky,backendName:"webgl",kernelFunc:u1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d1e(n){const{inputs:e,attrs:t,backend:s}=n,{axis:r}=t,{x:o}=e;up(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(o.dataId),{outputValues:a,outputShape:l,indices:u}=bue(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([u.length],"int32",u)]}const f1e={kernelName:Xy,backendName:"webgl",kernelFunc:d1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h1e(n){const{inputs:e,backend:t,attrs:s}=n,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r,a=i.shape.length,l=r.shape[o],u=new Array(a-1);let d=0;for(let w=0;w<a;w++)w!==o&&(u[d++]=i.shape[w]);const f=[],p=new Array(a).fill(0),y=i.shape.slice();y[o]=1;const v=new Array(l);for(let w=0;w<v.length;w++){p[o]=w;const C=ud({inputs:{x:i},backend:t,attrs:{begin:p,size:y}}),S=Ve({inputs:{x:C},backend:t,attrs:{shape:u}});v[w]=S,f.push(C)}return f.forEach(w=>t.disposeIntermediateTensorInfo(w)),v}const p1e={kernelName:kh,backendName:"webgl",kernelFunc:h1e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m1e{constructor(e,t){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/s);this.outputShape=[r,a];const l="0.0",u="sumValue",d=Math.floor(s/4)*4,f=s%4,p=`
        sumValue += dot(values, segFilter);
    `;let y="";o%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let v="";o%s>0&&(v=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${v}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${d}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${d};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g1e(n){const{inputs:e,backend:t,attrs:s}=n,{x:r,segmentIds:o}=e,{numSegments:i}=s,a=r.shape.length,l=[];let u=0;const d=hn([u],a);let f=r;d!=null&&(f=$s({inputs:{x:r},backend:t,attrs:{perm:d}}),l.push(f),u=Cn(1,a)[0]);const p=uA(f.shape,u,i),y=we([f.shape[u]]),v=Ve({inputs:{x:f},backend:t,attrs:{shape:[-1,y]}});l.push(v);const w=Qy(r.dtype),C=(N,A,R,L,z)=>{const M=N.shape[0],P=N.shape[1],F=lA(P,z),q={windowSize:F,inSize:P,batchSize:M,numSegments:z},ee=new m1e(q,A),ue=t.compileAndRun(ee,[N,R],L);if(l.push(ue),ue.shape[1]===z)return ue;const ie=ND({backend:t,attrs:{start:0,stop:z,step:1,dtype:"float32"}}),de=$D({inputs:{x:ie},backend:t,attrs:{reps:[P/F]}});return l.push(ie),l.push(de),C(ue,A,de,L,z)},S=C(v,"unsortedSegmentSum",o,w,i),b=Ve({inputs:{x:S},backend:t,attrs:{shape:p}});let E=b;if(d!=null){l.push(b);const N=xa(d);E=$s({inputs:{x:E},backend:t,attrs:{perm:N}})}return l.forEach(N=>t.disposeIntermediateTensorInfo(N)),E}const y1e={kernelName:Nh,backendName:"webgl",kernelFunc:g1e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x1e=[mce,yce,wce,Sce,Ice,Ece,Ace,Rce,Pce,Oce,zce,Gce,Kce,Qce,ede,nde,rde,lde,cde,fde,gde,Sde,Ide,Nde,Dde,Mde,Vde,Zue,Ude,Kde,Qde,sfe,ofe,afe,ufe,dfe,pfe,yfe,wfe,Tfe,bfe,kfe,$fe,_fe,Mfe,Lfe,Bfe,Wfe,Hfe,Jfe,jfe,she,ihe,uhe,che,fhe,phe,ghe,xhe,whe,bhe,Nhe,Ahe,Rhe,Mhe,Ohe,Uhe,qhe,Que,Xhe,Hde,Qhe,epe,spe,ece,ape,dpe,hpe,ype,wpe,bpe,Npe,_pe,Mpe,Ope,Bpe,Gpe,qpe,Xpe,Zpe,eme,nme,rme,ime,cme,pme,xme,kme,sce,Ame,Dme,Pme,Vme,$de,Ume,Gme,qme,Jme,jme,nce,tge,sge,oge,ige,Ade,Tme,uge,hge,yge,oce,Cge,bge,Ege,_ge,Mge,Lge,Bge,Wge,Hge,Xge,Qge,eye,rye,aye,cye,hye,Cde,bme,gye,xye,wye,Tye,bye,kye,Eye,Aye,Rye,Mye,Lye,Vye,Uye,Gye,qye,Xye,Sme,fce,Qye,e1e,s1e,a1e,c1e,hce,f1e,p1e,y1e,Wme];for(const n of x1e)Yy(n);let uE=!1;const v1e=async()=>{uE||(await k3("webgl"),await N3(),uE=!0)};v1e().then(()=>{const n=document.getElementById("root");if(!n)throw new Error("Could not find root element to mount to");hM.createRoot(n).render(xe.jsx(vv.StrictMode,{children:xe.jsx(FY,{})}))});
